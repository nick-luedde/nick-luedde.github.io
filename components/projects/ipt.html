<!DOCTYPE html>
<html class="dark-theme" lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <base target="_top">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:FILL@1" />
  <title>Apps Projects</title>
  
  <style>
/*! bulma.io v0.9.4 | MIT License | github.com/jgthms/bulma */
/* Bulma Utilities */
.button, .input, .textarea, .select select, .file-cta,
.file-name, .pagination-previous,
.pagination-next,
.pagination-link,
.pagination-ellipsis {
  -moz-appearance: none;
  -webkit-appearance: none;
  align-items: center;
  border: 1px solid transparent;
  border-radius: 4px;
  box-shadow: none;
  display: inline-flex;
  font-size: 1rem;
  height: 2.5em;
  justify-content: flex-start;
  line-height: 1.5;
  padding-bottom: calc(0.5em - 1px);
  padding-left: calc(0.75em - 1px);
  padding-right: calc(0.75em - 1px);
  padding-top: calc(0.5em - 1px);
  position: relative;
  vertical-align: top; }
  .button:focus, .input:focus, .textarea:focus, .select select:focus, .file-cta:focus,
  .file-name:focus, .pagination-previous:focus,
  .pagination-next:focus,
  .pagination-link:focus,
  .pagination-ellipsis:focus, .is-focused.button, .is-focused.input, .is-focused.textarea, .select select.is-focused, .is-focused.file-cta,
  .is-focused.file-name, .is-focused.pagination-previous,
  .is-focused.pagination-next,
  .is-focused.pagination-link,
  .is-focused.pagination-ellipsis, .button:active, .input:active, .textarea:active, .select select:active, .file-cta:active,
  .file-name:active, .pagination-previous:active,
  .pagination-next:active,
  .pagination-link:active,
  .pagination-ellipsis:active, .is-active.button, .is-active.input, .is-active.textarea, .select select.is-active, .is-active.file-cta,
  .is-active.file-name, .is-active.pagination-previous,
  .is-active.pagination-next,
  .is-active.pagination-link,
  .is-active.pagination-ellipsis {
    outline: none; }
  .button[disabled], .input[disabled], .textarea[disabled], .select select[disabled], .file-cta[disabled],
  .file-name[disabled], .pagination-previous[disabled],
  .pagination-next[disabled],
  .pagination-link[disabled],
  .pagination-ellipsis[disabled],
  fieldset[disabled] .button,
  fieldset[disabled] .input,
  fieldset[disabled] .textarea,
  fieldset[disabled] .select select,
  .select fieldset[disabled] select,
  fieldset[disabled] .file-cta,
  fieldset[disabled] .file-name,
  fieldset[disabled] .pagination-previous,
  fieldset[disabled] .pagination-next,
  fieldset[disabled] .pagination-link,
  fieldset[disabled] .pagination-ellipsis {
    cursor: not-allowed; }

.button, .file, .breadcrumb, .pagination-previous,
.pagination-next,
.pagination-link,
.pagination-ellipsis, .tabs, .is-unselectable {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none; }

.select:not(.is-multiple):not(.is-loading)::after, .navbar-link:not(.is-arrowless)::after {
  border: 3px solid transparent;
  border-radius: 2px;
  border-right: 0;
  border-top: 0;
  content: " ";
  display: block;
  height: 0.625em;
  margin-top: -0.4375em;
  pointer-events: none;
  position: absolute;
  top: 50%;
  transform: rotate(-45deg);
  transform-origin: center;
  width: 0.625em; }

.box:not(:last-child), .content:not(:last-child), .notification:not(:last-child), .progress:not(:last-child), .table:not(:last-child), .table-container:not(:last-child), .title:not(:last-child),
.subtitle:not(:last-child), .block:not(:last-child), .breadcrumb:not(:last-child), .level:not(:last-child), .message:not(:last-child), .pagination:not(:last-child), .tabs:not(:last-child) {
  margin-bottom: 1.5rem; }

.delete, .modal-close {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -moz-appearance: none;
  -webkit-appearance: none;
  background-color: rgba(242, 242, 242, 0.2);
  border: none;
  border-radius: 9999px;
  cursor: pointer;
  pointer-events: auto;
  display: inline-block;
  flex-grow: 0;
  flex-shrink: 0;
  font-size: 0;
  height: 20px;
  max-height: 20px;
  max-width: 20px;
  min-height: 20px;
  min-width: 20px;
  outline: none;
  position: relative;
  vertical-align: top;
  width: 20px; }
  .delete::before, .modal-close::before, .delete::after, .modal-close::after {
    background-color: #171717;
    content: "";
    display: block;
    left: 50%;
    position: absolute;
    top: 50%;
    transform: translateX(-50%) translateY(-50%) rotate(45deg);
    transform-origin: center center; }
  .delete::before, .modal-close::before {
    height: 2px;
    width: 50%; }
  .delete::after, .modal-close::after {
    height: 50%;
    width: 2px; }
  .delete:hover, .modal-close:hover, .delete:focus, .modal-close:focus {
    background-color: rgba(242, 242, 242, 0.3); }
  .delete:active, .modal-close:active {
    background-color: rgba(242, 242, 242, 0.4); }
  .is-small.delete, .is-small.modal-close {
    height: 16px;
    max-height: 16px;
    max-width: 16px;
    min-height: 16px;
    min-width: 16px;
    width: 16px; }
  .is-medium.delete, .is-medium.modal-close {
    height: 24px;
    max-height: 24px;
    max-width: 24px;
    min-height: 24px;
    min-width: 24px;
    width: 24px; }
  .is-large.delete, .is-large.modal-close {
    height: 32px;
    max-height: 32px;
    max-width: 32px;
    min-height: 32px;
    min-width: 32px;
    width: 32px; }

.button.is-loading::after, .loader, .select.is-loading::after, .control.is-loading::after {
  animation: spinAround 500ms infinite linear;
  border: 2px solid #363636;
  border-radius: 9999px;
  border-right-color: transparent;
  border-top-color: transparent;
  content: "";
  display: block;
  height: 1em;
  position: relative;
  width: 1em; }

.image.is-square img,
.image.is-square .has-ratio, .image.is-1by1 img,
.image.is-1by1 .has-ratio, .image.is-5by4 img,
.image.is-5by4 .has-ratio, .image.is-4by3 img,
.image.is-4by3 .has-ratio, .image.is-3by2 img,
.image.is-3by2 .has-ratio, .image.is-5by3 img,
.image.is-5by3 .has-ratio, .image.is-16by9 img,
.image.is-16by9 .has-ratio, .image.is-2by1 img,
.image.is-2by1 .has-ratio, .image.is-3by1 img,
.image.is-3by1 .has-ratio, .image.is-4by5 img,
.image.is-4by5 .has-ratio, .image.is-3by4 img,
.image.is-3by4 .has-ratio, .image.is-2by3 img,
.image.is-2by3 .has-ratio, .image.is-3by5 img,
.image.is-3by5 .has-ratio, .image.is-9by16 img,
.image.is-9by16 .has-ratio, .image.is-1by2 img,
.image.is-1by2 .has-ratio, .image.is-1by3 img,
.image.is-1by3 .has-ratio, .modal, .modal-background, .is-overlay, .hero-video {
  bottom: 0;
  left: 0;
  position: absolute;
  right: 0;
  top: 0; }

.navbar-burger {
  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background: none;
  border: none;
  color: currentColor;
  font-family: inherit;
  font-size: 1em;
  margin: 0;
  padding: 0; }

/* Bulma Base */
/*! minireset.css v0.0.6 | MIT License | github.com/jgthms/minireset.css */
html,
body,
p,
ol,
ul,
li,
dl,
dt,
dd,
blockquote,
figure,
fieldset,
legend,
textarea,
pre,
iframe,
hr,
h1,
h2,
h3,
h4,
h5,
h6 {
  margin: 0;
  padding: 0; }

h1,
h2,
h3,
h4,
h5,
h6 {
  font-size: 100%;
  font-weight: normal; }

ul {
  list-style: none; }

button,
input,
select,
textarea {
  margin: 0; }

html {
  box-sizing: border-box; }

*, *::before, *::after {
  box-sizing: inherit; }

img,
video {
  height: auto;
  max-width: 100%; }

iframe {
  border: 0; }

table {
  border-collapse: collapse;
  border-spacing: 0; }

td,
th {
  padding: 0; }
  td:not([align]),
  th:not([align]) {
    text-align: inherit; }

html {
  background-color: #171717;
  font-size: 16px;
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  min-width: 300px;
  overflow-x: hidden;
  overflow-y: scroll;
  text-rendering: optimizeLegibility;
  text-size-adjust: 100%; }

article,
aside,
figure,
footer,
header,
hgroup,
section {
  display: block; }

body,
button,
input,
optgroup,
select,
textarea {
  font-family: "Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif; }

code,
pre {
  -moz-osx-font-smoothing: auto;
  -webkit-font-smoothing: auto;
  font-family: monospace; }

body {
  color: #b5b5b5;
  font-size: 1em;
  font-weight: 400;
  line-height: 1.5; }

a {
  color: #467CFB;
  cursor: pointer;
  text-decoration: none; }
  a strong {
    color: currentColor; }
  a:hover {
    color: #dbdbdb; }

code {
  background-color: #242424;
  color: #c60532;
  font-size: 0.875em;
  font-weight: normal;
  padding: 0.25em 0.5em 0.25em; }

hr {
  background-color: #242424;
  border: none;
  display: block;
  height: 2px;
  margin: 1.5rem 0; }

img {
  height: auto;
  max-width: 100%; }

input[type="checkbox"],
input[type="radio"] {
  vertical-align: baseline; }

small {
  font-size: 0.875em; }

span {
  font-style: inherit;
  font-weight: inherit; }

strong {
  color: #dbdbdb;
  font-weight: 700; }

fieldset {
  border: none; }

pre {
  -webkit-overflow-scrolling: touch;
  background-color: #242424;
  color: #b5b5b5;
  font-size: 0.875em;
  overflow-x: auto;
  padding: 1.25rem 1.5rem;
  white-space: pre;
  word-wrap: normal; }
  pre code {
    background-color: transparent;
    color: currentColor;
    font-size: 1em;
    padding: 0; }

table td,
table th {
  vertical-align: top; }
  table td:not([align]),
  table th:not([align]) {
    text-align: inherit; }

table th {
  color: #dbdbdb; }

@keyframes spinAround {
  from {
    transform: rotate(0deg); }
  to {
    transform: rotate(359deg); } }

/* Bulma Elements */
.box {
  background-color: #171717;
  border-radius: 6px;
  box-shadow: 0 0.5em 1em -0.125em rgba(242, 242, 242, 0.1), 0 0px 0 1px rgba(242, 242, 242, 0.02);
  color: #b5b5b5;
  display: block;
  padding: 1.25rem; }

a.box:hover, a.box:focus {
  box-shadow: 0 0.5em 1em -0.125em rgba(242, 242, 242, 0.1), 0 0 0 1px #467CFB; }

a.box:active {
  box-shadow: inset 0 1px 2px rgba(242, 242, 242, 0.2), 0 0 0 1px #467CFB; }

.button {
  background-color: #171717;
  border-color: #363636;
  border-width: 1px;
  color: #dbdbdb;
  cursor: pointer;
  justify-content: center;
  padding-bottom: calc(0.5em - 1px);
  padding-left: 1em;
  padding-right: 1em;
  padding-top: calc(0.5em - 1px);
  text-align: center;
  white-space: nowrap; }
  .button strong {
    color: inherit; }
  .button .icon, .button .icon.is-small, .button .icon.is-medium, .button .icon.is-large {
    height: 1.5em;
    width: 1.5em; }
  .button .icon:first-child:not(:last-child) {
    margin-left: calc(-0.5em - 1px);
    margin-right: 0.25em; }
  .button .icon:last-child:not(:first-child) {
    margin-left: 0.25em;
    margin-right: calc(-0.5em - 1px); }
  .button .icon:first-child:last-child {
    margin-left: calc(-0.5em - 1px);
    margin-right: calc(-0.5em - 1px); }
  .button:hover, .button.is-hovered {
    border-color: #4a4a4a;
    color: #dbdbdb; }
  .button:focus, .button.is-focused {
    border-color: #467CFB;
    color: #dbdbdb; }
    .button:focus:not(:active), .button.is-focused:not(:active) {
      box-shadow: 0 0 0 0.125em rgba(70, 124, 251, 0.25); }
  .button:active, .button.is-active {
    border-color: #b5b5b5;
    color: #dbdbdb; }
  .button.is-text {
    background-color: transparent;
    border-color: transparent;
    color: #b5b5b5;
    text-decoration: underline; }
    .button.is-text:hover, .button.is-text.is-hovered, .button.is-text:focus, .button.is-text.is-focused {
      background-color: #242424;
      color: #dbdbdb; }
    .button.is-text:active, .button.is-text.is-active {
      background-color: #171717;
      color: #dbdbdb; }
    .button.is-text[disabled],
    fieldset[disabled] .button.is-text {
      background-color: transparent;
      border-color: transparent;
      box-shadow: none; }
  .button.is-ghost {
    background: none;
    border-color: transparent;
    color: #467CFB;
    text-decoration: none; }
    .button.is-ghost:hover, .button.is-ghost.is-hovered {
      color: #467CFB;
      text-decoration: underline; }
  .button.is-white {
    background-color: #171717;
    border-color: transparent;
    color: #f2f2f2; }
    .button.is-white:hover, .button.is-white.is-hovered {
      background-color: #111111;
      border-color: transparent;
      color: #f2f2f2; }
    .button.is-white:focus, .button.is-white.is-focused {
      border-color: transparent;
      color: #f2f2f2; }
      .button.is-white:focus:not(:active), .button.is-white.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(23, 23, 23, 0.25); }
    .button.is-white:active, .button.is-white.is-active {
      background-color: #0a0a0a;
      border-color: transparent;
      color: #f2f2f2; }
    .button.is-white[disabled],
    fieldset[disabled] .button.is-white {
      background-color: #171717;
      border-color: #171717;
      box-shadow: none; }
    .button.is-white.is-inverted {
      background-color: #f2f2f2;
      color: #171717; }
      .button.is-white.is-inverted:hover, .button.is-white.is-inverted.is-hovered {
        background-color: #e6e6e6; }
      .button.is-white.is-inverted[disabled],
      fieldset[disabled] .button.is-white.is-inverted {
        background-color: #f2f2f2;
        border-color: transparent;
        box-shadow: none;
        color: #171717; }
    .button.is-white.is-loading::after {
      border-color: transparent transparent #f2f2f2 #f2f2f2 !important; }
    .button.is-white.is-outlined {
      background-color: transparent;
      border-color: #171717;
      color: #171717; }
      .button.is-white.is-outlined:hover, .button.is-white.is-outlined.is-hovered, .button.is-white.is-outlined:focus, .button.is-white.is-outlined.is-focused {
        background-color: #171717;
        border-color: #171717;
        color: #f2f2f2; }
      .button.is-white.is-outlined.is-loading::after {
        border-color: transparent transparent #171717 #171717 !important; }
      .button.is-white.is-outlined.is-loading:hover::after, .button.is-white.is-outlined.is-loading.is-hovered::after, .button.is-white.is-outlined.is-loading:focus::after, .button.is-white.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #f2f2f2 #f2f2f2 !important; }
      .button.is-white.is-outlined[disabled],
      fieldset[disabled] .button.is-white.is-outlined {
        background-color: transparent;
        border-color: #171717;
        box-shadow: none;
        color: #171717; }
    .button.is-white.is-inverted.is-outlined {
      background-color: transparent;
      border-color: #f2f2f2;
      color: #f2f2f2; }
      .button.is-white.is-inverted.is-outlined:hover, .button.is-white.is-inverted.is-outlined.is-hovered, .button.is-white.is-inverted.is-outlined:focus, .button.is-white.is-inverted.is-outlined.is-focused {
        background-color: #f2f2f2;
        color: #171717; }
      .button.is-white.is-inverted.is-outlined.is-loading:hover::after, .button.is-white.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-white.is-inverted.is-outlined.is-loading:focus::after, .button.is-white.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #171717 #171717 !important; }
      .button.is-white.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-white.is-inverted.is-outlined {
        background-color: transparent;
        border-color: #f2f2f2;
        box-shadow: none;
        color: #f2f2f2; }
  .button.is-black {
    background-color: #f2f2f2;
    border-color: transparent;
    color: #171717; }
    .button.is-black:hover, .button.is-black.is-hovered {
      background-color: #ececec;
      border-color: transparent;
      color: #171717; }
    .button.is-black:focus, .button.is-black.is-focused {
      border-color: transparent;
      color: #171717; }
      .button.is-black:focus:not(:active), .button.is-black.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(242, 242, 242, 0.25); }
    .button.is-black:active, .button.is-black.is-active {
      background-color: #e6e6e6;
      border-color: transparent;
      color: #171717; }
    .button.is-black[disabled],
    fieldset[disabled] .button.is-black {
      background-color: #f2f2f2;
      border-color: #f2f2f2;
      box-shadow: none; }
    .button.is-black.is-inverted {
      background-color: #171717;
      color: #f2f2f2; }
      .button.is-black.is-inverted:hover, .button.is-black.is-inverted.is-hovered {
        background-color: #0a0a0a; }
      .button.is-black.is-inverted[disabled],
      fieldset[disabled] .button.is-black.is-inverted {
        background-color: #171717;
        border-color: transparent;
        box-shadow: none;
        color: #f2f2f2; }
    .button.is-black.is-loading::after {
      border-color: transparent transparent #171717 #171717 !important; }
    .button.is-black.is-outlined {
      background-color: transparent;
      border-color: #f2f2f2;
      color: #f2f2f2; }
      .button.is-black.is-outlined:hover, .button.is-black.is-outlined.is-hovered, .button.is-black.is-outlined:focus, .button.is-black.is-outlined.is-focused {
        background-color: #f2f2f2;
        border-color: #f2f2f2;
        color: #171717; }
      .button.is-black.is-outlined.is-loading::after {
        border-color: transparent transparent #f2f2f2 #f2f2f2 !important; }
      .button.is-black.is-outlined.is-loading:hover::after, .button.is-black.is-outlined.is-loading.is-hovered::after, .button.is-black.is-outlined.is-loading:focus::after, .button.is-black.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #171717 #171717 !important; }
      .button.is-black.is-outlined[disabled],
      fieldset[disabled] .button.is-black.is-outlined {
        background-color: transparent;
        border-color: #f2f2f2;
        box-shadow: none;
        color: #f2f2f2; }
    .button.is-black.is-inverted.is-outlined {
      background-color: transparent;
      border-color: #171717;
      color: #171717; }
      .button.is-black.is-inverted.is-outlined:hover, .button.is-black.is-inverted.is-outlined.is-hovered, .button.is-black.is-inverted.is-outlined:focus, .button.is-black.is-inverted.is-outlined.is-focused {
        background-color: #171717;
        color: #f2f2f2; }
      .button.is-black.is-inverted.is-outlined.is-loading:hover::after, .button.is-black.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-black.is-inverted.is-outlined.is-loading:focus::after, .button.is-black.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #f2f2f2 #f2f2f2 !important; }
      .button.is-black.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-black.is-inverted.is-outlined {
        background-color: transparent;
        border-color: #171717;
        box-shadow: none;
        color: #171717; }
  .button.is-light {
    background-color: #363636;
    border-color: transparent;
    color: #fff; }
    .button.is-light:hover, .button.is-light.is-hovered {
      background-color: #2f2f2f;
      border-color: transparent;
      color: #fff; }
    .button.is-light:focus, .button.is-light.is-focused {
      border-color: transparent;
      color: #fff; }
      .button.is-light:focus:not(:active), .button.is-light.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(54, 54, 54, 0.25); }
    .button.is-light:active, .button.is-light.is-active {
      background-color: #292929;
      border-color: transparent;
      color: #fff; }
    .button.is-light[disabled],
    fieldset[disabled] .button.is-light {
      background-color: #363636;
      border-color: #363636;
      box-shadow: none; }
    .button.is-light.is-inverted {
      background-color: #fff;
      color: #363636; }
      .button.is-light.is-inverted:hover, .button.is-light.is-inverted.is-hovered {
        background-color: #f2f2f2; }
      .button.is-light.is-inverted[disabled],
      fieldset[disabled] .button.is-light.is-inverted {
        background-color: #fff;
        border-color: transparent;
        box-shadow: none;
        color: #363636; }
    .button.is-light.is-loading::after {
      border-color: transparent transparent #fff #fff !important; }
    .button.is-light.is-outlined {
      background-color: transparent;
      border-color: #363636;
      color: #363636; }
      .button.is-light.is-outlined:hover, .button.is-light.is-outlined.is-hovered, .button.is-light.is-outlined:focus, .button.is-light.is-outlined.is-focused {
        background-color: #363636;
        border-color: #363636;
        color: #fff; }
      .button.is-light.is-outlined.is-loading::after {
        border-color: transparent transparent #363636 #363636 !important; }
      .button.is-light.is-outlined.is-loading:hover::after, .button.is-light.is-outlined.is-loading.is-hovered::after, .button.is-light.is-outlined.is-loading:focus::after, .button.is-light.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #fff #fff !important; }
      .button.is-light.is-outlined[disabled],
      fieldset[disabled] .button.is-light.is-outlined {
        background-color: transparent;
        border-color: #363636;
        box-shadow: none;
        color: #363636; }
    .button.is-light.is-inverted.is-outlined {
      background-color: transparent;
      border-color: #fff;
      color: #fff; }
      .button.is-light.is-inverted.is-outlined:hover, .button.is-light.is-inverted.is-outlined.is-hovered, .button.is-light.is-inverted.is-outlined:focus, .button.is-light.is-inverted.is-outlined.is-focused {
        background-color: #fff;
        color: #363636; }
      .button.is-light.is-inverted.is-outlined.is-loading:hover::after, .button.is-light.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-light.is-inverted.is-outlined.is-loading:focus::after, .button.is-light.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #363636 #363636 !important; }
      .button.is-light.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-light.is-inverted.is-outlined {
        background-color: transparent;
        border-color: #fff;
        box-shadow: none;
        color: #fff; }
  .button.is-dark {
    background-color: #e6e6e6;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
    .button.is-dark:hover, .button.is-dark.is-hovered {
      background-color: #dfdfdf;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-dark:focus, .button.is-dark.is-focused {
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
      .button.is-dark:focus:not(:active), .button.is-dark.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(230, 230, 230, 0.25); }
    .button.is-dark:active, .button.is-dark.is-active {
      background-color: #d9d9d9;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-dark[disabled],
    fieldset[disabled] .button.is-dark {
      background-color: #e6e6e6;
      border-color: #e6e6e6;
      box-shadow: none; }
    .button.is-dark.is-inverted {
      background-color: rgba(0, 0, 0, 0.7);
      color: #e6e6e6; }
      .button.is-dark.is-inverted:hover, .button.is-dark.is-inverted.is-hovered {
        background-color: rgba(0, 0, 0, 0.7); }
      .button.is-dark.is-inverted[disabled],
      fieldset[disabled] .button.is-dark.is-inverted {
        background-color: rgba(0, 0, 0, 0.7);
        border-color: transparent;
        box-shadow: none;
        color: #e6e6e6; }
    .button.is-dark.is-loading::after {
      border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
    .button.is-dark.is-outlined {
      background-color: transparent;
      border-color: #e6e6e6;
      color: #e6e6e6; }
      .button.is-dark.is-outlined:hover, .button.is-dark.is-outlined.is-hovered, .button.is-dark.is-outlined:focus, .button.is-dark.is-outlined.is-focused {
        background-color: #e6e6e6;
        border-color: #e6e6e6;
        color: rgba(0, 0, 0, 0.7); }
      .button.is-dark.is-outlined.is-loading::after {
        border-color: transparent transparent #e6e6e6 #e6e6e6 !important; }
      .button.is-dark.is-outlined.is-loading:hover::after, .button.is-dark.is-outlined.is-loading.is-hovered::after, .button.is-dark.is-outlined.is-loading:focus::after, .button.is-dark.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
      .button.is-dark.is-outlined[disabled],
      fieldset[disabled] .button.is-dark.is-outlined {
        background-color: transparent;
        border-color: #e6e6e6;
        box-shadow: none;
        color: #e6e6e6; }
    .button.is-dark.is-inverted.is-outlined {
      background-color: transparent;
      border-color: rgba(0, 0, 0, 0.7);
      color: rgba(0, 0, 0, 0.7); }
      .button.is-dark.is-inverted.is-outlined:hover, .button.is-dark.is-inverted.is-outlined.is-hovered, .button.is-dark.is-inverted.is-outlined:focus, .button.is-dark.is-inverted.is-outlined.is-focused {
        background-color: rgba(0, 0, 0, 0.7);
        color: #e6e6e6; }
      .button.is-dark.is-inverted.is-outlined.is-loading:hover::after, .button.is-dark.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-dark.is-inverted.is-outlined.is-loading:focus::after, .button.is-dark.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #e6e6e6 #e6e6e6 !important; }
      .button.is-dark.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-dark.is-inverted.is-outlined {
        background-color: transparent;
        border-color: rgba(0, 0, 0, 0.7);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.7); }
  .button.is-primary {
    background-color: #0E87C8;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
    .button.is-primary:hover, .button.is-primary.is-hovered {
      background-color: #0d7fbc;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-primary:focus, .button.is-primary.is-focused {
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
      .button.is-primary:focus:not(:active), .button.is-primary.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(14, 135, 200, 0.25); }
    .button.is-primary:active, .button.is-primary.is-active {
      background-color: #0c77b0;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-primary[disabled],
    fieldset[disabled] .button.is-primary {
      background-color: #0E87C8;
      border-color: #0E87C8;
      box-shadow: none; }
    .button.is-primary.is-inverted {
      background-color: rgba(0, 0, 0, 0.7);
      color: #0E87C8; }
      .button.is-primary.is-inverted:hover, .button.is-primary.is-inverted.is-hovered {
        background-color: rgba(0, 0, 0, 0.7); }
      .button.is-primary.is-inverted[disabled],
      fieldset[disabled] .button.is-primary.is-inverted {
        background-color: rgba(0, 0, 0, 0.7);
        border-color: transparent;
        box-shadow: none;
        color: #0E87C8; }
    .button.is-primary.is-loading::after {
      border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
    .button.is-primary.is-outlined {
      background-color: transparent;
      border-color: #0E87C8;
      color: #0E87C8; }
      .button.is-primary.is-outlined:hover, .button.is-primary.is-outlined.is-hovered, .button.is-primary.is-outlined:focus, .button.is-primary.is-outlined.is-focused {
        background-color: #0E87C8;
        border-color: #0E87C8;
        color: rgba(0, 0, 0, 0.7); }
      .button.is-primary.is-outlined.is-loading::after {
        border-color: transparent transparent #0E87C8 #0E87C8 !important; }
      .button.is-primary.is-outlined.is-loading:hover::after, .button.is-primary.is-outlined.is-loading.is-hovered::after, .button.is-primary.is-outlined.is-loading:focus::after, .button.is-primary.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
      .button.is-primary.is-outlined[disabled],
      fieldset[disabled] .button.is-primary.is-outlined {
        background-color: transparent;
        border-color: #0E87C8;
        box-shadow: none;
        color: #0E87C8; }
    .button.is-primary.is-inverted.is-outlined {
      background-color: transparent;
      border-color: rgba(0, 0, 0, 0.7);
      color: rgba(0, 0, 0, 0.7); }
      .button.is-primary.is-inverted.is-outlined:hover, .button.is-primary.is-inverted.is-outlined.is-hovered, .button.is-primary.is-inverted.is-outlined:focus, .button.is-primary.is-inverted.is-outlined.is-focused {
        background-color: rgba(0, 0, 0, 0.7);
        color: #0E87C8; }
      .button.is-primary.is-inverted.is-outlined.is-loading:hover::after, .button.is-primary.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-primary.is-inverted.is-outlined.is-loading:focus::after, .button.is-primary.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #0E87C8 #0E87C8 !important; }
      .button.is-primary.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-primary.is-inverted.is-outlined {
        background-color: transparent;
        border-color: rgba(0, 0, 0, 0.7);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.7); }
    .button.is-primary.is-light {
      background-color: #ecf7fe;
      color: #0e8acd; }
      .button.is-primary.is-light:hover, .button.is-primary.is-light.is-hovered {
        background-color: #e0f3fd;
        border-color: transparent;
        color: #0e8acd; }
      .button.is-primary.is-light:active, .button.is-primary.is-light.is-active {
        background-color: #d4eefc;
        border-color: transparent;
        color: #0e8acd; }
  .button.is-link {
    background-color: #467CFB;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
    .button.is-link:hover, .button.is-link.is-hovered {
      background-color: #3a73fb;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-link:focus, .button.is-link.is-focused {
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
      .button.is-link:focus:not(:active), .button.is-link.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(70, 124, 251, 0.25); }
    .button.is-link:active, .button.is-link.is-active {
      background-color: #2d6afa;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-link[disabled],
    fieldset[disabled] .button.is-link {
      background-color: #467CFB;
      border-color: #467CFB;
      box-shadow: none; }
    .button.is-link.is-inverted {
      background-color: rgba(0, 0, 0, 0.7);
      color: #467CFB; }
      .button.is-link.is-inverted:hover, .button.is-link.is-inverted.is-hovered {
        background-color: rgba(0, 0, 0, 0.7); }
      .button.is-link.is-inverted[disabled],
      fieldset[disabled] .button.is-link.is-inverted {
        background-color: rgba(0, 0, 0, 0.7);
        border-color: transparent;
        box-shadow: none;
        color: #467CFB; }
    .button.is-link.is-loading::after {
      border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
    .button.is-link.is-outlined {
      background-color: transparent;
      border-color: #467CFB;
      color: #467CFB; }
      .button.is-link.is-outlined:hover, .button.is-link.is-outlined.is-hovered, .button.is-link.is-outlined:focus, .button.is-link.is-outlined.is-focused {
        background-color: #467CFB;
        border-color: #467CFB;
        color: rgba(0, 0, 0, 0.7); }
      .button.is-link.is-outlined.is-loading::after {
        border-color: transparent transparent #467CFB #467CFB !important; }
      .button.is-link.is-outlined.is-loading:hover::after, .button.is-link.is-outlined.is-loading.is-hovered::after, .button.is-link.is-outlined.is-loading:focus::after, .button.is-link.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
      .button.is-link.is-outlined[disabled],
      fieldset[disabled] .button.is-link.is-outlined {
        background-color: transparent;
        border-color: #467CFB;
        box-shadow: none;
        color: #467CFB; }
    .button.is-link.is-inverted.is-outlined {
      background-color: transparent;
      border-color: rgba(0, 0, 0, 0.7);
      color: rgba(0, 0, 0, 0.7); }
      .button.is-link.is-inverted.is-outlined:hover, .button.is-link.is-inverted.is-outlined.is-hovered, .button.is-link.is-inverted.is-outlined:focus, .button.is-link.is-inverted.is-outlined.is-focused {
        background-color: rgba(0, 0, 0, 0.7);
        color: #467CFB; }
      .button.is-link.is-inverted.is-outlined.is-loading:hover::after, .button.is-link.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-link.is-inverted.is-outlined.is-loading:focus::after, .button.is-link.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #467CFB #467CFB !important; }
      .button.is-link.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-link.is-inverted.is-outlined {
        background-color: transparent;
        border-color: rgba(0, 0, 0, 0.7);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.7); }
    .button.is-link.is-light {
      background-color: #ebf1ff;
      color: #0542d2; }
      .button.is-link.is-light:hover, .button.is-link.is-light.is-hovered {
        background-color: #dfe8fe;
        border-color: transparent;
        color: #0542d2; }
      .button.is-link.is-light:active, .button.is-link.is-light.is-active {
        background-color: #d2dffe;
        border-color: transparent;
        color: #0542d2; }
  .button.is-info {
    background-color: #7A8690;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
    .button.is-info:hover, .button.is-info.is-hovered {
      background-color: #73808a;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-info:focus, .button.is-info.is-focused {
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
      .button.is-info:focus:not(:active), .button.is-info.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(122, 134, 144, 0.25); }
    .button.is-info:active, .button.is-info.is-active {
      background-color: #6d7983;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-info[disabled],
    fieldset[disabled] .button.is-info {
      background-color: #7A8690;
      border-color: #7A8690;
      box-shadow: none; }
    .button.is-info.is-inverted {
      background-color: rgba(0, 0, 0, 0.7);
      color: #7A8690; }
      .button.is-info.is-inverted:hover, .button.is-info.is-inverted.is-hovered {
        background-color: rgba(0, 0, 0, 0.7); }
      .button.is-info.is-inverted[disabled],
      fieldset[disabled] .button.is-info.is-inverted {
        background-color: rgba(0, 0, 0, 0.7);
        border-color: transparent;
        box-shadow: none;
        color: #7A8690; }
    .button.is-info.is-loading::after {
      border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
    .button.is-info.is-outlined {
      background-color: transparent;
      border-color: #7A8690;
      color: #7A8690; }
      .button.is-info.is-outlined:hover, .button.is-info.is-outlined.is-hovered, .button.is-info.is-outlined:focus, .button.is-info.is-outlined.is-focused {
        background-color: #7A8690;
        border-color: #7A8690;
        color: rgba(0, 0, 0, 0.7); }
      .button.is-info.is-outlined.is-loading::after {
        border-color: transparent transparent #7A8690 #7A8690 !important; }
      .button.is-info.is-outlined.is-loading:hover::after, .button.is-info.is-outlined.is-loading.is-hovered::after, .button.is-info.is-outlined.is-loading:focus::after, .button.is-info.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
      .button.is-info.is-outlined[disabled],
      fieldset[disabled] .button.is-info.is-outlined {
        background-color: transparent;
        border-color: #7A8690;
        box-shadow: none;
        color: #7A8690; }
    .button.is-info.is-inverted.is-outlined {
      background-color: transparent;
      border-color: rgba(0, 0, 0, 0.7);
      color: rgba(0, 0, 0, 0.7); }
      .button.is-info.is-inverted.is-outlined:hover, .button.is-info.is-inverted.is-outlined.is-hovered, .button.is-info.is-inverted.is-outlined:focus, .button.is-info.is-inverted.is-outlined.is-focused {
        background-color: rgba(0, 0, 0, 0.7);
        color: #7A8690; }
      .button.is-info.is-inverted.is-outlined.is-loading:hover::after, .button.is-info.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-info.is-inverted.is-outlined.is-loading:focus::after, .button.is-info.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #7A8690 #7A8690 !important; }
      .button.is-info.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-info.is-inverted.is-outlined {
        background-color: transparent;
        border-color: rgba(0, 0, 0, 0.7);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.7); }
    .button.is-info.is-light {
      background-color: #f4f5f6;
      color: #5f6972; }
      .button.is-info.is-light:hover, .button.is-info.is-light.is-hovered {
        background-color: #edeff0;
        border-color: transparent;
        color: #5f6972; }
      .button.is-info.is-light:active, .button.is-info.is-light.is-active {
        background-color: #e6e8ea;
        border-color: transparent;
        color: #5f6972; }
  .button.is-success {
    background-color: #029736;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
    .button.is-success:hover, .button.is-success.is-hovered {
      background-color: #028a32;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-success:focus, .button.is-success.is-focused {
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
      .button.is-success:focus:not(:active), .button.is-success.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(2, 151, 54, 0.25); }
    .button.is-success:active, .button.is-success.is-active {
      background-color: #027e2d;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-success[disabled],
    fieldset[disabled] .button.is-success {
      background-color: #029736;
      border-color: #029736;
      box-shadow: none; }
    .button.is-success.is-inverted {
      background-color: rgba(0, 0, 0, 0.7);
      color: #029736; }
      .button.is-success.is-inverted:hover, .button.is-success.is-inverted.is-hovered {
        background-color: rgba(0, 0, 0, 0.7); }
      .button.is-success.is-inverted[disabled],
      fieldset[disabled] .button.is-success.is-inverted {
        background-color: rgba(0, 0, 0, 0.7);
        border-color: transparent;
        box-shadow: none;
        color: #029736; }
    .button.is-success.is-loading::after {
      border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
    .button.is-success.is-outlined {
      background-color: transparent;
      border-color: #029736;
      color: #029736; }
      .button.is-success.is-outlined:hover, .button.is-success.is-outlined.is-hovered, .button.is-success.is-outlined:focus, .button.is-success.is-outlined.is-focused {
        background-color: #029736;
        border-color: #029736;
        color: rgba(0, 0, 0, 0.7); }
      .button.is-success.is-outlined.is-loading::after {
        border-color: transparent transparent #029736 #029736 !important; }
      .button.is-success.is-outlined.is-loading:hover::after, .button.is-success.is-outlined.is-loading.is-hovered::after, .button.is-success.is-outlined.is-loading:focus::after, .button.is-success.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
      .button.is-success.is-outlined[disabled],
      fieldset[disabled] .button.is-success.is-outlined {
        background-color: transparent;
        border-color: #029736;
        box-shadow: none;
        color: #029736; }
    .button.is-success.is-inverted.is-outlined {
      background-color: transparent;
      border-color: rgba(0, 0, 0, 0.7);
      color: rgba(0, 0, 0, 0.7); }
      .button.is-success.is-inverted.is-outlined:hover, .button.is-success.is-inverted.is-outlined.is-hovered, .button.is-success.is-inverted.is-outlined:focus, .button.is-success.is-inverted.is-outlined.is-focused {
        background-color: rgba(0, 0, 0, 0.7);
        color: #029736; }
      .button.is-success.is-inverted.is-outlined.is-loading:hover::after, .button.is-success.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-success.is-inverted.is-outlined.is-loading:focus::after, .button.is-success.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #029736 #029736 !important; }
      .button.is-success.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-success.is-inverted.is-outlined {
        background-color: transparent;
        border-color: rgba(0, 0, 0, 0.7);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.7); }
    .button.is-success.is-light {
      background-color: #ebfff2;
      color: #03d84d; }
      .button.is-success.is-light:hover, .button.is-success.is-light.is-hovered {
        background-color: #deffea;
        border-color: transparent;
        color: #03d84d; }
      .button.is-success.is-light:active, .button.is-success.is-light.is-active {
        background-color: #d2fee1;
        border-color: transparent;
        color: #03d84d; }
  .button.is-warning {
    background-color: #ffd100;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
    .button.is-warning:hover, .button.is-warning.is-hovered {
      background-color: #f2c700;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-warning:focus, .button.is-warning.is-focused {
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
      .button.is-warning:focus:not(:active), .button.is-warning.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(255, 209, 0, 0.25); }
    .button.is-warning:active, .button.is-warning.is-active {
      background-color: #e6bc00;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-warning[disabled],
    fieldset[disabled] .button.is-warning {
      background-color: #ffd100;
      border-color: #ffd100;
      box-shadow: none; }
    .button.is-warning.is-inverted {
      background-color: rgba(0, 0, 0, 0.7);
      color: #ffd100; }
      .button.is-warning.is-inverted:hover, .button.is-warning.is-inverted.is-hovered {
        background-color: rgba(0, 0, 0, 0.7); }
      .button.is-warning.is-inverted[disabled],
      fieldset[disabled] .button.is-warning.is-inverted {
        background-color: rgba(0, 0, 0, 0.7);
        border-color: transparent;
        box-shadow: none;
        color: #ffd100; }
    .button.is-warning.is-loading::after {
      border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
    .button.is-warning.is-outlined {
      background-color: transparent;
      border-color: #ffd100;
      color: #ffd100; }
      .button.is-warning.is-outlined:hover, .button.is-warning.is-outlined.is-hovered, .button.is-warning.is-outlined:focus, .button.is-warning.is-outlined.is-focused {
        background-color: #ffd100;
        border-color: #ffd100;
        color: rgba(0, 0, 0, 0.7); }
      .button.is-warning.is-outlined.is-loading::after {
        border-color: transparent transparent #ffd100 #ffd100 !important; }
      .button.is-warning.is-outlined.is-loading:hover::after, .button.is-warning.is-outlined.is-loading.is-hovered::after, .button.is-warning.is-outlined.is-loading:focus::after, .button.is-warning.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
      .button.is-warning.is-outlined[disabled],
      fieldset[disabled] .button.is-warning.is-outlined {
        background-color: transparent;
        border-color: #ffd100;
        box-shadow: none;
        color: #ffd100; }
    .button.is-warning.is-inverted.is-outlined {
      background-color: transparent;
      border-color: rgba(0, 0, 0, 0.7);
      color: rgba(0, 0, 0, 0.7); }
      .button.is-warning.is-inverted.is-outlined:hover, .button.is-warning.is-inverted.is-outlined.is-hovered, .button.is-warning.is-inverted.is-outlined:focus, .button.is-warning.is-inverted.is-outlined.is-focused {
        background-color: rgba(0, 0, 0, 0.7);
        color: #ffd100; }
      .button.is-warning.is-inverted.is-outlined.is-loading:hover::after, .button.is-warning.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-warning.is-inverted.is-outlined.is-loading:focus::after, .button.is-warning.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #ffd100 #ffd100 !important; }
      .button.is-warning.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-warning.is-inverted.is-outlined {
        background-color: transparent;
        border-color: rgba(0, 0, 0, 0.7);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.7); }
    .button.is-warning.is-light {
      background-color: #fffbeb;
      color: #947900; }
      .button.is-warning.is-light:hover, .button.is-warning.is-light.is-hovered {
        background-color: #fff9de;
        border-color: transparent;
        color: #947900; }
      .button.is-warning.is-light:active, .button.is-warning.is-light.is-active {
        background-color: #fff7d1;
        border-color: transparent;
        color: #947900; }
  .button.is-danger {
    background-color: #F91F52;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
    .button.is-danger:hover, .button.is-danger.is-hovered {
      background-color: #f91348;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-danger:focus, .button.is-danger.is-focused {
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
      .button.is-danger:focus:not(:active), .button.is-danger.is-focused:not(:active) {
        box-shadow: 0 0 0 0.125em rgba(249, 31, 82, 0.25); }
    .button.is-danger:active, .button.is-danger.is-active {
      background-color: #f8073f;
      border-color: transparent;
      color: rgba(0, 0, 0, 0.7); }
    .button.is-danger[disabled],
    fieldset[disabled] .button.is-danger {
      background-color: #F91F52;
      border-color: #F91F52;
      box-shadow: none; }
    .button.is-danger.is-inverted {
      background-color: rgba(0, 0, 0, 0.7);
      color: #F91F52; }
      .button.is-danger.is-inverted:hover, .button.is-danger.is-inverted.is-hovered {
        background-color: rgba(0, 0, 0, 0.7); }
      .button.is-danger.is-inverted[disabled],
      fieldset[disabled] .button.is-danger.is-inverted {
        background-color: rgba(0, 0, 0, 0.7);
        border-color: transparent;
        box-shadow: none;
        color: #F91F52; }
    .button.is-danger.is-loading::after {
      border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
    .button.is-danger.is-outlined {
      background-color: transparent;
      border-color: #F91F52;
      color: #F91F52; }
      .button.is-danger.is-outlined:hover, .button.is-danger.is-outlined.is-hovered, .button.is-danger.is-outlined:focus, .button.is-danger.is-outlined.is-focused {
        background-color: #F91F52;
        border-color: #F91F52;
        color: rgba(0, 0, 0, 0.7); }
      .button.is-danger.is-outlined.is-loading::after {
        border-color: transparent transparent #F91F52 #F91F52 !important; }
      .button.is-danger.is-outlined.is-loading:hover::after, .button.is-danger.is-outlined.is-loading.is-hovered::after, .button.is-danger.is-outlined.is-loading:focus::after, .button.is-danger.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent rgba(0, 0, 0, 0.7) rgba(0, 0, 0, 0.7) !important; }
      .button.is-danger.is-outlined[disabled],
      fieldset[disabled] .button.is-danger.is-outlined {
        background-color: transparent;
        border-color: #F91F52;
        box-shadow: none;
        color: #F91F52; }
    .button.is-danger.is-inverted.is-outlined {
      background-color: transparent;
      border-color: rgba(0, 0, 0, 0.7);
      color: rgba(0, 0, 0, 0.7); }
      .button.is-danger.is-inverted.is-outlined:hover, .button.is-danger.is-inverted.is-outlined.is-hovered, .button.is-danger.is-inverted.is-outlined:focus, .button.is-danger.is-inverted.is-outlined.is-focused {
        background-color: rgba(0, 0, 0, 0.7);
        color: #F91F52; }
      .button.is-danger.is-inverted.is-outlined.is-loading:hover::after, .button.is-danger.is-inverted.is-outlined.is-loading.is-hovered::after, .button.is-danger.is-inverted.is-outlined.is-loading:focus::after, .button.is-danger.is-inverted.is-outlined.is-loading.is-focused::after {
        border-color: transparent transparent #F91F52 #F91F52 !important; }
      .button.is-danger.is-inverted.is-outlined[disabled],
      fieldset[disabled] .button.is-danger.is-inverted.is-outlined {
        background-color: transparent;
        border-color: rgba(0, 0, 0, 0.7);
        box-shadow: none;
        color: rgba(0, 0, 0, 0.7); }
    .button.is-danger.is-light {
      background-color: #feebf0;
      color: #e00639; }
      .button.is-danger.is-light:hover, .button.is-danger.is-light.is-hovered {
        background-color: #fedfe6;
        border-color: transparent;
        color: #e00639; }
      .button.is-danger.is-light:active, .button.is-danger.is-light.is-active {
        background-color: #fed2dc;
        border-color: transparent;
        color: #e00639; }
  .button.is-small {
    font-size: 0.75rem; }
    .button.is-small:not(.is-rounded) {
      border-radius: 2px; }
  .button.is-normal {
    font-size: 1rem; }
  .button.is-medium {
    font-size: 1.25rem; }
  .button.is-large {
    font-size: 1.5rem; }
  .button[disabled],
  fieldset[disabled] .button {
    background-color: #171717;
    border-color: #363636;
    box-shadow: none;
    opacity: 0.5; }
  .button.is-fullwidth {
    display: flex;
    width: 100%; }
  .button.is-loading {
    color: transparent !important;
    pointer-events: none; }
    .button.is-loading::after {
      position: absolute;
      left: calc(50% - (1em * 0.5));
      top: calc(50% - (1em * 0.5));
      position: absolute !important; }
  .button.is-static {
    background-color: #242424;
    border-color: #363636;
    color: #7a7a7a;
    box-shadow: none;
    pointer-events: none; }
  .button.is-rounded {
    border-radius: 9999px;
    padding-left: calc(1em + 0.25em);
    padding-right: calc(1em + 0.25em); }

.buttons {
  align-items: center;
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-start; }
  .buttons .button {
    margin-bottom: 0.5rem; }
    .buttons .button:not(:last-child):not(.is-fullwidth) {
      margin-right: 0.5rem; }
  .buttons:last-child {
    margin-bottom: -0.5rem; }
  .buttons:not(:last-child) {
    margin-bottom: 1rem; }
  .buttons.are-small .button:not(.is-normal):not(.is-medium):not(.is-large) {
    font-size: 0.75rem; }
    .buttons.are-small .button:not(.is-normal):not(.is-medium):not(.is-large):not(.is-rounded) {
      border-radius: 2px; }
  .buttons.are-medium .button:not(.is-small):not(.is-normal):not(.is-large) {
    font-size: 1.25rem; }
  .buttons.are-large .button:not(.is-small):not(.is-normal):not(.is-medium) {
    font-size: 1.5rem; }
  .buttons.has-addons .button:not(:first-child) {
    border-bottom-left-radius: 0;
    border-top-left-radius: 0; }
  .buttons.has-addons .button:not(:last-child) {
    border-bottom-right-radius: 0;
    border-top-right-radius: 0;
    margin-right: -1px; }
  .buttons.has-addons .button:last-child {
    margin-right: 0; }
  .buttons.has-addons .button:hover, .buttons.has-addons .button.is-hovered {
    z-index: 2; }
  .buttons.has-addons .button:focus, .buttons.has-addons .button.is-focused, .buttons.has-addons .button:active, .buttons.has-addons .button.is-active, .buttons.has-addons .button.is-selected {
    z-index: 3; }
    .buttons.has-addons .button:focus:hover, .buttons.has-addons .button.is-focused:hover, .buttons.has-addons .button:active:hover, .buttons.has-addons .button.is-active:hover, .buttons.has-addons .button.is-selected:hover {
      z-index: 4; }
  .buttons.has-addons .button.is-expanded {
    flex-grow: 1;
    flex-shrink: 1; }
  .buttons.is-centered {
    justify-content: center; }
    .buttons.is-centered:not(.has-addons) .button:not(.is-fullwidth) {
      margin-left: 0.25rem;
      margin-right: 0.25rem; }
  .buttons.is-right {
    justify-content: flex-end; }
    .buttons.is-right:not(.has-addons) .button:not(.is-fullwidth) {
      margin-left: 0.25rem;
      margin-right: 0.25rem; }

@media screen and (max-width: 768px) {
  .button.is-responsive.is-small {
    font-size: 0.5625rem; }
  .button.is-responsive,
  .button.is-responsive.is-normal {
    font-size: 0.65625rem; }
  .button.is-responsive.is-medium {
    font-size: 0.75rem; }
  .button.is-responsive.is-large {
    font-size: 1rem; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .button.is-responsive.is-small {
    font-size: 0.65625rem; }
  .button.is-responsive,
  .button.is-responsive.is-normal {
    font-size: 0.75rem; }
  .button.is-responsive.is-medium {
    font-size: 1rem; }
  .button.is-responsive.is-large {
    font-size: 1.25rem; } }

.container {
  flex-grow: 1;
  margin: 0 auto;
  position: relative;
  width: auto; }
  .container.is-fluid {
    max-width: none !important;
    padding-left: 32px;
    padding-right: 32px;
    width: 100%; }
  @media screen and (min-width: 1024px) {
    .container {
      max-width: 960px; } }
  @media screen and (max-width: 1215px) {
    .container.is-widescreen:not(.is-max-desktop) {
      max-width: 1152px; } }
  @media screen and (max-width: 1407px) {
    .container.is-fullhd:not(.is-max-desktop):not(.is-max-widescreen) {
      max-width: 1344px; } }
  @media screen and (min-width: 1216px) {
    .container:not(.is-max-desktop) {
      max-width: 1152px; } }
  @media screen and (min-width: 1408px) {
    .container:not(.is-max-desktop):not(.is-max-widescreen) {
      max-width: 1344px; } }

.content li + li {
  margin-top: 0.25em; }

.content p:not(:last-child),
.content dl:not(:last-child),
.content ol:not(:last-child),
.content ul:not(:last-child),
.content blockquote:not(:last-child),
.content pre:not(:last-child),
.content table:not(:last-child) {
  margin-bottom: 1em; }

.content h1,
.content h2,
.content h3,
.content h4,
.content h5,
.content h6 {
  color: #dbdbdb;
  font-weight: 600;
  line-height: 1.125; }

.content h1 {
  font-size: 2em;
  margin-bottom: 0.5em; }
  .content h1:not(:first-child) {
    margin-top: 1em; }

.content h2 {
  font-size: 1.75em;
  margin-bottom: 0.5714em; }
  .content h2:not(:first-child) {
    margin-top: 1.1428em; }

.content h3 {
  font-size: 1.5em;
  margin-bottom: 0.6666em; }
  .content h3:not(:first-child) {
    margin-top: 1.3333em; }

.content h4 {
  font-size: 1.25em;
  margin-bottom: 0.8em; }

.content h5 {
  font-size: 1.125em;
  margin-bottom: 0.8888em; }

.content h6 {
  font-size: 1em;
  margin-bottom: 1em; }

.content blockquote {
  background-color: #242424;
  border-left: 5px solid #363636;
  padding: 1.25em 1.5em; }

.content ol {
  list-style-position: outside;
  margin-left: 2em;
  margin-top: 1em; }
  .content ol:not([type]) {
    list-style-type: decimal; }
    .content ol:not([type]).is-lower-alpha {
      list-style-type: lower-alpha; }
    .content ol:not([type]).is-lower-roman {
      list-style-type: lower-roman; }
    .content ol:not([type]).is-upper-alpha {
      list-style-type: upper-alpha; }
    .content ol:not([type]).is-upper-roman {
      list-style-type: upper-roman; }

.content ul {
  list-style: disc outside;
  margin-left: 2em;
  margin-top: 1em; }
  .content ul ul {
    list-style-type: circle;
    margin-top: 0.5em; }
    .content ul ul ul {
      list-style-type: square; }

.content dd {
  margin-left: 2em; }

.content figure {
  margin-left: 2em;
  margin-right: 2em;
  text-align: center; }
  .content figure:not(:first-child) {
    margin-top: 2em; }
  .content figure:not(:last-child) {
    margin-bottom: 2em; }
  .content figure img {
    display: inline-block; }
  .content figure figcaption {
    font-style: italic; }

.content pre {
  -webkit-overflow-scrolling: touch;
  overflow-x: auto;
  padding: 1.25em 1.5em;
  white-space: pre;
  word-wrap: normal; }

.content sup,
.content sub {
  font-size: 75%; }

.content table {
  width: 100%; }
  .content table td,
  .content table th {
    border: 1px solid #363636;
    border-width: 0 0 1px;
    padding: 0.5em 0.75em;
    vertical-align: top; }
  .content table th {
    color: #dbdbdb; }
    .content table th:not([align]) {
      text-align: inherit; }
  .content table thead td,
  .content table thead th {
    border-width: 0 0 2px;
    color: #dbdbdb; }
  .content table tfoot td,
  .content table tfoot th {
    border-width: 2px 0 0;
    color: #dbdbdb; }
  .content table tbody tr:last-child td,
  .content table tbody tr:last-child th {
    border-bottom-width: 0; }

.content .tabs li + li {
  margin-top: 0; }

.content.is-small {
  font-size: 0.75rem; }

.content.is-normal {
  font-size: 1rem; }

.content.is-medium {
  font-size: 1.25rem; }

.content.is-large {
  font-size: 1.5rem; }

.icon {
  align-items: center;
  display: inline-flex;
  justify-content: center;
  height: 1.5rem;
  width: 1.5rem; }
  .icon.is-small {
    height: 1rem;
    width: 1rem; }
  .icon.is-medium {
    height: 2rem;
    width: 2rem; }
  .icon.is-large {
    height: 3rem;
    width: 3rem; }

.icon-text {
  align-items: flex-start;
  color: inherit;
  display: inline-flex;
  flex-wrap: wrap;
  line-height: 1.5rem;
  vertical-align: top; }
  .icon-text .icon {
    flex-grow: 0;
    flex-shrink: 0; }
    .icon-text .icon:not(:last-child) {
      margin-right: 0.25em; }
    .icon-text .icon:not(:first-child) {
      margin-left: 0.25em; }

div.icon-text {
  display: flex; }

.image {
  display: block;
  position: relative; }
  .image img {
    display: block;
    height: auto;
    width: 100%; }
    .image img.is-rounded {
      border-radius: 9999px; }
  .image.is-fullwidth {
    width: 100%; }
  .image.is-square img,
  .image.is-square .has-ratio, .image.is-1by1 img,
  .image.is-1by1 .has-ratio, .image.is-5by4 img,
  .image.is-5by4 .has-ratio, .image.is-4by3 img,
  .image.is-4by3 .has-ratio, .image.is-3by2 img,
  .image.is-3by2 .has-ratio, .image.is-5by3 img,
  .image.is-5by3 .has-ratio, .image.is-16by9 img,
  .image.is-16by9 .has-ratio, .image.is-2by1 img,
  .image.is-2by1 .has-ratio, .image.is-3by1 img,
  .image.is-3by1 .has-ratio, .image.is-4by5 img,
  .image.is-4by5 .has-ratio, .image.is-3by4 img,
  .image.is-3by4 .has-ratio, .image.is-2by3 img,
  .image.is-2by3 .has-ratio, .image.is-3by5 img,
  .image.is-3by5 .has-ratio, .image.is-9by16 img,
  .image.is-9by16 .has-ratio, .image.is-1by2 img,
  .image.is-1by2 .has-ratio, .image.is-1by3 img,
  .image.is-1by3 .has-ratio {
    height: 100%;
    width: 100%; }
  .image.is-square, .image.is-1by1 {
    padding-top: 100%; }
  .image.is-5by4 {
    padding-top: 80%; }
  .image.is-4by3 {
    padding-top: 75%; }
  .image.is-3by2 {
    padding-top: 66.6666%; }
  .image.is-5by3 {
    padding-top: 60%; }
  .image.is-16by9 {
    padding-top: 56.25%; }
  .image.is-2by1 {
    padding-top: 50%; }
  .image.is-3by1 {
    padding-top: 33.3333%; }
  .image.is-4by5 {
    padding-top: 125%; }
  .image.is-3by4 {
    padding-top: 133.3333%; }
  .image.is-2by3 {
    padding-top: 150%; }
  .image.is-3by5 {
    padding-top: 166.6666%; }
  .image.is-9by16 {
    padding-top: 177.7777%; }
  .image.is-1by2 {
    padding-top: 200%; }
  .image.is-1by3 {
    padding-top: 300%; }
  .image.is-16x16 {
    height: 16px;
    width: 16px; }
  .image.is-24x24 {
    height: 24px;
    width: 24px; }
  .image.is-32x32 {
    height: 32px;
    width: 32px; }
  .image.is-48x48 {
    height: 48px;
    width: 48px; }
  .image.is-64x64 {
    height: 64px;
    width: 64px; }
  .image.is-96x96 {
    height: 96px;
    width: 96px; }
  .image.is-128x128 {
    height: 128px;
    width: 128px; }

.notification {
  background-color: #242424;
  border-radius: 4px;
  position: relative;
  padding: 1.25rem 2.5rem 1.25rem 1.5rem; }
  .notification a:not(.button):not(.dropdown-item) {
    color: currentColor;
    text-decoration: underline; }
  .notification strong {
    color: currentColor; }
  .notification code,
  .notification pre {
    background: #171717; }
  .notification pre code {
    background: transparent; }
  .notification > .delete {
    right: 0.5rem;
    position: absolute;
    top: 0.5rem; }
  .notification .title,
  .notification .subtitle,
  .notification .content {
    color: currentColor; }
  .notification.is-white {
    background-color: #171717;
    color: #f2f2f2; }
  .notification.is-black {
    background-color: #f2f2f2;
    color: #171717; }
  .notification.is-light {
    background-color: #363636;
    color: #fff; }
  .notification.is-dark {
    background-color: #e6e6e6;
    color: rgba(0, 0, 0, 0.7); }
  .notification.is-primary {
    background-color: #0E87C8;
    color: rgba(0, 0, 0, 0.7); }
    .notification.is-primary.is-light {
      background-color: #ecf7fe;
      color: #0e8acd; }
  .notification.is-link {
    background-color: #467CFB;
    color: rgba(0, 0, 0, 0.7); }
    .notification.is-link.is-light {
      background-color: #ebf1ff;
      color: #0542d2; }
  .notification.is-info {
    background-color: #7A8690;
    color: rgba(0, 0, 0, 0.7); }
    .notification.is-info.is-light {
      background-color: #f4f5f6;
      color: #5f6972; }
  .notification.is-success {
    background-color: #029736;
    color: rgba(0, 0, 0, 0.7); }
    .notification.is-success.is-light {
      background-color: #ebfff2;
      color: #03d84d; }
  .notification.is-warning {
    background-color: #ffd100;
    color: rgba(0, 0, 0, 0.7); }
    .notification.is-warning.is-light {
      background-color: #fffbeb;
      color: #947900; }
  .notification.is-danger {
    background-color: #F91F52;
    color: rgba(0, 0, 0, 0.7); }
    .notification.is-danger.is-light {
      background-color: #feebf0;
      color: #e00639; }

.progress {
  -moz-appearance: none;
  -webkit-appearance: none;
  border: none;
  border-radius: 9999px;
  display: block;
  height: 1rem;
  overflow: hidden;
  padding: 0;
  width: 100%; }
  .progress::-webkit-progress-bar {
    background-color: #ededed; }
  .progress::-webkit-progress-value {
    background-color: #b5b5b5; }
  .progress::-moz-progress-bar {
    background-color: #b5b5b5; }
  .progress::-ms-fill {
    background-color: #b5b5b5;
    border: none; }
  .progress.is-white::-webkit-progress-value {
    background-color: #171717; }
  .progress.is-white::-moz-progress-bar {
    background-color: #171717; }
  .progress.is-white::-ms-fill {
    background-color: #171717; }
  .progress.is-white:indeterminate {
    background-image: linear-gradient(to right, #171717 30%, #ededed 30%); }
  .progress.is-black::-webkit-progress-value {
    background-color: #f2f2f2; }
  .progress.is-black::-moz-progress-bar {
    background-color: #f2f2f2; }
  .progress.is-black::-ms-fill {
    background-color: #f2f2f2; }
  .progress.is-black:indeterminate {
    background-image: linear-gradient(to right, #f2f2f2 30%, #ededed 30%); }
  .progress.is-light::-webkit-progress-value {
    background-color: #363636; }
  .progress.is-light::-moz-progress-bar {
    background-color: #363636; }
  .progress.is-light::-ms-fill {
    background-color: #363636; }
  .progress.is-light:indeterminate {
    background-image: linear-gradient(to right, #363636 30%, #ededed 30%); }
  .progress.is-dark::-webkit-progress-value {
    background-color: #e6e6e6; }
  .progress.is-dark::-moz-progress-bar {
    background-color: #e6e6e6; }
  .progress.is-dark::-ms-fill {
    background-color: #e6e6e6; }
  .progress.is-dark:indeterminate {
    background-image: linear-gradient(to right, #e6e6e6 30%, #ededed 30%); }
  .progress.is-primary::-webkit-progress-value {
    background-color: #0E87C8; }
  .progress.is-primary::-moz-progress-bar {
    background-color: #0E87C8; }
  .progress.is-primary::-ms-fill {
    background-color: #0E87C8; }
  .progress.is-primary:indeterminate {
    background-image: linear-gradient(to right, #0E87C8 30%, #ededed 30%); }
  .progress.is-link::-webkit-progress-value {
    background-color: #467CFB; }
  .progress.is-link::-moz-progress-bar {
    background-color: #467CFB; }
  .progress.is-link::-ms-fill {
    background-color: #467CFB; }
  .progress.is-link:indeterminate {
    background-image: linear-gradient(to right, #467CFB 30%, #ededed 30%); }
  .progress.is-info::-webkit-progress-value {
    background-color: #7A8690; }
  .progress.is-info::-moz-progress-bar {
    background-color: #7A8690; }
  .progress.is-info::-ms-fill {
    background-color: #7A8690; }
  .progress.is-info:indeterminate {
    background-image: linear-gradient(to right, #7A8690 30%, #ededed 30%); }
  .progress.is-success::-webkit-progress-value {
    background-color: #029736; }
  .progress.is-success::-moz-progress-bar {
    background-color: #029736; }
  .progress.is-success::-ms-fill {
    background-color: #029736; }
  .progress.is-success:indeterminate {
    background-image: linear-gradient(to right, #029736 30%, #ededed 30%); }
  .progress.is-warning::-webkit-progress-value {
    background-color: #ffd100; }
  .progress.is-warning::-moz-progress-bar {
    background-color: #ffd100; }
  .progress.is-warning::-ms-fill {
    background-color: #ffd100; }
  .progress.is-warning:indeterminate {
    background-image: linear-gradient(to right, #ffd100 30%, #ededed 30%); }
  .progress.is-danger::-webkit-progress-value {
    background-color: #F91F52; }
  .progress.is-danger::-moz-progress-bar {
    background-color: #F91F52; }
  .progress.is-danger::-ms-fill {
    background-color: #F91F52; }
  .progress.is-danger:indeterminate {
    background-image: linear-gradient(to right, #F91F52 30%, #ededed 30%); }
  .progress:indeterminate {
    animation-duration: 1.5s;
    animation-iteration-count: infinite;
    animation-name: moveIndeterminate;
    animation-timing-function: linear;
    background-color: #ededed;
    background-image: linear-gradient(to right, #b5b5b5 30%, #ededed 30%);
    background-position: top left;
    background-repeat: no-repeat;
    background-size: 150% 150%; }
    .progress:indeterminate::-webkit-progress-bar {
      background-color: transparent; }
    .progress:indeterminate::-moz-progress-bar {
      background-color: transparent; }
    .progress:indeterminate::-ms-fill {
      animation-name: none; }
  .progress.is-small {
    height: 0.75rem; }
  .progress.is-medium {
    height: 1.25rem; }
  .progress.is-large {
    height: 1.5rem; }

@keyframes moveIndeterminate {
  from {
    background-position: 200% 0; }
  to {
    background-position: -200% 0; } }

.table {
  background-color: #171717;
  color: #dbdbdb; }
  .table td,
  .table th {
    border: 1px solid #363636;
    border-width: 0 0 1px;
    padding: 0.5em 0.75em;
    vertical-align: top; }
    .table td.is-white,
    .table th.is-white {
      background-color: #171717;
      border-color: #171717;
      color: #f2f2f2; }
    .table td.is-black,
    .table th.is-black {
      background-color: #f2f2f2;
      border-color: #f2f2f2;
      color: #171717; }
    .table td.is-light,
    .table th.is-light {
      background-color: #363636;
      border-color: #363636;
      color: #fff; }
    .table td.is-dark,
    .table th.is-dark {
      background-color: #e6e6e6;
      border-color: #e6e6e6;
      color: rgba(0, 0, 0, 0.7); }
    .table td.is-primary,
    .table th.is-primary {
      background-color: #0E87C8;
      border-color: #0E87C8;
      color: rgba(0, 0, 0, 0.7); }
    .table td.is-link,
    .table th.is-link {
      background-color: #467CFB;
      border-color: #467CFB;
      color: rgba(0, 0, 0, 0.7); }
    .table td.is-info,
    .table th.is-info {
      background-color: #7A8690;
      border-color: #7A8690;
      color: rgba(0, 0, 0, 0.7); }
    .table td.is-success,
    .table th.is-success {
      background-color: #029736;
      border-color: #029736;
      color: rgba(0, 0, 0, 0.7); }
    .table td.is-warning,
    .table th.is-warning {
      background-color: #ffd100;
      border-color: #ffd100;
      color: rgba(0, 0, 0, 0.7); }
    .table td.is-danger,
    .table th.is-danger {
      background-color: #F91F52;
      border-color: #F91F52;
      color: rgba(0, 0, 0, 0.7); }
    .table td.is-narrow,
    .table th.is-narrow {
      white-space: nowrap;
      width: 1%; }
    .table td.is-selected,
    .table th.is-selected {
      background-color: #0E87C8;
      color: rgba(0, 0, 0, 0.7); }
      .table td.is-selected a,
      .table td.is-selected strong,
      .table th.is-selected a,
      .table th.is-selected strong {
        color: currentColor; }
    .table td.is-vcentered,
    .table th.is-vcentered {
      vertical-align: middle; }
  .table th {
    color: #dbdbdb; }
    .table th:not([align]) {
      text-align: left; }
  .table tr.is-selected {
    background-color: #0E87C8;
    color: rgba(0, 0, 0, 0.7); }
    .table tr.is-selected a,
    .table tr.is-selected strong {
      color: currentColor; }
    .table tr.is-selected td,
    .table tr.is-selected th {
      border-color: rgba(0, 0, 0, 0.7);
      color: currentColor; }
  .table thead {
    background-color: transparent; }
    .table thead td,
    .table thead th {
      border-width: 0 0 2px;
      color: #dbdbdb; }
  .table tfoot {
    background-color: transparent; }
    .table tfoot td,
    .table tfoot th {
      border-width: 2px 0 0;
      color: #dbdbdb; }
  .table tbody {
    background-color: transparent; }
    .table tbody tr:last-child td,
    .table tbody tr:last-child th {
      border-bottom-width: 0; }
  .table.is-bordered td,
  .table.is-bordered th {
    border-width: 1px; }
  .table.is-bordered tr:last-child td,
  .table.is-bordered tr:last-child th {
    border-bottom-width: 1px; }
  .table.is-fullwidth {
    width: 100%; }
  .table.is-hoverable tbody tr:not(.is-selected):hover {
    background-color: #171717; }
  .table.is-hoverable.is-striped tbody tr:not(.is-selected):hover {
    background-color: #171717; }
    .table.is-hoverable.is-striped tbody tr:not(.is-selected):hover:nth-child(even) {
      background-color: #242424; }
  .table.is-narrow td,
  .table.is-narrow th {
    padding: 0.25em 0.5em; }
  .table.is-striped tbody tr:not(.is-selected):nth-child(even) {
    background-color: #171717; }

.table-container {
  -webkit-overflow-scrolling: touch;
  overflow: auto;
  overflow-y: hidden;
  max-width: 100%; }

.tags {
  align-items: center;
  display: flex;
  flex-wrap: wrap;
  justify-content: flex-start; }
  .tags .tag {
    margin-bottom: 0.5rem; }
    .tags .tag:not(:last-child) {
      margin-right: 0.5rem; }
  .tags:last-child {
    margin-bottom: -0.5rem; }
  .tags:not(:last-child) {
    margin-bottom: 1rem; }
  .tags.are-medium .tag:not(.is-normal):not(.is-large) {
    font-size: 1rem; }
  .tags.are-large .tag:not(.is-normal):not(.is-medium) {
    font-size: 1.25rem; }
  .tags.is-centered {
    justify-content: center; }
    .tags.is-centered .tag {
      margin-right: 0.25rem;
      margin-left: 0.25rem; }
  .tags.is-right {
    justify-content: flex-end; }
    .tags.is-right .tag:not(:first-child) {
      margin-left: 0.5rem; }
    .tags.is-right .tag:not(:last-child) {
      margin-right: 0; }
  .tags.has-addons .tag {
    margin-right: 0; }
    .tags.has-addons .tag:not(:first-child) {
      margin-left: 0;
      border-top-left-radius: 0;
      border-bottom-left-radius: 0; }
    .tags.has-addons .tag:not(:last-child) {
      border-top-right-radius: 0;
      border-bottom-right-radius: 0; }

.tag:not(body) {
  align-items: center;
  background-color: #242424;
  border-radius: 4px;
  color: #b5b5b5;
  display: inline-flex;
  font-size: 0.75rem;
  height: 2em;
  justify-content: center;
  line-height: 1.5;
  padding-left: 0.75em;
  padding-right: 0.75em;
  white-space: nowrap; }
  .tag:not(body) .delete {
    margin-left: 0.25rem;
    margin-right: -0.375rem; }
  .tag:not(body).is-white {
    background-color: #171717;
    color: #f2f2f2; }
  .tag:not(body).is-black {
    background-color: #f2f2f2;
    color: #171717; }
  .tag:not(body).is-light {
    background-color: #363636;
    color: #fff; }
  .tag:not(body).is-dark {
    background-color: #e6e6e6;
    color: rgba(0, 0, 0, 0.7); }
  .tag:not(body).is-primary {
    background-color: #0E87C8;
    color: rgba(0, 0, 0, 0.7); }
    .tag:not(body).is-primary.is-light {
      background-color: #ecf7fe;
      color: #0e8acd; }
  .tag:not(body).is-link {
    background-color: #467CFB;
    color: rgba(0, 0, 0, 0.7); }
    .tag:not(body).is-link.is-light {
      background-color: #ebf1ff;
      color: #0542d2; }
  .tag:not(body).is-info {
    background-color: #7A8690;
    color: rgba(0, 0, 0, 0.7); }
    .tag:not(body).is-info.is-light {
      background-color: #f4f5f6;
      color: #5f6972; }
  .tag:not(body).is-success {
    background-color: #029736;
    color: rgba(0, 0, 0, 0.7); }
    .tag:not(body).is-success.is-light {
      background-color: #ebfff2;
      color: #03d84d; }
  .tag:not(body).is-warning {
    background-color: #ffd100;
    color: rgba(0, 0, 0, 0.7); }
    .tag:not(body).is-warning.is-light {
      background-color: #fffbeb;
      color: #947900; }
  .tag:not(body).is-danger {
    background-color: #F91F52;
    color: rgba(0, 0, 0, 0.7); }
    .tag:not(body).is-danger.is-light {
      background-color: #feebf0;
      color: #e00639; }
  .tag:not(body).is-normal {
    font-size: 0.75rem; }
  .tag:not(body).is-medium {
    font-size: 1rem; }
  .tag:not(body).is-large {
    font-size: 1.25rem; }
  .tag:not(body) .icon:first-child:not(:last-child) {
    margin-left: -0.375em;
    margin-right: 0.1875em; }
  .tag:not(body) .icon:last-child:not(:first-child) {
    margin-left: 0.1875em;
    margin-right: -0.375em; }
  .tag:not(body) .icon:first-child:last-child {
    margin-left: -0.375em;
    margin-right: -0.375em; }
  .tag:not(body).is-delete {
    margin-left: 1px;
    padding: 0;
    position: relative;
    width: 2em; }
    .tag:not(body).is-delete::before, .tag:not(body).is-delete::after {
      background-color: currentColor;
      content: "";
      display: block;
      left: 50%;
      position: absolute;
      top: 50%;
      transform: translateX(-50%) translateY(-50%) rotate(45deg);
      transform-origin: center center; }
    .tag:not(body).is-delete::before {
      height: 1px;
      width: 50%; }
    .tag:not(body).is-delete::after {
      height: 50%;
      width: 1px; }
    .tag:not(body).is-delete:hover, .tag:not(body).is-delete:focus {
      background-color: #171717; }
    .tag:not(body).is-delete:active {
      background-color: #0a0a0a; }
  .tag:not(body).is-rounded {
    border-radius: 9999px; }

a.tag:hover {
  text-decoration: underline; }

.title,
.subtitle {
  word-break: break-word; }
  .title em,
  .title span,
  .subtitle em,
  .subtitle span {
    font-weight: inherit; }
  .title sub,
  .subtitle sub {
    font-size: 0.75em; }
  .title sup,
  .subtitle sup {
    font-size: 0.75em; }
  .title .tag,
  .subtitle .tag {
    vertical-align: middle; }

.title {
  color: #dbdbdb;
  font-size: 2rem;
  font-weight: 600;
  line-height: 1.125; }
  .title strong {
    color: inherit;
    font-weight: inherit; }
  .title:not(.is-spaced) + .subtitle {
    margin-top: -1.25rem; }
  .title.is-1 {
    font-size: 3rem; }
  .title.is-2 {
    font-size: 2.5rem; }
  .title.is-3 {
    font-size: 2rem; }
  .title.is-4 {
    font-size: 1.5rem; }
  .title.is-5 {
    font-size: 1.25rem; }
  .title.is-6 {
    font-size: 1rem; }
  .title.is-7 {
    font-size: 0.75rem; }

.subtitle {
  color: #b5b5b5;
  font-size: 1.25rem;
  font-weight: 400;
  line-height: 1.25; }
  .subtitle strong {
    color: #dbdbdb;
    font-weight: 600; }
  .subtitle:not(.is-spaced) + .title {
    margin-top: -1.25rem; }
  .subtitle.is-1 {
    font-size: 3rem; }
  .subtitle.is-2 {
    font-size: 2.5rem; }
  .subtitle.is-3 {
    font-size: 2rem; }
  .subtitle.is-4 {
    font-size: 1.5rem; }
  .subtitle.is-5 {
    font-size: 1.25rem; }
  .subtitle.is-6 {
    font-size: 1rem; }
  .subtitle.is-7 {
    font-size: 0.75rem; }

.heading {
  display: block;
  font-size: 11px;
  letter-spacing: 1px;
  margin-bottom: 5px;
  text-transform: uppercase; }

.number {
  align-items: center;
  background-color: #242424;
  border-radius: 9999px;
  display: inline-flex;
  font-size: 1.25rem;
  height: 2em;
  justify-content: center;
  margin-right: 1.5rem;
  min-width: 2.5em;
  padding: 0.25rem 0.5rem;
  text-align: center;
  vertical-align: top; }

/* Bulma Form */
.input, .textarea, .select select {
  background-color: #171717;
  border-color: #363636;
  border-radius: 4px;
  color: #dbdbdb; }
  .input::-moz-placeholder, .textarea::-moz-placeholder, .select select::-moz-placeholder {
    color: rgba(219, 219, 219, 0.3); }
  .input::-webkit-input-placeholder, .textarea::-webkit-input-placeholder, .select select::-webkit-input-placeholder {
    color: rgba(219, 219, 219, 0.3); }
  .input:-moz-placeholder, .textarea:-moz-placeholder, .select select:-moz-placeholder {
    color: rgba(219, 219, 219, 0.3); }
  .input:-ms-input-placeholder, .textarea:-ms-input-placeholder, .select select:-ms-input-placeholder {
    color: rgba(219, 219, 219, 0.3); }
  .input:hover, .textarea:hover, .select select:hover, .is-hovered.input, .is-hovered.textarea, .select select.is-hovered {
    border-color: #4a4a4a; }
  .input:focus, .textarea:focus, .select select:focus, .is-focused.input, .is-focused.textarea, .select select.is-focused, .input:active, .textarea:active, .select select:active, .is-active.input, .is-active.textarea, .select select.is-active {
    border-color: #467CFB;
    box-shadow: 0 0 0 0.125em rgba(70, 124, 251, 0.25); }
  .input[disabled], .textarea[disabled], .select select[disabled],
  fieldset[disabled] .input,
  fieldset[disabled] .textarea,
  fieldset[disabled] .select select,
  .select fieldset[disabled] select {
    background-color: #242424;
    border-color: #242424;
    box-shadow: none;
    color: #7a7a7a; }
    .input[disabled]::-moz-placeholder, .textarea[disabled]::-moz-placeholder, .select select[disabled]::-moz-placeholder,
    fieldset[disabled] .input::-moz-placeholder,
    fieldset[disabled] .textarea::-moz-placeholder,
    fieldset[disabled] .select select::-moz-placeholder,
    .select fieldset[disabled] select::-moz-placeholder {
      color: rgba(122, 122, 122, 0.3); }
    .input[disabled]::-webkit-input-placeholder, .textarea[disabled]::-webkit-input-placeholder, .select select[disabled]::-webkit-input-placeholder,
    fieldset[disabled] .input::-webkit-input-placeholder,
    fieldset[disabled] .textarea::-webkit-input-placeholder,
    fieldset[disabled] .select select::-webkit-input-placeholder,
    .select fieldset[disabled] select::-webkit-input-placeholder {
      color: rgba(122, 122, 122, 0.3); }
    .input[disabled]:-moz-placeholder, .textarea[disabled]:-moz-placeholder, .select select[disabled]:-moz-placeholder,
    fieldset[disabled] .input:-moz-placeholder,
    fieldset[disabled] .textarea:-moz-placeholder,
    fieldset[disabled] .select select:-moz-placeholder,
    .select fieldset[disabled] select:-moz-placeholder {
      color: rgba(122, 122, 122, 0.3); }
    .input[disabled]:-ms-input-placeholder, .textarea[disabled]:-ms-input-placeholder, .select select[disabled]:-ms-input-placeholder,
    fieldset[disabled] .input:-ms-input-placeholder,
    fieldset[disabled] .textarea:-ms-input-placeholder,
    fieldset[disabled] .select select:-ms-input-placeholder,
    .select fieldset[disabled] select:-ms-input-placeholder {
      color: rgba(122, 122, 122, 0.3); }

.input, .textarea {
  box-shadow: inset 0 0.0625em 0.125em rgba(242, 242, 242, 0.05);
  max-width: 100%;
  width: 100%; }
  .input[readonly], .textarea[readonly] {
    box-shadow: none; }
  .is-white.input, .is-white.textarea {
    border-color: #171717; }
    .is-white.input:focus, .is-white.textarea:focus, .is-white.is-focused.input, .is-white.is-focused.textarea, .is-white.input:active, .is-white.textarea:active, .is-white.is-active.input, .is-white.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(23, 23, 23, 0.25); }
  .is-black.input, .is-black.textarea {
    border-color: #f2f2f2; }
    .is-black.input:focus, .is-black.textarea:focus, .is-black.is-focused.input, .is-black.is-focused.textarea, .is-black.input:active, .is-black.textarea:active, .is-black.is-active.input, .is-black.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(242, 242, 242, 0.25); }
  .is-light.input, .is-light.textarea {
    border-color: #363636; }
    .is-light.input:focus, .is-light.textarea:focus, .is-light.is-focused.input, .is-light.is-focused.textarea, .is-light.input:active, .is-light.textarea:active, .is-light.is-active.input, .is-light.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(54, 54, 54, 0.25); }
  .is-dark.input, .is-dark.textarea {
    border-color: #e6e6e6; }
    .is-dark.input:focus, .is-dark.textarea:focus, .is-dark.is-focused.input, .is-dark.is-focused.textarea, .is-dark.input:active, .is-dark.textarea:active, .is-dark.is-active.input, .is-dark.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(230, 230, 230, 0.25); }
  .is-primary.input, .is-primary.textarea {
    border-color: #0E87C8; }
    .is-primary.input:focus, .is-primary.textarea:focus, .is-primary.is-focused.input, .is-primary.is-focused.textarea, .is-primary.input:active, .is-primary.textarea:active, .is-primary.is-active.input, .is-primary.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(14, 135, 200, 0.25); }
  .is-link.input, .is-link.textarea {
    border-color: #467CFB; }
    .is-link.input:focus, .is-link.textarea:focus, .is-link.is-focused.input, .is-link.is-focused.textarea, .is-link.input:active, .is-link.textarea:active, .is-link.is-active.input, .is-link.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(70, 124, 251, 0.25); }
  .is-info.input, .is-info.textarea {
    border-color: #7A8690; }
    .is-info.input:focus, .is-info.textarea:focus, .is-info.is-focused.input, .is-info.is-focused.textarea, .is-info.input:active, .is-info.textarea:active, .is-info.is-active.input, .is-info.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(122, 134, 144, 0.25); }
  .is-success.input, .is-success.textarea {
    border-color: #029736; }
    .is-success.input:focus, .is-success.textarea:focus, .is-success.is-focused.input, .is-success.is-focused.textarea, .is-success.input:active, .is-success.textarea:active, .is-success.is-active.input, .is-success.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(2, 151, 54, 0.25); }
  .is-warning.input, .is-warning.textarea {
    border-color: #ffd100; }
    .is-warning.input:focus, .is-warning.textarea:focus, .is-warning.is-focused.input, .is-warning.is-focused.textarea, .is-warning.input:active, .is-warning.textarea:active, .is-warning.is-active.input, .is-warning.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(255, 209, 0, 0.25); }
  .is-danger.input, .is-danger.textarea {
    border-color: #F91F52; }
    .is-danger.input:focus, .is-danger.textarea:focus, .is-danger.is-focused.input, .is-danger.is-focused.textarea, .is-danger.input:active, .is-danger.textarea:active, .is-danger.is-active.input, .is-danger.is-active.textarea {
      box-shadow: 0 0 0 0.125em rgba(249, 31, 82, 0.25); }
  .is-small.input, .is-small.textarea {
    border-radius: 2px;
    font-size: 0.75rem; }
  .is-medium.input, .is-medium.textarea {
    font-size: 1.25rem; }
  .is-large.input, .is-large.textarea {
    font-size: 1.5rem; }
  .is-fullwidth.input, .is-fullwidth.textarea {
    display: block;
    width: 100%; }
  .is-inline.input, .is-inline.textarea {
    display: inline;
    width: auto; }

.input.is-rounded {
  border-radius: 9999px;
  padding-left: calc(calc(0.75em - 1px) + 0.375em);
  padding-right: calc(calc(0.75em - 1px) + 0.375em); }

.input.is-static {
  background-color: transparent;
  border-color: transparent;
  box-shadow: none;
  padding-left: 0;
  padding-right: 0; }

.textarea {
  display: block;
  max-width: 100%;
  min-width: 100%;
  padding: calc(0.75em - 1px);
  resize: vertical; }
  .textarea:not([rows]) {
    max-height: 40em;
    min-height: 8em; }
  .textarea[rows] {
    height: initial; }
  .textarea.has-fixed-size {
    resize: none; }

.checkbox, .radio {
  cursor: pointer;
  display: inline-block;
  line-height: 1.25;
  position: relative; }
  .checkbox input, .radio input {
    cursor: pointer; }
  .checkbox:hover, .radio:hover {
    color: #dbdbdb; }
  .checkbox[disabled], .radio[disabled],
  fieldset[disabled] .checkbox,
  fieldset[disabled] .radio,
  .checkbox input[disabled],
  .radio input[disabled] {
    color: #7a7a7a;
    cursor: not-allowed; }

.radio + .radio {
  margin-left: 0.5em; }

.select {
  display: inline-block;
  max-width: 100%;
  position: relative;
  vertical-align: top; }
  .select:not(.is-multiple) {
    height: 2.5em; }
  .select:not(.is-multiple):not(.is-loading)::after {
    border-color: #467CFB;
    right: 1.125em;
    z-index: 4; }
  .select.is-rounded select {
    border-radius: 9999px;
    padding-left: 1em; }
  .select select {
    cursor: pointer;
    display: block;
    font-size: 1em;
    max-width: 100%;
    outline: none; }
    .select select::-ms-expand {
      display: none; }
    .select select[disabled]:hover,
    fieldset[disabled] .select select:hover {
      border-color: #242424; }
    .select select:not([multiple]) {
      padding-right: 2.5em; }
    .select select[multiple] {
      height: auto;
      padding: 0; }
      .select select[multiple] option {
        padding: 0.5em 1em; }
  .select:not(.is-multiple):not(.is-loading):hover::after {
    border-color: #dbdbdb; }
  .select.is-white:not(:hover)::after {
    border-color: #171717; }
  .select.is-white select {
    border-color: #171717; }
    .select.is-white select:hover, .select.is-white select.is-hovered {
      border-color: #0a0a0a; }
    .select.is-white select:focus, .select.is-white select.is-focused, .select.is-white select:active, .select.is-white select.is-active {
      box-shadow: 0 0 0 0.125em rgba(23, 23, 23, 0.25); }
  .select.is-black:not(:hover)::after {
    border-color: #f2f2f2; }
  .select.is-black select {
    border-color: #f2f2f2; }
    .select.is-black select:hover, .select.is-black select.is-hovered {
      border-color: #e6e6e6; }
    .select.is-black select:focus, .select.is-black select.is-focused, .select.is-black select:active, .select.is-black select.is-active {
      box-shadow: 0 0 0 0.125em rgba(242, 242, 242, 0.25); }
  .select.is-light:not(:hover)::after {
    border-color: #363636; }
  .select.is-light select {
    border-color: #363636; }
    .select.is-light select:hover, .select.is-light select.is-hovered {
      border-color: #292929; }
    .select.is-light select:focus, .select.is-light select.is-focused, .select.is-light select:active, .select.is-light select.is-active {
      box-shadow: 0 0 0 0.125em rgba(54, 54, 54, 0.25); }
  .select.is-dark:not(:hover)::after {
    border-color: #e6e6e6; }
  .select.is-dark select {
    border-color: #e6e6e6; }
    .select.is-dark select:hover, .select.is-dark select.is-hovered {
      border-color: #d9d9d9; }
    .select.is-dark select:focus, .select.is-dark select.is-focused, .select.is-dark select:active, .select.is-dark select.is-active {
      box-shadow: 0 0 0 0.125em rgba(230, 230, 230, 0.25); }
  .select.is-primary:not(:hover)::after {
    border-color: #0E87C8; }
  .select.is-primary select {
    border-color: #0E87C8; }
    .select.is-primary select:hover, .select.is-primary select.is-hovered {
      border-color: #0c77b0; }
    .select.is-primary select:focus, .select.is-primary select.is-focused, .select.is-primary select:active, .select.is-primary select.is-active {
      box-shadow: 0 0 0 0.125em rgba(14, 135, 200, 0.25); }
  .select.is-link:not(:hover)::after {
    border-color: #467CFB; }
  .select.is-link select {
    border-color: #467CFB; }
    .select.is-link select:hover, .select.is-link select.is-hovered {
      border-color: #2d6afa; }
    .select.is-link select:focus, .select.is-link select.is-focused, .select.is-link select:active, .select.is-link select.is-active {
      box-shadow: 0 0 0 0.125em rgba(70, 124, 251, 0.25); }
  .select.is-info:not(:hover)::after {
    border-color: #7A8690; }
  .select.is-info select {
    border-color: #7A8690; }
    .select.is-info select:hover, .select.is-info select.is-hovered {
      border-color: #6d7983; }
    .select.is-info select:focus, .select.is-info select.is-focused, .select.is-info select:active, .select.is-info select.is-active {
      box-shadow: 0 0 0 0.125em rgba(122, 134, 144, 0.25); }
  .select.is-success:not(:hover)::after {
    border-color: #029736; }
  .select.is-success select {
    border-color: #029736; }
    .select.is-success select:hover, .select.is-success select.is-hovered {
      border-color: #027e2d; }
    .select.is-success select:focus, .select.is-success select.is-focused, .select.is-success select:active, .select.is-success select.is-active {
      box-shadow: 0 0 0 0.125em rgba(2, 151, 54, 0.25); }
  .select.is-warning:not(:hover)::after {
    border-color: #ffd100; }
  .select.is-warning select {
    border-color: #ffd100; }
    .select.is-warning select:hover, .select.is-warning select.is-hovered {
      border-color: #e6bc00; }
    .select.is-warning select:focus, .select.is-warning select.is-focused, .select.is-warning select:active, .select.is-warning select.is-active {
      box-shadow: 0 0 0 0.125em rgba(255, 209, 0, 0.25); }
  .select.is-danger:not(:hover)::after {
    border-color: #F91F52; }
  .select.is-danger select {
    border-color: #F91F52; }
    .select.is-danger select:hover, .select.is-danger select.is-hovered {
      border-color: #f8073f; }
    .select.is-danger select:focus, .select.is-danger select.is-focused, .select.is-danger select:active, .select.is-danger select.is-active {
      box-shadow: 0 0 0 0.125em rgba(249, 31, 82, 0.25); }
  .select.is-small {
    border-radius: 2px;
    font-size: 0.75rem; }
  .select.is-medium {
    font-size: 1.25rem; }
  .select.is-large {
    font-size: 1.5rem; }
  .select.is-disabled::after {
    border-color: #7a7a7a !important;
    opacity: 0.5; }
  .select.is-fullwidth {
    width: 100%; }
    .select.is-fullwidth select {
      width: 100%; }
  .select.is-loading::after {
    margin-top: 0;
    position: absolute;
    right: 0.625em;
    top: 0.625em;
    transform: none; }
  .select.is-loading.is-small:after {
    font-size: 0.75rem; }
  .select.is-loading.is-medium:after {
    font-size: 1.25rem; }
  .select.is-loading.is-large:after {
    font-size: 1.5rem; }

.file {
  align-items: stretch;
  display: flex;
  justify-content: flex-start;
  position: relative; }
  .file.is-white .file-cta {
    background-color: #171717;
    border-color: transparent;
    color: #f2f2f2; }
  .file.is-white:hover .file-cta, .file.is-white.is-hovered .file-cta {
    background-color: #111111;
    border-color: transparent;
    color: #f2f2f2; }
  .file.is-white:focus .file-cta, .file.is-white.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(23, 23, 23, 0.25);
    color: #f2f2f2; }
  .file.is-white:active .file-cta, .file.is-white.is-active .file-cta {
    background-color: #0a0a0a;
    border-color: transparent;
    color: #f2f2f2; }
  .file.is-black .file-cta {
    background-color: #f2f2f2;
    border-color: transparent;
    color: #171717; }
  .file.is-black:hover .file-cta, .file.is-black.is-hovered .file-cta {
    background-color: #ececec;
    border-color: transparent;
    color: #171717; }
  .file.is-black:focus .file-cta, .file.is-black.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(242, 242, 242, 0.25);
    color: #171717; }
  .file.is-black:active .file-cta, .file.is-black.is-active .file-cta {
    background-color: #e6e6e6;
    border-color: transparent;
    color: #171717; }
  .file.is-light .file-cta {
    background-color: #363636;
    border-color: transparent;
    color: #fff; }
  .file.is-light:hover .file-cta, .file.is-light.is-hovered .file-cta {
    background-color: #2f2f2f;
    border-color: transparent;
    color: #fff; }
  .file.is-light:focus .file-cta, .file.is-light.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(54, 54, 54, 0.25);
    color: #fff; }
  .file.is-light:active .file-cta, .file.is-light.is-active .file-cta {
    background-color: #292929;
    border-color: transparent;
    color: #fff; }
  .file.is-dark .file-cta {
    background-color: #e6e6e6;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-dark:hover .file-cta, .file.is-dark.is-hovered .file-cta {
    background-color: #dfdfdf;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-dark:focus .file-cta, .file.is-dark.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(230, 230, 230, 0.25);
    color: rgba(0, 0, 0, 0.7); }
  .file.is-dark:active .file-cta, .file.is-dark.is-active .file-cta {
    background-color: #d9d9d9;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-primary .file-cta {
    background-color: #0E87C8;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-primary:hover .file-cta, .file.is-primary.is-hovered .file-cta {
    background-color: #0d7fbc;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-primary:focus .file-cta, .file.is-primary.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(14, 135, 200, 0.25);
    color: rgba(0, 0, 0, 0.7); }
  .file.is-primary:active .file-cta, .file.is-primary.is-active .file-cta {
    background-color: #0c77b0;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-link .file-cta {
    background-color: #467CFB;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-link:hover .file-cta, .file.is-link.is-hovered .file-cta {
    background-color: #3a73fb;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-link:focus .file-cta, .file.is-link.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(70, 124, 251, 0.25);
    color: rgba(0, 0, 0, 0.7); }
  .file.is-link:active .file-cta, .file.is-link.is-active .file-cta {
    background-color: #2d6afa;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-info .file-cta {
    background-color: #7A8690;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-info:hover .file-cta, .file.is-info.is-hovered .file-cta {
    background-color: #73808a;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-info:focus .file-cta, .file.is-info.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(122, 134, 144, 0.25);
    color: rgba(0, 0, 0, 0.7); }
  .file.is-info:active .file-cta, .file.is-info.is-active .file-cta {
    background-color: #6d7983;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-success .file-cta {
    background-color: #029736;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-success:hover .file-cta, .file.is-success.is-hovered .file-cta {
    background-color: #028a32;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-success:focus .file-cta, .file.is-success.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(2, 151, 54, 0.25);
    color: rgba(0, 0, 0, 0.7); }
  .file.is-success:active .file-cta, .file.is-success.is-active .file-cta {
    background-color: #027e2d;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-warning .file-cta {
    background-color: #ffd100;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-warning:hover .file-cta, .file.is-warning.is-hovered .file-cta {
    background-color: #f2c700;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-warning:focus .file-cta, .file.is-warning.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(255, 209, 0, 0.25);
    color: rgba(0, 0, 0, 0.7); }
  .file.is-warning:active .file-cta, .file.is-warning.is-active .file-cta {
    background-color: #e6bc00;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-danger .file-cta {
    background-color: #F91F52;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-danger:hover .file-cta, .file.is-danger.is-hovered .file-cta {
    background-color: #f91348;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-danger:focus .file-cta, .file.is-danger.is-focused .file-cta {
    border-color: transparent;
    box-shadow: 0 0 0.5em rgba(249, 31, 82, 0.25);
    color: rgba(0, 0, 0, 0.7); }
  .file.is-danger:active .file-cta, .file.is-danger.is-active .file-cta {
    background-color: #f8073f;
    border-color: transparent;
    color: rgba(0, 0, 0, 0.7); }
  .file.is-small {
    font-size: 0.75rem; }
  .file.is-normal {
    font-size: 1rem; }
  .file.is-medium {
    font-size: 1.25rem; }
    .file.is-medium .file-icon .fa {
      font-size: 21px; }
  .file.is-large {
    font-size: 1.5rem; }
    .file.is-large .file-icon .fa {
      font-size: 28px; }
  .file.has-name .file-cta {
    border-bottom-right-radius: 0;
    border-top-right-radius: 0; }
  .file.has-name .file-name {
    border-bottom-left-radius: 0;
    border-top-left-radius: 0; }
  .file.has-name.is-empty .file-cta {
    border-radius: 4px; }
  .file.has-name.is-empty .file-name {
    display: none; }
  .file.is-boxed .file-label {
    flex-direction: column; }
  .file.is-boxed .file-cta {
    flex-direction: column;
    height: auto;
    padding: 1em 3em; }
  .file.is-boxed .file-name {
    border-width: 0 1px 1px; }
  .file.is-boxed .file-icon {
    height: 1.5em;
    width: 1.5em; }
    .file.is-boxed .file-icon .fa {
      font-size: 21px; }
  .file.is-boxed.is-small .file-icon .fa {
    font-size: 14px; }
  .file.is-boxed.is-medium .file-icon .fa {
    font-size: 28px; }
  .file.is-boxed.is-large .file-icon .fa {
    font-size: 35px; }
  .file.is-boxed.has-name .file-cta {
    border-radius: 4px 4px 0 0; }
  .file.is-boxed.has-name .file-name {
    border-radius: 0 0 4px 4px;
    border-width: 0 1px 1px; }
  .file.is-centered {
    justify-content: center; }
  .file.is-fullwidth .file-label {
    width: 100%; }
  .file.is-fullwidth .file-name {
    flex-grow: 1;
    max-width: none; }
  .file.is-right {
    justify-content: flex-end; }
    .file.is-right .file-cta {
      border-radius: 0 4px 4px 0; }
    .file.is-right .file-name {
      border-radius: 4px 0 0 4px;
      border-width: 1px 0 1px 1px;
      order: -1; }

.file-label {
  align-items: stretch;
  display: flex;
  cursor: pointer;
  justify-content: flex-start;
  overflow: hidden;
  position: relative; }
  .file-label:hover .file-cta {
    background-color: #1d1d1d;
    color: #dbdbdb; }
  .file-label:hover .file-name {
    border-color: #2f2f2f; }
  .file-label:active .file-cta {
    background-color: #171717;
    color: #dbdbdb; }
  .file-label:active .file-name {
    border-color: #292929; }

.file-input {
  height: 100%;
  left: 0;
  opacity: 0;
  outline: none;
  position: absolute;
  top: 0;
  width: 100%; }

.file-cta,
.file-name {
  border-color: #363636;
  border-radius: 4px;
  font-size: 1em;
  padding-left: 1em;
  padding-right: 1em;
  white-space: nowrap; }

.file-cta {
  background-color: #242424;
  color: #b5b5b5; }

.file-name {
  border-color: #363636;
  border-style: solid;
  border-width: 1px 1px 1px 0;
  display: block;
  max-width: 16em;
  overflow: hidden;
  text-align: inherit;
  text-overflow: ellipsis; }

.file-icon {
  align-items: center;
  display: flex;
  height: 1em;
  justify-content: center;
  margin-right: 0.5em;
  width: 1em; }
  .file-icon .fa {
    font-size: 14px; }

.label {
  color: #dbdbdb;
  display: block;
  font-size: 1rem;
  font-weight: 700; }
  .label:not(:last-child) {
    margin-bottom: 0.5em; }
  .label.is-small {
    font-size: 0.75rem; }
  .label.is-medium {
    font-size: 1.25rem; }
  .label.is-large {
    font-size: 1.5rem; }

.help {
  display: block;
  font-size: 0.75rem;
  margin-top: 0.25rem; }
  .help.is-white {
    color: #171717; }
  .help.is-black {
    color: #f2f2f2; }
  .help.is-light {
    color: #363636; }
  .help.is-dark {
    color: #e6e6e6; }
  .help.is-primary {
    color: #0E87C8; }
  .help.is-link {
    color: #467CFB; }
  .help.is-info {
    color: #7A8690; }
  .help.is-success {
    color: #029736; }
  .help.is-warning {
    color: #ffd100; }
  .help.is-danger {
    color: #F91F52; }

.field:not(:last-child) {
  margin-bottom: 0.75rem; }

.field.has-addons {
  display: flex;
  justify-content: flex-start; }
  .field.has-addons .control:not(:last-child) {
    margin-right: -1px; }
  .field.has-addons .control:not(:first-child):not(:last-child) .button,
  .field.has-addons .control:not(:first-child):not(:last-child) .input,
  .field.has-addons .control:not(:first-child):not(:last-child) .select select {
    border-radius: 0; }
  .field.has-addons .control:first-child:not(:only-child) .button,
  .field.has-addons .control:first-child:not(:only-child) .input,
  .field.has-addons .control:first-child:not(:only-child) .select select {
    border-bottom-right-radius: 0;
    border-top-right-radius: 0; }
  .field.has-addons .control:last-child:not(:only-child) .button,
  .field.has-addons .control:last-child:not(:only-child) .input,
  .field.has-addons .control:last-child:not(:only-child) .select select {
    border-bottom-left-radius: 0;
    border-top-left-radius: 0; }
  .field.has-addons .control .button:not([disabled]):hover, .field.has-addons .control .button:not([disabled]).is-hovered,
  .field.has-addons .control .input:not([disabled]):hover,
  .field.has-addons .control .input:not([disabled]).is-hovered,
  .field.has-addons .control .select select:not([disabled]):hover,
  .field.has-addons .control .select select:not([disabled]).is-hovered {
    z-index: 2; }
  .field.has-addons .control .button:not([disabled]):focus, .field.has-addons .control .button:not([disabled]).is-focused, .field.has-addons .control .button:not([disabled]):active, .field.has-addons .control .button:not([disabled]).is-active,
  .field.has-addons .control .input:not([disabled]):focus,
  .field.has-addons .control .input:not([disabled]).is-focused,
  .field.has-addons .control .input:not([disabled]):active,
  .field.has-addons .control .input:not([disabled]).is-active,
  .field.has-addons .control .select select:not([disabled]):focus,
  .field.has-addons .control .select select:not([disabled]).is-focused,
  .field.has-addons .control .select select:not([disabled]):active,
  .field.has-addons .control .select select:not([disabled]).is-active {
    z-index: 3; }
    .field.has-addons .control .button:not([disabled]):focus:hover, .field.has-addons .control .button:not([disabled]).is-focused:hover, .field.has-addons .control .button:not([disabled]):active:hover, .field.has-addons .control .button:not([disabled]).is-active:hover,
    .field.has-addons .control .input:not([disabled]):focus:hover,
    .field.has-addons .control .input:not([disabled]).is-focused:hover,
    .field.has-addons .control .input:not([disabled]):active:hover,
    .field.has-addons .control .input:not([disabled]).is-active:hover,
    .field.has-addons .control .select select:not([disabled]):focus:hover,
    .field.has-addons .control .select select:not([disabled]).is-focused:hover,
    .field.has-addons .control .select select:not([disabled]):active:hover,
    .field.has-addons .control .select select:not([disabled]).is-active:hover {
      z-index: 4; }
  .field.has-addons .control.is-expanded {
    flex-grow: 1;
    flex-shrink: 1; }
  .field.has-addons.has-addons-centered {
    justify-content: center; }
  .field.has-addons.has-addons-right {
    justify-content: flex-end; }
  .field.has-addons.has-addons-fullwidth .control {
    flex-grow: 1;
    flex-shrink: 0; }

.field.is-grouped {
  display: flex;
  justify-content: flex-start; }
  .field.is-grouped > .control {
    flex-shrink: 0; }
    .field.is-grouped > .control:not(:last-child) {
      margin-bottom: 0;
      margin-right: 0.75rem; }
    .field.is-grouped > .control.is-expanded {
      flex-grow: 1;
      flex-shrink: 1; }
  .field.is-grouped.is-grouped-centered {
    justify-content: center; }
  .field.is-grouped.is-grouped-right {
    justify-content: flex-end; }
  .field.is-grouped.is-grouped-multiline {
    flex-wrap: wrap; }
    .field.is-grouped.is-grouped-multiline > .control:last-child, .field.is-grouped.is-grouped-multiline > .control:not(:last-child) {
      margin-bottom: 0.75rem; }
    .field.is-grouped.is-grouped-multiline:last-child {
      margin-bottom: -0.75rem; }
    .field.is-grouped.is-grouped-multiline:not(:last-child) {
      margin-bottom: 0; }

@media screen and (min-width: 769px), print {
  .field.is-horizontal {
    display: flex; } }

.field-label .label {
  font-size: inherit; }

@media screen and (max-width: 768px) {
  .field-label {
    margin-bottom: 0.5rem; } }

@media screen and (min-width: 769px), print {
  .field-label {
    flex-basis: 0;
    flex-grow: 1;
    flex-shrink: 0;
    margin-right: 1.5rem;
    text-align: right; }
    .field-label.is-small {
      font-size: 0.75rem;
      padding-top: 0.375em; }
    .field-label.is-normal {
      padding-top: 0.375em; }
    .field-label.is-medium {
      font-size: 1.25rem;
      padding-top: 0.375em; }
    .field-label.is-large {
      font-size: 1.5rem;
      padding-top: 0.375em; } }

.field-body .field .field {
  margin-bottom: 0; }

@media screen and (min-width: 769px), print {
  .field-body {
    display: flex;
    flex-basis: 0;
    flex-grow: 5;
    flex-shrink: 1; }
    .field-body .field {
      margin-bottom: 0; }
    .field-body > .field {
      flex-shrink: 1; }
      .field-body > .field:not(.is-narrow) {
        flex-grow: 1; }
      .field-body > .field:not(:last-child) {
        margin-right: 0.75rem; } }

.control {
  box-sizing: border-box;
  clear: both;
  font-size: 1rem;
  position: relative;
  text-align: inherit; }
  .control.has-icons-left .input:focus ~ .icon,
  .control.has-icons-left .select:focus ~ .icon, .control.has-icons-right .input:focus ~ .icon,
  .control.has-icons-right .select:focus ~ .icon {
    color: #b5b5b5; }
  .control.has-icons-left .input.is-small ~ .icon,
  .control.has-icons-left .select.is-small ~ .icon, .control.has-icons-right .input.is-small ~ .icon,
  .control.has-icons-right .select.is-small ~ .icon {
    font-size: 0.75rem; }
  .control.has-icons-left .input.is-medium ~ .icon,
  .control.has-icons-left .select.is-medium ~ .icon, .control.has-icons-right .input.is-medium ~ .icon,
  .control.has-icons-right .select.is-medium ~ .icon {
    font-size: 1.25rem; }
  .control.has-icons-left .input.is-large ~ .icon,
  .control.has-icons-left .select.is-large ~ .icon, .control.has-icons-right .input.is-large ~ .icon,
  .control.has-icons-right .select.is-large ~ .icon {
    font-size: 1.5rem; }
  .control.has-icons-left .icon, .control.has-icons-right .icon {
    color: #363636;
    height: 2.5em;
    pointer-events: none;
    position: absolute;
    top: 0;
    width: 2.5em;
    z-index: 4; }
  .control.has-icons-left .input,
  .control.has-icons-left .select select {
    padding-left: 2.5em; }
  .control.has-icons-left .icon.is-left {
    left: 0; }
  .control.has-icons-right .input,
  .control.has-icons-right .select select {
    padding-right: 2.5em; }
  .control.has-icons-right .icon.is-right {
    right: 0; }
  .control.is-loading::after {
    position: absolute !important;
    right: 0.625em;
    top: 0.625em;
    z-index: 4; }
  .control.is-loading.is-small:after {
    font-size: 0.75rem; }
  .control.is-loading.is-medium:after {
    font-size: 1.25rem; }
  .control.is-loading.is-large:after {
    font-size: 1.5rem; }

/* Bulma Components */
.breadcrumb {
  font-size: 1rem;
  white-space: nowrap; }
  .breadcrumb a {
    align-items: center;
    color: #467CFB;
    display: flex;
    justify-content: center;
    padding: 0 0.75em; }
    .breadcrumb a:hover {
      color: #dbdbdb; }
  .breadcrumb li {
    align-items: center;
    display: flex; }
    .breadcrumb li:first-child a {
      padding-left: 0; }
    .breadcrumb li.is-active a {
      color: #dbdbdb;
      cursor: default;
      pointer-events: none; }
    .breadcrumb li + li::before {
      color: #4a4a4a;
      content: "\0002f"; }
  .breadcrumb ul,
  .breadcrumb ol {
    align-items: flex-start;
    display: flex;
    flex-wrap: wrap;
    justify-content: flex-start; }
  .breadcrumb .icon:first-child {
    margin-right: 0.5em; }
  .breadcrumb .icon:last-child {
    margin-left: 0.5em; }
  .breadcrumb.is-centered ol,
  .breadcrumb.is-centered ul {
    justify-content: center; }
  .breadcrumb.is-right ol,
  .breadcrumb.is-right ul {
    justify-content: flex-end; }
  .breadcrumb.is-small {
    font-size: 0.75rem; }
  .breadcrumb.is-medium {
    font-size: 1.25rem; }
  .breadcrumb.is-large {
    font-size: 1.5rem; }
  .breadcrumb.has-arrow-separator li + li::before {
    content: "\02192"; }
  .breadcrumb.has-bullet-separator li + li::before {
    content: "\02022"; }
  .breadcrumb.has-dot-separator li + li::before {
    content: "\000b7"; }
  .breadcrumb.has-succeeds-separator li + li::before {
    content: "\0227B"; }

.card {
  background-color: #171717;
  border-radius: 0.25rem;
  box-shadow: 0 0.5em 1em -0.125em rgba(242, 242, 242, 0.1), 0 0px 0 1px rgba(242, 242, 242, 0.02);
  color: #b5b5b5;
  max-width: 100%;
  position: relative; }

.card-header:first-child, .card-content:first-child, .card-footer:first-child {
  border-top-left-radius: 0.25rem;
  border-top-right-radius: 0.25rem; }

.card-header:last-child, .card-content:last-child, .card-footer:last-child {
  border-bottom-left-radius: 0.25rem;
  border-bottom-right-radius: 0.25rem; }

.card-header {
  background-color: transparent;
  align-items: stretch;
  box-shadow: 0 0.125em 0.25em rgba(242, 242, 242, 0.1);
  display: flex; }

.card-header-title {
  align-items: center;
  color: #dbdbdb;
  display: flex;
  flex-grow: 1;
  font-weight: 700;
  padding: 0.75rem 1rem; }
  .card-header-title.is-centered {
    justify-content: center; }

.card-header-icon {
  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background: none;
  border: none;
  color: currentColor;
  font-family: inherit;
  font-size: 1em;
  margin: 0;
  padding: 0;
  align-items: center;
  cursor: pointer;
  display: flex;
  justify-content: center;
  padding: 0.75rem 1rem; }

.card-image {
  display: block;
  position: relative; }
  .card-image:first-child img {
    border-top-left-radius: 0.25rem;
    border-top-right-radius: 0.25rem; }
  .card-image:last-child img {
    border-bottom-left-radius: 0.25rem;
    border-bottom-right-radius: 0.25rem; }

.card-content {
  background-color: transparent;
  padding: 1.5rem; }

.card-footer {
  background-color: transparent;
  border-top: 1px solid #ededed;
  align-items: stretch;
  display: flex; }

.card-footer-item {
  align-items: center;
  display: flex;
  flex-basis: 0;
  flex-grow: 1;
  flex-shrink: 0;
  justify-content: center;
  padding: 0.75rem; }
  .card-footer-item:not(:last-child) {
    border-right: 1px solid #ededed; }

.card .media:not(:last-child) {
  margin-bottom: 1.5rem; }

.dropdown {
  display: inline-flex;
  position: relative;
  vertical-align: top; }
  .dropdown.is-active .dropdown-menu, .dropdown.is-hoverable:hover .dropdown-menu {
    display: block; }
  .dropdown.is-right .dropdown-menu {
    left: auto;
    right: 0; }
  .dropdown.is-up .dropdown-menu {
    bottom: 100%;
    padding-bottom: 4px;
    padding-top: initial;
    top: auto; }

.dropdown-menu {
  display: none;
  left: 0;
  min-width: 12rem;
  padding-top: 4px;
  position: absolute;
  top: 100%;
  z-index: 20; }

.dropdown-content {
  background-color: #171717;
  border-radius: 4px;
  box-shadow: 0 0.5em 1em -0.125em rgba(242, 242, 242, 0.1), 0 0px 0 1px rgba(242, 242, 242, 0.02);
  padding-bottom: 0.5rem;
  padding-top: 0.5rem; }

.dropdown-item {
  color: #b5b5b5;
  display: block;
  font-size: 0.875rem;
  line-height: 1.5;
  padding: 0.375rem 1rem;
  position: relative; }

a.dropdown-item,
button.dropdown-item {
  padding-right: 3rem;
  text-align: inherit;
  white-space: nowrap;
  width: 100%; }
  a.dropdown-item:hover,
  button.dropdown-item:hover {
    background-color: #242424;
    color: #f2f2f2; }
  a.dropdown-item.is-active,
  button.dropdown-item.is-active {
    background-color: #467CFB;
    color: rgba(0, 0, 0, 0.7); }

.dropdown-divider {
  background-color: #ededed;
  border: none;
  display: block;
  height: 1px;
  margin: 0.5rem 0; }

.level {
  align-items: center;
  justify-content: space-between; }
  .level code {
    border-radius: 4px; }
  .level img {
    display: inline-block;
    vertical-align: top; }
  .level.is-mobile {
    display: flex; }
    .level.is-mobile .level-left,
    .level.is-mobile .level-right {
      display: flex; }
    .level.is-mobile .level-left + .level-right {
      margin-top: 0; }
    .level.is-mobile .level-item:not(:last-child) {
      margin-bottom: 0;
      margin-right: 0.75rem; }
    .level.is-mobile .level-item:not(.is-narrow) {
      flex-grow: 1; }
  @media screen and (min-width: 769px), print {
    .level {
      display: flex; }
      .level > .level-item:not(.is-narrow) {
        flex-grow: 1; } }

.level-item {
  align-items: center;
  display: flex;
  flex-basis: auto;
  flex-grow: 0;
  flex-shrink: 0;
  justify-content: center; }
  .level-item .title,
  .level-item .subtitle {
    margin-bottom: 0; }
  @media screen and (max-width: 768px) {
    .level-item:not(:last-child) {
      margin-bottom: 0.75rem; } }

.level-left,
.level-right {
  flex-basis: auto;
  flex-grow: 0;
  flex-shrink: 0; }
  .level-left .level-item.is-flexible,
  .level-right .level-item.is-flexible {
    flex-grow: 1; }
  @media screen and (min-width: 769px), print {
    .level-left .level-item:not(:last-child),
    .level-right .level-item:not(:last-child) {
      margin-right: 0.75rem; } }

.level-left {
  align-items: center;
  justify-content: flex-start; }
  @media screen and (max-width: 768px) {
    .level-left + .level-right {
      margin-top: 1.5rem; } }
  @media screen and (min-width: 769px), print {
    .level-left {
      display: flex; } }

.level-right {
  align-items: center;
  justify-content: flex-end; }
  @media screen and (min-width: 769px), print {
    .level-right {
      display: flex; } }

.media {
  align-items: flex-start;
  display: flex;
  text-align: inherit; }
  .media .content:not(:last-child) {
    margin-bottom: 0.75rem; }
  .media .media {
    border-top: 1px solid rgba(54, 54, 54, 0.5);
    display: flex;
    padding-top: 0.75rem; }
    .media .media .content:not(:last-child),
    .media .media .control:not(:last-child) {
      margin-bottom: 0.5rem; }
    .media .media .media {
      padding-top: 0.5rem; }
      .media .media .media + .media {
        margin-top: 0.5rem; }
  .media + .media {
    border-top: 1px solid rgba(54, 54, 54, 0.5);
    margin-top: 1rem;
    padding-top: 1rem; }
  .media.is-large + .media {
    margin-top: 1.5rem;
    padding-top: 1.5rem; }

.media-left,
.media-right {
  flex-basis: auto;
  flex-grow: 0;
  flex-shrink: 0; }

.media-left {
  margin-right: 1rem; }

.media-right {
  margin-left: 1rem; }

.media-content {
  flex-basis: auto;
  flex-grow: 1;
  flex-shrink: 1;
  text-align: inherit; }

@media screen and (max-width: 768px) {
  .media-content {
    overflow-x: auto; } }

.menu {
  font-size: 1rem; }
  .menu.is-small {
    font-size: 0.75rem; }
  .menu.is-medium {
    font-size: 1.25rem; }
  .menu.is-large {
    font-size: 1.5rem; }

.menu-list {
  line-height: 1.25; }
  .menu-list a {
    border-radius: 2px;
    color: #b5b5b5;
    display: block;
    padding: 0.5em 0.75em; }
    .menu-list a:hover {
      background-color: #242424;
      color: #dbdbdb; }
    .menu-list a.is-active {
      background-color: #467CFB;
      color: rgba(0, 0, 0, 0.7); }
  .menu-list li ul {
    border-left: 1px solid #363636;
    margin: 0.75em;
    padding-left: 0.75em; }

.menu-label {
  color: #7a7a7a;
  font-size: 0.75em;
  letter-spacing: 0.1em;
  text-transform: uppercase; }
  .menu-label:not(:first-child) {
    margin-top: 1em; }
  .menu-label:not(:last-child) {
    margin-bottom: 1em; }

.message {
  background-color: #242424;
  border-radius: 4px;
  font-size: 1rem; }
  .message strong {
    color: currentColor; }
  .message a:not(.button):not(.tag):not(.dropdown-item) {
    color: currentColor;
    text-decoration: underline; }
  .message.is-small {
    font-size: 0.75rem; }
  .message.is-medium {
    font-size: 1.25rem; }
  .message.is-large {
    font-size: 1.5rem; }
  .message.is-white {
    background-color: #fafafa; }
    .message.is-white .message-header {
      background-color: #171717;
      color: #f2f2f2; }
    .message.is-white .message-body {
      border-color: #171717; }
  .message.is-black {
    background-color: #fafafa; }
    .message.is-black .message-header {
      background-color: #f2f2f2;
      color: #171717; }
    .message.is-black .message-body {
      border-color: #f2f2f2; }
  .message.is-light {
    background-color: #fafafa; }
    .message.is-light .message-header {
      background-color: #363636;
      color: #fff; }
    .message.is-light .message-body {
      border-color: #363636; }
  .message.is-dark {
    background-color: #fafafa; }
    .message.is-dark .message-header {
      background-color: #e6e6e6;
      color: rgba(0, 0, 0, 0.7); }
    .message.is-dark .message-body {
      border-color: #e6e6e6; }
  .message.is-primary {
    background-color: #ecf7fe; }
    .message.is-primary .message-header {
      background-color: #0E87C8;
      color: rgba(0, 0, 0, 0.7); }
    .message.is-primary .message-body {
      border-color: #0E87C8;
      color: #0e8acd; }
  .message.is-link {
    background-color: #ebf1ff; }
    .message.is-link .message-header {
      background-color: #467CFB;
      color: rgba(0, 0, 0, 0.7); }
    .message.is-link .message-body {
      border-color: #467CFB;
      color: #0542d2; }
  .message.is-info {
    background-color: #f4f5f6; }
    .message.is-info .message-header {
      background-color: #7A8690;
      color: rgba(0, 0, 0, 0.7); }
    .message.is-info .message-body {
      border-color: #7A8690;
      color: #5f6972; }
  .message.is-success {
    background-color: #ebfff2; }
    .message.is-success .message-header {
      background-color: #029736;
      color: rgba(0, 0, 0, 0.7); }
    .message.is-success .message-body {
      border-color: #029736;
      color: #03d84d; }
  .message.is-warning {
    background-color: #fffbeb; }
    .message.is-warning .message-header {
      background-color: #ffd100;
      color: rgba(0, 0, 0, 0.7); }
    .message.is-warning .message-body {
      border-color: #ffd100;
      color: #947900; }
  .message.is-danger {
    background-color: #feebf0; }
    .message.is-danger .message-header {
      background-color: #F91F52;
      color: rgba(0, 0, 0, 0.7); }
    .message.is-danger .message-body {
      border-color: #F91F52;
      color: #e00639; }

.message-header {
  align-items: center;
  background-color: #b5b5b5;
  border-radius: 4px 4px 0 0;
  color: #fff;
  display: flex;
  font-weight: 700;
  justify-content: space-between;
  line-height: 1.25;
  padding: 0.75em 1em;
  position: relative; }
  .message-header .delete {
    flex-grow: 0;
    flex-shrink: 0;
    margin-left: 0.75em; }
  .message-header + .message-body {
    border-width: 0;
    border-top-left-radius: 0;
    border-top-right-radius: 0; }

.message-body {
  border-color: #363636;
  border-radius: 4px;
  border-style: solid;
  border-width: 0 0 0 4px;
  color: #b5b5b5;
  padding: 1.25em 1.5em; }
  .message-body code,
  .message-body pre {
    background-color: #171717; }
  .message-body pre code {
    background-color: transparent; }

.modal {
  align-items: center;
  display: none;
  flex-direction: column;
  justify-content: center;
  overflow: hidden;
  position: fixed;
  z-index: 40; }
  .modal.is-active {
    display: flex; }

.modal-background {
  background-color: rgba(242, 242, 242, 0.86); }

.modal-content,
.modal-card {
  margin: 0 20px;
  max-height: calc(100vh - 160px);
  overflow: auto;
  position: relative;
  width: 100%; }
  @media screen and (min-width: 769px) {
    .modal-content,
    .modal-card {
      margin: 0 auto;
      max-height: calc(100vh - 40px);
      width: 640px; } }

.modal-close {
  background: none;
  height: 40px;
  position: fixed;
  right: 20px;
  top: 20px;
  width: 40px; }

.modal-card {
  display: flex;
  flex-direction: column;
  max-height: calc(100vh - 40px);
  overflow: hidden;
  -ms-overflow-y: visible; }

.modal-card-head,
.modal-card-foot {
  align-items: center;
  background-color: #242424;
  display: flex;
  flex-shrink: 0;
  justify-content: flex-start;
  padding: 20px;
  position: relative; }

.modal-card-head {
  border-bottom: 1px solid #363636;
  border-top-left-radius: 6px;
  border-top-right-radius: 6px; }

.modal-card-title {
  color: #dbdbdb;
  flex-grow: 1;
  flex-shrink: 0;
  font-size: 1.5rem;
  line-height: 1; }

.modal-card-foot {
  border-bottom-left-radius: 6px;
  border-bottom-right-radius: 6px;
  border-top: 1px solid #363636; }
  .modal-card-foot .button:not(:last-child) {
    margin-right: 0.5em; }

.modal-card-body {
  -webkit-overflow-scrolling: touch;
  background-color: #171717;
  flex-grow: 1;
  flex-shrink: 1;
  overflow: auto;
  padding: 20px; }

.navbar {
  background-color: #171717;
  min-height: 3.25rem;
  position: relative;
  z-index: 30; }
  .navbar.is-white {
    background-color: #171717;
    color: #f2f2f2; }
    .navbar.is-white .navbar-brand > .navbar-item,
    .navbar.is-white .navbar-brand .navbar-link {
      color: #f2f2f2; }
    .navbar.is-white .navbar-brand > a.navbar-item:focus, .navbar.is-white .navbar-brand > a.navbar-item:hover, .navbar.is-white .navbar-brand > a.navbar-item.is-active,
    .navbar.is-white .navbar-brand .navbar-link:focus,
    .navbar.is-white .navbar-brand .navbar-link:hover,
    .navbar.is-white .navbar-brand .navbar-link.is-active {
      background-color: #0a0a0a;
      color: #f2f2f2; }
    .navbar.is-white .navbar-brand .navbar-link::after {
      border-color: #f2f2f2; }
    .navbar.is-white .navbar-burger {
      color: #f2f2f2; }
    @media screen and (min-width: 1024px) {
      .navbar.is-white .navbar-start > .navbar-item,
      .navbar.is-white .navbar-start .navbar-link,
      .navbar.is-white .navbar-end > .navbar-item,
      .navbar.is-white .navbar-end .navbar-link {
        color: #f2f2f2; }
      .navbar.is-white .navbar-start > a.navbar-item:focus, .navbar.is-white .navbar-start > a.navbar-item:hover, .navbar.is-white .navbar-start > a.navbar-item.is-active,
      .navbar.is-white .navbar-start .navbar-link:focus,
      .navbar.is-white .navbar-start .navbar-link:hover,
      .navbar.is-white .navbar-start .navbar-link.is-active,
      .navbar.is-white .navbar-end > a.navbar-item:focus,
      .navbar.is-white .navbar-end > a.navbar-item:hover,
      .navbar.is-white .navbar-end > a.navbar-item.is-active,
      .navbar.is-white .navbar-end .navbar-link:focus,
      .navbar.is-white .navbar-end .navbar-link:hover,
      .navbar.is-white .navbar-end .navbar-link.is-active {
        background-color: #0a0a0a;
        color: #f2f2f2; }
      .navbar.is-white .navbar-start .navbar-link::after,
      .navbar.is-white .navbar-end .navbar-link::after {
        border-color: #f2f2f2; }
      .navbar.is-white .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-white .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-white .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #0a0a0a;
        color: #f2f2f2; }
      .navbar.is-white .navbar-dropdown a.navbar-item.is-active {
        background-color: #171717;
        color: #f2f2f2; } }
  .navbar.is-black {
    background-color: #f2f2f2;
    color: #171717; }
    .navbar.is-black .navbar-brand > .navbar-item,
    .navbar.is-black .navbar-brand .navbar-link {
      color: #171717; }
    .navbar.is-black .navbar-brand > a.navbar-item:focus, .navbar.is-black .navbar-brand > a.navbar-item:hover, .navbar.is-black .navbar-brand > a.navbar-item.is-active,
    .navbar.is-black .navbar-brand .navbar-link:focus,
    .navbar.is-black .navbar-brand .navbar-link:hover,
    .navbar.is-black .navbar-brand .navbar-link.is-active {
      background-color: #e6e6e6;
      color: #171717; }
    .navbar.is-black .navbar-brand .navbar-link::after {
      border-color: #171717; }
    .navbar.is-black .navbar-burger {
      color: #171717; }
    @media screen and (min-width: 1024px) {
      .navbar.is-black .navbar-start > .navbar-item,
      .navbar.is-black .navbar-start .navbar-link,
      .navbar.is-black .navbar-end > .navbar-item,
      .navbar.is-black .navbar-end .navbar-link {
        color: #171717; }
      .navbar.is-black .navbar-start > a.navbar-item:focus, .navbar.is-black .navbar-start > a.navbar-item:hover, .navbar.is-black .navbar-start > a.navbar-item.is-active,
      .navbar.is-black .navbar-start .navbar-link:focus,
      .navbar.is-black .navbar-start .navbar-link:hover,
      .navbar.is-black .navbar-start .navbar-link.is-active,
      .navbar.is-black .navbar-end > a.navbar-item:focus,
      .navbar.is-black .navbar-end > a.navbar-item:hover,
      .navbar.is-black .navbar-end > a.navbar-item.is-active,
      .navbar.is-black .navbar-end .navbar-link:focus,
      .navbar.is-black .navbar-end .navbar-link:hover,
      .navbar.is-black .navbar-end .navbar-link.is-active {
        background-color: #e6e6e6;
        color: #171717; }
      .navbar.is-black .navbar-start .navbar-link::after,
      .navbar.is-black .navbar-end .navbar-link::after {
        border-color: #171717; }
      .navbar.is-black .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-black .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-black .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #e6e6e6;
        color: #171717; }
      .navbar.is-black .navbar-dropdown a.navbar-item.is-active {
        background-color: #f2f2f2;
        color: #171717; } }
  .navbar.is-light {
    background-color: #363636;
    color: #fff; }
    .navbar.is-light .navbar-brand > .navbar-item,
    .navbar.is-light .navbar-brand .navbar-link {
      color: #fff; }
    .navbar.is-light .navbar-brand > a.navbar-item:focus, .navbar.is-light .navbar-brand > a.navbar-item:hover, .navbar.is-light .navbar-brand > a.navbar-item.is-active,
    .navbar.is-light .navbar-brand .navbar-link:focus,
    .navbar.is-light .navbar-brand .navbar-link:hover,
    .navbar.is-light .navbar-brand .navbar-link.is-active {
      background-color: #292929;
      color: #fff; }
    .navbar.is-light .navbar-brand .navbar-link::after {
      border-color: #fff; }
    .navbar.is-light .navbar-burger {
      color: #fff; }
    @media screen and (min-width: 1024px) {
      .navbar.is-light .navbar-start > .navbar-item,
      .navbar.is-light .navbar-start .navbar-link,
      .navbar.is-light .navbar-end > .navbar-item,
      .navbar.is-light .navbar-end .navbar-link {
        color: #fff; }
      .navbar.is-light .navbar-start > a.navbar-item:focus, .navbar.is-light .navbar-start > a.navbar-item:hover, .navbar.is-light .navbar-start > a.navbar-item.is-active,
      .navbar.is-light .navbar-start .navbar-link:focus,
      .navbar.is-light .navbar-start .navbar-link:hover,
      .navbar.is-light .navbar-start .navbar-link.is-active,
      .navbar.is-light .navbar-end > a.navbar-item:focus,
      .navbar.is-light .navbar-end > a.navbar-item:hover,
      .navbar.is-light .navbar-end > a.navbar-item.is-active,
      .navbar.is-light .navbar-end .navbar-link:focus,
      .navbar.is-light .navbar-end .navbar-link:hover,
      .navbar.is-light .navbar-end .navbar-link.is-active {
        background-color: #292929;
        color: #fff; }
      .navbar.is-light .navbar-start .navbar-link::after,
      .navbar.is-light .navbar-end .navbar-link::after {
        border-color: #fff; }
      .navbar.is-light .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-light .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-light .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #292929;
        color: #fff; }
      .navbar.is-light .navbar-dropdown a.navbar-item.is-active {
        background-color: #363636;
        color: #fff; } }
  .navbar.is-dark {
    background-color: #e6e6e6;
    color: rgba(0, 0, 0, 0.7); }
    .navbar.is-dark .navbar-brand > .navbar-item,
    .navbar.is-dark .navbar-brand .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-dark .navbar-brand > a.navbar-item:focus, .navbar.is-dark .navbar-brand > a.navbar-item:hover, .navbar.is-dark .navbar-brand > a.navbar-item.is-active,
    .navbar.is-dark .navbar-brand .navbar-link:focus,
    .navbar.is-dark .navbar-brand .navbar-link:hover,
    .navbar.is-dark .navbar-brand .navbar-link.is-active {
      background-color: #d9d9d9;
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-dark .navbar-brand .navbar-link::after {
      border-color: rgba(0, 0, 0, 0.7); }
    .navbar.is-dark .navbar-burger {
      color: rgba(0, 0, 0, 0.7); }
    @media screen and (min-width: 1024px) {
      .navbar.is-dark .navbar-start > .navbar-item,
      .navbar.is-dark .navbar-start .navbar-link,
      .navbar.is-dark .navbar-end > .navbar-item,
      .navbar.is-dark .navbar-end .navbar-link {
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-dark .navbar-start > a.navbar-item:focus, .navbar.is-dark .navbar-start > a.navbar-item:hover, .navbar.is-dark .navbar-start > a.navbar-item.is-active,
      .navbar.is-dark .navbar-start .navbar-link:focus,
      .navbar.is-dark .navbar-start .navbar-link:hover,
      .navbar.is-dark .navbar-start .navbar-link.is-active,
      .navbar.is-dark .navbar-end > a.navbar-item:focus,
      .navbar.is-dark .navbar-end > a.navbar-item:hover,
      .navbar.is-dark .navbar-end > a.navbar-item.is-active,
      .navbar.is-dark .navbar-end .navbar-link:focus,
      .navbar.is-dark .navbar-end .navbar-link:hover,
      .navbar.is-dark .navbar-end .navbar-link.is-active {
        background-color: #d9d9d9;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-dark .navbar-start .navbar-link::after,
      .navbar.is-dark .navbar-end .navbar-link::after {
        border-color: rgba(0, 0, 0, 0.7); }
      .navbar.is-dark .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-dark .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-dark .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #d9d9d9;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-dark .navbar-dropdown a.navbar-item.is-active {
        background-color: #e6e6e6;
        color: rgba(0, 0, 0, 0.7); } }
  .navbar.is-primary {
    background-color: #0E87C8;
    color: rgba(0, 0, 0, 0.7); }
    .navbar.is-primary .navbar-brand > .navbar-item,
    .navbar.is-primary .navbar-brand .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-primary .navbar-brand > a.navbar-item:focus, .navbar.is-primary .navbar-brand > a.navbar-item:hover, .navbar.is-primary .navbar-brand > a.navbar-item.is-active,
    .navbar.is-primary .navbar-brand .navbar-link:focus,
    .navbar.is-primary .navbar-brand .navbar-link:hover,
    .navbar.is-primary .navbar-brand .navbar-link.is-active {
      background-color: #0c77b0;
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-primary .navbar-brand .navbar-link::after {
      border-color: rgba(0, 0, 0, 0.7); }
    .navbar.is-primary .navbar-burger {
      color: rgba(0, 0, 0, 0.7); }
    @media screen and (min-width: 1024px) {
      .navbar.is-primary .navbar-start > .navbar-item,
      .navbar.is-primary .navbar-start .navbar-link,
      .navbar.is-primary .navbar-end > .navbar-item,
      .navbar.is-primary .navbar-end .navbar-link {
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-primary .navbar-start > a.navbar-item:focus, .navbar.is-primary .navbar-start > a.navbar-item:hover, .navbar.is-primary .navbar-start > a.navbar-item.is-active,
      .navbar.is-primary .navbar-start .navbar-link:focus,
      .navbar.is-primary .navbar-start .navbar-link:hover,
      .navbar.is-primary .navbar-start .navbar-link.is-active,
      .navbar.is-primary .navbar-end > a.navbar-item:focus,
      .navbar.is-primary .navbar-end > a.navbar-item:hover,
      .navbar.is-primary .navbar-end > a.navbar-item.is-active,
      .navbar.is-primary .navbar-end .navbar-link:focus,
      .navbar.is-primary .navbar-end .navbar-link:hover,
      .navbar.is-primary .navbar-end .navbar-link.is-active {
        background-color: #0c77b0;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-primary .navbar-start .navbar-link::after,
      .navbar.is-primary .navbar-end .navbar-link::after {
        border-color: rgba(0, 0, 0, 0.7); }
      .navbar.is-primary .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-primary .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-primary .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #0c77b0;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-primary .navbar-dropdown a.navbar-item.is-active {
        background-color: #0E87C8;
        color: rgba(0, 0, 0, 0.7); } }
  .navbar.is-link {
    background-color: #467CFB;
    color: rgba(0, 0, 0, 0.7); }
    .navbar.is-link .navbar-brand > .navbar-item,
    .navbar.is-link .navbar-brand .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-link .navbar-brand > a.navbar-item:focus, .navbar.is-link .navbar-brand > a.navbar-item:hover, .navbar.is-link .navbar-brand > a.navbar-item.is-active,
    .navbar.is-link .navbar-brand .navbar-link:focus,
    .navbar.is-link .navbar-brand .navbar-link:hover,
    .navbar.is-link .navbar-brand .navbar-link.is-active {
      background-color: #2d6afa;
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-link .navbar-brand .navbar-link::after {
      border-color: rgba(0, 0, 0, 0.7); }
    .navbar.is-link .navbar-burger {
      color: rgba(0, 0, 0, 0.7); }
    @media screen and (min-width: 1024px) {
      .navbar.is-link .navbar-start > .navbar-item,
      .navbar.is-link .navbar-start .navbar-link,
      .navbar.is-link .navbar-end > .navbar-item,
      .navbar.is-link .navbar-end .navbar-link {
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-link .navbar-start > a.navbar-item:focus, .navbar.is-link .navbar-start > a.navbar-item:hover, .navbar.is-link .navbar-start > a.navbar-item.is-active,
      .navbar.is-link .navbar-start .navbar-link:focus,
      .navbar.is-link .navbar-start .navbar-link:hover,
      .navbar.is-link .navbar-start .navbar-link.is-active,
      .navbar.is-link .navbar-end > a.navbar-item:focus,
      .navbar.is-link .navbar-end > a.navbar-item:hover,
      .navbar.is-link .navbar-end > a.navbar-item.is-active,
      .navbar.is-link .navbar-end .navbar-link:focus,
      .navbar.is-link .navbar-end .navbar-link:hover,
      .navbar.is-link .navbar-end .navbar-link.is-active {
        background-color: #2d6afa;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-link .navbar-start .navbar-link::after,
      .navbar.is-link .navbar-end .navbar-link::after {
        border-color: rgba(0, 0, 0, 0.7); }
      .navbar.is-link .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-link .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-link .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #2d6afa;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-link .navbar-dropdown a.navbar-item.is-active {
        background-color: #467CFB;
        color: rgba(0, 0, 0, 0.7); } }
  .navbar.is-info {
    background-color: #7A8690;
    color: rgba(0, 0, 0, 0.7); }
    .navbar.is-info .navbar-brand > .navbar-item,
    .navbar.is-info .navbar-brand .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-info .navbar-brand > a.navbar-item:focus, .navbar.is-info .navbar-brand > a.navbar-item:hover, .navbar.is-info .navbar-brand > a.navbar-item.is-active,
    .navbar.is-info .navbar-brand .navbar-link:focus,
    .navbar.is-info .navbar-brand .navbar-link:hover,
    .navbar.is-info .navbar-brand .navbar-link.is-active {
      background-color: #6d7983;
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-info .navbar-brand .navbar-link::after {
      border-color: rgba(0, 0, 0, 0.7); }
    .navbar.is-info .navbar-burger {
      color: rgba(0, 0, 0, 0.7); }
    @media screen and (min-width: 1024px) {
      .navbar.is-info .navbar-start > .navbar-item,
      .navbar.is-info .navbar-start .navbar-link,
      .navbar.is-info .navbar-end > .navbar-item,
      .navbar.is-info .navbar-end .navbar-link {
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-info .navbar-start > a.navbar-item:focus, .navbar.is-info .navbar-start > a.navbar-item:hover, .navbar.is-info .navbar-start > a.navbar-item.is-active,
      .navbar.is-info .navbar-start .navbar-link:focus,
      .navbar.is-info .navbar-start .navbar-link:hover,
      .navbar.is-info .navbar-start .navbar-link.is-active,
      .navbar.is-info .navbar-end > a.navbar-item:focus,
      .navbar.is-info .navbar-end > a.navbar-item:hover,
      .navbar.is-info .navbar-end > a.navbar-item.is-active,
      .navbar.is-info .navbar-end .navbar-link:focus,
      .navbar.is-info .navbar-end .navbar-link:hover,
      .navbar.is-info .navbar-end .navbar-link.is-active {
        background-color: #6d7983;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-info .navbar-start .navbar-link::after,
      .navbar.is-info .navbar-end .navbar-link::after {
        border-color: rgba(0, 0, 0, 0.7); }
      .navbar.is-info .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-info .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-info .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #6d7983;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-info .navbar-dropdown a.navbar-item.is-active {
        background-color: #7A8690;
        color: rgba(0, 0, 0, 0.7); } }
  .navbar.is-success {
    background-color: #029736;
    color: rgba(0, 0, 0, 0.7); }
    .navbar.is-success .navbar-brand > .navbar-item,
    .navbar.is-success .navbar-brand .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-success .navbar-brand > a.navbar-item:focus, .navbar.is-success .navbar-brand > a.navbar-item:hover, .navbar.is-success .navbar-brand > a.navbar-item.is-active,
    .navbar.is-success .navbar-brand .navbar-link:focus,
    .navbar.is-success .navbar-brand .navbar-link:hover,
    .navbar.is-success .navbar-brand .navbar-link.is-active {
      background-color: #027e2d;
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-success .navbar-brand .navbar-link::after {
      border-color: rgba(0, 0, 0, 0.7); }
    .navbar.is-success .navbar-burger {
      color: rgba(0, 0, 0, 0.7); }
    @media screen and (min-width: 1024px) {
      .navbar.is-success .navbar-start > .navbar-item,
      .navbar.is-success .navbar-start .navbar-link,
      .navbar.is-success .navbar-end > .navbar-item,
      .navbar.is-success .navbar-end .navbar-link {
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-success .navbar-start > a.navbar-item:focus, .navbar.is-success .navbar-start > a.navbar-item:hover, .navbar.is-success .navbar-start > a.navbar-item.is-active,
      .navbar.is-success .navbar-start .navbar-link:focus,
      .navbar.is-success .navbar-start .navbar-link:hover,
      .navbar.is-success .navbar-start .navbar-link.is-active,
      .navbar.is-success .navbar-end > a.navbar-item:focus,
      .navbar.is-success .navbar-end > a.navbar-item:hover,
      .navbar.is-success .navbar-end > a.navbar-item.is-active,
      .navbar.is-success .navbar-end .navbar-link:focus,
      .navbar.is-success .navbar-end .navbar-link:hover,
      .navbar.is-success .navbar-end .navbar-link.is-active {
        background-color: #027e2d;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-success .navbar-start .navbar-link::after,
      .navbar.is-success .navbar-end .navbar-link::after {
        border-color: rgba(0, 0, 0, 0.7); }
      .navbar.is-success .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-success .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-success .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #027e2d;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-success .navbar-dropdown a.navbar-item.is-active {
        background-color: #029736;
        color: rgba(0, 0, 0, 0.7); } }
  .navbar.is-warning {
    background-color: #ffd100;
    color: rgba(0, 0, 0, 0.7); }
    .navbar.is-warning .navbar-brand > .navbar-item,
    .navbar.is-warning .navbar-brand .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-warning .navbar-brand > a.navbar-item:focus, .navbar.is-warning .navbar-brand > a.navbar-item:hover, .navbar.is-warning .navbar-brand > a.navbar-item.is-active,
    .navbar.is-warning .navbar-brand .navbar-link:focus,
    .navbar.is-warning .navbar-brand .navbar-link:hover,
    .navbar.is-warning .navbar-brand .navbar-link.is-active {
      background-color: #e6bc00;
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-warning .navbar-brand .navbar-link::after {
      border-color: rgba(0, 0, 0, 0.7); }
    .navbar.is-warning .navbar-burger {
      color: rgba(0, 0, 0, 0.7); }
    @media screen and (min-width: 1024px) {
      .navbar.is-warning .navbar-start > .navbar-item,
      .navbar.is-warning .navbar-start .navbar-link,
      .navbar.is-warning .navbar-end > .navbar-item,
      .navbar.is-warning .navbar-end .navbar-link {
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-warning .navbar-start > a.navbar-item:focus, .navbar.is-warning .navbar-start > a.navbar-item:hover, .navbar.is-warning .navbar-start > a.navbar-item.is-active,
      .navbar.is-warning .navbar-start .navbar-link:focus,
      .navbar.is-warning .navbar-start .navbar-link:hover,
      .navbar.is-warning .navbar-start .navbar-link.is-active,
      .navbar.is-warning .navbar-end > a.navbar-item:focus,
      .navbar.is-warning .navbar-end > a.navbar-item:hover,
      .navbar.is-warning .navbar-end > a.navbar-item.is-active,
      .navbar.is-warning .navbar-end .navbar-link:focus,
      .navbar.is-warning .navbar-end .navbar-link:hover,
      .navbar.is-warning .navbar-end .navbar-link.is-active {
        background-color: #e6bc00;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-warning .navbar-start .navbar-link::after,
      .navbar.is-warning .navbar-end .navbar-link::after {
        border-color: rgba(0, 0, 0, 0.7); }
      .navbar.is-warning .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-warning .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-warning .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #e6bc00;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-warning .navbar-dropdown a.navbar-item.is-active {
        background-color: #ffd100;
        color: rgba(0, 0, 0, 0.7); } }
  .navbar.is-danger {
    background-color: #F91F52;
    color: rgba(0, 0, 0, 0.7); }
    .navbar.is-danger .navbar-brand > .navbar-item,
    .navbar.is-danger .navbar-brand .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-danger .navbar-brand > a.navbar-item:focus, .navbar.is-danger .navbar-brand > a.navbar-item:hover, .navbar.is-danger .navbar-brand > a.navbar-item.is-active,
    .navbar.is-danger .navbar-brand .navbar-link:focus,
    .navbar.is-danger .navbar-brand .navbar-link:hover,
    .navbar.is-danger .navbar-brand .navbar-link.is-active {
      background-color: #f8073f;
      color: rgba(0, 0, 0, 0.7); }
    .navbar.is-danger .navbar-brand .navbar-link::after {
      border-color: rgba(0, 0, 0, 0.7); }
    .navbar.is-danger .navbar-burger {
      color: rgba(0, 0, 0, 0.7); }
    @media screen and (min-width: 1024px) {
      .navbar.is-danger .navbar-start > .navbar-item,
      .navbar.is-danger .navbar-start .navbar-link,
      .navbar.is-danger .navbar-end > .navbar-item,
      .navbar.is-danger .navbar-end .navbar-link {
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-danger .navbar-start > a.navbar-item:focus, .navbar.is-danger .navbar-start > a.navbar-item:hover, .navbar.is-danger .navbar-start > a.navbar-item.is-active,
      .navbar.is-danger .navbar-start .navbar-link:focus,
      .navbar.is-danger .navbar-start .navbar-link:hover,
      .navbar.is-danger .navbar-start .navbar-link.is-active,
      .navbar.is-danger .navbar-end > a.navbar-item:focus,
      .navbar.is-danger .navbar-end > a.navbar-item:hover,
      .navbar.is-danger .navbar-end > a.navbar-item.is-active,
      .navbar.is-danger .navbar-end .navbar-link:focus,
      .navbar.is-danger .navbar-end .navbar-link:hover,
      .navbar.is-danger .navbar-end .navbar-link.is-active {
        background-color: #f8073f;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-danger .navbar-start .navbar-link::after,
      .navbar.is-danger .navbar-end .navbar-link::after {
        border-color: rgba(0, 0, 0, 0.7); }
      .navbar.is-danger .navbar-item.has-dropdown:focus .navbar-link,
      .navbar.is-danger .navbar-item.has-dropdown:hover .navbar-link,
      .navbar.is-danger .navbar-item.has-dropdown.is-active .navbar-link {
        background-color: #f8073f;
        color: rgba(0, 0, 0, 0.7); }
      .navbar.is-danger .navbar-dropdown a.navbar-item.is-active {
        background-color: #F91F52;
        color: rgba(0, 0, 0, 0.7); } }
  .navbar > .container {
    align-items: stretch;
    display: flex;
    min-height: 3.25rem;
    width: 100%; }
  .navbar.has-shadow {
    box-shadow: 0 2px 0 0 #242424; }
  .navbar.is-fixed-bottom, .navbar.is-fixed-top {
    left: 0;
    position: fixed;
    right: 0;
    z-index: 30; }
  .navbar.is-fixed-bottom {
    bottom: 0; }
    .navbar.is-fixed-bottom.has-shadow {
      box-shadow: 0 -2px 0 0 #242424; }
  .navbar.is-fixed-top {
    top: 0; }

html.has-navbar-fixed-top,
body.has-navbar-fixed-top {
  padding-top: 3.25rem; }

html.has-navbar-fixed-bottom,
body.has-navbar-fixed-bottom {
  padding-bottom: 3.25rem; }

.navbar-brand,
.navbar-tabs {
  align-items: stretch;
  display: flex;
  flex-shrink: 0;
  min-height: 3.25rem; }

.navbar-brand a.navbar-item:focus, .navbar-brand a.navbar-item:hover {
  background-color: transparent; }

.navbar-tabs {
  -webkit-overflow-scrolling: touch;
  max-width: 100vw;
  overflow-x: auto;
  overflow-y: hidden; }

.navbar-burger {
  color: #b5b5b5;
  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background: none;
  border: none;
  cursor: pointer;
  display: block;
  height: 3.25rem;
  position: relative;
  width: 3.25rem;
  margin-left: auto; }
  .navbar-burger span {
    background-color: currentColor;
    display: block;
    height: 1px;
    left: calc(50% - 8px);
    position: absolute;
    transform-origin: center;
    transition-duration: 86ms;
    transition-property: background-color, opacity, transform;
    transition-timing-function: ease-out;
    width: 16px; }
    .navbar-burger span:nth-child(1) {
      top: calc(50% - 6px); }
    .navbar-burger span:nth-child(2) {
      top: calc(50% - 1px); }
    .navbar-burger span:nth-child(3) {
      top: calc(50% + 4px); }
  .navbar-burger:hover {
    background-color: rgba(0, 0, 0, 0.05); }
  .navbar-burger.is-active span:nth-child(1) {
    transform: translateY(5px) rotate(45deg); }
  .navbar-burger.is-active span:nth-child(2) {
    opacity: 0; }
  .navbar-burger.is-active span:nth-child(3) {
    transform: translateY(-5px) rotate(-45deg); }

.navbar-menu {
  display: none; }

.navbar-item,
.navbar-link {
  color: #b5b5b5;
  display: block;
  line-height: 1.5;
  padding: 0.5rem 0.75rem;
  position: relative; }
  .navbar-item .icon:only-child,
  .navbar-link .icon:only-child {
    margin-left: -0.25rem;
    margin-right: -0.25rem; }

a.navbar-item,
.navbar-link {
  cursor: pointer; }
  a.navbar-item:focus, a.navbar-item:focus-within, a.navbar-item:hover, a.navbar-item.is-active,
  .navbar-link:focus,
  .navbar-link:focus-within,
  .navbar-link:hover,
  .navbar-link.is-active {
    background-color: #171717;
    color: #467CFB; }

.navbar-item {
  flex-grow: 0;
  flex-shrink: 0; }
  .navbar-item img {
    max-height: 1.75rem; }
  .navbar-item.has-dropdown {
    padding: 0; }
  .navbar-item.is-expanded {
    flex-grow: 1;
    flex-shrink: 1; }
  .navbar-item.is-tab {
    border-bottom: 1px solid transparent;
    min-height: 3.25rem;
    padding-bottom: calc(0.5rem - 1px); }
    .navbar-item.is-tab:focus, .navbar-item.is-tab:hover {
      background-color: transparent;
      border-bottom-color: #467CFB; }
    .navbar-item.is-tab.is-active {
      background-color: transparent;
      border-bottom-color: #467CFB;
      border-bottom-style: solid;
      border-bottom-width: 3px;
      color: #467CFB;
      padding-bottom: calc(0.5rem - 3px); }

.navbar-content {
  flex-grow: 1;
  flex-shrink: 1; }

.navbar-link:not(.is-arrowless) {
  padding-right: 2.5em; }
  .navbar-link:not(.is-arrowless)::after {
    border-color: #467CFB;
    margin-top: -0.375em;
    right: 1.125em; }

.navbar-dropdown {
  font-size: 0.875rem;
  padding-bottom: 0.5rem;
  padding-top: 0.5rem; }
  .navbar-dropdown .navbar-item {
    padding-left: 1.5rem;
    padding-right: 1.5rem; }

.navbar-divider {
  background-color: #242424;
  border: none;
  display: none;
  height: 2px;
  margin: 0.5rem 0; }

@media screen and (max-width: 1023px) {
  .navbar > .container {
    display: block; }
  .navbar-brand .navbar-item,
  .navbar-tabs .navbar-item {
    align-items: center;
    display: flex; }
  .navbar-link::after {
    display: none; }
  .navbar-menu {
    background-color: #171717;
    box-shadow: 0 8px 16px rgba(242, 242, 242, 0.1);
    padding: 0.5rem 0; }
    .navbar-menu.is-active {
      display: block; }
  .navbar.is-fixed-bottom-touch, .navbar.is-fixed-top-touch {
    left: 0;
    position: fixed;
    right: 0;
    z-index: 30; }
  .navbar.is-fixed-bottom-touch {
    bottom: 0; }
    .navbar.is-fixed-bottom-touch.has-shadow {
      box-shadow: 0 -2px 3px rgba(242, 242, 242, 0.1); }
  .navbar.is-fixed-top-touch {
    top: 0; }
  .navbar.is-fixed-top .navbar-menu, .navbar.is-fixed-top-touch .navbar-menu {
    -webkit-overflow-scrolling: touch;
    max-height: calc(100vh - 3.25rem);
    overflow: auto; }
  html.has-navbar-fixed-top-touch,
  body.has-navbar-fixed-top-touch {
    padding-top: 3.25rem; }
  html.has-navbar-fixed-bottom-touch,
  body.has-navbar-fixed-bottom-touch {
    padding-bottom: 3.25rem; } }

@media screen and (min-width: 1024px) {
  .navbar,
  .navbar-menu,
  .navbar-start,
  .navbar-end {
    align-items: stretch;
    display: flex; }
  .navbar {
    min-height: 3.25rem; }
    .navbar.is-spaced {
      padding: 1rem 2rem; }
      .navbar.is-spaced .navbar-start,
      .navbar.is-spaced .navbar-end {
        align-items: center; }
      .navbar.is-spaced a.navbar-item,
      .navbar.is-spaced .navbar-link {
        border-radius: 4px; }
    .navbar.is-transparent a.navbar-item:focus, .navbar.is-transparent a.navbar-item:hover, .navbar.is-transparent a.navbar-item.is-active,
    .navbar.is-transparent .navbar-link:focus,
    .navbar.is-transparent .navbar-link:hover,
    .navbar.is-transparent .navbar-link.is-active {
      background-color: transparent !important; }
    .navbar.is-transparent .navbar-item.has-dropdown.is-active .navbar-link, .navbar.is-transparent .navbar-item.has-dropdown.is-hoverable:focus .navbar-link, .navbar.is-transparent .navbar-item.has-dropdown.is-hoverable:focus-within .navbar-link, .navbar.is-transparent .navbar-item.has-dropdown.is-hoverable:hover .navbar-link {
      background-color: transparent !important; }
    .navbar.is-transparent .navbar-dropdown a.navbar-item:focus, .navbar.is-transparent .navbar-dropdown a.navbar-item:hover {
      background-color: #242424;
      color: #f2f2f2; }
    .navbar.is-transparent .navbar-dropdown a.navbar-item.is-active {
      background-color: #242424;
      color: #467CFB; }
  .navbar-burger {
    display: none; }
  .navbar-item,
  .navbar-link {
    align-items: center;
    display: flex; }
  .navbar-item.has-dropdown {
    align-items: stretch; }
  .navbar-item.has-dropdown-up .navbar-link::after {
    transform: rotate(135deg) translate(0.25em, -0.25em); }
  .navbar-item.has-dropdown-up .navbar-dropdown {
    border-bottom: 2px solid #363636;
    border-radius: 6px 6px 0 0;
    border-top: none;
    bottom: 100%;
    box-shadow: 0 -8px 8px rgba(242, 242, 242, 0.1);
    top: auto; }
  .navbar-item.is-active .navbar-dropdown, .navbar-item.is-hoverable:focus .navbar-dropdown, .navbar-item.is-hoverable:focus-within .navbar-dropdown, .navbar-item.is-hoverable:hover .navbar-dropdown {
    display: block; }
    .navbar.is-spaced .navbar-item.is-active .navbar-dropdown, .navbar-item.is-active .navbar-dropdown.is-boxed, .navbar.is-spaced .navbar-item.is-hoverable:focus .navbar-dropdown, .navbar-item.is-hoverable:focus .navbar-dropdown.is-boxed, .navbar.is-spaced .navbar-item.is-hoverable:focus-within .navbar-dropdown, .navbar-item.is-hoverable:focus-within .navbar-dropdown.is-boxed, .navbar.is-spaced .navbar-item.is-hoverable:hover .navbar-dropdown, .navbar-item.is-hoverable:hover .navbar-dropdown.is-boxed {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0); }
  .navbar-menu {
    flex-grow: 1;
    flex-shrink: 0; }
  .navbar-start {
    justify-content: flex-start;
    margin-right: auto; }
  .navbar-end {
    justify-content: flex-end;
    margin-left: auto; }
  .navbar-dropdown {
    background-color: #171717;
    border-bottom-left-radius: 6px;
    border-bottom-right-radius: 6px;
    border-top: 2px solid #363636;
    box-shadow: 0 8px 8px rgba(242, 242, 242, 0.1);
    display: none;
    font-size: 0.875rem;
    left: 0;
    min-width: 100%;
    position: absolute;
    top: 100%;
    z-index: 20; }
    .navbar-dropdown .navbar-item {
      padding: 0.375rem 1rem;
      white-space: nowrap; }
    .navbar-dropdown a.navbar-item {
      padding-right: 3rem; }
      .navbar-dropdown a.navbar-item:focus, .navbar-dropdown a.navbar-item:hover {
        background-color: #242424;
        color: #f2f2f2; }
      .navbar-dropdown a.navbar-item.is-active {
        background-color: #242424;
        color: #467CFB; }
    .navbar.is-spaced .navbar-dropdown, .navbar-dropdown.is-boxed {
      border-radius: 6px;
      border-top: none;
      box-shadow: 0 8px 8px rgba(242, 242, 242, 0.1), 0 0 0 1px rgba(242, 242, 242, 0.1);
      display: block;
      opacity: 0;
      pointer-events: none;
      top: calc(100% + (-4px));
      transform: translateY(-5px);
      transition-duration: 86ms;
      transition-property: opacity, transform; }
    .navbar-dropdown.is-right {
      left: auto;
      right: 0; }
  .navbar-divider {
    display: block; }
  .navbar > .container .navbar-brand,
  .container > .navbar .navbar-brand {
    margin-left: -0.75rem; }
  .navbar > .container .navbar-menu,
  .container > .navbar .navbar-menu {
    margin-right: -0.75rem; }
  .navbar.is-fixed-bottom-desktop, .navbar.is-fixed-top-desktop {
    left: 0;
    position: fixed;
    right: 0;
    z-index: 30; }
  .navbar.is-fixed-bottom-desktop {
    bottom: 0; }
    .navbar.is-fixed-bottom-desktop.has-shadow {
      box-shadow: 0 -2px 3px rgba(242, 242, 242, 0.1); }
  .navbar.is-fixed-top-desktop {
    top: 0; }
  html.has-navbar-fixed-top-desktop,
  body.has-navbar-fixed-top-desktop {
    padding-top: 3.25rem; }
  html.has-navbar-fixed-bottom-desktop,
  body.has-navbar-fixed-bottom-desktop {
    padding-bottom: 3.25rem; }
  html.has-spaced-navbar-fixed-top,
  body.has-spaced-navbar-fixed-top {
    padding-top: 5.25rem; }
  html.has-spaced-navbar-fixed-bottom,
  body.has-spaced-navbar-fixed-bottom {
    padding-bottom: 5.25rem; }
  a.navbar-item.is-active,
  .navbar-link.is-active {
    color: #f2f2f2; }
  a.navbar-item.is-active:not(:focus):not(:hover),
  .navbar-link.is-active:not(:focus):not(:hover) {
    background-color: transparent; }
  .navbar-item.has-dropdown:focus .navbar-link, .navbar-item.has-dropdown:hover .navbar-link, .navbar-item.has-dropdown.is-active .navbar-link {
    background-color: #171717; } }

.hero.is-fullheight-with-navbar {
  min-height: calc(100vh - 3.25rem); }

.pagination {
  font-size: 1rem;
  margin: -0.25rem; }
  .pagination.is-small {
    font-size: 0.75rem; }
  .pagination.is-medium {
    font-size: 1.25rem; }
  .pagination.is-large {
    font-size: 1.5rem; }
  .pagination.is-rounded .pagination-previous,
  .pagination.is-rounded .pagination-next {
    padding-left: 1em;
    padding-right: 1em;
    border-radius: 9999px; }
  .pagination.is-rounded .pagination-link {
    border-radius: 9999px; }

.pagination,
.pagination-list {
  align-items: center;
  display: flex;
  justify-content: center;
  text-align: center; }

.pagination-previous,
.pagination-next,
.pagination-link,
.pagination-ellipsis {
  font-size: 1em;
  justify-content: center;
  margin: 0.25rem;
  padding-left: 0.5em;
  padding-right: 0.5em;
  text-align: center; }

.pagination-previous,
.pagination-next,
.pagination-link {
  border-color: #363636;
  color: #dbdbdb;
  min-width: 2.5em; }
  .pagination-previous:hover,
  .pagination-next:hover,
  .pagination-link:hover {
    border-color: #4a4a4a;
    color: #dbdbdb; }
  .pagination-previous:focus,
  .pagination-next:focus,
  .pagination-link:focus {
    border-color: #467CFB; }
  .pagination-previous:active,
  .pagination-next:active,
  .pagination-link:active {
    box-shadow: inset 0 1px 2px rgba(242, 242, 242, 0.2); }
  .pagination-previous[disabled], .pagination-previous.is-disabled,
  .pagination-next[disabled],
  .pagination-next.is-disabled,
  .pagination-link[disabled],
  .pagination-link.is-disabled {
    background-color: #363636;
    border-color: #363636;
    box-shadow: none;
    color: #7a7a7a;
    opacity: 0.5; }

.pagination-previous,
.pagination-next {
  padding-left: 0.75em;
  padding-right: 0.75em;
  white-space: nowrap; }

.pagination-link.is-current {
  background-color: #467CFB;
  border-color: #467CFB;
  color: rgba(0, 0, 0, 0.7); }

.pagination-ellipsis {
  color: #4a4a4a;
  pointer-events: none; }

.pagination-list {
  flex-wrap: wrap; }
  .pagination-list li {
    list-style: none; }

@media screen and (max-width: 768px) {
  .pagination {
    flex-wrap: wrap; }
  .pagination-previous,
  .pagination-next {
    flex-grow: 1;
    flex-shrink: 1; }
  .pagination-list li {
    flex-grow: 1;
    flex-shrink: 1; } }

@media screen and (min-width: 769px), print {
  .pagination-list {
    flex-grow: 1;
    flex-shrink: 1;
    justify-content: flex-start;
    order: 1; }
  .pagination-previous,
  .pagination-next,
  .pagination-link,
  .pagination-ellipsis {
    margin-bottom: 0;
    margin-top: 0; }
  .pagination-previous {
    order: 2; }
  .pagination-next {
    order: 3; }
  .pagination {
    justify-content: space-between;
    margin-bottom: 0;
    margin-top: 0; }
    .pagination.is-centered .pagination-previous {
      order: 1; }
    .pagination.is-centered .pagination-list {
      justify-content: center;
      order: 2; }
    .pagination.is-centered .pagination-next {
      order: 3; }
    .pagination.is-right .pagination-previous {
      order: 1; }
    .pagination.is-right .pagination-next {
      order: 2; }
    .pagination.is-right .pagination-list {
      justify-content: flex-end;
      order: 3; } }

.panel {
  border-radius: 6px;
  box-shadow: 0 0.5em 1em -0.125em rgba(242, 242, 242, 0.1), 0 0px 0 1px rgba(242, 242, 242, 0.02);
  font-size: 1rem; }
  .panel:not(:last-child) {
    margin-bottom: 1.5rem; }
  .panel.is-white .panel-heading {
    background-color: #171717;
    color: #f2f2f2; }
  .panel.is-white .panel-tabs a.is-active {
    border-bottom-color: #171717; }
  .panel.is-white .panel-block.is-active .panel-icon {
    color: #171717; }
  .panel.is-black .panel-heading {
    background-color: #f2f2f2;
    color: #171717; }
  .panel.is-black .panel-tabs a.is-active {
    border-bottom-color: #f2f2f2; }
  .panel.is-black .panel-block.is-active .panel-icon {
    color: #f2f2f2; }
  .panel.is-light .panel-heading {
    background-color: #363636;
    color: #fff; }
  .panel.is-light .panel-tabs a.is-active {
    border-bottom-color: #363636; }
  .panel.is-light .panel-block.is-active .panel-icon {
    color: #363636; }
  .panel.is-dark .panel-heading {
    background-color: #e6e6e6;
    color: rgba(0, 0, 0, 0.7); }
  .panel.is-dark .panel-tabs a.is-active {
    border-bottom-color: #e6e6e6; }
  .panel.is-dark .panel-block.is-active .panel-icon {
    color: #e6e6e6; }
  .panel.is-primary .panel-heading {
    background-color: #0E87C8;
    color: rgba(0, 0, 0, 0.7); }
  .panel.is-primary .panel-tabs a.is-active {
    border-bottom-color: #0E87C8; }
  .panel.is-primary .panel-block.is-active .panel-icon {
    color: #0E87C8; }
  .panel.is-link .panel-heading {
    background-color: #467CFB;
    color: rgba(0, 0, 0, 0.7); }
  .panel.is-link .panel-tabs a.is-active {
    border-bottom-color: #467CFB; }
  .panel.is-link .panel-block.is-active .panel-icon {
    color: #467CFB; }
  .panel.is-info .panel-heading {
    background-color: #7A8690;
    color: rgba(0, 0, 0, 0.7); }
  .panel.is-info .panel-tabs a.is-active {
    border-bottom-color: #7A8690; }
  .panel.is-info .panel-block.is-active .panel-icon {
    color: #7A8690; }
  .panel.is-success .panel-heading {
    background-color: #029736;
    color: rgba(0, 0, 0, 0.7); }
  .panel.is-success .panel-tabs a.is-active {
    border-bottom-color: #029736; }
  .panel.is-success .panel-block.is-active .panel-icon {
    color: #029736; }
  .panel.is-warning .panel-heading {
    background-color: #ffd100;
    color: rgba(0, 0, 0, 0.7); }
  .panel.is-warning .panel-tabs a.is-active {
    border-bottom-color: #ffd100; }
  .panel.is-warning .panel-block.is-active .panel-icon {
    color: #ffd100; }
  .panel.is-danger .panel-heading {
    background-color: #F91F52;
    color: rgba(0, 0, 0, 0.7); }
  .panel.is-danger .panel-tabs a.is-active {
    border-bottom-color: #F91F52; }
  .panel.is-danger .panel-block.is-active .panel-icon {
    color: #F91F52; }

.panel-tabs:not(:last-child),
.panel-block:not(:last-child) {
  border-bottom: 1px solid #ededed; }

.panel-heading {
  background-color: #ededed;
  border-radius: 6px 6px 0 0;
  color: #dbdbdb;
  font-size: 1.25em;
  font-weight: 700;
  line-height: 1.25;
  padding: 0.75em 1em; }

.panel-tabs {
  align-items: flex-end;
  display: flex;
  font-size: 0.875em;
  justify-content: center; }
  .panel-tabs a {
    border-bottom: 1px solid #363636;
    margin-bottom: -1px;
    padding: 0.5em; }
    .panel-tabs a.is-active {
      border-bottom-color: #b5b5b5;
      color: #dbdbdb; }

.panel-list a {
  color: #b5b5b5; }
  .panel-list a:hover {
    color: #467CFB; }

.panel-block {
  align-items: center;
  color: #dbdbdb;
  display: flex;
  justify-content: flex-start;
  padding: 0.5em 0.75em; }
  .panel-block input[type="checkbox"] {
    margin-right: 0.75em; }
  .panel-block > .control {
    flex-grow: 1;
    flex-shrink: 1;
    width: 100%; }
  .panel-block.is-wrapped {
    flex-wrap: wrap; }
  .panel-block.is-active {
    border-left-color: #467CFB;
    color: #dbdbdb; }
    .panel-block.is-active .panel-icon {
      color: #467CFB; }
  .panel-block:last-child {
    border-bottom-left-radius: 6px;
    border-bottom-right-radius: 6px; }

a.panel-block,
label.panel-block {
  cursor: pointer; }
  a.panel-block:hover,
  label.panel-block:hover {
    background-color: #242424; }

.panel-icon {
  display: inline-block;
  font-size: 14px;
  height: 1em;
  line-height: 1em;
  text-align: center;
  vertical-align: top;
  width: 1em;
  color: #7a7a7a;
  margin-right: 0.75em; }
  .panel-icon .fa {
    font-size: inherit;
    line-height: inherit; }

.tabs {
  -webkit-overflow-scrolling: touch;
  align-items: stretch;
  display: flex;
  font-size: 1rem;
  justify-content: space-between;
  overflow: hidden;
  overflow-x: auto;
  white-space: nowrap; }
  .tabs a {
    align-items: center;
    border-bottom-color: #363636;
    border-bottom-style: solid;
    border-bottom-width: 1px;
    color: #b5b5b5;
    display: flex;
    justify-content: center;
    margin-bottom: -1px;
    padding: 0.5em 1em;
    vertical-align: top; }
    .tabs a:hover {
      border-bottom-color: #dbdbdb;
      color: #dbdbdb; }
  .tabs li {
    display: block; }
    .tabs li.is-active a {
      border-bottom-color: #467CFB;
      color: #467CFB; }
  .tabs ul {
    align-items: center;
    border-bottom-color: #363636;
    border-bottom-style: solid;
    border-bottom-width: 1px;
    display: flex;
    flex-grow: 1;
    flex-shrink: 0;
    justify-content: flex-start; }
    .tabs ul.is-left {
      padding-right: 0.75em; }
    .tabs ul.is-center {
      flex: none;
      justify-content: center;
      padding-left: 0.75em;
      padding-right: 0.75em; }
    .tabs ul.is-right {
      justify-content: flex-end;
      padding-left: 0.75em; }
  .tabs .icon:first-child {
    margin-right: 0.5em; }
  .tabs .icon:last-child {
    margin-left: 0.5em; }
  .tabs.is-centered ul {
    justify-content: center; }
  .tabs.is-right ul {
    justify-content: flex-end; }
  .tabs.is-boxed a {
    border: 1px solid transparent;
    border-radius: 4px 4px 0 0; }
    .tabs.is-boxed a:hover {
      background-color: #242424;
      border-bottom-color: #363636; }
  .tabs.is-boxed li.is-active a {
    background-color: #171717;
    border-color: #363636;
    border-bottom-color: transparent !important; }
  .tabs.is-fullwidth li {
    flex-grow: 1;
    flex-shrink: 0; }
  .tabs.is-toggle a {
    border-color: #363636;
    border-style: solid;
    border-width: 1px;
    margin-bottom: 0;
    position: relative; }
    .tabs.is-toggle a:hover {
      background-color: #242424;
      border-color: #4a4a4a;
      z-index: 2; }
  .tabs.is-toggle li + li {
    margin-left: -1px; }
  .tabs.is-toggle li:first-child a {
    border-top-left-radius: 4px;
    border-bottom-left-radius: 4px; }
  .tabs.is-toggle li:last-child a {
    border-top-right-radius: 4px;
    border-bottom-right-radius: 4px; }
  .tabs.is-toggle li.is-active a {
    background-color: #467CFB;
    border-color: #467CFB;
    color: rgba(0, 0, 0, 0.7);
    z-index: 1; }
  .tabs.is-toggle ul {
    border-bottom: none; }
  .tabs.is-toggle.is-toggle-rounded li:first-child a {
    border-bottom-left-radius: 9999px;
    border-top-left-radius: 9999px;
    padding-left: 1.25em; }
  .tabs.is-toggle.is-toggle-rounded li:last-child a {
    border-bottom-right-radius: 9999px;
    border-top-right-radius: 9999px;
    padding-right: 1.25em; }
  .tabs.is-small {
    font-size: 0.75rem; }
  .tabs.is-medium {
    font-size: 1.25rem; }
  .tabs.is-large {
    font-size: 1.5rem; }

/* Bulma Grid */
.column {
  display: block;
  flex-basis: 0;
  flex-grow: 1;
  flex-shrink: 1;
  padding: 0.75rem; }
  .columns.is-mobile > .column.is-narrow {
    flex: none;
    width: unset; }
  .columns.is-mobile > .column.is-full {
    flex: none;
    width: 100%; }
  .columns.is-mobile > .column.is-three-quarters {
    flex: none;
    width: 75%; }
  .columns.is-mobile > .column.is-two-thirds {
    flex: none;
    width: 66.6666%; }
  .columns.is-mobile > .column.is-half {
    flex: none;
    width: 50%; }
  .columns.is-mobile > .column.is-one-third {
    flex: none;
    width: 33.3333%; }
  .columns.is-mobile > .column.is-one-quarter {
    flex: none;
    width: 25%; }
  .columns.is-mobile > .column.is-one-fifth {
    flex: none;
    width: 20%; }
  .columns.is-mobile > .column.is-two-fifths {
    flex: none;
    width: 40%; }
  .columns.is-mobile > .column.is-three-fifths {
    flex: none;
    width: 60%; }
  .columns.is-mobile > .column.is-four-fifths {
    flex: none;
    width: 80%; }
  .columns.is-mobile > .column.is-offset-three-quarters {
    margin-left: 75%; }
  .columns.is-mobile > .column.is-offset-two-thirds {
    margin-left: 66.6666%; }
  .columns.is-mobile > .column.is-offset-half {
    margin-left: 50%; }
  .columns.is-mobile > .column.is-offset-one-third {
    margin-left: 33.3333%; }
  .columns.is-mobile > .column.is-offset-one-quarter {
    margin-left: 25%; }
  .columns.is-mobile > .column.is-offset-one-fifth {
    margin-left: 20%; }
  .columns.is-mobile > .column.is-offset-two-fifths {
    margin-left: 40%; }
  .columns.is-mobile > .column.is-offset-three-fifths {
    margin-left: 60%; }
  .columns.is-mobile > .column.is-offset-four-fifths {
    margin-left: 80%; }
  .columns.is-mobile > .column.is-0 {
    flex: none;
    width: 0%; }
  .columns.is-mobile > .column.is-offset-0 {
    margin-left: 0%; }
  .columns.is-mobile > .column.is-1 {
    flex: none;
    width: 8.33333%; }
  .columns.is-mobile > .column.is-offset-1 {
    margin-left: 8.33333%; }
  .columns.is-mobile > .column.is-2 {
    flex: none;
    width: 16.66667%; }
  .columns.is-mobile > .column.is-offset-2 {
    margin-left: 16.66667%; }
  .columns.is-mobile > .column.is-3 {
    flex: none;
    width: 25%; }
  .columns.is-mobile > .column.is-offset-3 {
    margin-left: 25%; }
  .columns.is-mobile > .column.is-4 {
    flex: none;
    width: 33.33333%; }
  .columns.is-mobile > .column.is-offset-4 {
    margin-left: 33.33333%; }
  .columns.is-mobile > .column.is-5 {
    flex: none;
    width: 41.66667%; }
  .columns.is-mobile > .column.is-offset-5 {
    margin-left: 41.66667%; }
  .columns.is-mobile > .column.is-6 {
    flex: none;
    width: 50%; }
  .columns.is-mobile > .column.is-offset-6 {
    margin-left: 50%; }
  .columns.is-mobile > .column.is-7 {
    flex: none;
    width: 58.33333%; }
  .columns.is-mobile > .column.is-offset-7 {
    margin-left: 58.33333%; }
  .columns.is-mobile > .column.is-8 {
    flex: none;
    width: 66.66667%; }
  .columns.is-mobile > .column.is-offset-8 {
    margin-left: 66.66667%; }
  .columns.is-mobile > .column.is-9 {
    flex: none;
    width: 75%; }
  .columns.is-mobile > .column.is-offset-9 {
    margin-left: 75%; }
  .columns.is-mobile > .column.is-10 {
    flex: none;
    width: 83.33333%; }
  .columns.is-mobile > .column.is-offset-10 {
    margin-left: 83.33333%; }
  .columns.is-mobile > .column.is-11 {
    flex: none;
    width: 91.66667%; }
  .columns.is-mobile > .column.is-offset-11 {
    margin-left: 91.66667%; }
  .columns.is-mobile > .column.is-12 {
    flex: none;
    width: 100%; }
  .columns.is-mobile > .column.is-offset-12 {
    margin-left: 100%; }
  @media screen and (max-width: 768px) {
    .column.is-narrow-mobile {
      flex: none;
      width: unset; }
    .column.is-full-mobile {
      flex: none;
      width: 100%; }
    .column.is-three-quarters-mobile {
      flex: none;
      width: 75%; }
    .column.is-two-thirds-mobile {
      flex: none;
      width: 66.6666%; }
    .column.is-half-mobile {
      flex: none;
      width: 50%; }
    .column.is-one-third-mobile {
      flex: none;
      width: 33.3333%; }
    .column.is-one-quarter-mobile {
      flex: none;
      width: 25%; }
    .column.is-one-fifth-mobile {
      flex: none;
      width: 20%; }
    .column.is-two-fifths-mobile {
      flex: none;
      width: 40%; }
    .column.is-three-fifths-mobile {
      flex: none;
      width: 60%; }
    .column.is-four-fifths-mobile {
      flex: none;
      width: 80%; }
    .column.is-offset-three-quarters-mobile {
      margin-left: 75%; }
    .column.is-offset-two-thirds-mobile {
      margin-left: 66.6666%; }
    .column.is-offset-half-mobile {
      margin-left: 50%; }
    .column.is-offset-one-third-mobile {
      margin-left: 33.3333%; }
    .column.is-offset-one-quarter-mobile {
      margin-left: 25%; }
    .column.is-offset-one-fifth-mobile {
      margin-left: 20%; }
    .column.is-offset-two-fifths-mobile {
      margin-left: 40%; }
    .column.is-offset-three-fifths-mobile {
      margin-left: 60%; }
    .column.is-offset-four-fifths-mobile {
      margin-left: 80%; }
    .column.is-0-mobile {
      flex: none;
      width: 0%; }
    .column.is-offset-0-mobile {
      margin-left: 0%; }
    .column.is-1-mobile {
      flex: none;
      width: 8.33333%; }
    .column.is-offset-1-mobile {
      margin-left: 8.33333%; }
    .column.is-2-mobile {
      flex: none;
      width: 16.66667%; }
    .column.is-offset-2-mobile {
      margin-left: 16.66667%; }
    .column.is-3-mobile {
      flex: none;
      width: 25%; }
    .column.is-offset-3-mobile {
      margin-left: 25%; }
    .column.is-4-mobile {
      flex: none;
      width: 33.33333%; }
    .column.is-offset-4-mobile {
      margin-left: 33.33333%; }
    .column.is-5-mobile {
      flex: none;
      width: 41.66667%; }
    .column.is-offset-5-mobile {
      margin-left: 41.66667%; }
    .column.is-6-mobile {
      flex: none;
      width: 50%; }
    .column.is-offset-6-mobile {
      margin-left: 50%; }
    .column.is-7-mobile {
      flex: none;
      width: 58.33333%; }
    .column.is-offset-7-mobile {
      margin-left: 58.33333%; }
    .column.is-8-mobile {
      flex: none;
      width: 66.66667%; }
    .column.is-offset-8-mobile {
      margin-left: 66.66667%; }
    .column.is-9-mobile {
      flex: none;
      width: 75%; }
    .column.is-offset-9-mobile {
      margin-left: 75%; }
    .column.is-10-mobile {
      flex: none;
      width: 83.33333%; }
    .column.is-offset-10-mobile {
      margin-left: 83.33333%; }
    .column.is-11-mobile {
      flex: none;
      width: 91.66667%; }
    .column.is-offset-11-mobile {
      margin-left: 91.66667%; }
    .column.is-12-mobile {
      flex: none;
      width: 100%; }
    .column.is-offset-12-mobile {
      margin-left: 100%; } }
  @media screen and (min-width: 769px), print {
    .column.is-narrow, .column.is-narrow-tablet {
      flex: none;
      width: unset; }
    .column.is-full, .column.is-full-tablet {
      flex: none;
      width: 100%; }
    .column.is-three-quarters, .column.is-three-quarters-tablet {
      flex: none;
      width: 75%; }
    .column.is-two-thirds, .column.is-two-thirds-tablet {
      flex: none;
      width: 66.6666%; }
    .column.is-half, .column.is-half-tablet {
      flex: none;
      width: 50%; }
    .column.is-one-third, .column.is-one-third-tablet {
      flex: none;
      width: 33.3333%; }
    .column.is-one-quarter, .column.is-one-quarter-tablet {
      flex: none;
      width: 25%; }
    .column.is-one-fifth, .column.is-one-fifth-tablet {
      flex: none;
      width: 20%; }
    .column.is-two-fifths, .column.is-two-fifths-tablet {
      flex: none;
      width: 40%; }
    .column.is-three-fifths, .column.is-three-fifths-tablet {
      flex: none;
      width: 60%; }
    .column.is-four-fifths, .column.is-four-fifths-tablet {
      flex: none;
      width: 80%; }
    .column.is-offset-three-quarters, .column.is-offset-three-quarters-tablet {
      margin-left: 75%; }
    .column.is-offset-two-thirds, .column.is-offset-two-thirds-tablet {
      margin-left: 66.6666%; }
    .column.is-offset-half, .column.is-offset-half-tablet {
      margin-left: 50%; }
    .column.is-offset-one-third, .column.is-offset-one-third-tablet {
      margin-left: 33.3333%; }
    .column.is-offset-one-quarter, .column.is-offset-one-quarter-tablet {
      margin-left: 25%; }
    .column.is-offset-one-fifth, .column.is-offset-one-fifth-tablet {
      margin-left: 20%; }
    .column.is-offset-two-fifths, .column.is-offset-two-fifths-tablet {
      margin-left: 40%; }
    .column.is-offset-three-fifths, .column.is-offset-three-fifths-tablet {
      margin-left: 60%; }
    .column.is-offset-four-fifths, .column.is-offset-four-fifths-tablet {
      margin-left: 80%; }
    .column.is-0, .column.is-0-tablet {
      flex: none;
      width: 0%; }
    .column.is-offset-0, .column.is-offset-0-tablet {
      margin-left: 0%; }
    .column.is-1, .column.is-1-tablet {
      flex: none;
      width: 8.33333%; }
    .column.is-offset-1, .column.is-offset-1-tablet {
      margin-left: 8.33333%; }
    .column.is-2, .column.is-2-tablet {
      flex: none;
      width: 16.66667%; }
    .column.is-offset-2, .column.is-offset-2-tablet {
      margin-left: 16.66667%; }
    .column.is-3, .column.is-3-tablet {
      flex: none;
      width: 25%; }
    .column.is-offset-3, .column.is-offset-3-tablet {
      margin-left: 25%; }
    .column.is-4, .column.is-4-tablet {
      flex: none;
      width: 33.33333%; }
    .column.is-offset-4, .column.is-offset-4-tablet {
      margin-left: 33.33333%; }
    .column.is-5, .column.is-5-tablet {
      flex: none;
      width: 41.66667%; }
    .column.is-offset-5, .column.is-offset-5-tablet {
      margin-left: 41.66667%; }
    .column.is-6, .column.is-6-tablet {
      flex: none;
      width: 50%; }
    .column.is-offset-6, .column.is-offset-6-tablet {
      margin-left: 50%; }
    .column.is-7, .column.is-7-tablet {
      flex: none;
      width: 58.33333%; }
    .column.is-offset-7, .column.is-offset-7-tablet {
      margin-left: 58.33333%; }
    .column.is-8, .column.is-8-tablet {
      flex: none;
      width: 66.66667%; }
    .column.is-offset-8, .column.is-offset-8-tablet {
      margin-left: 66.66667%; }
    .column.is-9, .column.is-9-tablet {
      flex: none;
      width: 75%; }
    .column.is-offset-9, .column.is-offset-9-tablet {
      margin-left: 75%; }
    .column.is-10, .column.is-10-tablet {
      flex: none;
      width: 83.33333%; }
    .column.is-offset-10, .column.is-offset-10-tablet {
      margin-left: 83.33333%; }
    .column.is-11, .column.is-11-tablet {
      flex: none;
      width: 91.66667%; }
    .column.is-offset-11, .column.is-offset-11-tablet {
      margin-left: 91.66667%; }
    .column.is-12, .column.is-12-tablet {
      flex: none;
      width: 100%; }
    .column.is-offset-12, .column.is-offset-12-tablet {
      margin-left: 100%; } }
  @media screen and (max-width: 1023px) {
    .column.is-narrow-touch {
      flex: none;
      width: unset; }
    .column.is-full-touch {
      flex: none;
      width: 100%; }
    .column.is-three-quarters-touch {
      flex: none;
      width: 75%; }
    .column.is-two-thirds-touch {
      flex: none;
      width: 66.6666%; }
    .column.is-half-touch {
      flex: none;
      width: 50%; }
    .column.is-one-third-touch {
      flex: none;
      width: 33.3333%; }
    .column.is-one-quarter-touch {
      flex: none;
      width: 25%; }
    .column.is-one-fifth-touch {
      flex: none;
      width: 20%; }
    .column.is-two-fifths-touch {
      flex: none;
      width: 40%; }
    .column.is-three-fifths-touch {
      flex: none;
      width: 60%; }
    .column.is-four-fifths-touch {
      flex: none;
      width: 80%; }
    .column.is-offset-three-quarters-touch {
      margin-left: 75%; }
    .column.is-offset-two-thirds-touch {
      margin-left: 66.6666%; }
    .column.is-offset-half-touch {
      margin-left: 50%; }
    .column.is-offset-one-third-touch {
      margin-left: 33.3333%; }
    .column.is-offset-one-quarter-touch {
      margin-left: 25%; }
    .column.is-offset-one-fifth-touch {
      margin-left: 20%; }
    .column.is-offset-two-fifths-touch {
      margin-left: 40%; }
    .column.is-offset-three-fifths-touch {
      margin-left: 60%; }
    .column.is-offset-four-fifths-touch {
      margin-left: 80%; }
    .column.is-0-touch {
      flex: none;
      width: 0%; }
    .column.is-offset-0-touch {
      margin-left: 0%; }
    .column.is-1-touch {
      flex: none;
      width: 8.33333%; }
    .column.is-offset-1-touch {
      margin-left: 8.33333%; }
    .column.is-2-touch {
      flex: none;
      width: 16.66667%; }
    .column.is-offset-2-touch {
      margin-left: 16.66667%; }
    .column.is-3-touch {
      flex: none;
      width: 25%; }
    .column.is-offset-3-touch {
      margin-left: 25%; }
    .column.is-4-touch {
      flex: none;
      width: 33.33333%; }
    .column.is-offset-4-touch {
      margin-left: 33.33333%; }
    .column.is-5-touch {
      flex: none;
      width: 41.66667%; }
    .column.is-offset-5-touch {
      margin-left: 41.66667%; }
    .column.is-6-touch {
      flex: none;
      width: 50%; }
    .column.is-offset-6-touch {
      margin-left: 50%; }
    .column.is-7-touch {
      flex: none;
      width: 58.33333%; }
    .column.is-offset-7-touch {
      margin-left: 58.33333%; }
    .column.is-8-touch {
      flex: none;
      width: 66.66667%; }
    .column.is-offset-8-touch {
      margin-left: 66.66667%; }
    .column.is-9-touch {
      flex: none;
      width: 75%; }
    .column.is-offset-9-touch {
      margin-left: 75%; }
    .column.is-10-touch {
      flex: none;
      width: 83.33333%; }
    .column.is-offset-10-touch {
      margin-left: 83.33333%; }
    .column.is-11-touch {
      flex: none;
      width: 91.66667%; }
    .column.is-offset-11-touch {
      margin-left: 91.66667%; }
    .column.is-12-touch {
      flex: none;
      width: 100%; }
    .column.is-offset-12-touch {
      margin-left: 100%; } }
  @media screen and (min-width: 1024px) {
    .column.is-narrow-desktop {
      flex: none;
      width: unset; }
    .column.is-full-desktop {
      flex: none;
      width: 100%; }
    .column.is-three-quarters-desktop {
      flex: none;
      width: 75%; }
    .column.is-two-thirds-desktop {
      flex: none;
      width: 66.6666%; }
    .column.is-half-desktop {
      flex: none;
      width: 50%; }
    .column.is-one-third-desktop {
      flex: none;
      width: 33.3333%; }
    .column.is-one-quarter-desktop {
      flex: none;
      width: 25%; }
    .column.is-one-fifth-desktop {
      flex: none;
      width: 20%; }
    .column.is-two-fifths-desktop {
      flex: none;
      width: 40%; }
    .column.is-three-fifths-desktop {
      flex: none;
      width: 60%; }
    .column.is-four-fifths-desktop {
      flex: none;
      width: 80%; }
    .column.is-offset-three-quarters-desktop {
      margin-left: 75%; }
    .column.is-offset-two-thirds-desktop {
      margin-left: 66.6666%; }
    .column.is-offset-half-desktop {
      margin-left: 50%; }
    .column.is-offset-one-third-desktop {
      margin-left: 33.3333%; }
    .column.is-offset-one-quarter-desktop {
      margin-left: 25%; }
    .column.is-offset-one-fifth-desktop {
      margin-left: 20%; }
    .column.is-offset-two-fifths-desktop {
      margin-left: 40%; }
    .column.is-offset-three-fifths-desktop {
      margin-left: 60%; }
    .column.is-offset-four-fifths-desktop {
      margin-left: 80%; }
    .column.is-0-desktop {
      flex: none;
      width: 0%; }
    .column.is-offset-0-desktop {
      margin-left: 0%; }
    .column.is-1-desktop {
      flex: none;
      width: 8.33333%; }
    .column.is-offset-1-desktop {
      margin-left: 8.33333%; }
    .column.is-2-desktop {
      flex: none;
      width: 16.66667%; }
    .column.is-offset-2-desktop {
      margin-left: 16.66667%; }
    .column.is-3-desktop {
      flex: none;
      width: 25%; }
    .column.is-offset-3-desktop {
      margin-left: 25%; }
    .column.is-4-desktop {
      flex: none;
      width: 33.33333%; }
    .column.is-offset-4-desktop {
      margin-left: 33.33333%; }
    .column.is-5-desktop {
      flex: none;
      width: 41.66667%; }
    .column.is-offset-5-desktop {
      margin-left: 41.66667%; }
    .column.is-6-desktop {
      flex: none;
      width: 50%; }
    .column.is-offset-6-desktop {
      margin-left: 50%; }
    .column.is-7-desktop {
      flex: none;
      width: 58.33333%; }
    .column.is-offset-7-desktop {
      margin-left: 58.33333%; }
    .column.is-8-desktop {
      flex: none;
      width: 66.66667%; }
    .column.is-offset-8-desktop {
      margin-left: 66.66667%; }
    .column.is-9-desktop {
      flex: none;
      width: 75%; }
    .column.is-offset-9-desktop {
      margin-left: 75%; }
    .column.is-10-desktop {
      flex: none;
      width: 83.33333%; }
    .column.is-offset-10-desktop {
      margin-left: 83.33333%; }
    .column.is-11-desktop {
      flex: none;
      width: 91.66667%; }
    .column.is-offset-11-desktop {
      margin-left: 91.66667%; }
    .column.is-12-desktop {
      flex: none;
      width: 100%; }
    .column.is-offset-12-desktop {
      margin-left: 100%; } }
  @media screen and (min-width: 1216px) {
    .column.is-narrow-widescreen {
      flex: none;
      width: unset; }
    .column.is-full-widescreen {
      flex: none;
      width: 100%; }
    .column.is-three-quarters-widescreen {
      flex: none;
      width: 75%; }
    .column.is-two-thirds-widescreen {
      flex: none;
      width: 66.6666%; }
    .column.is-half-widescreen {
      flex: none;
      width: 50%; }
    .column.is-one-third-widescreen {
      flex: none;
      width: 33.3333%; }
    .column.is-one-quarter-widescreen {
      flex: none;
      width: 25%; }
    .column.is-one-fifth-widescreen {
      flex: none;
      width: 20%; }
    .column.is-two-fifths-widescreen {
      flex: none;
      width: 40%; }
    .column.is-three-fifths-widescreen {
      flex: none;
      width: 60%; }
    .column.is-four-fifths-widescreen {
      flex: none;
      width: 80%; }
    .column.is-offset-three-quarters-widescreen {
      margin-left: 75%; }
    .column.is-offset-two-thirds-widescreen {
      margin-left: 66.6666%; }
    .column.is-offset-half-widescreen {
      margin-left: 50%; }
    .column.is-offset-one-third-widescreen {
      margin-left: 33.3333%; }
    .column.is-offset-one-quarter-widescreen {
      margin-left: 25%; }
    .column.is-offset-one-fifth-widescreen {
      margin-left: 20%; }
    .column.is-offset-two-fifths-widescreen {
      margin-left: 40%; }
    .column.is-offset-three-fifths-widescreen {
      margin-left: 60%; }
    .column.is-offset-four-fifths-widescreen {
      margin-left: 80%; }
    .column.is-0-widescreen {
      flex: none;
      width: 0%; }
    .column.is-offset-0-widescreen {
      margin-left: 0%; }
    .column.is-1-widescreen {
      flex: none;
      width: 8.33333%; }
    .column.is-offset-1-widescreen {
      margin-left: 8.33333%; }
    .column.is-2-widescreen {
      flex: none;
      width: 16.66667%; }
    .column.is-offset-2-widescreen {
      margin-left: 16.66667%; }
    .column.is-3-widescreen {
      flex: none;
      width: 25%; }
    .column.is-offset-3-widescreen {
      margin-left: 25%; }
    .column.is-4-widescreen {
      flex: none;
      width: 33.33333%; }
    .column.is-offset-4-widescreen {
      margin-left: 33.33333%; }
    .column.is-5-widescreen {
      flex: none;
      width: 41.66667%; }
    .column.is-offset-5-widescreen {
      margin-left: 41.66667%; }
    .column.is-6-widescreen {
      flex: none;
      width: 50%; }
    .column.is-offset-6-widescreen {
      margin-left: 50%; }
    .column.is-7-widescreen {
      flex: none;
      width: 58.33333%; }
    .column.is-offset-7-widescreen {
      margin-left: 58.33333%; }
    .column.is-8-widescreen {
      flex: none;
      width: 66.66667%; }
    .column.is-offset-8-widescreen {
      margin-left: 66.66667%; }
    .column.is-9-widescreen {
      flex: none;
      width: 75%; }
    .column.is-offset-9-widescreen {
      margin-left: 75%; }
    .column.is-10-widescreen {
      flex: none;
      width: 83.33333%; }
    .column.is-offset-10-widescreen {
      margin-left: 83.33333%; }
    .column.is-11-widescreen {
      flex: none;
      width: 91.66667%; }
    .column.is-offset-11-widescreen {
      margin-left: 91.66667%; }
    .column.is-12-widescreen {
      flex: none;
      width: 100%; }
    .column.is-offset-12-widescreen {
      margin-left: 100%; } }
  @media screen and (min-width: 1408px) {
    .column.is-narrow-fullhd {
      flex: none;
      width: unset; }
    .column.is-full-fullhd {
      flex: none;
      width: 100%; }
    .column.is-three-quarters-fullhd {
      flex: none;
      width: 75%; }
    .column.is-two-thirds-fullhd {
      flex: none;
      width: 66.6666%; }
    .column.is-half-fullhd {
      flex: none;
      width: 50%; }
    .column.is-one-third-fullhd {
      flex: none;
      width: 33.3333%; }
    .column.is-one-quarter-fullhd {
      flex: none;
      width: 25%; }
    .column.is-one-fifth-fullhd {
      flex: none;
      width: 20%; }
    .column.is-two-fifths-fullhd {
      flex: none;
      width: 40%; }
    .column.is-three-fifths-fullhd {
      flex: none;
      width: 60%; }
    .column.is-four-fifths-fullhd {
      flex: none;
      width: 80%; }
    .column.is-offset-three-quarters-fullhd {
      margin-left: 75%; }
    .column.is-offset-two-thirds-fullhd {
      margin-left: 66.6666%; }
    .column.is-offset-half-fullhd {
      margin-left: 50%; }
    .column.is-offset-one-third-fullhd {
      margin-left: 33.3333%; }
    .column.is-offset-one-quarter-fullhd {
      margin-left: 25%; }
    .column.is-offset-one-fifth-fullhd {
      margin-left: 20%; }
    .column.is-offset-two-fifths-fullhd {
      margin-left: 40%; }
    .column.is-offset-three-fifths-fullhd {
      margin-left: 60%; }
    .column.is-offset-four-fifths-fullhd {
      margin-left: 80%; }
    .column.is-0-fullhd {
      flex: none;
      width: 0%; }
    .column.is-offset-0-fullhd {
      margin-left: 0%; }
    .column.is-1-fullhd {
      flex: none;
      width: 8.33333%; }
    .column.is-offset-1-fullhd {
      margin-left: 8.33333%; }
    .column.is-2-fullhd {
      flex: none;
      width: 16.66667%; }
    .column.is-offset-2-fullhd {
      margin-left: 16.66667%; }
    .column.is-3-fullhd {
      flex: none;
      width: 25%; }
    .column.is-offset-3-fullhd {
      margin-left: 25%; }
    .column.is-4-fullhd {
      flex: none;
      width: 33.33333%; }
    .column.is-offset-4-fullhd {
      margin-left: 33.33333%; }
    .column.is-5-fullhd {
      flex: none;
      width: 41.66667%; }
    .column.is-offset-5-fullhd {
      margin-left: 41.66667%; }
    .column.is-6-fullhd {
      flex: none;
      width: 50%; }
    .column.is-offset-6-fullhd {
      margin-left: 50%; }
    .column.is-7-fullhd {
      flex: none;
      width: 58.33333%; }
    .column.is-offset-7-fullhd {
      margin-left: 58.33333%; }
    .column.is-8-fullhd {
      flex: none;
      width: 66.66667%; }
    .column.is-offset-8-fullhd {
      margin-left: 66.66667%; }
    .column.is-9-fullhd {
      flex: none;
      width: 75%; }
    .column.is-offset-9-fullhd {
      margin-left: 75%; }
    .column.is-10-fullhd {
      flex: none;
      width: 83.33333%; }
    .column.is-offset-10-fullhd {
      margin-left: 83.33333%; }
    .column.is-11-fullhd {
      flex: none;
      width: 91.66667%; }
    .column.is-offset-11-fullhd {
      margin-left: 91.66667%; }
    .column.is-12-fullhd {
      flex: none;
      width: 100%; }
    .column.is-offset-12-fullhd {
      margin-left: 100%; } }

.columns {
  margin-left: -0.75rem;
  margin-right: -0.75rem;
  margin-top: -0.75rem; }
  .columns:last-child {
    margin-bottom: -0.75rem; }
  .columns:not(:last-child) {
    margin-bottom: calc(1.5rem - 0.75rem); }
  .columns.is-centered {
    justify-content: center; }
  .columns.is-gapless {
    margin-left: 0;
    margin-right: 0;
    margin-top: 0; }
    .columns.is-gapless > .column {
      margin: 0;
      padding: 0 !important; }
    .columns.is-gapless:not(:last-child) {
      margin-bottom: 1.5rem; }
    .columns.is-gapless:last-child {
      margin-bottom: 0; }
  .columns.is-mobile {
    display: flex; }
  .columns.is-multiline {
    flex-wrap: wrap; }
  .columns.is-vcentered {
    align-items: center; }
  @media screen and (min-width: 769px), print {
    .columns:not(.is-desktop) {
      display: flex; } }
  @media screen and (min-width: 1024px) {
    .columns.is-desktop {
      display: flex; } }

.columns.is-variable {
  --columnGap: 0.75rem;
  margin-left: calc(-1 * var(--columnGap));
  margin-right: calc(-1 * var(--columnGap)); }
  .columns.is-variable > .column {
    padding-left: var(--columnGap);
    padding-right: var(--columnGap); }
  .columns.is-variable.is-0 {
    --columnGap: 0rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-0-mobile {
      --columnGap: 0rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-0-tablet {
      --columnGap: 0rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-0-tablet-only {
      --columnGap: 0rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-0-touch {
      --columnGap: 0rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-0-desktop {
      --columnGap: 0rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-0-desktop-only {
      --columnGap: 0rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-0-widescreen {
      --columnGap: 0rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-0-widescreen-only {
      --columnGap: 0rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-0-fullhd {
      --columnGap: 0rem; } }
  .columns.is-variable.is-1 {
    --columnGap: 0.25rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-1-mobile {
      --columnGap: 0.25rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-1-tablet {
      --columnGap: 0.25rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-1-tablet-only {
      --columnGap: 0.25rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-1-touch {
      --columnGap: 0.25rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-1-desktop {
      --columnGap: 0.25rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-1-desktop-only {
      --columnGap: 0.25rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-1-widescreen {
      --columnGap: 0.25rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-1-widescreen-only {
      --columnGap: 0.25rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-1-fullhd {
      --columnGap: 0.25rem; } }
  .columns.is-variable.is-2 {
    --columnGap: 0.5rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-2-mobile {
      --columnGap: 0.5rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-2-tablet {
      --columnGap: 0.5rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-2-tablet-only {
      --columnGap: 0.5rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-2-touch {
      --columnGap: 0.5rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-2-desktop {
      --columnGap: 0.5rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-2-desktop-only {
      --columnGap: 0.5rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-2-widescreen {
      --columnGap: 0.5rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-2-widescreen-only {
      --columnGap: 0.5rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-2-fullhd {
      --columnGap: 0.5rem; } }
  .columns.is-variable.is-3 {
    --columnGap: 0.75rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-3-mobile {
      --columnGap: 0.75rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-3-tablet {
      --columnGap: 0.75rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-3-tablet-only {
      --columnGap: 0.75rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-3-touch {
      --columnGap: 0.75rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-3-desktop {
      --columnGap: 0.75rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-3-desktop-only {
      --columnGap: 0.75rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-3-widescreen {
      --columnGap: 0.75rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-3-widescreen-only {
      --columnGap: 0.75rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-3-fullhd {
      --columnGap: 0.75rem; } }
  .columns.is-variable.is-4 {
    --columnGap: 1rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-4-mobile {
      --columnGap: 1rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-4-tablet {
      --columnGap: 1rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-4-tablet-only {
      --columnGap: 1rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-4-touch {
      --columnGap: 1rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-4-desktop {
      --columnGap: 1rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-4-desktop-only {
      --columnGap: 1rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-4-widescreen {
      --columnGap: 1rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-4-widescreen-only {
      --columnGap: 1rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-4-fullhd {
      --columnGap: 1rem; } }
  .columns.is-variable.is-5 {
    --columnGap: 1.25rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-5-mobile {
      --columnGap: 1.25rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-5-tablet {
      --columnGap: 1.25rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-5-tablet-only {
      --columnGap: 1.25rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-5-touch {
      --columnGap: 1.25rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-5-desktop {
      --columnGap: 1.25rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-5-desktop-only {
      --columnGap: 1.25rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-5-widescreen {
      --columnGap: 1.25rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-5-widescreen-only {
      --columnGap: 1.25rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-5-fullhd {
      --columnGap: 1.25rem; } }
  .columns.is-variable.is-6 {
    --columnGap: 1.5rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-6-mobile {
      --columnGap: 1.5rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-6-tablet {
      --columnGap: 1.5rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-6-tablet-only {
      --columnGap: 1.5rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-6-touch {
      --columnGap: 1.5rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-6-desktop {
      --columnGap: 1.5rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-6-desktop-only {
      --columnGap: 1.5rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-6-widescreen {
      --columnGap: 1.5rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-6-widescreen-only {
      --columnGap: 1.5rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-6-fullhd {
      --columnGap: 1.5rem; } }
  .columns.is-variable.is-7 {
    --columnGap: 1.75rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-7-mobile {
      --columnGap: 1.75rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-7-tablet {
      --columnGap: 1.75rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-7-tablet-only {
      --columnGap: 1.75rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-7-touch {
      --columnGap: 1.75rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-7-desktop {
      --columnGap: 1.75rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-7-desktop-only {
      --columnGap: 1.75rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-7-widescreen {
      --columnGap: 1.75rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-7-widescreen-only {
      --columnGap: 1.75rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-7-fullhd {
      --columnGap: 1.75rem; } }
  .columns.is-variable.is-8 {
    --columnGap: 2rem; }
  @media screen and (max-width: 768px) {
    .columns.is-variable.is-8-mobile {
      --columnGap: 2rem; } }
  @media screen and (min-width: 769px), print {
    .columns.is-variable.is-8-tablet {
      --columnGap: 2rem; } }
  @media screen and (min-width: 769px) and (max-width: 1023px) {
    .columns.is-variable.is-8-tablet-only {
      --columnGap: 2rem; } }
  @media screen and (max-width: 1023px) {
    .columns.is-variable.is-8-touch {
      --columnGap: 2rem; } }
  @media screen and (min-width: 1024px) {
    .columns.is-variable.is-8-desktop {
      --columnGap: 2rem; } }
  @media screen and (min-width: 1024px) and (max-width: 1215px) {
    .columns.is-variable.is-8-desktop-only {
      --columnGap: 2rem; } }
  @media screen and (min-width: 1216px) {
    .columns.is-variable.is-8-widescreen {
      --columnGap: 2rem; } }
  @media screen and (min-width: 1216px) and (max-width: 1407px) {
    .columns.is-variable.is-8-widescreen-only {
      --columnGap: 2rem; } }
  @media screen and (min-width: 1408px) {
    .columns.is-variable.is-8-fullhd {
      --columnGap: 2rem; } }

.tile {
  align-items: stretch;
  display: block;
  flex-basis: 0;
  flex-grow: 1;
  flex-shrink: 1;
  min-height: min-content; }
  .tile.is-ancestor {
    margin-left: -0.75rem;
    margin-right: -0.75rem;
    margin-top: -0.75rem; }
    .tile.is-ancestor:last-child {
      margin-bottom: -0.75rem; }
    .tile.is-ancestor:not(:last-child) {
      margin-bottom: 0.75rem; }
  .tile.is-child {
    margin: 0 !important; }
  .tile.is-parent {
    padding: 0.75rem; }
  .tile.is-vertical {
    flex-direction: column; }
    .tile.is-vertical > .tile.is-child:not(:last-child) {
      margin-bottom: 1.5rem !important; }
  @media screen and (min-width: 769px), print {
    .tile:not(.is-child) {
      display: flex; }
    .tile.is-1 {
      flex: none;
      width: 8.33333%; }
    .tile.is-2 {
      flex: none;
      width: 16.66667%; }
    .tile.is-3 {
      flex: none;
      width: 25%; }
    .tile.is-4 {
      flex: none;
      width: 33.33333%; }
    .tile.is-5 {
      flex: none;
      width: 41.66667%; }
    .tile.is-6 {
      flex: none;
      width: 50%; }
    .tile.is-7 {
      flex: none;
      width: 58.33333%; }
    .tile.is-8 {
      flex: none;
      width: 66.66667%; }
    .tile.is-9 {
      flex: none;
      width: 75%; }
    .tile.is-10 {
      flex: none;
      width: 83.33333%; }
    .tile.is-11 {
      flex: none;
      width: 91.66667%; }
    .tile.is-12 {
      flex: none;
      width: 100%; } }

/* Bulma Helpers */
.has-text-white {
  color: #171717 !important; }

a.has-text-white:hover, a.has-text-white:focus {
  color: black !important; }

.has-background-white {
  background-color: #171717 !important; }

.has-text-black {
  color: #f2f2f2 !important; }

a.has-text-black:hover, a.has-text-black:focus {
  color: #d9d9d9 !important; }

.has-background-black {
  background-color: #f2f2f2 !important; }

.has-text-light {
  color: #363636 !important; }

a.has-text-light:hover, a.has-text-light:focus {
  color: #1c1c1c !important; }

.has-background-light {
  background-color: #363636 !important; }

.has-text-dark {
  color: #e6e6e6 !important; }

a.has-text-dark:hover, a.has-text-dark:focus {
  color: #cccccc !important; }

.has-background-dark {
  background-color: #e6e6e6 !important; }

.has-text-primary {
  color: #0E87C8 !important; }

a.has-text-primary:hover, a.has-text-primary:focus {
  color: #0b6798 !important; }

.has-background-primary {
  background-color: #0E87C8 !important; }

.has-text-primary-light {
  color: #ecf7fe !important; }

a.has-text-primary-light:hover, a.has-text-primary-light:focus {
  color: #bce5fa !important; }

.has-background-primary-light {
  background-color: #ecf7fe !important; }

.has-text-primary-dark {
  color: #0e8acd !important; }

a.has-text-primary-dark:hover, a.has-text-primary-dark:focus {
  color: #1fa7ef !important; }

.has-background-primary-dark {
  background-color: #0e8acd !important; }

.has-text-link {
  color: #467CFB !important; }

a.has-text-link:hover, a.has-text-link:focus {
  color: #1459fa !important; }

.has-background-link {
  background-color: #467CFB !important; }

.has-text-link-light {
  color: #ebf1ff !important; }

a.has-text-link-light:hover, a.has-text-link-light:focus {
  color: #b9cefd !important; }

.has-background-link-light {
  background-color: #ebf1ff !important; }

.has-text-link-dark {
  color: #0542d2 !important; }

a.has-text-link-dark:hover, a.has-text-link-dark:focus {
  color: #0f55fa !important; }

.has-background-link-dark {
  background-color: #0542d2 !important; }

.has-text-info {
  color: #7A8690 !important; }

a.has-text-info:hover, a.has-text-info:focus {
  color: #626c75 !important; }

.has-background-info {
  background-color: #7A8690 !important; }

.has-text-info-light {
  color: #f4f5f6 !important; }

a.has-text-info-light:hover, a.has-text-info-light:focus {
  color: #d8dcdf !important; }

.has-background-info-light {
  background-color: #f4f5f6 !important; }

.has-text-info-dark {
  color: #5f6972 !important; }

a.has-text-info-dark:hover, a.has-text-info-dark:focus {
  color: #77838d !important; }

.has-background-info-dark {
  background-color: #5f6972 !important; }

.has-text-success {
  color: #029736 !important; }

a.has-text-success:hover, a.has-text-success:focus {
  color: #016524 !important; }

.has-background-success {
  background-color: #029736 !important; }

.has-text-success-light {
  color: #ebfff2 !important; }

a.has-text-success-light:hover, a.has-text-success-light:focus {
  color: #b9fed1 !important; }

.has-background-success-light {
  background-color: #ebfff2 !important; }

.has-text-success-dark {
  color: #03d84d !important; }

a.has-text-success-dark:hover, a.has-text-success-dark:focus {
  color: #12fc64 !important; }

.has-background-success-dark {
  background-color: #03d84d !important; }

.has-text-warning {
  color: #ffd100 !important; }

a.has-text-warning:hover, a.has-text-warning:focus {
  color: #cca700 !important; }

.has-background-warning {
  background-color: #ffd100 !important; }

.has-text-warning-light {
  color: #fffbeb !important; }

a.has-text-warning-light:hover, a.has-text-warning-light:focus {
  color: #fff2b8 !important; }

.has-background-warning-light {
  background-color: #fffbeb !important; }

.has-text-warning-dark {
  color: #947900 !important; }

a.has-text-warning-dark:hover, a.has-text-warning-dark:focus {
  color: #c7a300 !important; }

.has-background-warning-dark {
  background-color: #947900 !important; }

.has-text-danger {
  color: #F91F52 !important; }

a.has-text-danger:hover, a.has-text-danger:focus {
  color: #df0639 !important; }

.has-background-danger {
  background-color: #F91F52 !important; }

.has-text-danger-light {
  color: #feebf0 !important; }

a.has-text-danger-light:hover, a.has-text-danger-light:focus {
  color: #fdb9c9 !important; }

.has-background-danger-light {
  background-color: #feebf0 !important; }

.has-text-danger-dark {
  color: #e00639 !important; }

a.has-text-danger-dark:hover, a.has-text-danger-dark:focus {
  color: #f91f52 !important; }

.has-background-danger-dark {
  background-color: #e00639 !important; }

.has-text-black-bis {
  color: #fafafa !important; }

.has-background-black-bis {
  background-color: #fafafa !important; }

.has-text-black-ter {
  color: whitesmoke !important; }

.has-background-black-ter {
  background-color: whitesmoke !important; }

.has-text-grey-darker {
  color: #dbdbdb !important; }

.has-background-grey-darker {
  background-color: #dbdbdb !important; }

.has-text-grey-dark {
  color: #b5b5b5 !important; }

.has-background-grey-dark {
  background-color: #b5b5b5 !important; }

.has-text-grey {
  color: #7a7a7a !important; }

.has-background-grey {
  background-color: #7a7a7a !important; }

.has-text-grey-light {
  color: #4a4a4a !important; }

.has-background-grey-light {
  background-color: #4a4a4a !important; }

.has-text-grey-lighter {
  color: #363636 !important; }

.has-background-grey-lighter {
  background-color: #363636 !important; }

.has-text-white-ter {
  color: #242424 !important; }

.has-background-white-ter {
  background-color: #242424 !important; }

.has-text-white-bis {
  color: #171717 !important; }

.has-background-white-bis {
  background-color: #171717 !important; }

.is-flex-direction-row {
  flex-direction: row !important; }

.is-flex-direction-row-reverse {
  flex-direction: row-reverse !important; }

.is-flex-direction-column {
  flex-direction: column !important; }

.is-flex-direction-column-reverse {
  flex-direction: column-reverse !important; }

.is-flex-wrap-nowrap {
  flex-wrap: nowrap !important; }

.is-flex-wrap-wrap {
  flex-wrap: wrap !important; }

.is-flex-wrap-wrap-reverse {
  flex-wrap: wrap-reverse !important; }

.is-justify-content-flex-start {
  justify-content: flex-start !important; }

.is-justify-content-flex-end {
  justify-content: flex-end !important; }

.is-justify-content-center {
  justify-content: center !important; }

.is-justify-content-space-between {
  justify-content: space-between !important; }

.is-justify-content-space-around {
  justify-content: space-around !important; }

.is-justify-content-space-evenly {
  justify-content: space-evenly !important; }

.is-justify-content-start {
  justify-content: start !important; }

.is-justify-content-end {
  justify-content: end !important; }

.is-justify-content-left {
  justify-content: left !important; }

.is-justify-content-right {
  justify-content: right !important; }

.is-align-content-flex-start {
  align-content: flex-start !important; }

.is-align-content-flex-end {
  align-content: flex-end !important; }

.is-align-content-center {
  align-content: center !important; }

.is-align-content-space-between {
  align-content: space-between !important; }

.is-align-content-space-around {
  align-content: space-around !important; }

.is-align-content-space-evenly {
  align-content: space-evenly !important; }

.is-align-content-stretch {
  align-content: stretch !important; }

.is-align-content-start {
  align-content: start !important; }

.is-align-content-end {
  align-content: end !important; }

.is-align-content-baseline {
  align-content: baseline !important; }

.is-align-items-stretch {
  align-items: stretch !important; }

.is-align-items-flex-start {
  align-items: flex-start !important; }

.is-align-items-flex-end {
  align-items: flex-end !important; }

.is-align-items-center {
  align-items: center !important; }

.is-align-items-baseline {
  align-items: baseline !important; }

.is-align-items-start {
  align-items: start !important; }

.is-align-items-end {
  align-items: end !important; }

.is-align-items-self-start {
  align-items: self-start !important; }

.is-align-items-self-end {
  align-items: self-end !important; }

.is-align-self-auto {
  align-self: auto !important; }

.is-align-self-flex-start {
  align-self: flex-start !important; }

.is-align-self-flex-end {
  align-self: flex-end !important; }

.is-align-self-center {
  align-self: center !important; }

.is-align-self-baseline {
  align-self: baseline !important; }

.is-align-self-stretch {
  align-self: stretch !important; }

.is-flex-grow-0 {
  flex-grow: 0 !important; }

.is-flex-grow-1 {
  flex-grow: 1 !important; }

.is-flex-grow-2 {
  flex-grow: 2 !important; }

.is-flex-grow-3 {
  flex-grow: 3 !important; }

.is-flex-grow-4 {
  flex-grow: 4 !important; }

.is-flex-grow-5 {
  flex-grow: 5 !important; }

.is-flex-shrink-0 {
  flex-shrink: 0 !important; }

.is-flex-shrink-1 {
  flex-shrink: 1 !important; }

.is-flex-shrink-2 {
  flex-shrink: 2 !important; }

.is-flex-shrink-3 {
  flex-shrink: 3 !important; }

.is-flex-shrink-4 {
  flex-shrink: 4 !important; }

.is-flex-shrink-5 {
  flex-shrink: 5 !important; }

.is-clearfix::after {
  clear: both;
  content: " ";
  display: table; }

.is-pulled-left {
  float: left !important; }

.is-pulled-right {
  float: right !important; }

.is-radiusless {
  border-radius: 0 !important; }

.is-shadowless {
  box-shadow: none !important; }

.is-clickable {
  cursor: pointer !important;
  pointer-events: all !important; }

.is-clipped {
  overflow: hidden !important; }

.is-relative {
  position: relative !important; }

.is-marginless {
  margin: 0 !important; }

.is-paddingless {
  padding: 0 !important; }

.m-0 {
  margin: 0 !important; }

.mt-0 {
  margin-top: 0 !important; }

.mr-0 {
  margin-right: 0 !important; }

.mb-0 {
  margin-bottom: 0 !important; }

.ml-0 {
  margin-left: 0 !important; }

.mx-0 {
  margin-left: 0 !important;
  margin-right: 0 !important; }

.my-0 {
  margin-top: 0 !important;
  margin-bottom: 0 !important; }

.m-1 {
  margin: 0.25rem !important; }

.mt-1 {
  margin-top: 0.25rem !important; }

.mr-1 {
  margin-right: 0.25rem !important; }

.mb-1 {
  margin-bottom: 0.25rem !important; }

.ml-1 {
  margin-left: 0.25rem !important; }

.mx-1 {
  margin-left: 0.25rem !important;
  margin-right: 0.25rem !important; }

.my-1 {
  margin-top: 0.25rem !important;
  margin-bottom: 0.25rem !important; }

.m-2 {
  margin: 0.5rem !important; }

.mt-2 {
  margin-top: 0.5rem !important; }

.mr-2 {
  margin-right: 0.5rem !important; }

.mb-2 {
  margin-bottom: 0.5rem !important; }

.ml-2 {
  margin-left: 0.5rem !important; }

.mx-2 {
  margin-left: 0.5rem !important;
  margin-right: 0.5rem !important; }

.my-2 {
  margin-top: 0.5rem !important;
  margin-bottom: 0.5rem !important; }

.m-3 {
  margin: 0.75rem !important; }

.mt-3 {
  margin-top: 0.75rem !important; }

.mr-3 {
  margin-right: 0.75rem !important; }

.mb-3 {
  margin-bottom: 0.75rem !important; }

.ml-3 {
  margin-left: 0.75rem !important; }

.mx-3 {
  margin-left: 0.75rem !important;
  margin-right: 0.75rem !important; }

.my-3 {
  margin-top: 0.75rem !important;
  margin-bottom: 0.75rem !important; }

.m-4 {
  margin: 1rem !important; }

.mt-4 {
  margin-top: 1rem !important; }

.mr-4 {
  margin-right: 1rem !important; }

.mb-4 {
  margin-bottom: 1rem !important; }

.ml-4 {
  margin-left: 1rem !important; }

.mx-4 {
  margin-left: 1rem !important;
  margin-right: 1rem !important; }

.my-4 {
  margin-top: 1rem !important;
  margin-bottom: 1rem !important; }

.m-5 {
  margin: 1.5rem !important; }

.mt-5 {
  margin-top: 1.5rem !important; }

.mr-5 {
  margin-right: 1.5rem !important; }

.mb-5 {
  margin-bottom: 1.5rem !important; }

.ml-5 {
  margin-left: 1.5rem !important; }

.mx-5 {
  margin-left: 1.5rem !important;
  margin-right: 1.5rem !important; }

.my-5 {
  margin-top: 1.5rem !important;
  margin-bottom: 1.5rem !important; }

.m-6 {
  margin: 3rem !important; }

.mt-6 {
  margin-top: 3rem !important; }

.mr-6 {
  margin-right: 3rem !important; }

.mb-6 {
  margin-bottom: 3rem !important; }

.ml-6 {
  margin-left: 3rem !important; }

.mx-6 {
  margin-left: 3rem !important;
  margin-right: 3rem !important; }

.my-6 {
  margin-top: 3rem !important;
  margin-bottom: 3rem !important; }

.m-auto {
  margin: auto !important; }

.mt-auto {
  margin-top: auto !important; }

.mr-auto {
  margin-right: auto !important; }

.mb-auto {
  margin-bottom: auto !important; }

.ml-auto {
  margin-left: auto !important; }

.mx-auto {
  margin-left: auto !important;
  margin-right: auto !important; }

.my-auto {
  margin-top: auto !important;
  margin-bottom: auto !important; }

.p-0 {
  padding: 0 !important; }

.pt-0 {
  padding-top: 0 !important; }

.pr-0 {
  padding-right: 0 !important; }

.pb-0 {
  padding-bottom: 0 !important; }

.pl-0 {
  padding-left: 0 !important; }

.px-0 {
  padding-left: 0 !important;
  padding-right: 0 !important; }

.py-0 {
  padding-top: 0 !important;
  padding-bottom: 0 !important; }

.p-1 {
  padding: 0.25rem !important; }

.pt-1 {
  padding-top: 0.25rem !important; }

.pr-1 {
  padding-right: 0.25rem !important; }

.pb-1 {
  padding-bottom: 0.25rem !important; }

.pl-1 {
  padding-left: 0.25rem !important; }

.px-1 {
  padding-left: 0.25rem !important;
  padding-right: 0.25rem !important; }

.py-1 {
  padding-top: 0.25rem !important;
  padding-bottom: 0.25rem !important; }

.p-2 {
  padding: 0.5rem !important; }

.pt-2 {
  padding-top: 0.5rem !important; }

.pr-2 {
  padding-right: 0.5rem !important; }

.pb-2 {
  padding-bottom: 0.5rem !important; }

.pl-2 {
  padding-left: 0.5rem !important; }

.px-2 {
  padding-left: 0.5rem !important;
  padding-right: 0.5rem !important; }

.py-2 {
  padding-top: 0.5rem !important;
  padding-bottom: 0.5rem !important; }

.p-3 {
  padding: 0.75rem !important; }

.pt-3 {
  padding-top: 0.75rem !important; }

.pr-3 {
  padding-right: 0.75rem !important; }

.pb-3 {
  padding-bottom: 0.75rem !important; }

.pl-3 {
  padding-left: 0.75rem !important; }

.px-3 {
  padding-left: 0.75rem !important;
  padding-right: 0.75rem !important; }

.py-3 {
  padding-top: 0.75rem !important;
  padding-bottom: 0.75rem !important; }

.p-4 {
  padding: 1rem !important; }

.pt-4 {
  padding-top: 1rem !important; }

.pr-4 {
  padding-right: 1rem !important; }

.pb-4 {
  padding-bottom: 1rem !important; }

.pl-4 {
  padding-left: 1rem !important; }

.px-4 {
  padding-left: 1rem !important;
  padding-right: 1rem !important; }

.py-4 {
  padding-top: 1rem !important;
  padding-bottom: 1rem !important; }

.p-5 {
  padding: 1.5rem !important; }

.pt-5 {
  padding-top: 1.5rem !important; }

.pr-5 {
  padding-right: 1.5rem !important; }

.pb-5 {
  padding-bottom: 1.5rem !important; }

.pl-5 {
  padding-left: 1.5rem !important; }

.px-5 {
  padding-left: 1.5rem !important;
  padding-right: 1.5rem !important; }

.py-5 {
  padding-top: 1.5rem !important;
  padding-bottom: 1.5rem !important; }

.p-6 {
  padding: 3rem !important; }

.pt-6 {
  padding-top: 3rem !important; }

.pr-6 {
  padding-right: 3rem !important; }

.pb-6 {
  padding-bottom: 3rem !important; }

.pl-6 {
  padding-left: 3rem !important; }

.px-6 {
  padding-left: 3rem !important;
  padding-right: 3rem !important; }

.py-6 {
  padding-top: 3rem !important;
  padding-bottom: 3rem !important; }

.p-auto {
  padding: auto !important; }

.pt-auto {
  padding-top: auto !important; }

.pr-auto {
  padding-right: auto !important; }

.pb-auto {
  padding-bottom: auto !important; }

.pl-auto {
  padding-left: auto !important; }

.px-auto {
  padding-left: auto !important;
  padding-right: auto !important; }

.py-auto {
  padding-top: auto !important;
  padding-bottom: auto !important; }

.is-size-1 {
  font-size: 3rem !important; }

.is-size-2 {
  font-size: 2.5rem !important; }

.is-size-3 {
  font-size: 2rem !important; }

.is-size-4 {
  font-size: 1.5rem !important; }

.is-size-5 {
  font-size: 1.25rem !important; }

.is-size-6 {
  font-size: 1rem !important; }

.is-size-7 {
  font-size: 0.75rem !important; }

@media screen and (max-width: 768px) {
  .is-size-1-mobile {
    font-size: 3rem !important; }
  .is-size-2-mobile {
    font-size: 2.5rem !important; }
  .is-size-3-mobile {
    font-size: 2rem !important; }
  .is-size-4-mobile {
    font-size: 1.5rem !important; }
  .is-size-5-mobile {
    font-size: 1.25rem !important; }
  .is-size-6-mobile {
    font-size: 1rem !important; }
  .is-size-7-mobile {
    font-size: 0.75rem !important; } }

@media screen and (min-width: 769px), print {
  .is-size-1-tablet {
    font-size: 3rem !important; }
  .is-size-2-tablet {
    font-size: 2.5rem !important; }
  .is-size-3-tablet {
    font-size: 2rem !important; }
  .is-size-4-tablet {
    font-size: 1.5rem !important; }
  .is-size-5-tablet {
    font-size: 1.25rem !important; }
  .is-size-6-tablet {
    font-size: 1rem !important; }
  .is-size-7-tablet {
    font-size: 0.75rem !important; } }

@media screen and (max-width: 1023px) {
  .is-size-1-touch {
    font-size: 3rem !important; }
  .is-size-2-touch {
    font-size: 2.5rem !important; }
  .is-size-3-touch {
    font-size: 2rem !important; }
  .is-size-4-touch {
    font-size: 1.5rem !important; }
  .is-size-5-touch {
    font-size: 1.25rem !important; }
  .is-size-6-touch {
    font-size: 1rem !important; }
  .is-size-7-touch {
    font-size: 0.75rem !important; } }

@media screen and (min-width: 1024px) {
  .is-size-1-desktop {
    font-size: 3rem !important; }
  .is-size-2-desktop {
    font-size: 2.5rem !important; }
  .is-size-3-desktop {
    font-size: 2rem !important; }
  .is-size-4-desktop {
    font-size: 1.5rem !important; }
  .is-size-5-desktop {
    font-size: 1.25rem !important; }
  .is-size-6-desktop {
    font-size: 1rem !important; }
  .is-size-7-desktop {
    font-size: 0.75rem !important; } }

@media screen and (min-width: 1216px) {
  .is-size-1-widescreen {
    font-size: 3rem !important; }
  .is-size-2-widescreen {
    font-size: 2.5rem !important; }
  .is-size-3-widescreen {
    font-size: 2rem !important; }
  .is-size-4-widescreen {
    font-size: 1.5rem !important; }
  .is-size-5-widescreen {
    font-size: 1.25rem !important; }
  .is-size-6-widescreen {
    font-size: 1rem !important; }
  .is-size-7-widescreen {
    font-size: 0.75rem !important; } }

@media screen and (min-width: 1408px) {
  .is-size-1-fullhd {
    font-size: 3rem !important; }
  .is-size-2-fullhd {
    font-size: 2.5rem !important; }
  .is-size-3-fullhd {
    font-size: 2rem !important; }
  .is-size-4-fullhd {
    font-size: 1.5rem !important; }
  .is-size-5-fullhd {
    font-size: 1.25rem !important; }
  .is-size-6-fullhd {
    font-size: 1rem !important; }
  .is-size-7-fullhd {
    font-size: 0.75rem !important; } }

.has-text-centered {
  text-align: center !important; }

.has-text-justified {
  text-align: justify !important; }

.has-text-left {
  text-align: left !important; }

.has-text-right {
  text-align: right !important; }

@media screen and (max-width: 768px) {
  .has-text-centered-mobile {
    text-align: center !important; } }

@media screen and (min-width: 769px), print {
  .has-text-centered-tablet {
    text-align: center !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .has-text-centered-tablet-only {
    text-align: center !important; } }

@media screen and (max-width: 1023px) {
  .has-text-centered-touch {
    text-align: center !important; } }

@media screen and (min-width: 1024px) {
  .has-text-centered-desktop {
    text-align: center !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .has-text-centered-desktop-only {
    text-align: center !important; } }

@media screen and (min-width: 1216px) {
  .has-text-centered-widescreen {
    text-align: center !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .has-text-centered-widescreen-only {
    text-align: center !important; } }

@media screen and (min-width: 1408px) {
  .has-text-centered-fullhd {
    text-align: center !important; } }

@media screen and (max-width: 768px) {
  .has-text-justified-mobile {
    text-align: justify !important; } }

@media screen and (min-width: 769px), print {
  .has-text-justified-tablet {
    text-align: justify !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .has-text-justified-tablet-only {
    text-align: justify !important; } }

@media screen and (max-width: 1023px) {
  .has-text-justified-touch {
    text-align: justify !important; } }

@media screen and (min-width: 1024px) {
  .has-text-justified-desktop {
    text-align: justify !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .has-text-justified-desktop-only {
    text-align: justify !important; } }

@media screen and (min-width: 1216px) {
  .has-text-justified-widescreen {
    text-align: justify !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .has-text-justified-widescreen-only {
    text-align: justify !important; } }

@media screen and (min-width: 1408px) {
  .has-text-justified-fullhd {
    text-align: justify !important; } }

@media screen and (max-width: 768px) {
  .has-text-left-mobile {
    text-align: left !important; } }

@media screen and (min-width: 769px), print {
  .has-text-left-tablet {
    text-align: left !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .has-text-left-tablet-only {
    text-align: left !important; } }

@media screen and (max-width: 1023px) {
  .has-text-left-touch {
    text-align: left !important; } }

@media screen and (min-width: 1024px) {
  .has-text-left-desktop {
    text-align: left !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .has-text-left-desktop-only {
    text-align: left !important; } }

@media screen and (min-width: 1216px) {
  .has-text-left-widescreen {
    text-align: left !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .has-text-left-widescreen-only {
    text-align: left !important; } }

@media screen and (min-width: 1408px) {
  .has-text-left-fullhd {
    text-align: left !important; } }

@media screen and (max-width: 768px) {
  .has-text-right-mobile {
    text-align: right !important; } }

@media screen and (min-width: 769px), print {
  .has-text-right-tablet {
    text-align: right !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .has-text-right-tablet-only {
    text-align: right !important; } }

@media screen and (max-width: 1023px) {
  .has-text-right-touch {
    text-align: right !important; } }

@media screen and (min-width: 1024px) {
  .has-text-right-desktop {
    text-align: right !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .has-text-right-desktop-only {
    text-align: right !important; } }

@media screen and (min-width: 1216px) {
  .has-text-right-widescreen {
    text-align: right !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .has-text-right-widescreen-only {
    text-align: right !important; } }

@media screen and (min-width: 1408px) {
  .has-text-right-fullhd {
    text-align: right !important; } }

.is-capitalized {
  text-transform: capitalize !important; }

.is-lowercase {
  text-transform: lowercase !important; }

.is-uppercase {
  text-transform: uppercase !important; }

.is-italic {
  font-style: italic !important; }

.is-underlined {
  text-decoration: underline !important; }

.has-text-weight-light {
  font-weight: 300 !important; }

.has-text-weight-normal {
  font-weight: 400 !important; }

.has-text-weight-medium {
  font-weight: 500 !important; }

.has-text-weight-semibold {
  font-weight: 600 !important; }

.has-text-weight-bold {
  font-weight: 700 !important; }

.is-family-primary {
  font-family: "Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif !important; }

.is-family-secondary {
  font-family: "Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif !important; }

.is-family-sans-serif {
  font-family: "Trebuchet MS", "Lucida Sans Unicode", "Lucida Grande", "Lucida Sans", Arial, sans-serif !important; }

.is-family-monospace {
  font-family: monospace !important; }

.is-family-code {
  font-family: monospace !important; }

.is-block {
  display: block !important; }

@media screen and (max-width: 768px) {
  .is-block-mobile {
    display: block !important; } }

@media screen and (min-width: 769px), print {
  .is-block-tablet {
    display: block !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .is-block-tablet-only {
    display: block !important; } }

@media screen and (max-width: 1023px) {
  .is-block-touch {
    display: block !important; } }

@media screen and (min-width: 1024px) {
  .is-block-desktop {
    display: block !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .is-block-desktop-only {
    display: block !important; } }

@media screen and (min-width: 1216px) {
  .is-block-widescreen {
    display: block !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .is-block-widescreen-only {
    display: block !important; } }

@media screen and (min-width: 1408px) {
  .is-block-fullhd {
    display: block !important; } }

.is-flex {
  display: flex !important; }

@media screen and (max-width: 768px) {
  .is-flex-mobile {
    display: flex !important; } }

@media screen and (min-width: 769px), print {
  .is-flex-tablet {
    display: flex !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .is-flex-tablet-only {
    display: flex !important; } }

@media screen and (max-width: 1023px) {
  .is-flex-touch {
    display: flex !important; } }

@media screen and (min-width: 1024px) {
  .is-flex-desktop {
    display: flex !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .is-flex-desktop-only {
    display: flex !important; } }

@media screen and (min-width: 1216px) {
  .is-flex-widescreen {
    display: flex !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .is-flex-widescreen-only {
    display: flex !important; } }

@media screen and (min-width: 1408px) {
  .is-flex-fullhd {
    display: flex !important; } }

.is-inline {
  display: inline !important; }

@media screen and (max-width: 768px) {
  .is-inline-mobile {
    display: inline !important; } }

@media screen and (min-width: 769px), print {
  .is-inline-tablet {
    display: inline !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .is-inline-tablet-only {
    display: inline !important; } }

@media screen and (max-width: 1023px) {
  .is-inline-touch {
    display: inline !important; } }

@media screen and (min-width: 1024px) {
  .is-inline-desktop {
    display: inline !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .is-inline-desktop-only {
    display: inline !important; } }

@media screen and (min-width: 1216px) {
  .is-inline-widescreen {
    display: inline !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .is-inline-widescreen-only {
    display: inline !important; } }

@media screen and (min-width: 1408px) {
  .is-inline-fullhd {
    display: inline !important; } }

.is-inline-block {
  display: inline-block !important; }

@media screen and (max-width: 768px) {
  .is-inline-block-mobile {
    display: inline-block !important; } }

@media screen and (min-width: 769px), print {
  .is-inline-block-tablet {
    display: inline-block !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .is-inline-block-tablet-only {
    display: inline-block !important; } }

@media screen and (max-width: 1023px) {
  .is-inline-block-touch {
    display: inline-block !important; } }

@media screen and (min-width: 1024px) {
  .is-inline-block-desktop {
    display: inline-block !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .is-inline-block-desktop-only {
    display: inline-block !important; } }

@media screen and (min-width: 1216px) {
  .is-inline-block-widescreen {
    display: inline-block !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .is-inline-block-widescreen-only {
    display: inline-block !important; } }

@media screen and (min-width: 1408px) {
  .is-inline-block-fullhd {
    display: inline-block !important; } }

.is-inline-flex {
  display: inline-flex !important; }

@media screen and (max-width: 768px) {
  .is-inline-flex-mobile {
    display: inline-flex !important; } }

@media screen and (min-width: 769px), print {
  .is-inline-flex-tablet {
    display: inline-flex !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .is-inline-flex-tablet-only {
    display: inline-flex !important; } }

@media screen and (max-width: 1023px) {
  .is-inline-flex-touch {
    display: inline-flex !important; } }

@media screen and (min-width: 1024px) {
  .is-inline-flex-desktop {
    display: inline-flex !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .is-inline-flex-desktop-only {
    display: inline-flex !important; } }

@media screen and (min-width: 1216px) {
  .is-inline-flex-widescreen {
    display: inline-flex !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .is-inline-flex-widescreen-only {
    display: inline-flex !important; } }

@media screen and (min-width: 1408px) {
  .is-inline-flex-fullhd {
    display: inline-flex !important; } }

.is-hidden {
  display: none !important; }

.is-sr-only {
  border: none !important;
  clip: rect(0, 0, 0, 0) !important;
  height: 0.01em !important;
  overflow: hidden !important;
  padding: 0 !important;
  position: absolute !important;
  white-space: nowrap !important;
  width: 0.01em !important; }

@media screen and (max-width: 768px) {
  .is-hidden-mobile {
    display: none !important; } }

@media screen and (min-width: 769px), print {
  .is-hidden-tablet {
    display: none !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .is-hidden-tablet-only {
    display: none !important; } }

@media screen and (max-width: 1023px) {
  .is-hidden-touch {
    display: none !important; } }

@media screen and (min-width: 1024px) {
  .is-hidden-desktop {
    display: none !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .is-hidden-desktop-only {
    display: none !important; } }

@media screen and (min-width: 1216px) {
  .is-hidden-widescreen {
    display: none !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .is-hidden-widescreen-only {
    display: none !important; } }

@media screen and (min-width: 1408px) {
  .is-hidden-fullhd {
    display: none !important; } }

.is-invisible {
  visibility: hidden !important; }

@media screen and (max-width: 768px) {
  .is-invisible-mobile {
    visibility: hidden !important; } }

@media screen and (min-width: 769px), print {
  .is-invisible-tablet {
    visibility: hidden !important; } }

@media screen and (min-width: 769px) and (max-width: 1023px) {
  .is-invisible-tablet-only {
    visibility: hidden !important; } }

@media screen and (max-width: 1023px) {
  .is-invisible-touch {
    visibility: hidden !important; } }

@media screen and (min-width: 1024px) {
  .is-invisible-desktop {
    visibility: hidden !important; } }

@media screen and (min-width: 1024px) and (max-width: 1215px) {
  .is-invisible-desktop-only {
    visibility: hidden !important; } }

@media screen and (min-width: 1216px) {
  .is-invisible-widescreen {
    visibility: hidden !important; } }

@media screen and (min-width: 1216px) and (max-width: 1407px) {
  .is-invisible-widescreen-only {
    visibility: hidden !important; } }

@media screen and (min-width: 1408px) {
  .is-invisible-fullhd {
    visibility: hidden !important; } }

/* Bulma Layout */
.hero {
  align-items: stretch;
  display: flex;
  flex-direction: column;
  justify-content: space-between; }
  .hero .navbar {
    background: none; }
  .hero .tabs ul {
    border-bottom: none; }
  .hero.is-white {
    background-color: #171717;
    color: #f2f2f2; }
    .hero.is-white a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-white strong {
      color: inherit; }
    .hero.is-white .title {
      color: #f2f2f2; }
    .hero.is-white .subtitle {
      color: rgba(242, 242, 242, 0.9); }
      .hero.is-white .subtitle a:not(.button),
      .hero.is-white .subtitle strong {
        color: #f2f2f2; }
    @media screen and (max-width: 1023px) {
      .hero.is-white .navbar-menu {
        background-color: #171717; } }
    .hero.is-white .navbar-item,
    .hero.is-white .navbar-link {
      color: rgba(242, 242, 242, 0.7); }
    .hero.is-white a.navbar-item:hover, .hero.is-white a.navbar-item.is-active,
    .hero.is-white .navbar-link:hover,
    .hero.is-white .navbar-link.is-active {
      background-color: #0a0a0a;
      color: #f2f2f2; }
    .hero.is-white .tabs a {
      color: #f2f2f2;
      opacity: 0.9; }
      .hero.is-white .tabs a:hover {
        opacity: 1; }
    .hero.is-white .tabs li.is-active a {
      color: #171717 !important;
      opacity: 1; }
    .hero.is-white .tabs.is-boxed a, .hero.is-white .tabs.is-toggle a {
      color: #f2f2f2; }
      .hero.is-white .tabs.is-boxed a:hover, .hero.is-white .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-white .tabs.is-boxed li.is-active a, .hero.is-white .tabs.is-boxed li.is-active a:hover, .hero.is-white .tabs.is-toggle li.is-active a, .hero.is-white .tabs.is-toggle li.is-active a:hover {
      background-color: #f2f2f2;
      border-color: #f2f2f2;
      color: #171717; }
    .hero.is-white.is-bold {
      background-image: linear-gradient(141deg, black 0%, #171717 71%, #252322 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-white.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, black 0%, #171717 71%, #252322 100%); } }
  .hero.is-black {
    background-color: #f2f2f2;
    color: #171717; }
    .hero.is-black a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-black strong {
      color: inherit; }
    .hero.is-black .title {
      color: #171717; }
    .hero.is-black .subtitle {
      color: rgba(23, 23, 23, 0.9); }
      .hero.is-black .subtitle a:not(.button),
      .hero.is-black .subtitle strong {
        color: #171717; }
    @media screen and (max-width: 1023px) {
      .hero.is-black .navbar-menu {
        background-color: #f2f2f2; } }
    .hero.is-black .navbar-item,
    .hero.is-black .navbar-link {
      color: rgba(23, 23, 23, 0.7); }
    .hero.is-black a.navbar-item:hover, .hero.is-black a.navbar-item.is-active,
    .hero.is-black .navbar-link:hover,
    .hero.is-black .navbar-link.is-active {
      background-color: #e6e6e6;
      color: #171717; }
    .hero.is-black .tabs a {
      color: #171717;
      opacity: 0.9; }
      .hero.is-black .tabs a:hover {
        opacity: 1; }
    .hero.is-black .tabs li.is-active a {
      color: #f2f2f2 !important;
      opacity: 1; }
    .hero.is-black .tabs.is-boxed a, .hero.is-black .tabs.is-toggle a {
      color: #171717; }
      .hero.is-black .tabs.is-boxed a:hover, .hero.is-black .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-black .tabs.is-boxed li.is-active a, .hero.is-black .tabs.is-boxed li.is-active a:hover, .hero.is-black .tabs.is-toggle li.is-active a, .hero.is-black .tabs.is-toggle li.is-active a:hover {
      background-color: #171717;
      border-color: #171717;
      color: #f2f2f2; }
    .hero.is-black.is-bold {
      background-image: linear-gradient(141deg, #ddd5d6 0%, #f2f2f2 71%, white 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-black.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #ddd5d6 0%, #f2f2f2 71%, white 100%); } }
  .hero.is-light {
    background-color: #363636;
    color: #fff; }
    .hero.is-light a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-light strong {
      color: inherit; }
    .hero.is-light .title {
      color: #fff; }
    .hero.is-light .subtitle {
      color: rgba(255, 255, 255, 0.9); }
      .hero.is-light .subtitle a:not(.button),
      .hero.is-light .subtitle strong {
        color: #fff; }
    @media screen and (max-width: 1023px) {
      .hero.is-light .navbar-menu {
        background-color: #363636; } }
    .hero.is-light .navbar-item,
    .hero.is-light .navbar-link {
      color: rgba(255, 255, 255, 0.7); }
    .hero.is-light a.navbar-item:hover, .hero.is-light a.navbar-item.is-active,
    .hero.is-light .navbar-link:hover,
    .hero.is-light .navbar-link.is-active {
      background-color: #292929;
      color: #fff; }
    .hero.is-light .tabs a {
      color: #fff;
      opacity: 0.9; }
      .hero.is-light .tabs a:hover {
        opacity: 1; }
    .hero.is-light .tabs li.is-active a {
      color: #363636 !important;
      opacity: 1; }
    .hero.is-light .tabs.is-boxed a, .hero.is-light .tabs.is-toggle a {
      color: #fff; }
      .hero.is-light .tabs.is-boxed a:hover, .hero.is-light .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-light .tabs.is-boxed li.is-active a, .hero.is-light .tabs.is-boxed li.is-active a:hover, .hero.is-light .tabs.is-toggle li.is-active a, .hero.is-light .tabs.is-toggle li.is-active a:hover {
      background-color: #fff;
      border-color: #fff;
      color: #363636; }
    .hero.is-light.is-bold {
      background-image: linear-gradient(141deg, #1f191a 0%, #363636 71%, #46403f 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-light.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #1f191a 0%, #363636 71%, #46403f 100%); } }
  .hero.is-dark {
    background-color: #e6e6e6;
    color: rgba(0, 0, 0, 0.7); }
    .hero.is-dark a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-dark strong {
      color: inherit; }
    .hero.is-dark .title {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-dark .subtitle {
      color: rgba(0, 0, 0, 0.9); }
      .hero.is-dark .subtitle a:not(.button),
      .hero.is-dark .subtitle strong {
        color: rgba(0, 0, 0, 0.7); }
    @media screen and (max-width: 1023px) {
      .hero.is-dark .navbar-menu {
        background-color: #e6e6e6; } }
    .hero.is-dark .navbar-item,
    .hero.is-dark .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-dark a.navbar-item:hover, .hero.is-dark a.navbar-item.is-active,
    .hero.is-dark .navbar-link:hover,
    .hero.is-dark .navbar-link.is-active {
      background-color: #d9d9d9;
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-dark .tabs a {
      color: rgba(0, 0, 0, 0.7);
      opacity: 0.9; }
      .hero.is-dark .tabs a:hover {
        opacity: 1; }
    .hero.is-dark .tabs li.is-active a {
      color: #e6e6e6 !important;
      opacity: 1; }
    .hero.is-dark .tabs.is-boxed a, .hero.is-dark .tabs.is-toggle a {
      color: rgba(0, 0, 0, 0.7); }
      .hero.is-dark .tabs.is-boxed a:hover, .hero.is-dark .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-dark .tabs.is-boxed li.is-active a, .hero.is-dark .tabs.is-boxed li.is-active a:hover, .hero.is-dark .tabs.is-toggle li.is-active a, .hero.is-dark .tabs.is-toggle li.is-active a:hover {
      background-color: rgba(0, 0, 0, 0.7);
      border-color: rgba(0, 0, 0, 0.7);
      color: #e6e6e6; }
    .hero.is-dark.is-bold {
      background-image: linear-gradient(141deg, #d1c7c9 0%, #e6e6e6 71%, #f3f2f2 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-dark.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #d1c7c9 0%, #e6e6e6 71%, #f3f2f2 100%); } }
  .hero.is-primary {
    background-color: #0E87C8;
    color: rgba(0, 0, 0, 0.7); }
    .hero.is-primary a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-primary strong {
      color: inherit; }
    .hero.is-primary .title {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-primary .subtitle {
      color: rgba(0, 0, 0, 0.9); }
      .hero.is-primary .subtitle a:not(.button),
      .hero.is-primary .subtitle strong {
        color: rgba(0, 0, 0, 0.7); }
    @media screen and (max-width: 1023px) {
      .hero.is-primary .navbar-menu {
        background-color: #0E87C8; } }
    .hero.is-primary .navbar-item,
    .hero.is-primary .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-primary a.navbar-item:hover, .hero.is-primary a.navbar-item.is-active,
    .hero.is-primary .navbar-link:hover,
    .hero.is-primary .navbar-link.is-active {
      background-color: #0c77b0;
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-primary .tabs a {
      color: rgba(0, 0, 0, 0.7);
      opacity: 0.9; }
      .hero.is-primary .tabs a:hover {
        opacity: 1; }
    .hero.is-primary .tabs li.is-active a {
      color: #0E87C8 !important;
      opacity: 1; }
    .hero.is-primary .tabs.is-boxed a, .hero.is-primary .tabs.is-toggle a {
      color: rgba(0, 0, 0, 0.7); }
      .hero.is-primary .tabs.is-boxed a:hover, .hero.is-primary .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-primary .tabs.is-boxed li.is-active a, .hero.is-primary .tabs.is-boxed li.is-active a:hover, .hero.is-primary .tabs.is-toggle li.is-active a, .hero.is-primary .tabs.is-toggle li.is-active a:hover {
      background-color: rgba(0, 0, 0, 0.7);
      border-color: rgba(0, 0, 0, 0.7);
      color: #0E87C8; }
    .hero.is-primary.is-bold {
      background-image: linear-gradient(141deg, #0384a0 0%, #0E87C8 71%, #0a74e6 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-primary.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #0384a0 0%, #0E87C8 71%, #0a74e6 100%); } }
  .hero.is-link {
    background-color: #467CFB;
    color: rgba(0, 0, 0, 0.7); }
    .hero.is-link a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-link strong {
      color: inherit; }
    .hero.is-link .title {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-link .subtitle {
      color: rgba(0, 0, 0, 0.9); }
      .hero.is-link .subtitle a:not(.button),
      .hero.is-link .subtitle strong {
        color: rgba(0, 0, 0, 0.7); }
    @media screen and (max-width: 1023px) {
      .hero.is-link .navbar-menu {
        background-color: #467CFB; } }
    .hero.is-link .navbar-item,
    .hero.is-link .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-link a.navbar-item:hover, .hero.is-link a.navbar-item.is-active,
    .hero.is-link .navbar-link:hover,
    .hero.is-link .navbar-link.is-active {
      background-color: #2d6afa;
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-link .tabs a {
      color: rgba(0, 0, 0, 0.7);
      opacity: 0.9; }
      .hero.is-link .tabs a:hover {
        opacity: 1; }
    .hero.is-link .tabs li.is-active a {
      color: #467CFB !important;
      opacity: 1; }
    .hero.is-link .tabs.is-boxed a, .hero.is-link .tabs.is-toggle a {
      color: rgba(0, 0, 0, 0.7); }
      .hero.is-link .tabs.is-boxed a:hover, .hero.is-link .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-link .tabs.is-boxed li.is-active a, .hero.is-link .tabs.is-boxed li.is-active a:hover, .hero.is-link .tabs.is-toggle li.is-active a, .hero.is-link .tabs.is-toggle li.is-active a:hover {
      background-color: rgba(0, 0, 0, 0.7);
      border-color: rgba(0, 0, 0, 0.7);
      color: #467CFB; }
    .hero.is-link.is-bold {
      background-image: linear-gradient(141deg, #0f7fff 0%, #467CFB 71%, #5c71ff 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-link.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #0f7fff 0%, #467CFB 71%, #5c71ff 100%); } }
  .hero.is-info {
    background-color: #7A8690;
    color: rgba(0, 0, 0, 0.7); }
    .hero.is-info a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-info strong {
      color: inherit; }
    .hero.is-info .title {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-info .subtitle {
      color: rgba(0, 0, 0, 0.9); }
      .hero.is-info .subtitle a:not(.button),
      .hero.is-info .subtitle strong {
        color: rgba(0, 0, 0, 0.7); }
    @media screen and (max-width: 1023px) {
      .hero.is-info .navbar-menu {
        background-color: #7A8690; } }
    .hero.is-info .navbar-item,
    .hero.is-info .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-info a.navbar-item:hover, .hero.is-info a.navbar-item.is-active,
    .hero.is-info .navbar-link:hover,
    .hero.is-info .navbar-link.is-active {
      background-color: #6d7983;
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-info .tabs a {
      color: rgba(0, 0, 0, 0.7);
      opacity: 0.9; }
      .hero.is-info .tabs a:hover {
        opacity: 1; }
    .hero.is-info .tabs li.is-active a {
      color: #7A8690 !important;
      opacity: 1; }
    .hero.is-info .tabs.is-boxed a, .hero.is-info .tabs.is-toggle a {
      color: rgba(0, 0, 0, 0.7); }
      .hero.is-info .tabs.is-boxed a:hover, .hero.is-info .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-info .tabs.is-boxed li.is-active a, .hero.is-info .tabs.is-boxed li.is-active a:hover, .hero.is-info .tabs.is-toggle li.is-active a, .hero.is-info .tabs.is-toggle li.is-active a:hover {
      background-color: rgba(0, 0, 0, 0.7);
      border-color: rgba(0, 0, 0, 0.7);
      color: #7A8690; }
    .hero.is-info.is-bold {
      background-image: linear-gradient(141deg, #577480 0%, #7A8690 71%, #828ea1 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-info.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #577480 0%, #7A8690 71%, #828ea1 100%); } }
  .hero.is-success {
    background-color: #029736;
    color: rgba(0, 0, 0, 0.7); }
    .hero.is-success a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-success strong {
      color: inherit; }
    .hero.is-success .title {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-success .subtitle {
      color: rgba(0, 0, 0, 0.9); }
      .hero.is-success .subtitle a:not(.button),
      .hero.is-success .subtitle strong {
        color: rgba(0, 0, 0, 0.7); }
    @media screen and (max-width: 1023px) {
      .hero.is-success .navbar-menu {
        background-color: #029736; } }
    .hero.is-success .navbar-item,
    .hero.is-success .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-success a.navbar-item:hover, .hero.is-success a.navbar-item.is-active,
    .hero.is-success .navbar-link:hover,
    .hero.is-success .navbar-link.is-active {
      background-color: #027e2d;
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-success .tabs a {
      color: rgba(0, 0, 0, 0.7);
      opacity: 0.9; }
      .hero.is-success .tabs a:hover {
        opacity: 1; }
    .hero.is-success .tabs li.is-active a {
      color: #029736 !important;
      opacity: 1; }
    .hero.is-success .tabs.is-boxed a, .hero.is-success .tabs.is-toggle a {
      color: rgba(0, 0, 0, 0.7); }
      .hero.is-success .tabs.is-boxed a:hover, .hero.is-success .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-success .tabs.is-boxed li.is-active a, .hero.is-success .tabs.is-boxed li.is-active a:hover, .hero.is-success .tabs.is-toggle li.is-active a, .hero.is-success .tabs.is-toggle li.is-active a:hover {
      background-color: rgba(0, 0, 0, 0.7);
      border-color: rgba(0, 0, 0, 0.7);
      color: #029736; }
    .hero.is-success.is-bold {
      background-image: linear-gradient(141deg, #006613 0%, #029736 71%, #00b35c 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-success.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #006613 0%, #029736 71%, #00b35c 100%); } }
  .hero.is-warning {
    background-color: #ffd100;
    color: rgba(0, 0, 0, 0.7); }
    .hero.is-warning a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-warning strong {
      color: inherit; }
    .hero.is-warning .title {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-warning .subtitle {
      color: rgba(0, 0, 0, 0.9); }
      .hero.is-warning .subtitle a:not(.button),
      .hero.is-warning .subtitle strong {
        color: rgba(0, 0, 0, 0.7); }
    @media screen and (max-width: 1023px) {
      .hero.is-warning .navbar-menu {
        background-color: #ffd100; } }
    .hero.is-warning .navbar-item,
    .hero.is-warning .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-warning a.navbar-item:hover, .hero.is-warning a.navbar-item.is-active,
    .hero.is-warning .navbar-link:hover,
    .hero.is-warning .navbar-link.is-active {
      background-color: #e6bc00;
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-warning .tabs a {
      color: rgba(0, 0, 0, 0.7);
      opacity: 0.9; }
      .hero.is-warning .tabs a:hover {
        opacity: 1; }
    .hero.is-warning .tabs li.is-active a {
      color: #ffd100 !important;
      opacity: 1; }
    .hero.is-warning .tabs.is-boxed a, .hero.is-warning .tabs.is-toggle a {
      color: rgba(0, 0, 0, 0.7); }
      .hero.is-warning .tabs.is-boxed a:hover, .hero.is-warning .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-warning .tabs.is-boxed li.is-active a, .hero.is-warning .tabs.is-boxed li.is-active a:hover, .hero.is-warning .tabs.is-toggle li.is-active a, .hero.is-warning .tabs.is-toggle li.is-active a:hover {
      background-color: rgba(0, 0, 0, 0.7);
      border-color: rgba(0, 0, 0, 0.7);
      color: #ffd100; }
    .hero.is-warning.is-bold {
      background-image: linear-gradient(141deg, #cc8500 0%, #ffd100 71%, #fffc1a 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-warning.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #cc8500 0%, #ffd100 71%, #fffc1a 100%); } }
  .hero.is-danger {
    background-color: #F91F52;
    color: rgba(0, 0, 0, 0.7); }
    .hero.is-danger a:not(.button):not(.dropdown-item):not(.tag):not(.pagination-link.is-current),
    .hero.is-danger strong {
      color: inherit; }
    .hero.is-danger .title {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-danger .subtitle {
      color: rgba(0, 0, 0, 0.9); }
      .hero.is-danger .subtitle a:not(.button),
      .hero.is-danger .subtitle strong {
        color: rgba(0, 0, 0, 0.7); }
    @media screen and (max-width: 1023px) {
      .hero.is-danger .navbar-menu {
        background-color: #F91F52; } }
    .hero.is-danger .navbar-item,
    .hero.is-danger .navbar-link {
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-danger a.navbar-item:hover, .hero.is-danger a.navbar-item.is-active,
    .hero.is-danger .navbar-link:hover,
    .hero.is-danger .navbar-link.is-active {
      background-color: #f8073f;
      color: rgba(0, 0, 0, 0.7); }
    .hero.is-danger .tabs a {
      color: rgba(0, 0, 0, 0.7);
      opacity: 0.9; }
      .hero.is-danger .tabs a:hover {
        opacity: 1; }
    .hero.is-danger .tabs li.is-active a {
      color: #F91F52 !important;
      opacity: 1; }
    .hero.is-danger .tabs.is-boxed a, .hero.is-danger .tabs.is-toggle a {
      color: rgba(0, 0, 0, 0.7); }
      .hero.is-danger .tabs.is-boxed a:hover, .hero.is-danger .tabs.is-toggle a:hover {
        background-color: rgba(242, 242, 242, 0.1); }
    .hero.is-danger .tabs.is-boxed li.is-active a, .hero.is-danger .tabs.is-boxed li.is-active a:hover, .hero.is-danger .tabs.is-toggle li.is-active a, .hero.is-danger .tabs.is-toggle li.is-active a:hover {
      background-color: rgba(0, 0, 0, 0.7);
      border-color: rgba(0, 0, 0, 0.7);
      color: #F91F52; }
    .hero.is-danger.is-bold {
      background-image: linear-gradient(141deg, #e5005c 0%, #F91F52 71%, #ff3340 100%); }
      @media screen and (max-width: 768px) {
        .hero.is-danger.is-bold .navbar-menu {
          background-image: linear-gradient(141deg, #e5005c 0%, #F91F52 71%, #ff3340 100%); } }
  .hero.is-small .hero-body {
    padding: 1.5rem; }
  @media screen and (min-width: 769px), print {
    .hero.is-medium .hero-body {
      padding: 9rem 4.5rem; } }
  @media screen and (min-width: 769px), print {
    .hero.is-large .hero-body {
      padding: 18rem 6rem; } }
  .hero.is-halfheight .hero-body, .hero.is-fullheight .hero-body, .hero.is-fullheight-with-navbar .hero-body {
    align-items: center;
    display: flex; }
    .hero.is-halfheight .hero-body > .container, .hero.is-fullheight .hero-body > .container, .hero.is-fullheight-with-navbar .hero-body > .container {
      flex-grow: 1;
      flex-shrink: 1; }
  .hero.is-halfheight {
    min-height: 50vh; }
  .hero.is-fullheight {
    min-height: 100vh; }

.hero-video {
  overflow: hidden; }
  .hero-video video {
    left: 50%;
    min-height: 100%;
    min-width: 100%;
    position: absolute;
    top: 50%;
    transform: translate3d(-50%, -50%, 0); }
  .hero-video.is-transparent {
    opacity: 0.3; }
  @media screen and (max-width: 768px) {
    .hero-video {
      display: none; } }

.hero-buttons {
  margin-top: 1.5rem; }
  @media screen and (max-width: 768px) {
    .hero-buttons .button {
      display: flex; }
      .hero-buttons .button:not(:last-child) {
        margin-bottom: 0.75rem; } }
  @media screen and (min-width: 769px), print {
    .hero-buttons {
      display: flex;
      justify-content: center; }
      .hero-buttons .button:not(:last-child) {
        margin-right: 1.5rem; } }

.hero-head,
.hero-foot {
  flex-grow: 0;
  flex-shrink: 0; }

.hero-body {
  flex-grow: 1;
  flex-shrink: 0;
  padding: 3rem 1.5rem; }
  @media screen and (min-width: 769px), print {
    .hero-body {
      padding: 3rem 3rem; } }

.section {
  padding: 3rem 1.5rem; }
  @media screen and (min-width: 1024px) {
    .section {
      padding: 3rem 3rem; }
      .section.is-medium {
        padding: 9rem 4.5rem; }
      .section.is-large {
        padding: 18rem 6rem; } }

.footer {
  background-color: #171717;
  padding: 3rem 1.5rem 6rem; }

/* THEME COLORS... */

.dark-theme {
  --primary-color: #171717;
  --secondary-color: #333;
  --highlight-color: #333;
  --font-color: ghostwhite;
  --label-color: rgb(200, 200, 200);
  --soft-color: rgb(175, 175, 175);
  --modal-glass-color: rgba(100, 100, 100, 0.95);
  --orange-color: #ef7521;
  --danger-color: #f91f52;
  --warning-color: #ffd100;
  --success-color: #029736;
  --link-color: #467cfb;
  --info-color: #7a8690;
  --teal-color: #0d7dba;
  --purple-color: #b86bff;
  --light-color: #3d3d3d;
  --focus-border-color: #426Bff;
  --focus-shadow-color: rgba(66, 107, 255, 0.25);
  --color-scheme: dark;
}

.light-theme {
  --primary-color: ghostwhite;
  --secondary-color: #eee;
  --highlight-color: #eee;
  --font-color: #171717;
  --label-color: rgb(85, 85, 85);
  --soft-color: rgb(175, 175, 175);
  --modal-glass-color: rgba(51, 51, 51, 0.95);
  --orange-color: #ef7521;
  --danger-color: #c3002f;
  --warning-color: #cc4100;
  --success-color: #245d38;
  --link-color: #3e8ed0;
  --info-color: #001970;
  --teal-color: #35647e;
  --purple-color: #9426fc;
  --light-color: #dbdbdb;
  --focus-border-color: #485fc7;
  --focus-shadow-color: rgba(72, 95, 199, 0.25);
  --color-scheme: light;
}

.theme-independent-white-font {
  color: ghostwhite !important;
}

.theme-independent-dark-font {
  color: #171717 !important;
}

* {
  margin: 0;
}

html {
  color-scheme: var(--color-scheme);
  height: 100%;
}

/* https://css-tricks.com/couple-takes-sticky-footer/ */

body {
  font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
  height: 100%;
}

.main-content {
  /* padding for top nav with app-logo */
  padding-top: 32px;
  flex: 1 0 auto;
}

.main-footer {
  display: flex;
  align-items: end;
  height: 24px;
  flex-shrink: 0;
}

/* scrollbar */
/* ::-webkit-scrollbar {
  width: 0.75em;
} */

/* hrs a bit less spacing */
hr {
  margin: .5rem 0;
  height: 1px;
  background-color: var(--soft-color);
}

/* Bulma overrides */
/* .input,
.textarea,
select,
.select {
  box-shadow: none;
  border-color: transparent;
} */

.full-height--32px {
  height: calc(100vh - 32px);
}

.full-height--56px {
  height: calc(100vh - 56px);
}

.body-has-nav {
  padding-top: 32px;
}

.modal-background {
  background-color: var(--modal-glass-color);
}

/* helper so that bulma buttons wrap text and size vertically */
.tall-button {
  white-space: normal !important;
  height: auto !important;
}

/* Outline bulma button type elements on focus */
.focus-border,
.select>select:focus,
.input:focus,
.textarea:focus,
.navbar-burger:focus,
.delete:focus,
.button:focus,
.button.is-white:focus,
.button.is-primary:focus,
.button.is-white:focus,
.button.is-black:focus,
.button.is-dark:focus,
.button.is-light:focus,
.button.is-link:focus,
.button.is-info:focus,
.button.is-success:focus,
.button.is-warning:focus,
.button.is-danger:focus {
  border: 1px solid var(--focus-border-color) !important;
  box-shadow: 0 0 0 0.125em var(--focus-shadow-color) !important;
}

.input[type="date"], .input[type="datetime-local"] {
  display: block;
}

.error-border {
  border: 1px solid var(--danger-color);
}

/* Vertical align bulma/material icons */
.icon-align {
  position: relative;
  top: 6px;
}

/* is-flex without !important */
.is-flex-polite {
  display: flex;
}

.white-space-wrap {
  white-space: pre-wrap;
}

.sticky {
  position: sticky;
  z-index: 5;
}

.sticky-header {
  position: sticky;
  top: 32px;
  z-index: 5;
}

.sticky-header.has-small-tabs {
  top: 64px;
  z-index: 4;
}

.sticky-header.has-tabs {
  top: 81px;
  z-index: 4;
}

.force-32-height {
  height: 32px !important;
}

/* workaround for BULMA columns horizontal scrolling */
.columns {
  max-width: 100%;
  margin-left: 0;
  margin-right: 0;
  margin-top: 0;
}

/* Sort indicators */
.sort-asc::after {
  content: "";
  margin-left: 8px;
}

.sort-desc::after {
  content: "";
  margin-left: 8px;
}

.a-disabled {
  pointer-events: none;
  cursor: default;
}

/* Override for bulma media content overflow-x */
.overflow-x-inherit {
  overflow-x: inherit !important;
}

/* simple bottom-right overlay button */
.bottom-right-overlay {
  position: fixed;
  bottom: 0;
  right: 0;
  margin: 1rem;
  z-index: 1;
}

/* layout */

/* horizontal scrolling container */
.horizontal-container {
  display: flex;
  flex-wrap: nowrap;
  overflow-x: auto;
}

.horizontal-container-element {
  flex: 0 0 auto;
}

.force-max-width-816 {
  max-width: 816px !important;
}

/* helpers */
.no-events {
  cursor: default;
  pointer-events: none;
}

.border-radius {
  border-radius: 6px;
}

.border-radius-medium {
  border-radius: 4px;
}

.border-radius-small {
  border-radius: 2px;
}

.transparent-background {
  background: transparent;
}

.border-top {
  border-top: 1px solid var(--secondary-color);
}

.border-bottom {
  border-bottom: 1px solid var(--secondary-color);
}

.border-right {
  border-right: 1px solid var(--secondary-color);
}

.border-full {
  border: 1px solid var(--secondary-color);
}

.light-border-bottom {
  border-bottom: 1px solid var(--light-color);
}

.light-border {
  border: 1px solid var(--light-color);
}

.highlight-border {
  border: 1px solid var(--highlight-color);
}

.highlight-border-bottom {
  border-bottom: 1px solid var(--highlight-color);
}

.danger-border {
  border: 1px solid var(--danger-color);
}

.warning-border {
  border: 1px solid var(--warning-color);
}

.success-border {
  border: 1px solid var(--success-color);
}

.link-border {
  border: 1px solid var(--link-color);
}

.info-border {
  border: 1px solid var(--info-color);
}

.teal-border {
  border: 1px solid var(--teal-color);
}

.white-border {
  border: 1px solid var(--primary-color);
}

.dark-border {
  border: 1px solid var(--font-color);
}

.purple-text {
  color: var(--purple-color) !important;
}

.highlight-link-outline:hover,
.highlight-link-outline:focus {
  outline: 1px solid var(--link-color);
}

.display-block {
  display: block;
}

.height-full {
  height: 100%;
}

.highlight-item {
  background-color: var(--highlight-color);
  color: var(--font-color);
}

.soft-background {
  background-color: var(--soft-color);
}

.highlight-background {
  background-color: var(--highlight-color);
}

.highlight-hover:hover {
  background-color: var(--highlight-color);
}

.is-size-7-polite {
  font-size: .75rem;
}

/* spinner (taken from how bulma does the is-loading spinner) */
.bulma-spinner {
  animation: spinAround 750ms infinite linear;
  border: 2px solid;
  border-radius: 9999px;
  border-right-color: transparent;
  border-top-color: transparent;
  display: block;
  height: 1em;
  width: 1em;
  position: relative;
}

.spinner {
  animation-name: spinner;
  animation-duration: 3500ms;
  animation-iteration-count: infinite;
  animation-timing-function: linear;
}

/* blink/flash */
.flashing {
  animation: flash 1s ease-in 3;
}

/* animations */
@-moz-keyframes spinner {
  from {
    -moz-transform: rotate(0deg);
  }

  to {
    -moz-transform: rotate(360deg);
  }
}

@-webkit-keyframes spinner {
  from {
    -webkit-transform: rotate(0deg);
  }

  to {
    -webkit-transform: rotate(360deg);
  }
}

@keyframes spinner {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

@-webkit-keyframes flash {
  50% {
    opacity: 25%;
  }
}

@keyframes flash {
  50% {
    opacity: 25%;
  }
}

</style>

  <script src="https://unpkg.com/vue@3"></script>
<script src="https://unpkg.com/vue-router@4"></script>
</head>

<body>
  <div id="app" style="height: 100%;">
    <main-view></main-view>
  </div>
</body>

<script>

</script>

<script type="text/js-worker" id="worker-filtering">
const fnregistry = {
  'item__tags': (val, row) => row.item.tags.includes(val),
  'project__platforms': (val, row) => row.project.platforms.includes(val),
  'project__categories': (val, row) => row.project.categories.includes(val),
  'project__dependsOn': (val, row) => row.project.dependsOnProjects.includes(val),
  'project__dependentFor': (val, row) => row.project.dependentForProjects.some((proj) => proj.id === val),
};

const actions = {
  filter: ({ criteria, records, headers }) => {
    records = typeof records === 'string' ? JSON.parse(records) : records;
    criteria = typeof criteria === 'string' ? JSON.parse(criteria) : criteria;
    headers = typeof headers === 'string' ? JSON.parse(headers) : headers;

    const crit = criteria;
    const lowerSearch = crit.search.toLowerCase();
    const sort = crit.sort;
    const filter = crit.filter;
    const dates = crit.dates;

    const filterProps = Object.keys(filter).filter(
      (prop) => filter[prop] !== undefined && filter[prop] !== ""
    );
    const dateProps = Object.keys(dates).filter(
      (prop) => !!dates[prop] && (!!dates[prop].start || !!dates[prop].end)
    );

    const filtered = records
      .filter((row) => {
        return (
          headers.some(({ prop }) =>
            String(row[prop]).toLowerCase().includes(lowerSearch)
          ) &&
          filterProps.every((prop) => {
            /** @type {string[]} */
            const filterSelections = filter[prop] || [];
            const val = row[prop];
            const lookup = fnregistry[prop];
            return filterSelections.some(filteredValue =>
              (lookup) ? lookup(filteredValue, row)
                : String(val) === String(filteredValue)
            );
          }) &&
          (dateProps.every(prop => {
            const d = dates[prop];
            const val = row[prop];
            return (!d.start || val >= d.start)
              && (!d.end || val <= d.end);
          }))
        );
      })
      .sort((a, b) => {
        if (a[sort.header] === null) return 1;
        if (b[sort.header] === null) return -1;

        const sorter = sort.ascending
          ? a[sort.header] < b[sort.header]
          : a[sort.header] > b[sort.header];

        return sorter ? -1 : 1;
      });

    console.log('FILTERED FROM THE WORKER'); //DEBUG

    return filtered;
  }
};

self.onmessage = (event) => {
  const action = actions[event.data.action];
  if (!action)
    throw new TypeError(`Worker action ${event.data.action} not found!`);

  const result = action.call(null, ...(event.data.args || []));

  postMessage({
    id: event.data.id,
    action: event.data.action,
    result
  });
};
</script>
<script type="text/js-worker" id="worker-fts">
const actions = {
  fts: (search, models, { limit = 20 } = {}) => {
    models = typeof models === 'string' ? JSON.parse(models) : models;

    const itemsMap = models.items.reduce((o, i) => {
      o[i.id] = i;
      return o;
    }, {});

    const projects = models.projects
      .filter(row => Object.values(row).some(val => String(val).toLocaleLowerCase().includes(search)))
      .sort((a, b) => a.name > b.name ? 1 : -1);
    const items = models.items
      .filter(row => Object.values(row).some(val => String(val).toLocaleLowerCase().includes(search)))
      .sort((a, b) => a.name > b.name ? 1 : -1);
    const comments = models.comments
      .filter(row => Object.values(row).some(val => String(val).toLocaleLowerCase().includes(search)))
      .map(c => itemsMap[c.item])
      .filter(c => !!c && !items.some(i => i.id === c.id))
      .sort((a, b) => a.name > b.name ? 1 : -1);

    const results = [
      ...projects.map(model => ({ type: 'Project', model })),
      ...items.map(model => ({ type: 'Item', model })),
      ...comments.map(model => ({ type: 'Item', model }))
    ];

    return results.slice(0, limit);
  }
};

self.onmessage = (event) => {
  const action = actions[event.data.action];
  if (!action)
    throw new TypeError(`Worker action ${event.data.action} not found!`);

  const result = action.call(null, ...(event.data.args || []));

  postMessage({
    id: event.data.id,
    action: event.data.action,
    result
  });
};
</script>


<script>
/**
 * @typedef {object} AdtTimeOptions
 * @prop {number} [hours]
 * @prop {number} [minutes] 
 * @prop {number} [seconds]
 * @prop {number} [milliseconds] 
 */

/**
 * @typedef {object} AdtCreateOptions
 * @prop {number} [year]
 * @prop {number} [month]
 * @prop {number} [day]
 * @prop {number} [hours]
 * @prop {number} [minutes] 
 * @prop {number} [seconds]
 * @prop {number} [milliseconds] 
 * @prop {boolean} [utc]
 */

/**
 * @typedef {object} AdtModifyOptions
 * @prop {number} [years] 
 * @prop {number} [months] 
 * @prop {number} [days]
 * @prop {number} [hours]
 * @prop {number} [minutes] 
 * @prop {number} [seconds]
 * @prop {number} [milliseconds]  
 * @prop {boolean} [utc]
 */

class AppsDateTime {

  static adt() {
    /**
     * Applies options to the date
     * @param {Date} date - date
     * @param {AdtCreateOptions} [options]
     */
    const apply = (date, options = {}) => {
      if (options.utc) {
        if (options.year !== undefined) date.setUTCFullYear(options.year);
        if (options.month !== undefined) date.setUTCMonth(options.month - 1);
        if (options.day !== undefined) date.setUTCDate(options.day);
        if (options.hours !== undefined) date.setUTCHours(options.hours);
        if (options.minutes !== undefined) date.setUTCMinutes(options.minutes);
        if (options.seconds !== undefined) date.setUTCSeconds(options.seconds);
        if (options.milliseconds !== undefined) date.setUTCMilliseconds(options.milliseconds);
      } else {
        if (options.year !== undefined) date.setFullYear(options.year);
        if (options.month !== undefined) date.setMonth(options.month - 1);
        if (options.day !== undefined) date.setDate(options.day);
        if (options.hours !== undefined) date.setHours(options.hours);
        if (options.minutes !== undefined) date.setMinutes(options.minutes);
        if (options.seconds !== undefined) date.setSeconds(options.seconds);
        if (options.milliseconds !== undefined) date.setMilliseconds(options.milliseconds);
      }

      return date;
    };

    /**
     * Applies arithmetic to date
     * @param {Date} date - date
     * @param {-1 | 1} sign - -1 | 1
     * @param {AdtModifyOptions} [options]
     */
    const arithmetic = (date, sign, options = {}) => {

      if (options.utc) {
        if (options.years !== undefined) date.setUTCFullYear(date.getUTCFullYear() + (sign * options.years));
        if (options.months !== undefined) date.setUTCMonth(date.getUTCMonth() + (sign * options.months));
        if (options.days !== undefined) date.setUTCDate(date.getUTCDate() + (sign * options.days));
        if (options.hours !== undefined) date.setUTCHours(date.getUTCHours() + (sign * options.hours));
        if (options.minutes !== undefined) date.setUTCMinutes(date.getUTCMinutes() + (sign * options.minutes));
        if (options.seconds !== undefined) date.setUTCSeconds(date.getUTCSeconds() + (sign * options.seconds));
        if (options.milliseconds !== undefined) date.setUTCMilliseconds(date.getUTCMilliseconds() + (sign * options.milliseconds));
      } else {
        if (options.years !== undefined) date.setFullYear(date.getFullYear() + (sign * options.years));
        if (options.months !== undefined) date.setMonth(date.getMonth() + (sign * options.months));
        if (options.days !== undefined) date.setDate(date.getDate() + (sign * options.days));
        if (options.hours !== undefined) date.setHours(date.getHours() + (sign * options.hours));
        if (options.minutes !== undefined) date.setMinutes(date.getMinutes() + (sign * options.minutes));
        if (options.seconds !== undefined) date.setSeconds(date.getSeconds() + (sign * options.seconds));
        if (options.milliseconds !== undefined) date.setMilliseconds(date.getMilliseconds() + (sign * options.milliseconds));
      }

      return date;
    };

    /** @param {AdtCreateOptions} [options] */
    const build = ({ year, month, day, hours, minutes, seconds, milliseconds } = {}) => {
      const date = new Date();
      apply(date, { year, month, day, hours, minutes, seconds, milliseconds });
      return date;
    };

    /** @param {string} dtstr */
    const fromString = (dtstr) => {
      const datePattern = /^\d+-\d{2}-\d{2}$/;
      const datetimePattern = /^\d+-\d{2}-\d{2}(T|\s)\d{2}:\d{2}:\d{2}(\.\d{3}Z?)?$/;

      const isUTC = dtstr.endsWith('Z');

      const isDate = datePattern.test(dtstr);
      const isDateTime = datetimePattern.test(dtstr);
      if (!isDate && !isDateTime)
        return null;

      const dt = new Date(1970, 0, 1);
      if (isDate) {
        const [year, month, day] = dtstr.split('-').map((part) => parseInt(part, 10));
        apply(dt, { year, month, day, hours: 0, minutes: 0, seconds: 0, milliseconds: 0 });
      }

      if (isDateTime) {
        const delimByT = dtstr.includes('T');
        const [date, timepart] = dtstr.split(delimByT ? 'T' : ' ');
        const [year, month, day] = date.split('-').map((part) => parseInt(part, 10));
        const [time, ms] = timepart.split('.');
        const [hours, minutes, seconds] = time.split(':').map((part) => parseInt(part, 10));
        apply(dt, { year, month, day, hours, minutes, seconds, milliseconds: parseInt(ms, 10), utc: isUTC });
      }

      if (Number.isNaN(dt.getTime()))
        return null;

      return dt;
    };

    /**
     * @param {Date} dt - date
     * @param {AdtCreateOptions} [options]
     */
    const update = (dt, { year, month, day, hours, minutes, seconds, milliseconds } = {}) => {
      const date = new Date(dt);
      apply(date, { year, month, day, hours, minutes, seconds, milliseconds });
      return date;
    };

    /**
     * @param {Date} dt - date
     * @param {AdtModifyOptions} [options]
     */
    const add = (dt, { years, months, days, hours, minutes, seconds, milliseconds } = {}) => {
      const date = new Date(dt);
      arithmetic(date, 1, { years, months, days, hours, minutes, seconds, milliseconds });
      return date;
    };

    /**
     * @param {Date} dt - date
     * @param {AdtModifyOptions} [options]
     */
    const subtract = (dt, { years, months, days, hours, minutes, seconds, milliseconds } = {}) => {
      const date = new Date(dt);
      arithmetic(date, -1, { years, months, days, hours, minutes, seconds, milliseconds });
      return date;
    };

    /** @param {Date[]} dts */
    const min = (dts) => {
      if (dts.length === 0)
        return null;

      const ms = Math.min(...dts.map(dt => dt.getTime()));
      return new Date(ms);
    };

    /** @param {Date[]} dts */
    const max = (dts) => {
      if (dts.length === 0)
        return null;

      const ms = Math.max(...dts.map(dt => dt.getTime()));
      return new Date(ms);
    };

    /**
     * @param {Date} larger - Larger date
     * @param {Date} smaller - Smaller date
     * @param {AdtTimeOptions} [options]
     */
    const prettyDiff = (larger, smaller, { hours, minutes, seconds, milliseconds } = {}) => {
      const yearDiff = larger.getFullYear() - smaller.getFullYear();
      const monthDiff = larger.getMonth() - smaller.getMonth();
      const dayDiff = larger.getDate() - smaller.getDate();
      const hoursDiff = larger.getHours() - smaller.getHours();
      const minutesDiff = larger.getMinutes() - smaller.getMinutes();
      const secondsDiff = larger.getSeconds() - smaller.getSeconds();
      const millisecondsDiff = larger.getMilliseconds() - smaller.getMilliseconds();

      const allMonths = (yearDiff * 12) + monthDiff - (dayDiff < 0);
      const totalYears = Math.floor(allMonths / 12);
      const totalMonths = allMonths % 12;

      const adjustedDays = dayDiff - (hoursDiff < 0);
      const totalDays = adjustedDays >= 0 ? adjustedDays : new Date(larger.getFullYear(), larger.getMonth() + 1, 0).getDate() + adjustedDays;

      const adjustedHours = hoursDiff - (minutesDiff < 0);
      const totalHours = adjustedHours >= 0 ? adjustedHours : 24 + adjustedHours;

      const adjustedMinutes = minutesDiff - (secondsDiff < 0);
      const totalMinutes = adjustedMinutes >= 0 ? adjustedMinutes : 60 + adjustedMinutes;

      const adjustedSeconds = secondsDiff - (millisecondsDiff < 0);
      const totalSeconds = adjustedSeconds >= 0 ? adjustedSeconds : 60 + adjustedSeconds;

      const totalMilliseconds = ((millisecondsDiff < 0) * 1000) + millisecondsDiff;

      const showMilliseconds = !!milliseconds;
      const showSeconds = !!seconds || showMilliseconds;
      const showMinutes = !!minutes || showSeconds;
      const showHours = !!hours || showMinutes;

      const parts = [];
      if (totalYears > 0)
        parts.push(`${totalYears} year${totalYears > 1 ? 's' : ''}`);

      if (totalMonths > 0)
        parts.push(`${totalMonths} month${totalMonths > 1 ? 's' : ''}`);

      if (totalDays > 0)
        parts.push(`${totalDays} day${totalDays > 1 ? 's' : ''}`);

      if (showHours && totalHours > 0)
        parts.push(`${totalHours} hr${totalHours > 1 ? 's' : ''}`);

      if (showMinutes && totalMinutes > 0)
        parts.push(`${totalMinutes} min`);

      if (showSeconds && totalSeconds > 0)
        parts.push(`${totalSeconds} s`);

      if (showMilliseconds && totalMilliseconds > 0)
        parts.push(`${totalMilliseconds} ms`);

      return parts.join(', ');
    };

    /**
     * @param {Date} one - date
     * @param {Date} two - date
     */
    const diff = (one, two) => {
      const larger = one > two ? one : two;
      const smaller = one < two ? one : two;

      const milliseconds = larger.getTime() - smaller.getTime();
      const seconds = parseFloat((milliseconds / 1000).toFixed(2));
      const minutes = parseFloat((seconds / 60).toFixed(2));
      const hours = parseFloat((minutes / 60).toFixed(2));
      const days = parseFloat((hours / 24).toFixed(2));

      const yearDiff = larger.getFullYear() - smaller.getFullYear();
      const monthDiff = larger.getMonth() - smaller.getMonth();
      const dayDiff = larger.getDate() - smaller.getDate();

      // bit of just an approx here....
      const monthRatio = parseFloat((dayDiff / 30.437).toFixed(2));
      const totalMonths = monthDiff + monthRatio + (yearDiff * 12);

      const months = totalMonths;
      const years = parseFloat((months / 12).toFixed(10));

      const pretty = ({ hours, minutes, seconds, milliseconds } = {}) => prettyDiff(larger, smaller, { hours, minutes, seconds, milliseconds });

      return { years, months, days, hours, minutes, seconds, milliseconds, pretty };
    };

    /**
     * @param {Date} dt - date
     * @param {Date} start - date
     * @param {Date} end - date
     * @param {object} [options] - optional options
     * @param {boolean} [options.time] - compare times
     * @param {boolean} [options.includeStart] - inclusive for the start date
     * @param {boolean} [options.includeEnd] - inclusive for the end date
     */
    const compare = (dt, start, end, { time = true, includeStart, includeEnd } = {}) => {
      const d = new Date(dt);
      const s = new Date(start);
      const e = new Date(end);

      if (!time) {
        apply(d, { hours: 0, seconds: 0, milliseconds: 0 });
        apply(s, { hours: 0, seconds: 0, milliseconds: 0 });
        apply(e, { hours: 0, seconds: 0, milliseconds: 0 });
      }

      const gt = includeStart ? d >= s : d > s;
      const lt = includeEnd ? d <= e : d < e;

      return { gt, lt };
    };

    /**
     * Calculates interval from now to the provided date
     * @param {Date} to - date
     * @param {object} [options] - optional options
     * @param {'year' | 'month' | 'day'} [options.cutoff] - when to cutoff to just the date vs the diff
     */
    const interval = (to, { cutoff } = {}) => {
      const from = new Date();
      const isPast = from > to;
      const larger = isPast ? from : to;
      const smaller = !isPast ? from : to;

      const { years, months, days, hours, minutes, seconds, pretty } = diff(from, to);

      const hasBeenYears = years >= 1;
      const hasBeenMonths = months >= 1;
      const hasBeenDays = days >= 1;
      const hasBeenHours = hasBeenDays || hours >= 1;
      const hasBeenMinutes = hasBeenHours || minutes >= 1;
      const hasBeenSeconds = hasBeenMinutes || seconds >= 1;

      const isPastCutoff = !!cutoff
        && (
          (cutoff === 'year' && hasBeenYears)
          || (cutoff === 'month' && hasBeenMonths)
          || (cutoff === 'day' && hasBeenDays)
        );

      if (isPastCutoff)
        return to.toLocaleDateString();

      const suffix = isPast ? ' ago' : '';

      if (hasBeenMonths)
        return `${prettyDiff(larger, smaller)}${suffix}`;

      if (hasBeenDays)
        return `${prettyDiff(larger, smaller, { hours: true })}${suffix}`;

      if (hasBeenHours || hasBeenMinutes)
        return `${pretty({ minutes: true })}${suffix}`;

      if (hasBeenSeconds)
        return `${pretty({ seconds: true })}${suffix}`;

      return 'Just now';
    };

    /**
     * @param {Date} dt - date
     * @param {Date} start - date
     * @param {Date} end - date
     * @param {object} [options] - optional options
     * @param {boolean} [options.time] - compare times
     * @param {boolean} [options.includeStart] - inclusive for the start date
     * @param {boolean} [options.includeEnd] - inclusive for the end date
     */
    const between = (dt, start, end, { time = true, includeStart, includeEnd } = {}) => {
      const { gt, lt } = compare(dt, start, end, { time, includeStart, includeEnd });
      return gt && lt;
    };

    /**
     * @param {Date} dt - date
     * @param {Date} start - date
     * @param {Date} end - date
     * @param {object} [options] - optional options
     * @param {boolean} [options.time] - compare times
     * @param {boolean} [options.includeStart] - inclusive for the start date
     * @param {boolean} [options.includeEnd] - inclusive for the end date
     */
    const clamp = (dt, start, end, { time = true, includeStart, includeEnd } = {}) => {
      const { gt, lt } = compare(dt, start, end, { time, includeStart, includeEnd });
      return (gt && lt) || (!gt && !lt) ? new Date(dt)
        : !gt ? new Date(start)
          : new Date(end);
    };

    const api = {
      build,
      fromString,
      update,
      add,
      subtract,
      min,
      max,
      diff,
      interval,
      between,
      clamp
    };

    return api;
  }

}
class AppsSchemaValidation {

  /**
   * Not sure if this is helpfull, but could be mildly for performance when do a lot of real-time validation
   * Saves a little time and space to have a cached 'singleton' type instances, but could be a bad pattern, dunno really...
   */
  static instance() {
    if (!AppsSchemaValidation.__instance__)
      AppsSchemaValidation.__instance__ = AppsSchemaValidation.asv();

    /** @type {Asv>} */
    const instance = AppsSchemaValidation.__instance__;
    return instance;
  }

  static asv() {
    //TODO: what kinda options do we even have here?
    // dunno...

    //TODO: factor out some share functionality so we dont need quite as much duplication!
    //TODO: static array definitiions ['string', 'number'] would be valid for ['abc', 123] but not [123, 'abc']
    //TODO: enum and enumlist type supprt

    //TODO: parser for errors... maybe an array of errors with prop names, could be useful here and there

    const sym = Symbol('validation');

    const isRawSimpleSchema = (obj) => !isNullish(obj) && typeof obj.type === 'string';
    const isSchema = (obj) => !isNullish(obj) && !!obj[sym];
    const isSchemaType = (obj) => isSchema(obj) || Object.values(obj).every(isSchema);

    const isNullish = (v) => v === null || v === undefined || v === '';
    const isMissing = (v) => isNullish(v) || Number.isNaN(v) || (Array.isArray(v) && v.length === 0);
    const verifyWithMessage = (valid, /** @type {string} */ msg) => !valid && msg;

    const helpers = {
      functionInGlobal: (prop, fnName) => (prop in globalThis && !isNullish(globalThis[prop]) && typeof globalThis[prop][fnName] === 'function'),
      pseudoRandomId: () => {
        //TODO: improve this
        const chars = ['ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'];
        const LEN = 10;
        let id = '';
        for (let i = 0; i < LEN; i++) {
          const char = chars[Math.floor(Math.random() * chars.length)];
          id += char;
        }
        return id;
      },
      generateId: () => helpers.functionInGlobal('Utilities', 'getUuid')
        ? Utilities.getUuid()
        : helpers.functionInGlobal('crypto', 'randomUUID')
          ? crypto.randomUUID()
          : helpers.pseudoRandomId(),
      getAuditUser: () => helpers.functionInGlobal('Session', 'getActiveUser')
        ? Session.getActiveUser().getEmail()
        : null
    };

    //TODO: val or length check....
    const checks = {
      required: (val) => verifyWithMessage(!isMissing(val), 'Is required'),
      max: (/** @type {number} */ mx) => (val) => !isNullish(val) && verifyWithMessage(val <= mx, `Must be less than ${mx}`),
      min: (/** @type {number} */ mn) => (val) => !isNullish(val) && verifyWithMessage(val >= mn, `Must be greater than ${mn}`),
      maxlength: (/** @type {number} */ mx) => (val) => !isNullish(val) && verifyWithMessage(val.length <= mx, `Must be less than ${mx} in length`),
      minlength: (/** @type {number} */ mn) => (val) => !isNullish(val) && verifyWithMessage(val.length >= mn, `Must be greater than ${mn} in length`),
      any: {
        is: () => false,
        toStorage: (val) => String(val),
        fromStorage: (val) => val,
      },
      number: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'number', 'Is not a number'),
        toStorage: (val) => isNullish(val) ? null : Number(val),
        fromStorage: (val) => isNullish(val) ? null : Number(val),
      },
      string: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'string', 'Is not a string'),
        toStorage: (val) => isNullish(val) ? null : String(val),
        fromStorage: (val) => isNullish(val) ? null : String(val),
      },
      id: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'string', 'Is not a string id'),
        toStorage: (val) => isNullish(val) ? null : String(val),
        fromStorage: (val) => isNullish(val) ? null : String(val),
      },
      audit: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'string', 'Is not a string audit'),
        toStorage: (val) => isNullish(val) ? null : String(val),
        fromStorage: (val) => isNullish(val) ? null : String(val),
      },
      url: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'string' && val.startsWith('https://'), "Is not an 'https://' url"),
        sanitize: (/** @type {string} */ val) => isNullish(val) ? null
          : /^(https:\/\/)/i.test(val) ? val : null,
        toStorage: (val) => isNullish(val) ? null : checks.url.sanitize(val),
        fromStorage: (val) => isNullish(val) ? null : checks.url.sanitize(val),
      },
      boolean: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'boolean', 'Is not a boolean'),
        toStorage: (val) => isNullish(val) ? null : Boolean(val),
        fromStorage: (val) => isNullish(val) ? null : Boolean(val),
      },
      date: {
        is: (val) => !isNullish(val) && verifyWithMessage(val instanceof Date, 'Is not a date'),
        toStorage: (val) => isNullish(val) ? null : new Date(val),
        fromStorage: (val) => isNullish(val) ? null : new Date(val),
      },
      datestring: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'string' && /[\d]+-[\d]{2}-[\d]{2}/.test(val), 'Is not a date-string'),
        toStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'string' && val !== '') return val;
          if (val instanceof Date) return val.toJSON().split('T')[0];
          return null;
        },
        fromStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'string' && val !== '') return val;
          if (val instanceof Date) return val.toJSON().split('T')[0];
          return null;
        },
      },
      datetimestring: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'string' && /[\d]+-[\d]{2}-[\d]{2}T[\d]{2}:[\d]{2}(:[\d]{0,2})?/.test(val), 'Is not a datetime string'),
        toStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'string' && val !== '') return val;
          if (val instanceof Date) return val.toJSON().split('.')[0];
          return null;
        },
        fromStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'string' && val !== '') return val;
          if (val instanceof Date) return `${val.getFullYear()}-${String(val.getMonth() + 1).padStart(2, '0')}-${String(val.getDate()).padStart(2, '0')}T${String(val.getHours()).padStart(2, '0')}:${String(val.getMinutes()).padStart(2, '0')}:00`;
          return null;
        },
      },
      jsondate: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'string' && /[\d]+-[\d]{2}-[\d]{2}T[\d]{2}:[\d]{2}:[\d]{2}\.[\d]{3}[A-Z]/.test(val), 'Is not a json date string'),
        toStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'string' && val !== '') return val;
          if (val instanceof Date) return val.toJSON();
          return null;
        },
        fromStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'string' && val !== '') return val;
          if (val instanceof Date) return val.toJSON();
          return null;
        },
      },
      timestamp: {
        is: (val) => checks.jsondate.is(val),
        toStorage: (val) => {
          if (typeof val === 'string' && val !== '') return val;
          if (val instanceof Date) return val.toJSON();
          return null;
        },
        fromStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'string' && val !== '') return val;
          if (val instanceof Date) return val.toJSON();
          if (typeof val === 'object' && !isNullish(val.seconds)) {
            const tts = new Date(0);
            tts.setUTCSeconds(val.seconds);
            return tts.toJSON();
          }
          return null;
        },
      },
      array: {
        is: (val) => !isNullish(val) && verifyWithMessage(Array.isArray(val), 'Is not an array'),
        toStorageRaw: (val) => {
          if (isNullish(val)) return null;
          if (Array.isArray(val)) return val;
          return null;
        },
        toStorage: (val) => {
          if (isNullish(val)) return null;
          if (Array.isArray(val)) return JSON.stringify(val);
          if (typeof val === 'string' && val !== '') return val;
          return null;
        },
        fromStorage: (val) => {
          if (isNullish(val)) return null;
          if (Array.isArray(val)) return val;
          if (typeof val === 'string') {
            const parsed = JSON.parse(val);
            return Array.isArray(parsed) ? parsed : null;
          };
          return null;
        },
      },
      object: {
        is: (val) => !isNullish(val) && verifyWithMessage(typeof val === 'object', 'Is not an object'),
        toStorageRaw: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'object') return val;
          return null;
        },
        toStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'object') return JSON.stringify(val);
          if (typeof val === 'string' && val !== '') return val;
          return null;
        },
        fromStorage: (val) => {
          if (isNullish(val)) return null;
          if (typeof val === 'object') return val;
          if (typeof val === 'string') return JSON.parse(val);
          return null;
        },
      },
      file: {
        is: (val) => checks.object.is(val),
        toStorage: (val) => checks.object.toStorage(val),
        fromStorage: (val) => checks.object.fromStorage(val),
        types: (types) => (val) => !isNullish(val) && verifyWithMessage(types.some(val.type), 'Is not an accepted file type'),
        size: (mx) => (val) => !isNullish(val) && verifyWithMessage(val.size <= mx, 'Is too large'),
      }
    };

    /**
     * Base object for scheme definition
     * @param {AsvSchemeType} type 
     */
    const base = (type) => {
      /** @type {BaseAsvTypeContext} */
      const ctx = {
        type,
        rules: [],
        client: {},
        defaultFn: undefined,
        updateFn: undefined,
        sub: {
          schema: undefined,
          isSimple: false
        },
        valid: {
          isValid: (val, mdl) => !ctx.valid.check || verifyWithMessage(ctx.valid.check(val, mdl), ctx.valid.msg),
          check: undefined,
          msg: ''
        },
      };

      const hasLength = ctx.type === 'array'
        || ctx.type === 'string';

      /** @type {BaseAsvType} */
      const api = {
        [sym]: true,
        type: ctx.type,
        required: () => {
          ctx.rules.push(checks.required);
          ctx.client.required = true;
          return api;
        },
        max: (mx) => {
          if (hasLength) {
            ctx.rules.push(checks.maxlength(mx));
            ctx.client.maxlength = mx;
          } else {
            ctx.rules.push(checks.max(mx));
            ctx.client.max = mx;
          }
          return api;
        },
        min: (mn) => {
          if (hasLength) {
            ctx.rules.push(checks.minlength(mn));
            ctx.client.minlength = mn;
          } else {
            ctx.rules.push(checks.min(mn));
            ctx.client.min = mn;
          }
          return api;
        },
        default: (fn) => {
          ctx.defaultFn = fn;
          return api;
        },
        update: (fn) => {
          ctx.updateFn = fn;
          return api;
        },
        valid: (fn, msg) => {
          // fn = (val, model) => {}
          ctx.valid.check = fn;
          ctx.valid.msg = msg || 'Is not valid';
          ctx.rules.push(ctx.valid.isValid);
          return api;
        },
        resolver: (fn) => {
          ctx.resolver = fn;
          return api;
        },
        schema: (obj) => {
          ctx.sub.isSimple = isSchema(obj) || isRawSimpleSchema(obj);
          ctx.sub.schema = isSchema(obj) ? { v: obj }
            : isSchemaType(obj) ? obj
              : ctx.sub.isSimple ? fromRaw({ v: obj }) : fromRaw(obj);
          return api;
        },
        client: {
          get: ctx.client,
          set: (/** @type {{ [key: string]: string }} */ vals) => {
            Object.entries(vals).forEach(([key, val]) => ctx.client[key] = val);
            return api;
          }
        },

        evaluate: (val, model) => {
          const results = {
            errors: ctx.rules.map(rule => rule(val, model)).filter(r => !!r),
            hasError: false,
          };
          let hasError = results.errors.length > 0;

          if (ctx.sub.schema && !isNullish(val)) {

            if (ctx.type === 'array' && Array.isArray(val)) {
              const subvalidation = val.map(entry => {
                const res = validateComplete(ctx.sub.schema, ctx.sub.isSimple ? { v: entry } : entry, model);

                hasError = hasError || res.hasError;
                return ctx.sub.isSimple ? res.item.v : res;
              });
              results.items = subvalidation;

            } else {

              const subvalidation = validateComplete(ctx.sub.schema, val, model);
              results.errors = [...results.errors, ...subvalidation.errors];
              results.item = subvalidation.item;
              hasError = hasError || subvalidation.hasError;

            }
          }

          results.hasError = hasError;
          return results;
        },
        apply: (val, model, { isNew } = {}) => {
          if (isNew && isNullish(val) && ctx.defaultFn) val = ctx.defaultFn();
          if (ctx.updateFn) val = ctx.updateFn(model);
          if (ctx.resolver) val = ctx.resolver(val);
          if (ctx.sub.schema && !isNullish(val))

            if (ctx.type === 'array' && Array.isArray(val)) {

              val = val.map(entry => {
                const res = applyComplete(ctx.sub.schema, ctx.sub.isSimple ? { v: entry } : entry, model, { isNew, noStringify: true })
                return ctx.sub.isSimple ? res.v : res;
              });

            } else {

              val = applyComplete(ctx.sub.schema, val, model, { isNew })

            }

          return val;
        },
        exec: (val, model, { isNew, noStringify } = {}) => {
          const applied = api.apply(val, model, { isNew });
          const validation = api.evaluate(applied, model);
          const storage = noStringify ? checks[ctx.type].toStorageRaw(applied) : checks[ctx.type].toStorage(applied);
          return { validation, storage };
        },

        parse: (val) => checks[ctx.type].fromStorage(val),
      };

      return { ctx, api };
    };

    const types = {

      /** @returns {AsvAny} */
      any: () => {
        const { api } = base('any');

        return api;
      },

      /** @returns {AsvNumber} */
      number: () => {
        const { ctx, api } = base('number');

        ctx.rules.push(checks.number.is);
        api.client.set({ type: 'number' });

        return api;
      },

      /** @returns {AsvString} */
      string: () => {
        const { ctx, api } = base('string');

        ctx.rules.push(checks.string.is);
        api.client.set({ type: 'text' });

        return api;
      },

      /** @returns {AsvId} */
      id: () => {
        const { ctx, api } = base('id');

        ctx.rules.push(checks.id.is);
        api.client.set({ type: 'text' });

        ctx.defaultFn = helpers.generateId;

        return api;
      },

      /** @returns {AsvUrl} */
      url: () => {
        const { ctx, api } = base('url');

        ctx.rules.push(checks.url.is);
        api.client.set({ type: 'text' });

        return api;
      },

      /** @returns {AsvBoolean} */
      boolean: () => {
        const { ctx, api } = base('boolean');

        ctx.rules.push(checks.boolean.is);

        return api;
      },

      /** @returns {AsvDate} */
      date: () => {
        const { ctx, api } = base('date');

        ctx.rules.push(checks.date.is);
        api.client.set({ type: 'date' });

        return api;
      },

      /** @returns {AsvDateString} */
      datestring: () => {
        const { ctx, api } = base('datestring');

        ctx.rules.push(checks.datestring.is);
        api.client.set({ type: 'date' });

        return api;
      },

      /** @returns {AsvDateTimeString} */
      datetimestring: () => {
        const { ctx, api } = base('datetimestring');

        ctx.rules.push(checks.datetimestring.is);
        api.client.set({ type: 'datetime-local' });

        return api;
      },

      /** @returns {AsvJsonDate} */
      jsondate: () => {
        const { ctx, api } = base('jsondate');

        ctx.rules.push(checks.jsondate.is);
        api.client.set({ type: 'date' });

        return api;
      },

      /** @returns {AsvTimestamp} */
      timestamp: () => {
        const { ctx, api } = base('timestamp');

        ctx.rules.push(checks.timestamp.is);
        api.client.set({ type: 'datetime-local' });

        api.default = () => {
          ctx.defaultFn = () => new Date().toJSON();
          return api;
        };

        api.update = () => {
          ctx.updateFn = () => new Date().toJSON();
          return api;
        };

        return api;
      },

      /** @returns {AsvAudit} */
      audit: () => {
        const { ctx, api } = base('audit');

        ctx.rules.push(checks.audit.is);
        api.client.set({ type: 'text' });

        const getter = helpers.getAuditUser;

        api.default = () => {
          ctx.defaultFn = getter;
          return api;
        };

        api.update = () => {
          ctx.updateFn = getter;
          return api;
        };

        return api;
      },

      /** @returns {AsvArray} */
      array: () => {
        const { ctx, api } = base('array');

        ctx.rules.push(checks.array.is);

        return api;
      },

      /** @returns {AsvObject} */
      object: () => {
        const { ctx, api } = base('object');

        ctx.rules.push(checks.object.is);

        return api;
      },

      /** @returns {AsvFile} */
      file: () => {
        const { ctx, api } = base('file');

        ctx.rules.push(checks.file.is);
        api.client.set({ max: 1 });

        ctx.sub.schema = {
          id: types.string(),
          name: types.string(),
          url: types.url(),
          size: types.number(),
          type: types.string()
        };

        api.types = (types) => {
          const acceptedTypes = Array.isArray(types) ? types : String(types).split(',').map(t => t.trim());
          ctx.rules.push(checks.file.types(acceptedTypes));
          ctx.client.accept = acceptedTypes.join(',');
          return api;
        };

        api.size = (mx) => {
          ctx.rules.push(checks.file.size(mx));
          ctx.client.maxsize = mx;
          return api;
        };

        return api;
      }

    };

    const validateComplete = (scheme, obj, model) => {
      const results = { errors: [], item: {}, hasError: false };
      Object.entries(scheme).forEach(([key, sch]) => {
        const value = obj ? obj[key] : null;
        const evaluated = sch.evaluate(value, model);
        results.item[key] = evaluated;
        results.hasError = results.hasError || evaluated.hasError;
      });

      return results;
    };

    /** @type {AsvValidate} */
    const validate = (schema, obj, { throwError } = {}) => {
      const results = validateComplete(schema, obj, obj);
      if (throwError && results.hasError)
        throw new Error(JSON.stringify(results));

      return results;
    };

    /** @type {AsvApply} */
    const applyComplete = (scheme, obj, model, { isNew, noStringify }) => {
      const newObj = {};
      Object.entries(scheme).forEach(([key, sch]) => {
        const value = obj ? obj[key] : null;

        newObj[key] = sch.apply(value, model, { isNew, noStringify });
      });

      return newObj;
    };

    const execComplete = (scheme, obj, model, { isNew, noStringify }) => {
      const newObj = {};
      const results = {};
      let hasError = false;
      Object.entries(scheme).forEach(([key, sch]) => {
        const value = obj ? obj[key] : null;
        const { storage, validation } = sch.exec(value, model, { isNew, noStringify });

        newObj[key] = storage;
        results[key] = validation.errors;
        hasError = hasError || validation.hasError;
      });

      return { newObj, results, hasError };
    };

    /** @type {AsvExec} */
    const exec = (scheme, obj, { isNew, throwError }) => {
      const { newObj, results, hasError } = execComplete(scheme, obj, obj, { isNew });
      if (hasError && throwError)
        throw new Error(JSON.stringify(results));

      return newObj;
    };

    const errorsToArray = (results, path = '') => {
      // get array of failures with path and errors
      if (!results.hasError)
        return [];

      /** @type {{ path: string, errors: string[] }[]} */
      let errors = [];

      let topErrors = results.errors || [];
      if (topErrors.length > 0)
        errors.push({ path, errors: topErrors });

      const item = results.item || {};

      Object.entries(item).forEach(([key, res]) => {
        if (res.errors.length > 0)
          errors.push({ path: `${path}${key}`, errors: res.errors });

        if (Array.isArray(res.items))
          errors = [...errors, ...res.items.map((ch, i) => errorsToArray(ch, `${path}${key}[${i}].`)).flat()];

        if (res.item)
          errors = [...errors, ...errorsToArray(res, `${path}${key}.`)];
      });

      const items = results.items || [];
      items.forEach(res => {
        errors = [...errors, ...errorsToArray(res, path)];
      });

      return errors;
    };

    /** @type {AsvParse} */
    const parseComplete = (scheme, obj) => {
      const newObj = {};
      Object.entries(scheme).forEach(([key, sch]) => {
        const value = obj ? obj[key] : null;

        newObj[key] = sch.parse(value);
      });

      return newObj;
    };

    /** @type {AsvGenerate} */
    const genComplete = (scheme, obj, model, { empty }) => {
      Object.entries(scheme).forEach(([key, sch]) => {
        let value = empty ? null : sch.apply(null, model, { isNew: true });
        if (!isNullish(value) && typeof value === 'object' && sch.schema)
          value = genComplete(sch.schema, value, model);
        obj[key] = value;
      });
      return obj;
    };

    /** @type {AsvGetSchemaContext} */
    const build = (schema) => getContext(schema);

    /** @type {AsvFromRaw} */
    const fromRaw = (raw) => {
      const built = {};

      Object.entries(raw).forEach(([key, sch]) => {
        const creator = types[sch.type];
        if (!creator)
          throw new Error(`${sch.type} is not a valid AppsSchemaValidation type!`);

        const type = creator();

        if (sch.required) type.required();
        if (sch.max !== undefined) type.max(sch.max);
        if (sch.min !== undefined) type.min(sch.min);
        if (sch.default) type.default(sch.default);
        if (sch.update) {
          if (typeof sch.update === 'function')
            type.update(sch.update);
          else
            type.update(sch.update.fn, sch.update.msg);
        }

        if (sch.schema) type.schema(sch.schema);
        if (sch.resolver) type.resolver(sch.resolver);

        //File
        if (sch.types) type.types(sch.types);
        if (sch.size) type.size(sch.size);

        //Client
        if (sch.client) type.client.set(sch.client);

        built[key] = type;
      });

      return built;
    };

    /** 
     * @template R
     * 
     * @param {AsvRawSchema<R>} raw
     */
    const compile = (raw) => {
      
      const built = fromRaw(raw);
      return build(built);
    };

    /** @type {AsvGetSchemaContext} */
    const getContext = (schema) => {
      return {
        schema,
        test: (obj) => validate(schema, obj, { throwError: true }),
        apply: (obj, { isNew } = {}) => applyComplete(schema, obj, obj, { isNew }),
        validate: (obj, { throwError = false } = {}) => validate(schema, obj, { throwError }),
        exec: (obj, { isNew, throwError = true } = {}) => exec(schema, obj, { isNew, throwError }),
        errors: (obj) => errorsToArray(validate(schema, obj)),
        parse: (obj) => parseComplete(schema, obj),
        generate: (obj = {}, { empty = false } = {}) => genComplete(schema, obj, obj, { empty })
      };
    };

    return {
      ...types,
      build,
      compile
    };
  }

}
class DataModel {

  /**
   * Data model definition for app data
   */
  static model() {
    return {
      Project: {
        _key: {
          type: 'string'
        },
        id: {
          type: 'id'
        },
        name: {
          required: true,
          type: 'string'
        },
        description: {
          required: true,
          type: 'string',
          client: { type: 'textarea' }
        },
        version: {
          required: true,
          type: 'string'
        },
        status: {
          required: true,
          type: 'string'
        },
        categories: {
          type: 'array',
          default: () => []
        },
        platforms: {
          required: true,
          type: 'array',
          default: () => []
        },
        dependsOnProjects: {
          type: 'array',
          default: () => []
        },
        priority: {
          required: true,
          type: 'string',
        },
        accessibilityStatus: {
          type: 'string',
        },
        iteration: {
          type: 'datestring'
        },
        planningNotes: {
          type: 'string',
          client: { type: 'textarea' }
        },
        program: {
          required: true,
          type: 'string',
        },
        hasPII: {
          type: 'boolean',
        },
        links: {
          type: 'array',
          default: () => [],
          resolver: (val) => val.map(({ name, url, type }) => ({ name, url, type }))
        },
        owner: {
          required: true,
          type: 'string',
          default: () => 'Me'
        },
        backup: {
          required: true,
          type: 'string',
        },
        isPublic: {
          type: 'boolean',
        },
        createdBy: {
          type: 'audit',
          default: true
        },
        createdDate: {
          type: 'timestamp',
          default: true
        },
        modifiedBy: {
          type: 'audit',
          update: true
        },
        modifiedDate: {
          type: 'timestamp',
          update: true
        }
      },

      Deployment: {
        _key: {
          type: 'string'
        },
        id: {
          type: 'id'
        },
        project: {
          required: true,
          type: 'string'
        },
        description: {
          type: 'string',
          client: { type: 'textarea' }
        },
        version: {
          required: true,
          type: 'string'
        },
        owner: {
          required: true,
          type: 'string',
          default: () => 'Me'
        },
        scheduled: {
          type: 'datetimestring'
        },
        date: {
          required: true,
          type: 'datestring',
        },
        tags: {
          type: 'array',
          default: () => []
        },
        notes: {
          type: 'string',
        },
        createdBy: {
          type: 'audit',
          default: true
        },
        createdDate: {
          type: 'timestamp',
          default: true
        },
        modifiedBy: {
          type: 'audit',
          update: true
        },
        modifiedDate: {
          type: 'timestamp',
          update: true
        }
      },

      Timeline: {
        _key: {
          type: 'string'
        },
        id: {
          type: 'id'
        },
        projects: {
          type: 'array',
          default: () => []
        },
        name: {
          required: true,
          type: 'string'
        },
        description: {
          type: 'string',
          client: { type: 'textarea' }
        },
        status: {
          required: true,
          type: 'string'
        },
        effort: {
          type: 'number',
        },
        priority: {
          type: 'number',
        },
        magnitude: {
          type: 'number',
        },
        impacts: {
          type: 'array',
          default: () => []
        },
        notes: {
          type: 'string',
          client: { type: 'textarea' }
        },
        startDate: {
          required: true,
          type: 'datestring',
        },
        endDate: {
          required: true,
          type: 'datestring',
        },
        createdBy: {
          type: 'audit',
          default: true
        },
        createdDate: {
          type: 'timestamp',
          default: true
        },
        modifiedBy: {
          type: 'audit',
          update: true
        },
        modifiedDate: {
          type: 'timestamp',
          update: true
        }
      },

      Item: {
        _key: {
          type: 'string'
        },
        id: {
          type: 'id'
        },
        itemNumber: {
          type: 'number',
          default: () => {
            if (typeof MockDatabase === 'undefined') return 0;
            const max = Math.max(...MockDatabase.db.Items.map(itm => itm.itemNumber));
            return max + 1;
          }
        },
        project: {
          type: 'string',
          required: true
        },
        deployment: {
          type: 'string',
        },
        parent: {
          type: 'string'
        },
        name: {
          type: 'string',
          required: true
        },
        description: {
          type: 'string',
          client: { type: 'textarea' }
        },
        tags: {
          type: 'array',
          default: () => []
        },
        files: {
          type: 'array',
          default: () => [],
          max: 10,
          schema: { type: 'file' }
        },
        version: {
          required: true,
          type: 'string'
        },
        type: {
          required: true,
          type: 'string'
        },
        priority: {
          required: true,
          type: 'string'
        },
        status: {
          required: true,
          type: 'string'
        },
        scheduledDate: {
          type: 'datetimestring'
        },
        hours: {
          type: 'number'
        },
        resolvedDate: {
          type: 'datestring'
        },
        closedDate: {
          type: 'datestring'
        },
        assignee: {
          required: true,
          type: 'string'
        },
        createdBy: {
          type: 'audit',
          default: true
        },
        createdDate: {
          type: 'timestamp',
          default: true
        },
        modifiedBy: {
          type: 'audit',
          update: true
        },
        modifiedDate: {
          type: 'timestamp',
          update: true
        }
      },

      Comment: {
        _key: {
          type: 'string'
        },
        id: {
          type: 'id'
        },
        item: {
          required: true,
          type: 'string'
        },
        comment: {
          required: true,
          type: 'string',
          client: { type: 'textarea' }
        },
        createdBy: {
          type: 'audit',
          default: true
        },
        createdDate: {
          type: 'timestamp',
          default: true
        },
        modifiedBy: {
          type: 'audit',
          update: true
        },
        modifiedDate: {
          type: 'timestamp',
          update: true
        }
      },

      User: {
        _key: {
          type: 'string'
        },
        id: {
          type: 'id'
        },
        email: {
          required: true,
          type: 'string'
        },
        settings: {
          type: 'object',
          default: () => ({ favoriteProjects: [] })
        },
        role: {
          type: 'string'
        },
        createdDate: {
          type: 'timestamp',
          default: true
        }
      },

      Config: {
        _key: {
          type: 'string'
        },
        id: {
          required: true,
          type: 'string'
        },
        json: {
          required: true,
          type: 'object'
        }
      }
    }
  }

  /**
   * ASV compiled schemas for the data model
   */
  static schema() {
    const asv = AppsSchemaValidation.asv();
    const model = DataModel.model();

    return {
      Project: asv.compile(model.Project),
      Timeline: asv.compile(model.Timeline),
      Item: asv.compile(model.Item),
      Comment: asv.compile(model.Comment),
      User: asv.compile(model.User),
      Config: asv.compile(model.Config)
    };
  }
}

const useAsyncQueueDebouncedAutosave = (saveFn, ms = 2500) => {
  // 'imports' from Vue
  const {
    ref,
  } = Vue;

  // https://stackoverflow.com/questions/26150232/resolve-javascript-promise-outside-the-promise-constructor-scope
  function Deferred() {
    const self = this;
    this.promise = new Promise((resolve, reject) => {
      self.resolve = resolve;
      self.reject = reject;
    });
  }

  const queue = ref([]);
  const inProgress = ref(false);
  const closeQueue = ref(false);

  const MAX_RETRIES = 20;
  const autosaveRetryCount = ref(0);
  const autosavedAt = ref('');
  const isAutosaving = ref(false);
  const autosaveError = ref('');
  const cancelAutosave = ref(false);

  const DEBOUNCE_MS = ms;

  /**
   * Dequeues all functions
   */
  const dequeue = async () => {
    const q = queue.value;

    let [next] = q;
    while (next) {
      
      try {
        const res = await next.fn();
        next.def.resolve(res);
      } catch (error) {
        next.def.reject(error);
      }

      q.shift();
      [next] = q;
    }
    inProgress.value = false;
  };
  
  /**
   * Pushes a function onto the queueu
   * @param {Function} fn - function to enqueue
   */
  const enqueue = (fn) => {
    if (closeQueue.value)
      return;

    const def = new Deferred();
    
    queue.value.push({ fn, def });

    if (!inProgress.value) {
      inProgress.value = true;
      dequeue();
    }

    return def.promise;
  }

  /**
   * Debounced autosaver function
   */
  const autosave = debounce(async () => {
    if (cancelAutosave.value) {
      autosaveRetryCount.value = 0;
      return;
    }

    //Don't overlap on saves, keep debouncing till clear
    if (isAutosaving.value) {
      if (autosaveRetryCount.value >= MAX_RETRIES) {
        autosaveError.value = 'Autosaving timed out, please try again. If it still times out contact your system admin!';
        autosaveRetryCount.value = 0;
        return;
      }

      autosaveRetryCount.value += 1;
      autosave();
      return;
    }

    isAutosaving.value = true;

    await enqueue(saveFn);

    autosavedAt.value = Date.now();
    autosaveRetryCount.value = 0;
    isAutosaving.value = false;

  }, DEBOUNCE_MS);


  return {
    queue,
    inProgress,
    closeQueue,
    enqueue,
    autosaveRetryCount,
    autosavedAt,
    isAutosaving,
    autosaveError,
    cancelAutosave,
    autosave
  }
};
const useLastSavedOn = (rec, { live = true, interval = 43 } = {}) => {
  // 'imports' from Vue
  const {
    computed,
    ref,
    onUnmounted
  } = Vue;

  const adt = AppsDateTime.adt();

  const currentTime = ref(new Date());
  const intervalId = live ? setInterval(() => currentTime.value = new Date(), 1000 * interval) : null;

  const lastSavedOn = computed(() => {
    if (!rec.modifiedDate) return 'Never';
    const modified = new Date(rec.modifiedDate);
    currentTime.value; //hack for reactivity?
    return adt.interval(modified, { cutoff: 'month' });
  });

  onUnmounted(() => clearInterval(intervalId));

  return {
    lastSavedOn
  };
};
const useListFilters = () => {
  // 'imports' from Vue
  const {
    computed,
  } = Vue;

  // 'imports' from state
  const {
    data,
    list
  } = store.state;

  const users = computed(() =>
    data.users
      .sort((a, b) => (a.email < b.email ? -1 : 1))
      .map((user) => ({ value: user.email, text: user.email }))
  );

  const projects = computed(() =>
    data.projects
      .sort((a, b) => a.name.toLowerCase() > b.name.toLowerCase() ? 1 : -1)
      .map(proj => ({ value: proj.id, text: proj.name }))
  );

  const projectStatuses = computed(() =>
    list.projectStatuses
      .map(status => ({ value: status, text: status }))
  );

  const projectPrograms = computed(() =>
    list.projectPrograms
      .map(program => ({ value: program, text: program }))
  );

  const projectPlatforms = computed(() => {
    const uniquePlatforms = new Set();
    data.projects.forEach(project => project.platforms.forEach(plt => uniquePlatforms.add(plt)));
    return [...uniquePlatforms]
      .sort()
      .map(platform => ({ value: platform, text: platform }));
  });

  const projectCategories = computed(() => {
    const uniqueCategories = new Set();
    data.projects.forEach(project => project.categories.forEach(plt => uniqueCategories.add(plt)));
    return [...uniqueCategories]
      .sort()
      .map(category => ({ value: category, text: category }));
  });

  const itemTypes = computed(() =>
    list.types.map(type => ({ value: type, text: type }))
  );

  const itemStatuses = computed(() =>
    list.statuses.map(status => ({ value: status, text: status }))
  );

  const itemTags = computed(() => {
    const set = new Set(data.items.map(itm => itm.tags).flat());
    return [...set].sort().filter(tag => !!tag).map(tag => ({ value: tag, text: tag }));
  });

  const priorities = computed(() =>
    list.priorities.map(priority => ({ value: priority, text: priority }))
  );

  const accessibilityStatuses = computed(() =>
    list.accessibilityStatuses.map(status => ({ value: status, text: status }))
  );

  const timelineStatuses = computed(() =>
    list.timelineStatuses.map(status => ({ value: status, text: status }))
  );

  const timelineImpacts = computed(() => {
    const set = new Set(data.timelines.map(tl => tl.impacts).flat());
    return [...set].sort().filter(impact => !!impact).map(impact => ({ value: impact, text: impact }));
  });

  return {
    users,
    projects,
    projectStatuses,
    projectPrograms,
    projectPlatforms,
    projectCategories,
    itemTypes,
    itemStatuses,
    itemTags,
    priorities,
    accessibilityStatuses,
    timelineStatuses,
    timelineImpacts
  };
}
const useProjectBreakdown = ({ my, team, accessibility }) => {
  // 'imports from vue
  const {
    ref,
    computed
  } = Vue;

  // 'imports' from store 
  const {
    state,
    calculated
  } = store;

  // 'imports' from store.calculated 
  const {
    projectById
  } = store.calculated;

  const selectedUsers = ref([]);

  const projects = computed(() => {
    const user = state.app.user;
    if (!user)
      return [];

    if (my)
      return calculated.activeProjects.value
        .filter(project => project.owner === user.email);

    const isInSelectedUsers = (project) => selectedUsers.value.length === 0 || selectedUsers.value.includes(project.owner);

    if (team)
      return calculated.activeProjects.value.filter(isInSelectedUsers);

    if (accessibility)
      return calculated.activeProjects.value
        .filter(project => !!project.accessibilityStatus && project.accessibilityStatus !== 'N/A' && isInSelectedUsers(project));
  });

  const favoriteProjects = computed(() => {
    const user = state.app.user;
    if (!user)
      return [];

    const favorites = user.settings ? (user.settings.favoriteProjects || []) : [];
    return state.data.projects
      .filter(project => favorites.includes(project.id))
      .sort((a, b) => a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1);
  });

  const activeProjects = computed(() => {
    const user = state.app.user;
    if (!user)
      return [];

    return projects.value
      .filter(project => ['Planning', 'Development', 'System testing', 'UAT'].includes(project.status))
      .sort((a, b) => a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1);
  });

  const backlogProjects = computed(() =>
    projects.value.filter(project => project.status === 'Backlog')
  );

  const planningProjects = computed(() =>
    projects.value.filter(project => project.status === 'Planning')
  );

  const developmentProjects = computed(() =>
    projects.value.filter(project => project.status === 'Development')
  );

  const testingProjects = computed(() =>
    projects.value.filter(project => project.status === 'System testing' || project.status === 'UAT')
  );

  const stableProjects = computed(() =>
    projects.value.filter(project => project.status === 'Stable')
  );

  const groupByPriority = (projects) => {
    const priorities = [...state.list.priorities].reverse();
    const group = [...priorities, 'Other']
      .reduce((g, priority) => (g[priority] = []) && g, {});

    projects.forEach(proj => (group[proj.priority] || group.Other).push(proj));
    return group;
  };

  const projectPriorityGroup = computed(() => {
    const projects = activeProjects.value;
    return groupByPriority(projects);
  });

  const projectOwnerPriorityGroup = computed(() => {
    const emails = state.list.users;

    const ownerGroup = emails.reduce((g, email) => (g[email] = []) && g, {});
    activeProjects.value.forEach(proj => ownerGroup[proj.owner].push(proj));

    const group = Object.entries(ownerGroup).reduce((g, [owner, projects]) => (g[owner] = groupByPriority(projects)) && g, {});
    return group;
  });

  const items = computed(() => {
    const user = state.app.user;
    if (!user)
      return [];

    if (my)
      return calculated.activeProjectItems.value
        .filter(item => item.assignee === user.email)
        .map(item => ({ item, project: projectById.value[item.project] }));

    if (team)
      return calculated.activeProjectItems.value
        .filter(item => selectedUsers.value.length === 0 || selectedUsers.value.includes(item.assignee))
        .map(item => ({ item, project: projectById.value[item.project] }));

    if (accessibility)
      return calculated.activeProjectItems.value
        .filter(item => item.type === 'Accessibility')
        .map(item => ({ item, project: projectById.value[item.project] }));

  });

  const openItems = computed(
    () => items.value
      .filter(({ item }) => item.status === 'Open')
      .sort((a, b) => `${a.project.name.toLowerCase()}${a.item.createdDate}` < `${b.project.name.toLowerCase()}${b.item.createdDate}` ? 1 : -1)
  );
  const testingItems = computed(
    () => items.value
      .filter(({ item }) => item.status === 'Testing')
      .sort((a, b) => `${a.project.name.toLowerCase()}${a.item.createdDate}` < `${b.project.name.toLowerCase()}${b.item.createdDate}` ? 1 : -1)
  );
  const pendingItems = computed(() => items.value.filter(({ item }) => !['Closed', 'Hold'].includes(item.status)));

  const pendingScheduledItems = computed(() => {
    const [today] = (new Date()).toJSON().split('T');
    return pendingItems.value
      .filter(({ item }) => item.scheduledDate >= today)
      .sort((a, b) => a.item.scheduledDate < b.item.scheduledDate ? -1 : 1);
  });

  const pendingPastDueItems = computed(() => {
    const [today] = (new Date()).toJSON().split('T');
    return pendingItems.value
      .filter(({ item }) => item.scheduledDate < today)
      .sort((a, b) => a.item.scheduledDate < b.item.scheduledDate ? -1 : 1);
  });

  const stats = computed(() => {
    const totalProjects = projects.value.length;
    const totalItems = items.value.length;
    const pending = pendingItems.value.length;
    const closed = totalItems - pending;
    const percent = closed / (totalItems || 1) * 100;

    return {
      totalProjects,
      totalItems,
      pendingItems: pending,
      closedItems: closed,
      completePercent: `${percent.toFixed(2)}%`
    };
  });

  const sortProjectByPriority = (projects) => {
    const priorities = {
      Critical: 0,
      High: 1,
      Medium: 2,
      Low: 3
    };

    return [...projects].sort((a, b) => priorities[a.priority] - priorities[b.priority]);
  };

  return {
    selectedUsers,
    projects,
    favoriteProjects,
    activeProjects,
    backlogProjects,
    planningProjects,
    developmentProjects,
    testingProjects,
    stableProjects,
    projectPriorityGroup,
    projectOwnerPriorityGroup,
    items,
    openItems,
    testingItems,
    pendingItems,
    pendingScheduledItems,
    pendingPastDueItems,
    stats,
    sortProjectByPriority,
  };
};
/**
 * @template T
 * 
 * @param {object} options
 * @param {AsvSchemaContext<T>} options.schema
 * @param {T} options.reactiveObj
 */
const useSchemaValidation = ({ schema, reactiveObj }) => {
  /** @type {VueOverrides} */
  const {
    unref,
    computed,
  } = Vue;

  const Model = schema;

  const validation = computed(() => {
    console.time('validation'); //DEBUG
    const sch = Model.validate(unref(reactiveObj), { throwError: false });
    console.timeEnd('validation');
    return sch;
  });

  const item = computed(() => validation.value.item);
  const items = computed(() => validation.value.items);
  const isValid = computed(() => !validation.value.hasError);

  const errors = computed(() => Model.errors(reactiveObj));

  const test = () => Model.test(unref(reactiveObj));

  //TODO: more helpers here...
  //TODO: options for individual validation that isnt reactive to the entire obj?

  return {
    schema: Model.schema,
    item,
    items,
    isValid,
    errors,
    test
  };
};
/**
 * @typedef {Object} VueTableFilter
 * @property {Object.<String[]>}
 */

/**
 * @typedef {Object} VueTableSort
 * @property {string} header - header sorted
 * @property {boolean} ascending - if sort is asc direction
 */

/**
 * @typedef {Object} VueTableSortFilterCriteria
 * @property {string} search - search text
 * @property {VueTableFilter} filter - filter by custom props
 * @property {Object} dates - filter by dates
 * @property {VueTableSort} sort - sort by header
 */

/**
 * @typedef {Object} VueTableFilterField
 * @property {string} prop - property to filter
 * @property {Object[]} options - filter options
 * @property {Object} options[].value - filter option value
 * @property {Object} options[].text - filter option display text
 */

/**
 * @typedef {Object} VueTableFilterDate
 * @property {string} prop - date prop name
 * @property {string} start - filter start
 * @property {string} end - filter end
 */

const useTableSortFilterScroll = (context, {
  rows,
  headers,
  criteria,
  filterFields,
  filterDates,
  observeScrolling = true,
  syncUrlQuery = true,
  useWorker = false,
} = {}) => {
  // 'imports' from Vue
  const {
    computed,
    ref,
    onMounted,
    onUnmounted,
    watch,
  } = Vue;

  // 'imports' from vue router
  const {
    useRouter
  } = VueRouter;

  // 'imports' from state
  const {
    app
  } = store.state;

  rows = ref(rows);
  criteria = ref(criteria);
  headers = ref(headers);
  filterFields = ref(filterFields);
  filterDates = ref(filterDates);

  const working = ref(false);

  const ROWS_DISPLAY_INCREMENT = 100;
  const rowsToDisplay = ref(ROWS_DISPLAY_INCREMENT);
  // in order to hook this ref up in a vue component, add ref="scrollElement" to the desired container html el
  const scrollElement = ref(null);

  if (observeScrolling) {
    /**
     * debounce scroll observer function for checking if scrolled to the bottom of the list container
     */
    const scrollObserver = debounce(() => {
      //https://stackoverflow.com/questions/2387136/cross-browser-method-to-determine-vertical-scroll-percentage-in-javascript
      const el = scrollElement.value || document.documentElement;

      const percent = el.scrollTop / (el.scrollHeight - el.clientHeight);

      if (percent > 0.99 && filteredRows.value.length > rowsToDisplay.value)
        rowsToDisplay.value += ROWS_DISPLAY_INCREMENT;
    }, 500);

    onMounted(() => {
      const el = scrollElement.value || window;
      el.addEventListener("scroll", scrollObserver);
    });

    onUnmounted(() => {
      const el = scrollElement.value || window;
      el.removeEventListener("scroll", scrollObserver);
    });
  }

  let filteredRows;
  if (useWorker) {
    const work = AppsWorker('worker-filtering');
    filteredRows = ref(rows.value);

    const recordArgs = computed(() => JSON.stringify(rows.value));
    const headerArgs = computed(() => JSON.stringify(headers.value));
    const criteriaArgs = computed(() => JSON.stringify(criteria.value));

    const gentlyUnload = () => setTimeout(() => working.value = false, 350);

    const workerFilterRows = async () => {
      try {
        console.time('Filtering...'); //DEBUG
        const results = await work.exec('filter', {
          records: recordArgs.value,
          headers: headerArgs.value,
          criteria: criteriaArgs.value
        });
        console.timeEnd('Filtering...');  //DEBUG

        filteredRows.value = results;

        context.emit("update:count", results.length);
        context.emit("update:displayed-rows", results);
      } catch (error) {
        app.errorMessage = error.message;
        working.value = false;
        console.error(error);
      }
    };

    watch(criteriaArgs, async () => {
      console.log('criteria.watcher');
      working.value = true;
      await workerFilterRows();
      gentlyUnload();
    });

    watch(() => [recordArgs.value, headerArgs.value], () => {
      console.log('record*header.watcher');
      workerFilterRows();
    });

    onUnmounted(() => work.worker.terminate());

  } else {
    filteredRows = computed(() => {
      /** @type {VueTableSortFilterCriteria} */
      const crit = criteria.value;
      const lowerSearch = crit.search.toLowerCase();
      const sort = crit.sort;
      const filter = crit.filter;
      const dates = crit.dates;

      const filterProps = Object.keys(filter).filter(
        (prop) => filter[prop] !== undefined && filter[prop] !== ""
      );
      const dateProps = Object.keys(dates).filter(
        (prop) => !!dates[prop] && (!!dates[prop].start || !!dates[prop].end)
      );

      console.time('Filtering...'); //DEBUG

      const filtered = rows.value
        .filter((row) => {
          return (
            headers.value.some(({ prop }) =>
              String(row[prop]).toLowerCase().includes(lowerSearch)
            ) &&
            filterProps.every((prop) => {
              /** @type {string[]} */
              const filterSelections = filter[prop] || [];
              const val = row[prop];
              return filterSelections.some(filteredValue =>
                (typeof val === "function") ? val(filteredValue)
                  : String(val) === String(filteredValue)
              );
            }) &&
            (dateProps.every(prop => {
              const d = dates[prop];
              const val = row[prop];
              return (!d.start || val >= d.start)
                && (!d.end || val <= d.end);
            }))
          );
        })
        .sort((a, b) => {
          if (a[sort.header] === null) return 1;
          if (b[sort.header] === null) return -1;

          const sorter = sort.ascending
            ? a[sort.header] < b[sort.header]
            : a[sort.header] > b[sort.header];

          return sorter ? -1 : 1;
        });

      context.emit("update:count", filtered.length);
      context.emit("update:displayed-rows", filtered);

      console.timeEnd('Filtering...');  //DEBUG

      rowsToDisplay.value = ROWS_DISPLAY_INCREMENT;

      return filtered;
    });
  }

  const displayRows = computed(() =>
    filteredRows.value.slice(0, rowsToDisplay.value)
  );

  if (syncUrlQuery) {

    const router = useRouter();

    /**
     * Parses current route query params for filter fields
     * @returns {Object} criteria
     */
    const parseQueryParametersToCriteria = () => {
      const params = router.currentRoute.value.query;

      const copy = {
        ...params
      };

      const {
        sort = criteria.value.sort.header || "",
        asc = criteria.value.sort.ascending ? "true" : "false",
        search = criteria.value.search || ""
      } = copy;

      delete copy.sort;
      delete copy.asc;
      delete copy.search;

      const queryCriteria = {
        sort: {
          header: sort,
          ascending: asc === "true"
        },
        search,
        filter: { ...criteria.value.filter },
        dates: { ...criteria.value.dates }
      };

      filterFields.value.forEach(({ prop }) => {
        const list = copy[prop];

        let paramArray;
        if (list !== undefined) {
          const q = list.split(',').filter(l => l !== '');
          paramArray = q.map(decodeURIComponent);
        }
        queryCriteria.filter[prop] = paramArray || queryCriteria.filter[prop] || undefined;
      });

      filterDates.value.forEach(d => {
        const param = copy[`df.${d.prop}`];

        if (param) {
          const parts = param.split(':');

          queryCriteria.dates[d.prop] = {
            start: parts[0],
            end: parts[1]
          };
        }
      });

      return queryCriteria;
    };

    /**
     * Parses a given criteria object to a set of query params
     * @returns {Object} query params
     */
    const parseCriteriaToQueryParams = () => {
      const crit = criteria.value;

      const filterQuery = Object.keys(crit.filter)
        .filter(key => Array.isArray(crit.filter[key]))
        .reduce((obj, key) => {
          obj[key] = crit.filter[key].map(encodeURIComponent).join(',');
          return obj;
        }, {});

      const dateQuery = Object.keys(crit.dates)
        .filter(key => !!crit.dates[key] && (!!crit.dates[key].start || !!crit.dates[key].end))
        .reduce((obj, key) => {
          const d = crit.dates[key];
          obj[`df.${key}`] = `${d.start || ''}:${d.end || ''}`;
          return obj;
        }, {});

      const query = {
        ...filterQuery,
        ...dateQuery
      };

      query.sort = crit.sort.header;
      query.asc = crit.sort.ascending;
      if (crit.search !== "")
        query.search = crit.search;

      return query;
    };

    onMounted(() => {
      const crit = parseQueryParametersToCriteria();

      criteria.value.search = crit.search;
      criteria.value.sort = crit.sort;
      criteria.value.filter = crit.filter;
      criteria.value.dates = crit.dates;
    });

    watch(criteria,
      () => {
        const query = parseCriteriaToQueryParams();

        console.log('query', query); //DEBUG

        //preserve params
        const currentParams = app.currentQueryParams;
        Object.keys(currentParams)
          .filter(param => param !== 'sort' && param !== 'asc' && param !== 'search' && !filterFields.value.some(({ prop }) => prop === param) && !filterDates.value.some(({ prop }) => `df.${prop}` === param))
          .forEach(p => query[p] = currentParams[p]);

        router.replace({ path: app.currentRoute, query });
      },
      { deep: true }
    );
  }

  return {
    rows,
    criteria,
    headers,
    filterFields,
    filterDates,
    working,
    rowsToDisplay,
    scrollElement,
    filteredRows,
    displayRows
  }
};
/**
 * Dispatch definition
 */
const appDispatch = () => {

  if (localStorage.getItem('__isp_sys_log'))
    localStorage.removeItem('__isp_sys_log');

  /**
   * Handles mapping server response data to store
   * @param {Object} response - server response data
   */
  const handleAppDataResponse = (response) => {
    const { state } = store;

    const {
      types,
      priorities,
      statuses,
      themes,
      projectStatuses,
      projectPrograms,
      accessibilityStatuses,
      timelineStatuses,
      timelineEfforts,
      timelinePriorities,
      timelineMagnitudes,
      users
    } = response.body.lists;

    const {
      datasourceUrl
    } = response.body.config;

    state.app.config.datasourceUrl = datasourceUrl;

    state.list.types = types;
    state.list.priorities = priorities;
    state.list.statuses = statuses;
    state.list.themes = themes;
    state.list.projectStatuses = projectStatuses;
    state.list.projectPrograms = projectPrograms;
    state.list.accessibilityStatuses = accessibilityStatuses;
    state.list.timelineStatuses = timelineStatuses;
    state.list.timelineEfforts = timelineEfforts;
    state.list.timelinePriorities = timelinePriorities;
    state.list.timelineMagnitudes = timelineMagnitudes;
    state.list.users = users;

    state.dataModel.model = response.body.DataModel;

    const models = response.body.models;

    state.data.projects = models.projects;
    state.data.items = models.items;
    state.data.comments = models.comments;
    state.data.timelines = models.timelines;
    // state.data.deployments = models.deployments;
    state.data.users = models.users;

    return state;
  };

  /**
   * Handles patching poll response objects to store
   * @param {AppsDataPollUpdate[]} records - server poll response records
   */
  const patchPollResponse = (records) => {
    const { dispatch } = store;
    const { data } = store.state;
    records.forEach(update => {
      const models = data[`${update.model.toLowerCase()}s`];
      const index = models.findIndex(m => m._key === update.rec._key);

      // delete, update, or add
      if (update.del && index !== -1)
        models.splice(index, 1);
      else if (index !== -1)
        dispatch.app.mapNewToExisting(models[index], update.rec);
      else
        models.push(update.rec);
    });
  };

  // let syslog;
  // const initSyslog = () => systemLogger({ local: true, maxEntries: 100 });
  // const getSyslog = () => {
  //   if (!syslog)
  //     syslog = initSyslog();

  //   return syslog;
  // };

  return {

    // getSyslog,

    /**
     * Maps new model data to existimg model props
     * @param {Object} currentObj - current object
     * @param {Object} newObj - new object
     */
    mapNewToExisting(currentObj, newObj) {
      Object.keys(newObj).forEach(prop => currentObj[prop] = newObj[prop]);
    },

    /**
     * Updates a given requirement
     * @param {Object} requirement - requirement to update
     */
    async loadAppData({ bypassWorkingQueue = false } = {}) {
      const {
        state,
        api,
      } = store;

      if (!bypassWorkingQueue)
        state.app.workingQueue.push(true);

      try {
        const response = await api.get(`/auth/ds/app-data?session=${state.app.session}`).send();
        handleAppDataResponse(response);

        state.app.refresh.initialLoadComplete = true;

      } catch (error) {
        console.log(error);
        state.app.errorMessage = error.message;
      }

      if (!bypassWorkingQueue)
        state.app.workingQueue.pop();
    },

    /**
     * Loads latest data changes 
     */
    async loadLatestData({ showWorkingQueue = true, force = false } = {}) {
      const {
        state,
        api,
        dispatch
      } = store;

      const { refresh } = state.app;

      console.log('loadLatestData');

      const WAIT = 1000 * 60 * 15;
      const now = new Date();
      if (!force && (!refresh.initialLoadComplete || now - new Date(refresh.lastDataFetch) < WAIT))
        return;

      if (showWorkingQueue)
        state.app.workingQueue.push(true);

      try {
        const response = await api.get(`/auth/ds/app-data/latest?start=${encodeURIComponent(refresh.lastDataFetch)}`).send();

        const models = response.body;
        models.projects.forEach(dispatch.project.patchIntoDataList);
        models.items.forEach(dispatch.item.patchIntoDataList);
        models.comments.forEach(dispatch.comment.patchIntoDataList);
        models.timelines.forEach(dispatch.timeline.patchIntoDataList);
        // models.deployments.forEach(dispatch.deployment.patchIntoDataList);

        refresh.lastDataFetch = now.toJSON();

      } catch (error) {
        console.log(error);
        state.app.errorMessage = error.message;
        state.app.error = error;
      }

      if (showWorkingQueue)
        state.app.workingQueue.pop();
    },

    /**
     * @deprecated
     * Sends a poll request for new server data
     */
    async pollServerData() {
      const {
        state,
        api,
      } = store;

      // Don't trap errors here since this is designed to be used as a scheduled poll method, and we want the poller to handle errors
      // getSyslog().log({ message: 'Polling for server data' });
      const response = await api.get(`/auth/ds/app-data-poll?session=${state.app.session}`).send();

      if (response.status !== 200)
        throw new Error(response.body.message);

      // getSyslog().log({ message: `Poll responds with ${!response.body ? 'empty' : 'new data'}` });

      if (response.body)
        handleAppDataResponse(response);

      return response;
    },

    /**
     * @deprecated
     * Sends a long-poll request for server data
     */
    async longPollServerData() {
      const {
        state,
        api,
      } = store;

      // Don't trap errors here since this is designed to be used as a scheduled poll method, and we want the poller to handle errors
      // getSyslog().log({ message: 'Long polling for server data' });
      const response = await api.get(`/auth/ds/long-poll?session=${state.app.session}`).send();

      if (response.status !== 200)
        throw new Error(response.body.message);

      const { incrementals, all } = response.body;

      if (incrementals) {
        // getSyslog().log({ message: `Long poll responds with ${incrementals.length === 0 ? 'empty' : incrementals.length + ' record(s)'}` });

        if (incrementals.length > 0)
          patchPollResponse(incrementals);
      } else if (all) {
        // getSyslog().log({ message: `Long poll responds with all fresh data` });
        handleAppDataResponse({ body: all });
      }

      state.app.polling.sessionPolls++;
      state.app.polling.lastUpdate = new Date().toLocaleString();

      return response;
    },

    /**
     * @deprecated
     * Requests that the poller be cancelled
     */
    disconnectPoller() {
      const {
        state,
        api,
      } = store;
      console.log('disconnectPoller'); //DEBUG

      try {
        // getSyslog().log({ message: 'Disconnected, cancelling poller...' });

        console.log('disconnectPoller post()'); //DEBUG
        const response = api.post(`/auth/ds/cancel-poll?session=${state.app.session}`).send();

        return response;
      } catch (err) {
        console.error(err);
      }
    }

  };
};
const commentDispatch = () => {

  const mapSavedToExisting = (existing, saved) => {
    existing._key = saved._key;
    existing.id = saved.id;
    existing.createdBy = saved.createdBy;
    existing.createdDate = saved.createdDate;
  };

  /**
   * Patches the information from the object into the state data lists
   * @param {IComment} comm - comm to patch
   */
  const patchIntoDataList = (comm) => {
    const {
      state,
      calculated,
      dispatch
    } = store;

    const existing = calculated.commentById.value[comm.id];
    if (existing)
      dispatch.app.mapNewToExisting(existing, comm);
    else
      state.data.comments.push(comm);
  };

  return {
    patchIntoDataList,
    
    /**
     * Requests comment save
     * @param {Object} comment - comment to save
     * @param {Object} item - item to update on save
     */
    async saveComment(comment, item) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      const isNew = (comment._key === null || comment._key === undefined);

      state.app.workingQueue.push(true);

      try {
        const response = await api.post(`/auth/ds/comment/save?session=${state.app.session}`).send(comment);
        const saved = response.body;

        mapSavedToExisting(comment, saved.comment);
        // update item metadata too
        item.modifiedDate = saved.item.modifiedDate;
        item.modifiedBy = saved.item.modifiedBy;

        if (isNew)
          state.data.comments.push(comment);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Request comment delete
     * @param {Object} comment - comment to delete
     */
    async deleteComment(comment) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.delete(`/auth/ds/comment/delete?session=${state.app.session}`).send(comment);

        state.data.comments = state.data.comments.filter(com => com.id !== comment.id);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    }
  };
};
const deploymentDispatch = () => {

  const mapSavedToExisting = (existing, saved) => {
    existing._key = saved._key;
    existing.id = saved.id;
    existing.createdBy = saved.createdBy;
    existing.createdDate = saved.createdDate;
    existing.modifiedBy = saved.modifiedBy;
    existing.modifiedDate = saved.modifiedDate;
  };

  /**
   * Patches the information from the object into the state data lists
   * @param {IDeployment} dep - dep to patch
   */
  const patchIntoDataList = (dep) => {
    const {
      state,
      calculated,
      dispatch
    } = store;

    const existing = calculated.deploymentById.value[dep.id];
    if (existing)
      dispatch.app.mapNewToExisting(existing, dep);
    else
      state.data.deployments.push(dep);
  };

  return {
    patchIntoDataList,
    
    /**
     * Requests a deployment save
     * @param {IDeployment} deployment - deployment to save
     */
    async saveDeployment(deployment) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.post(`/auth/ds/deployment/save?session=${state.app.session}`).send(deployment);
        const saved = response.body;

        mapSavedToExisting(deployment, saved);
        patchIntoDataList(deployment);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Requests a deployment delete
     * @param {IDeployment} deployment - deployment to delete 
     */
    async deleteDeployment(deployment) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.delete(`/auth/ds/deployment/delete?session=${state.app.session}`).send(deployment);

        state.data.deployments = state.data.deployments
          .filter(dep => dep.id !== deployment.id);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Creates a new deployment model
     * @param {Partial<IDeployment>} [options] - additional deployment props to set
     */
    createNewDeployment(options) {
      // 'imports' from store.state
      const {
        state
      } = store;

      /** @type {IDeployment} */
      const newDeployment = {
        id: crypto.randomUUID(),
        version: 'new',
        owner: state.app.user.email,
        tags: [],
        date: (new Date()).toJSON().split('T')[0],
        description: '',
        notes: '',
        scheduled: null,
        project: null,
        ...options,
      };

      return newDeployment;
    },

    /**
     * helper to get a router path for a new deployment
     */
    getNewDeploymentRoute() {
      const newId = crypto.randomUUID();
      return { path: `/deployment/${newId}`, query: { isNew: true } };
    }
  };
};
const itemDispatch = () => {

  const mapSavedToExisting = (existing, saved) => {
    existing._key = saved._key;
    existing.itemNumber = saved.itemNumber;
    existing.id = saved.id;
    existing.createdBy = saved.createdBy;
    existing.createdDate = saved.createdDate;
    existing.modifiedBy = saved.modifiedBy;
    existing.modifiedDate = saved.modifiedDate;
  };

  /**
   * Patches the information from the object into the state data lists
   * @param {Object} item - item to patch
   */
  const patchIntoDataList = (item) => {
    const {
      state,
      calculated,
      dispatch
    } = store;

    const existing = calculated.itemById.value[item.id];
    if (existing)
      dispatch.app.mapNewToExisting(existing, item);
    else
      state.data.items.push(item);

    return existing || item;
  };

  return {
    patchIntoDataList,
    /**
     * Requests item save
     * @param {Object} item - item to save
     */
    async saveItem(item) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.post(`/auth/ds/item/save?session=${state.app.session}`).send(item);

        const saved = response.body;

        mapSavedToExisting(item, saved);
        patchIntoDataList(saved);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Requests item delete
     * @param {Object} item 
     */
    async deleteItem(item) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.delete(`/auth/ds/item/delete?session=${state.app.session}`).send(item);

        state.data.items = state.data.items.filter(itm => itm.id !== item.id);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Requests an item be uploaded and attached
     * @param {Object} blob - blob to attach
     */
    async uploadItemFile(blob) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.post('/auth/file/create').send(blob);
        const { id, name, url, size } = response.body;
        blob.id = id;
        blob.url = url;

        //dont keep data prop after upload
        blob.data = undefined;

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    // /** DEPRECATED
    //  * Requests an item file be removed
    //  * @param {Object} file - file metadata
    //  */
    // async deleteItemFile(file) {
    //   // 'imports' from store.state
    //   const {
    //     api,
    //     state
    //   } = store;

    //   state.app.workingQueue.push(true);

    //   try {
    //     const response = await api.delete('/auth/file/delete').send(file.id);

    //     state.app.workingQueue.pop();
    //     return response;
    //   } catch (error) {
    //     console.error(error);
    //     state.app.errorMessage = error.message;
    //   }

    //   state.app.workingQueue.pop();
    // },

    /**
     * Requests an item be uploaded and attached
     * @param {Object} options - options
     * @param {string} [options.url] - optional file url
     * @param {string} [options.id] - optional file id
     */
    async getDriveFileDetails({ url, id }) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.post('/auth/file/drive/details').send({ url, id });

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Adds a scheduled item to Google Calendar
     * @param {Object} item - item
     */
    async addItemToCalendar(item) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.post('/auth/ds/item/calendar-event').send({ item, startTimeString: item.scheduledDate });

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Creates a new item model
     * @param {Object} [options] - additional item props to set
     */
    createNewItem(options = {}) {
      // 'imports' from store.state
      const {
        state
      } = store;

      const newItem = {
        id: crypto.randomUUID(),
        project: null,
        type: null,
        assignee: state.app.user.email,
        priority: "Medium",
        status: "New",
        version: null,
        files: [],
        tags: [],
        ...options
      };

      return newItem;
    }

  };
};
const projectDispatch = () => {

  const mapSavedToExisting = (existing, saved) => {
    existing._key = saved._key;
    existing.id = saved.id;
    existing.createdBy = saved.createdBy;
    existing.createdDate = saved.createdDate;
    existing.modifiedBy = saved.modifiedBy;
    existing.modifiedDate = saved.modifiedDate;
  };

  /**
   * Patches the information from the object into the state data lists
   * @param {Object} proj - proj to patch
   */
  const patchIntoDataList = (proj) => {
    const {
      state,
      calculated,
      dispatch
    } = store;

    const existing = calculated.projectById.value[proj.id];
    if (existing)
      dispatch.app.mapNewToExisting(existing, proj);
    else
      state.data.projects.push(proj);
  };

  return {
    patchIntoDataList,
    
    /**
     * Requests a project save
     * @param {Object} project - project to save
     */
    async saveProject(project) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.post(`/auth/ds/project/save?session=${state.app.session}`).send(project);
        const saved = response.body;

        mapSavedToExisting(project, saved);
        patchIntoDataList(project);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Requests a project delete
     * @param {Object} project - project to delete 
     */
    async deleteProject(project) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.delete(`/auth/ds/project/delete?session=${state.app.session}`).send(project);

        state.data.projects = state.data.projects
          .filter(proj => proj.id !== project.id);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Requests a project duplicate
     * @param {Object} project - project to duplicate 
     */
    duplicateProject(project) {
      const copy = JSON.parse(JSON.stringify(project));
      copy.name = `Copy of ${copy.name}`;
      copy.id = crypto.randomUUID();

      copy._key = undefined;
      copy.createdDate = null;
      copy.createdBy = null;
      copy.modifiedDate = null;
      copy.modifiedBy = null;

      return copy;
    },

    /**
     * Updates the project version, and all outstanding work items
     * @param {Object} project - project with new version
     */
    async updateProjectVersion(project) {
      // 'imports' from store.state
      const {
        api,
        state,
        dispatch
      } = store;

      state.app.workingQueue.push(true);

      try {
        const projectSave = api.post(`/auth/ds/project/save?session=${state.app.session}`).send(project);
        const itemsSave = api.post(`/auth/ds/project/update-items-version?session=${state.app.session}`).send(project);

        const [projectResponse, itemResponse] = await Promise.all([projectSave, itemsSave]);

        mapSavedToExisting(project, projectResponse.body);
        patchIntoDataList(project);

        itemResponse.body.forEach(savedItem => {
          const dataItem = dispatch.item.patchIntoDataList(savedItem);
          dataItem.version = savedItem.version;
        });

        state.app.workingQueue.pop();
        return {
          projectResponse,
          itemResponse
        };
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Creates a new project model
     * @param {Object} [options] - additional project props to set
     */
    createNewProject(options) {
      // 'imports' from store.state
      const {
        state
      } = store;

      const newProject = {
        id: crypto.randomUUID(),
        version: '0.00',
        owner: state.app.user.email,
        categories: [],
        platforms: [],
        dependsOnProjects: [],
        links: [],
        ...options,
      };

      return newProject;
    },

    /**
     * helper to get a router path for a new project
     */
    getNewProjectRoute() {
      const newId = crypto.randomUUID();
      return { path: `/project/${newId}`, query: { isNew: true } };
    }
  };
};
const timelineDispatch = () => {

  const mapSavedToExisting = (existing, saved) => {
    existing._key = saved._key;
    existing.id = saved.id;
    existing.createdBy = saved.createdBy;
    existing.createdDate = saved.createdDate;
    existing.modifiedBy = saved.modifiedBy;
    existing.modifiedDate = saved.modifiedDate;
  };

  /**
   * Patches the information from the object into the state data lists
   * @param {ITimeline} tl - tl to patch
   */
  const patchIntoDataList = (tl) => {
    const {
      state,
      calculated,
      dispatch
    } = store;

    const existing = calculated.timelineById.value[tl.id];
    if (existing)
      dispatch.app.mapNewToExisting(existing, tl);
    else
      state.data.timelines.push(tl);
  };

  return {
    patchIntoDataList,
    
    /**
     * Requests a timeline save
     * @param {Object} timeline - timeline to save
     */
    async saveTimeline(timeline) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      const isNew = (timeline._key === null || timeline._key === undefined);

      state.app.workingQueue.push(true);

      try {
        const response = await api.post(`/auth/ds/timeline/save?session=${state.app.session}`).send(timeline);
        const saved = response.body;

        mapSavedToExisting(timeline, saved);

        if (isNew)
          state.data.timelines.push(timeline);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Requests a timeline delete
     * @param {Object} timeline - timeline to delete 
     */
    async deleteTimeline(timeline) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.delete(`/auth/ds/timeline/delete?session=${state.app.session}`).send(timeline);

        state.data.timelines = state.data.timelines
          .filter(ml => ml.id !== timeline.id);

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    /**
     * Creates a new timeline model
     * @param {Object} [options] - additional timeline props to set
     */
    createNewTimeline(options = {}) {
      const newTimeline = {
        id: crypto.randomUUID(),
        projects: [],
        impacts: [],
        ...options,
      };

      return newTimeline;
    },

    /**
     * helper to get a router path for a new timeline
     */
    getNewTimelineRoute() {
      const newId = crypto.randomUUID();
      return { path: `/timeline/${newId}`, query: { isNew: true } };
    }
  };
};
const userDispatch = () => {

  const mapSavedToExisting = (existing, saved) => {
    existing._key = saved._key;
    existing.id = saved.id;
    existing.createdBy = saved.createdBy;
    existing.createdDate = saved.createdDate;
    existing.modifiedBy = saved.modifiedBy;
    existing.modifiedDate = saved.modifiedDate;
  };

  /**
   * Requests a user save
   * @param {IUser} user - user to save
   */
  const saveUser = async (user) => {
    // 'imports' from store.state
    const {
      api,
      state
    } = store;

    state.app.workingQueue.push(true);

    try {
      const response = await api.post('/auth/ds/user/save').send(user);
      const saved = response.body;

      mapSavedToExisting(user, saved);

      state.app.workingQueue.pop();
      return response;
    } catch (error) {
      console.error(error);
      state.app.errorMessage = error.message;
    }

    state.app.workingQueue.pop();
  };

  const autosaverForAppUser = async () => {
    const { state } = store;
    return await saveUser(state.app.user);
  };

  const {
    autosave
  } = useAsyncQueueDebouncedAutosave(autosaverForAppUser);

  return {
    saveUser,
    autosaveAppUser: autosave,
  };
};
/**
 * Dispatch definition
 */
const utilDispatch = () => {

  return {

    /**
     * Creates new prd template
     * @param {Object} [options]
     */
    async createPrdTemplate({ type, name } = {}) {
      // 'imports' from store.state
      const {
        api,
        state
      } = store;

      state.app.workingQueue.push(true);

      try {
        const response = await api.post('/auth/ds/files/create-prd').send({ type, name });

        state.app.workingQueue.pop();
        return response;
      } catch (error) {
        console.error(error);
        state.app.errorMessage = error.message;
      }

      state.app.workingQueue.pop();
    },

    // /**
    //  * Parses current route query params for filter fields
    //  * @returns {Object} criteria
    //  */
    // parseFilterParametersToCriteria(defaultCriteria = { search: '', sort: {}, filter: {} }) {
    //   const {
    //     state,
    //   } = store;

    //   const params = state.app.currentQueryParams;

    //   const copy = {
    //     ...params
    //   };

    //   const {
    //     sort = defaultCriteria.sort.header || "",
    //     asc = defaultCriteria.sort.ascending ? "true" : "false",
    //     search = defaultCriteria.search || ""
    //   } = copy;

    //   delete copy.sort;
    //   delete copy.asc;
    //   delete copy.search;

    //   const queryCriteria = {
    //     sort: {
    //       header: sort,
    //       ascending: asc === "true"
    //     },
    //     search,
    //     filter: defaultCriteria.filter
    //   };

    //   Object.keys(copy).forEach(param => queryCriteria.filter[param] = copy[param]);

    //   return queryCriteria;

    // },

    // /**
    //  * Parses a given criteria object to a set of query params
    //  * @returns {Object} query params
    //  */
    // parseCriteriaToQueryParams(crit) {
    //   const query = Object.keys(crit.filter)
    //     .filter(key => crit.filter[key] !== "")
    //     .reduce((obj, key) => {
    //       obj[key] = crit.filter[key];
    //       return obj;
    //     }, {});

    //   query.sort = crit.sort.header;
    //   query.asc = crit.sort.ascending;
    //   if (crit.search !== "")
    //     query.search = crit.search;

    //   return query;
    // },

    /**
     * Helper to download a give set of data as csv
     * @param {string} fileName - file name
     * @param {Object[]} data - data to download
     */
    downloadDataAsCsv(fileName, data) {
      
      const headers = Object.keys(data[0]).map(key => `"${key.replace(/"/gs, "'")}"`).join(',');
      const rows = data.map(row =>
        Object.values(row).map(val => {
          if (typeof val === 'string')
            return `"${val.replace(/(\r\n|\r|\n)/gs, ' | ').replace(/"/gs, "'")}"`;
          return `"${val}"`;
        }).join(',')
      )
        .join('\r\n');
    
      const csv = headers
        + '\r\n'
        + rows;

      const a = document.createElement('a');
      a.setAttribute(
        'href',
        'data:application/octet-stream;charset=utf-8,'
        + encodeURIComponent(csv)
      );
      a.setAttribute('download', fileName);
      a.style.display = 'none';

      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

  };
};
const useAccessibilityDashboardViewModel = () => {
  // 'imports from vue
  const {
    reactive,
  } = Vue;

  const { 
    selectedUsers,
    projects,
    activeProjects,
    backlogProjects,
    planningProjects,
    developmentProjects,
    testingProjects,
    stableProjects,
    items,
    pendingItems,
    pendingScheduledItems,
    pendingPastDueItems,
    stats,
    sortProjectByPriority,
  } = useProjectBreakdown({ accessibility: true });

  return reactive({
    selectedUsers,
    projects,
    activeProjects,
    backlogProjects,
    planningProjects,
    developmentProjects,
    testingProjects,
    stableProjects,
    items,
    pendingItems,
    pendingScheduledItems,
    pendingPastDueItems,
    stats,
    sortProjectByPriority
  });
};
// ************************** CURRENTLY NOT IN USE!!! ***************************


/**
 * logic based on comment state
 * @param {Object} cmt - comment
 * @returns {Object} composed reactive state
 */
 const useItemCommentViewModel = (cmt) => {
  // 'imports' from Vue
  const {
    computed,
    reactive
  } = Vue;

  // 'imports' from store
  const {
    dispatch
  } = store;

  // 'imports' from store.calculated
  const {
    projectById,
    itemByKey,
  } = store.calculated;

  const comment = reactive(cmt);

  const item = computed(() => itemByKey.value[comment.item]);
  const project = computed(() => projectById.value[item.value.project]);

  const validation = useSchemaValidation({ reactiveObj: comment, schema: schema.Comment });
  const isValid = computed(() => validation.isValid.value);

  const canEdit = computed(() => true);

  /**
   * dispatches save request
   */
  const saveComment = async () => {
    return await dispatch.saveComment(comment, item.value);
  };

  return reactive({
    comment,
    item,
    project,
    validation,
    isValid,
    canEdit,
    saveComment
  });
};
const useDashboardViewModel = ({ my, team }) => {
  // 'imports from vue
  const {
    reactive,
    computed
  } = Vue;

  // 'imports' from store 
  const {
    state,
  } = store;

  const {
    selectedUsers,
    projects,
    favoriteProjects,
    activeProjects,
    backlogProjects,
    planningProjects,
    developmentProjects,
    testingProjects,
    stableProjects,
    projectPriorityGroup,
    projectOwnerPriorityGroup,
    items,
    openItems,
    testingItems,
    pendingItems,
    pendingScheduledItems,
    pendingPastDueItems,
    stats,
    sortProjectByPriority,
  } = useProjectBreakdown({ my, team });

  const workloadVms = computed(() => state.list.users.map(email => useWorkloadViewModel(email)));

  return reactive({
    selectedUsers,
    projects,
    favoriteProjects,
    activeProjects,
    backlogProjects,
    planningProjects,
    developmentProjects,
    testingProjects,
    stableProjects,
    items,
    openItems,
    testingItems,
    pendingItems,
    pendingScheduledItems,
    pendingPastDueItems,
    projectPriorityGroup,
    projectOwnerPriorityGroup,
    stats,
    sortProjectByPriority,
    workloadVms
  });
};
/**
 * logic based on item state
 * @param {IItem} itm - item
 */
const useItemViewModel = (itm) => {
  /** @type {VueOverrides} */
  const {
    computed,
    reactive
  } = Vue;

  // 'imports' from store
  const {
    state,
    dispatch,
    schema
  } = store;

  // 'imports' from store.calculated
  const {
    projectById,
    itemById,
    itemsByItem,
    commentsByItem,
    itemsByProject,
  } = store.calculated;

  const item = reactive(itm);

  const isNew = computed(() => item._key === null || item._key === undefined);

  const project = computed(() => projectById.value[item.project]);
  const parentItem = computed(() => itemById.value[item.parent]);
  const relatedItems = computed(() => itemsByItem.value[item.id] || []);
  const comments = computed(() => [...(commentsByItem.value[item.id] || [])].reverse());

  const isHigherOrderType = (/** @type {IItemType} */ type) => {
    return type === 'Feature'
      || type === 'Epic';
  };

  const higherOrderType = computed(() => isHigherOrderType(item.type));

  const parentHighers = computed(() => {
    let parent = parentItem.value;
    const highers = [];

    while (parent) {
      if (isHigherOrderType(parent.type))
        highers.push(parent);
      parent = itemById.value[parent.parent];

      if (!!parent && parent.id === parent.parent)
        break;
    }

    return highers;
  });

  const projectItems = computed(() => itemsByProject.value[item.project] || []);

  const itemStatusBulmaClass = computed(() => {
    const colors = {
      New: "has-background-white",
      Open: "has-background-warning-light",
      Testing: "has-background-success-light",
      Closed: "has-background-info-light",
      Hold: "has-background-light",
    };

    return colors[item.status] || "";
  });
  const itemStatusBulmaTag = computed(() => {
    const colors = {
      New: "is-light",
      Open: "is-warning",
      Testing: "is-success",
      Closed: "is-info",
      Hold: "is-dark",
    };

    return colors[item.status] || "";
  });

  const validation = useSchemaValidation({ reactiveObj: item, schema: schema.Item });
  const isValid = computed(() => validation.isValid.value);

  const canEdit = computed(() => true);

  const isQueued = computed(() =>
    state.app.user.settings.queue
    && state.app.user.settings.queue.includes(item.id)
  );

  const pushToQueue = async () => {
    const queue = new Set(state.app.user.settings.queue || []);
    queue.add(item.id);
    state.app.user.settings.queue = [...queue];
    return dispatch.user.autosaveAppUser();
  };

  const popFromQueue = async () => {
    const queue = new Set(state.app.user.settings.queue || []);
    queue.delete(item.id);
    state.app.user.settings.queue = [...queue];
    return dispatch.user.autosaveAppUser();
  };

  /**
   * Quicksaves without queue or validity check
   */
  const quicksave = async () => {
    return await dispatch.item.saveItem(item);
  }

  /**
   * dispatches a save request
   */
  const autosaver = async () => {
    if (!isValid.value)
      return;

    return await dispatch.item.saveItem(item);
  };

  const {
    closeQueue,
    enqueue,
    cancelAutosave,
    autosave
  } = useAsyncQueueDebouncedAutosave(autosaver);

  /**
   * dispatches save request
   */
  const saveItem = async () => {
    return await enqueue(autosaver);
  };

  /**
   * dispatches a delete request
   */
  const deleteItem = async () => {
    cancelAutosave.value = true;
    const response = enqueue(
      () => dispatch.item.deleteItem(item)
    );
    closeQueue.value = true;
    return await response;
  };

  /**
   * Dispatches an file upload request
   * @param {Object} blob - blob metadata
   */
  const uploadFile = async (blob) => {
    return await enqueue(
      () => dispatch.item.uploadItemFile(blob)
    );
  };

  // /** DEPRECATED
  //  * Disatches a file remove request
  //  * @param {Object} file - file metadata
  //  */
  // const removeFile = async (file) => {
  //   return await enqueue(
  //     () => dispatch.item.deleteItemFile(file)
  //   );
  // };

  /**
   * Dispatches file details, then adds to files
   * @param {string} url - url of file to attach
   */
  const attachDriveFileDetails = async (url) => {
    const response = await dispatch.item.getDriveFileDetails({ url });
    if (response) {
      const info = response.body;
      item.files.push({
        id: info.id,
        name: info.name,
        url: info.url
      });
      autosave();
    }
  };

  /**
   * Dispatches a comment save
   * @param {string} com - comment string to post
   */
  const postComment = async (com) => {
    const newComment = {
      id: null,
      item: item.id,
      comment: com
    };

    return await dispatch.comment.saveComment(newComment, item);
  };

  /**
   * Dispatches delete request
   * @param {Object} comment - comment to delete
   */
  const deleteComment = async (comment) => {
    return await dispatch.comment.deleteComment(comment);
  }

  /**
   * Links a the given child item with this as parent
   * @param {Object} childItem - child item to link
   */
  const linkChildItem = async (childItem) => {
    childItem.parent = item.id;
    return await enqueue(
      () => dispatch.item.saveItem(childItem)
    );
  };

  /**
   * dispatches a add item to calendar request
   */
  const addToCalendar = async () => {
    return await dispatch.item.addItemToCalendar(item);
  };

  /**
   * Automatically manages the items closed date property (and potentially resolved date if it is not set) when the status is changed
   * @param {string} status - new status to apply
   */
  const autoResolveItemByStatus = async (status) => {
    if (status === item.status)
      return;
    const prev = item.status;
    item.status = status;

    if (status === 'Closed') {
      const [todayString] = new Date().toJSON().split('T');

      item.resolvedDate = item.resolvedDate || todayString;
      item.closedDate = todayString;
    } else if (prev === 'Closed') {
      item.closedDate = '';
    }

    return await quicksave();
  };

  return reactive({
    item,
    isNew,
    project,
    parentItem,
    relatedItems,
    comments,
    higherOrderType,
    parentHighers,
    projectItems,
    itemStatusBulmaClass,
    itemStatusBulmaTag,
    validation,
    isValid,
    canEdit,
    isQueued,
    pushToQueue,
    popFromQueue,
    quicksave,
    saveItem,
    autosave,
    uploadFile,
    attachDriveFileDetails,
    postComment,
    deleteComment,
    linkChildItem,
    addToCalendar,
    deleteItem,
    autoResolveItemByStatus
  });
};
/**
 * logic based on project state
 * @param {Object} proj - project
 * @returns {Object} composed reactive state
 */
const useProjectDependencyViewModel = (proj) => {
  // 'imports' from Vue
  const {
    computed,
    reactive
  } = Vue;

  // 'imports' from store.state
  const {
    state,
  } = store;

  // 'imports' from store.calculated
  const {
    projectById,
  } = store.calculated;

  const project = reactive(proj);

  const dependencyLayerMap = computed(() => {
    let layerIndex = 1;
    const visited = new Set(project.dependsOnProjects);
    visited.add(project.id);

    let layerProjects = project.dependsOnProjects.map(id => projectById.value[id]).filter(p => !!p);
    const map = {};

    while (layerProjects.length > 0) {
      map[layerIndex] = layerProjects;

      const nextLayerIds = layerProjects
        .reduce((layer, proj) => [...layer, ...proj.dependsOnProjects], []);
      layerProjects = nextLayerIds.map(id => projectById.value[id])
        .filter(p => !!p && !visited.has(p.id));

      nextLayerIds.forEach(id => visited.add(id));
      
      layerIndex++;
    }

    return map;

  });

  return reactive({
    project,
    dependencyLayerMap,
  });
};
/**
 * logic based on project state
 * @param {IProject} proj - project
 */
const useProjectViewModel = (proj) => {
  /** @type {VueOverrides} */
  const {
    computed,
    reactive
  } = Vue;

  // 'imports' from store.state
  const {
    state,
    dispatch,
    schema,
    helpers
  } = store;

  // 'imports' from store.calculated
  const {
    projectById,
    itemById,
    itemsByProject,
    deploymentsByProject,
    timelinesByProject,
    dependentForByProjects
  } = store.calculated;

  const project = reactive(proj);

  const isNew = computed(() => project._key === null || project._key === undefined);
  const isFavorite = computed(() => state.app.user && state.app.user.settings.favoriteProjects.includes(project.id));

  const dependsOnProjects = computed(() => project.dependsOnProjects.map(id => projectById.value[id]).filter(proj => !!proj));
  const dependentForProjects = computed(() => dependentForByProjects.value[project.id] || []);

  const timelines = computed(() => timelinesByProject.value[project.id] || []);
  const currentTimelines = computed(() => {
    const [todayString] = new Date().toJSON().split('T');

    return timelines.value.filter(ms => todayString >= ms.startDate && todayString <= ms.endDate);
  });
  const currentTimelineChartRows = computed(() =>
    currentTimelines.value.map(ms => ({
      timeline: ms.name,
      startDate: new Date(ms.startDate),
      endDate: new Date(ms.endDate),
    }))
  );

  const deployments = computed(() => deploymentsByProject.value[project.id] || []);

  const items = computed(() => itemsByProject.value[project.id] || []);
  const itemsByVersion = computed(() => helpers.createForeignKeyMap(items.value, 'version')); 
  const pendingItems = computed(() => items.value.filter(item => !['Closed', 'Hold'].includes(item.status)));

  const stats = computed(() => {
    const total = items.value.length;
    const pending = pendingItems.value.length;
    const closed = total - pending;
    const percent = closed / (total || 1) * 100;

    return {
      totalItems: total,
      pendingItems: pending,
      closedItems: closed,
      completePercent: `${percent.toFixed(2)}%`
    };
  });
  const versions = computed(() => {
    const uniques = new Set(items.value.map(item => item.version));
    return [...uniques].sort((a, b) => a < b ? -1 : 1);
  });

  const relatedTree = computed(() => {
    const tree = {};

    items.value.forEach(item => {
      const parent = itemById.value[item.parent];
      let parentNode;
      let itemNode;

      if (!!parent) {
        parentNode = tree[parent.id];
        if (!parentNode) {
          parentNode = {
            item: parent,
            parent: null,
            related: []
          };
          tree[parent.id] = parentNode;
        }
      }

      itemNode = tree[item.id];
      if (!itemNode) {
        itemNode = {
          item,
          parent: parentNode,
          related: []
        };

        tree[item.id] = itemNode;
      } else {
        itemNode.parent = parentNode;
      }

      if (parentNode)
        parentNode.related.push(itemNode);
    });

    return tree;
  });

  /**
   * Recursively gets all related items of all related items
   * @param {Object} item - item to get related list
   * @returns {Object[]} list of all related items
   */
  const getDeepItemRelatedList = (item) => {
    const node = relatedTree.value[item.id];
    const items = node.related.map(related => related.item);
    return [
      ...items,
      ...node.related.map(related => getDeepItemRelatedList(related.item)).flat()
    ];
  };

  const validation = useSchemaValidation({ reactiveObj: project, schema: schema.Project });
  const isValid = computed(() => validation.isValid.value);

  const canEdit = computed(() => true);

  const priorityTag = computed(() => {
    const tags = {
      Critical: 'is-danger',
      High: 'is-warning',
      Medium: 'is-dark',
      Low: 'is-light'
    };

    return tags[project.priority] || '';
  });

  /**
   * Quicksaves without queue or validity check
   */
  const quicksave = async () => {
    return await dispatch.project.saveProject(project);
  }

  /**
   * dispatches save request
   */
  const autosaver = async () => {
    if (!isValid.value)
      return;

    return await dispatch.project.saveProject(project);
  };

  const {
    closeQueue,
    enqueue,
    cancelAutosave,
    autosave
  } = useAsyncQueueDebouncedAutosave(autosaver);

  /**
   * Dispatches a save request
   */
  const saveProject = async () => {
    return await enqueue(autosaver);
  };

  /**
   * Dispatches delete request
   */
  const deleteProject = async () => {
    cancelAutosave.value = true;
    const response = enqueue(
      () => dispatch.project.deleteProject(project)
    );
    closeQueue.value = true;
    return await response;
  };

  /**
   * Dispatches an update project version (which will update all outstanding item versions to move them forward to the next v)
   */
  const updateProjectVersion = async (version) => {
    if (!isValid.value)
      return;

    project.version = version;
    return await enqueue(
      () => dispatch.project.updateProjectVersion(project)
    );
  };

  /**
   * Dispatches an update to the user settings for favorit projects
   */
  const toggleProjectFavorite = async () => {
    const user = state.app.user;
    if (!user)
      return;

    if (isFavorite.value)
      user.settings.favoriteProjects = user.settings.favoriteProjects.filter(id => id !== project.id)
    else
      user.settings.favoriteProjects.push(project.id);

    return await dispatch.user.saveUser(user);
  };

  const duplicate = () => dispatch.project.duplicateProject(project);

  /**
   * Creates a PRD file from template, adds to links, saves
   */
  const createProjectPrdLink = async () => {
    const response = await dispatch.util.createPrdTemplate({ name: `${project.name}_PRD` });
    const info = response.body;
    
    // project.links.push({
    //   name: info.name,
    //   url: info.url,
    // });
    autosave();
  };
  
  /**
   * Re-orders the link array (if it is an array that is)
   * @param {Number} currIndex - current item index to re-order
   * @param {Number} newIndex - new index to place item
   */
  const reorderLink = (currIndex, newIndex) => {
    const [el] = project.links.splice(currIndex, 1);
    if (el === undefined)
      throw new Error(`No element at index ${currIndex} in array, cannot re-order!`);

    const adjustedIndex = Math.min(Math.max(newIndex, 0), project.links.length);
    project.links = [
      ...project.links.slice(0, adjustedIndex),
      el,
      ...project.links.slice(adjustedIndex)
    ];
  };

  /**
   * Adds a new link to the links list
   * @param {Object} el - new link el
   */
  const addLink = (el) => project.links.push(el);

  /**
   * Removes a link from the links list
   * @param {Number} index - el to delete
   */
  const removeLink = (index) => {
    const [removed] = project.links.splice(index, 1);
    return removed;
  };

  return reactive({
    project,
    isNew,
    isFavorite,
    dependsOnProjects,
    dependentForProjects,
    timelines,
    currentTimelines,
    currentTimelineChartRows,
    deployments,
    items,
    itemsByVersion,
    pendingItems,
    stats,
    versions,
    relatedTree,
    getDeepItemRelatedList,
    validation,
    isValid,
    canEdit,
    priorityTag,
    quicksave,
    saveProject,
    autosave,
    deleteProject,
    updateProjectVersion,
    toggleProjectFavorite,
    duplicate,
    createProjectPrdLink,
    reorderLink,
    addLink,
    removeLink
  });
};
const useQueueViewModel = ({ initialId } = {}) => {
  /** @type {VueOverrides} */
  const {
    ref,
    computed,
    reactive,
  } = Vue;

  const {
    state,
    dispatch,
  } = store;

  const {
    itemById
  } = store.calculated;

  const queue = computed(() =>
    state.app.user.settings.queue || []
  );

  const items = computed(() => queue.value.map(id => itemById.value[id]).filter(Boolean));
  const selectedItem = ref(itemById.value[initialId] || items.value[0]);

  /** @param {string} id */
  const push = (id) => {
    const q = new Set(queue.value);
    q.add(id);
    state.app.user.settings.queue = [...q];

    return itemById.value[id];
  };

  /** @param {string} id */
  const pop = (id) => {
    const q = new Set(queue.value);
    q.delete(id);
    state.app.user.settings.queue = [...q];

    return itemById.value[id];
  };

  /**
   * Reorders the given id in the queue
   * @param {string} id 
   * @param {number} position - new position index
   */
  const reorder = (id, position) => {
    const current = queue.value.indexOf(id);
    if (current === -1) return;

    // dragging current 1 to position 2;
    // should stay the same

    // dragging current 1 to position 1;
    // should stay the same

    const isSame = current === position;
    if (isSame) return;

    const isDown = current < position;
    const targetPosition = isDown ? position - 1 : position;
    if (targetPosition > queue.value.length || targetPosition < 0) return;

    const fresh = queue.value.filter(q => q !== id);

    const ordered = [
      ...fresh.slice(0, targetPosition),
      id,
      ...fresh.slice(targetPosition)
    ];

    state.app.user.settings.queue = ordered;

    return ordered.map(id => itemById.value[id]).filter(Boolean);
  };

  /** @param {IItem} itm */
  const handleNewItem = (itm) => selectedItem.value = itm;

  const autosave = dispatch.user.autosaveAppUser;

  return reactive({
    queue,
    items,
    selectedItem,
    push,
    pop,
    reorder,
    handleNewItem,
    autosave
  });
};
/**
 * logic based on timeline state
 * @param {Object} mile - timeline
 * @returns {Object} composed reactive state
 */
const useTimelineViewModel = (mile) => {
  // 'imports' from Vue
  const {
    computed,
    reactive
  } = Vue;

  // 'imports' from store.state
  const {
    dispatch,
    schema
  } = store;

  // 'imports' from store.calculated
  const {
    projectById
  } = store.calculated;

  const adt = AppsDateTime.adt();

  const timeline = reactive(mile);

  const isNew = computed(() => timeline._key === null || timeline._key === undefined);
  const projects = computed(() => timeline.projects.map(id => projectById.value[id]).filter(p => !!p));

  const startDate = computed(() => {
    if (!timeline.startDate)
      return new Date(null);

    return adt.fromString(timeline.startDate) || new Date(null);
  });
  const endDate = computed(() => {
    if (!timeline.endDate)
      return new Date(null);

    return adt.fromString(timeline.endDate) || new Date(null);
  });

  // Formula to estimate the 'complexity' of a timeline
  const complexityIndex = computed(() => {
    const weights = {
      effort: .20,
      priority: .40,
      magnitude: .20,
      duration: .10,
      projects: .10
    };

    const durationLogE = Math.log(endDate.value.valueOf() - startDate.value.valueOf());

    const index =
      (timeline.effort || 0) * weights.effort +
      (timeline.priority || 0) * weights.priority +
      (timeline.magnitude || 0) * weights.magnitude +
      (durationLogE || 0) * weights.duration +
      projects.value.length * weights.effort;

    return Math.round(index * 100) / 100;
  });

  const duration = computed(() =>
    !timeline.startDate || !timeline.endDate ? '(unknown)' : adt.diff(startDate.value, endDate.value).pretty()
  );
  const isPast = computed(() => endDate.value < new Date());
  const remaining = computed(() => !timeline.endDate ? '(unknown)' : isPast.value ? '0 days' : adt.interval(endDate.value));

  const statusBulmaTag = computed(() => {
    const tags = {
      Open: 'is-success',
      Closed: 'is-info',
    };

    return tags[timeline.status] || 'is-light';
  });

  const validation = useSchemaValidation({ reactiveObj: timeline, schema: schema.Timeline });
  const isValid = computed(() => validation.isValid.value);

  const canEdit = computed(() => true);

  /**
   * Quicksaves without queue or validity check
   */
  const quicksave = async () => {
    return await dispatch.timeline.saveTimeline(timeline);
  }

  /**
   * dispatches save request
   */
  const autosaver = async () => {
    if (!isValid.value)
      return;

    return await dispatch.timeline.saveTimeline(timeline);
  };

  const {
    closeQueue,
    enqueue,
    cancelAutosave,
    autosave,
    isAutosaving
  } = useAsyncQueueDebouncedAutosave(autosaver);

  /**
   * Dispatches a save request
   */
  const saveTimeline = async () => {
    return await enqueue(autosaver);
  };

  /**
   * Dispatches delete request
   */
  const deleteTimeline = async () => {
    cancelAutosave.value = true;
    const response = enqueue(
      () => dispatch.timeline.deleteTimeline(timeline)
    );
    closeQueue.value = true;
    return await response;
  };

  return reactive({
    timeline,
    isNew,
    projects,
    startDate,
    endDate,
    complexityIndex,
    duration,
    remaining,
    statusBulmaTag,
    validation,
    isValid,
    canEdit,
    quicksave,
    saveTimeline,
    autosave,
    isAutosaving,
    deleteTimeline,
  });
};
/**
 * logic based on user state
 * @param {Object} usr - user
 * @returns {Object} composed reactive state
 */
 const useUserViewModel = (usr) => {
  // 'imports' from Vue
  const {
    reactive
  } = Vue;

  // 'imports' from store
  const {
    dispatch
  } = store;

  const user = reactive(usr);

  /**
   * dispatches save request
   */
  const saveUser = async () => {
    await dispatch.user.saveUser(user);
  };

  return reactive({
    user,
    saveUser
  });
};
/**
 * logic based on user state
 * @param {string} eml - user email
 * @returns {Object} composed reactive state
 */
const useWorkloadViewModel = (eml) => {
  // 'imports' from Vue
  const {
    ref,
    computed,
    reactive
  } = Vue;

  // 'imports' from store.state
  const {
    state
  } = store;

  // 'imports' from store.calculated
  const {
    itemsByProject
  } = store.calculated;

  const email = ref(eml);

  const username = computed(() => {
    const [primary] = email.value.split('@');
    const parts = primary.split('.');

    return parts.map(p => (p.charAt(0).toUpperCase() + p.slice(1))).join(' ');
  });

  const projects = computed(() => state.data.projects.filter(project => project.owner === email.value));
  const stablePojects = computed(() => projects.value.filter(project => project.status === 'Stable'));
  const activeProjects = computed(() => projects.value.filter(project => ['Planning', 'Development', 'System testing', 'UAT'].includes(project.status)));

  const activeProjectItems = computed(() => {
    let items = [];
    activeProjects.value.forEach(project => {
      const projectItems = itemsByProject.value[project.id] || [];
      const activeItems = projectItems.filter(item => ['New', 'Open', 'Testing'].includes(item.status));
      items = [
        ...items,
        ...activeItems
      ];
    });

    return items;
  });

  const workload = computed(() => {
    // other stats?  items over time...  whatever and whatnot
    
    return {
      stableProjects: stablePojects.value.length,
      activeProjects: activeProjects.value.length,
      activeProjectItems: activeProjectItems.value.length
    };
  });

  return reactive({
    email,
    username,
    projects,
    stablePojects,
    activeProjects,
    activeProjectItems,
    workload
  });
};
/**
 * Request type definition
 * @typedef {Object} AppsRequest
 * @property {string} method - request method ('get', 'post', 'delete')
 * @property {Object} headers - key value headers
 * @property {string} route - requested route
 * @property {Object} params - request parameters
 * @property {Object} body - request body
 */

/**
 * Response type definition
 * @typedef {Object} AppsResponse
 * @property {number} status - http status code
 * @property {string} type - http mime type
 * @property {Object} headers - key value headers
 * @property {Object} body - request body
 */

/**
 * App client to server api handler
 * @param {Object} [options] - optional options
 * @param {Function} [options.errorHandler] - optional error handler function for all requests
 * @param {string} [options.env] - optional environment
 */
const AppsClient = (options = {}) => {
  //TODO: options?

  const errorHandler = options.errorHandler && typeof options.errorHandler === 'function'
    ? options.errorHandler
    : () => { };

  const env = options.env || 'development'

  const STATUS_CODE = {
    SUCCESS: 200,
    CREATED: 201,
    BAD_REQUEST: 400,
    FORBIDDEN: 403,
    NOT_FOUND: 404,
    SERVER_ERROR: 500
  };

  const MIME_TYPES = {
    JSON: 'application/json',
    HTML: 'text/html'
  };

  const request = (route) => {
    const req = {
      route,
      method: '',
      headers: {},
      body: null
    };

    /**
     * Sends request to server api
     * @param {any} body 
     * @returns {Promise<AppsResponse>}
     */
    const send = (body) => new Promise((resolve, reject) => {
      req.body = body || null;

      if (env !== 'production')
        console.log('AppsClient.send', req);

      google.script.run
        .withSuccessHandler(res => {
          res = JSON.parse(res);

          if (env !== 'production')
            console.log('AppsClient response', res);

          if ([
            STATUS_CODE.BAD_REQUEST,
            STATUS_CODE.FORBIDDEN,
            STATUS_CODE.NOT_FOUND,
            STATUS_CODE.SERVER_ERROR
          ].includes(res.status)) {
            const err = new Error(res.body.message);
            err.name = res.body.name || 'Error';
            err.stack = res.body.stack;

            errorHandler(err);
            reject(err);
          }
          else
            resolve(res);
        })
        .withFailureHandler(error => {
          errorHandler(error);
          reject(error);
        })
        .api(req);
    });

    const headers = (hdrs) => {
      req.headers = {
        ...req.headers,
        ...hdrs
      };

      return api;
    };

    const method = (mthd) => {
      req.method = mthd;
      return api;
    }

    const api = {
      method,
      headers,
      send
    };

    return api;
  };

  const get = (route) => {
    const req = request(route);
    req.method('get');

    return req;
  };

  const post = (route) => {
    const req = request(route);
    req.method('post');

    return req;
  };

  const del = (route) => {
    const req = request(route);
    req.method('delete');

    return req;
  };

  return {
    get,
    post,
    delete: del
  };
};
/**
 * Creates new apps data poll request obj
 * @param {Object} options - options
 * @param {Function} options.pollfn - poll function to exec
 * @param {number} [options.interval] - optional poll interval (ignored if long)
 * @param {boolean} [options.long] - optional flag for long polling
 * @param {boolean} [options.logging] - optional flagg for logging (console logs)
 */
const AppsDataPollRequest = ({
  pollfn,
  interval = 1000 * 60 * 10,
  long = true,
  logging = false
}) => {

  if (typeof pollfn !== 'function')
    throw new Error('pollfn arg must be of type function!');

  // ignore interval if this is long-polling (meaning a new poll request will be sent immediately after on returns)
  interval = !!long ? 0 : interval;

  /**
   * 1. Keep track of when polling happens [done]
   * 2. Poll at a (cancellable) interval [doneish]
   * 3. Only poll if browser is active (configurable?) [done]
   * 4. Server side could handle some poll caching (like timing for when datasources where last updated...)
   */

  const context = {
    state: 'init',
    pending: false,
    errorcount: 0
  };

  const MAX_ERRORS_BEFORE_QUIT = 3;

  /**
   * Handler function for managing polling status when the browser becomes inactive
   */
  const inactiveHandler = () => {
    const isActive = document.visibilityState === 'visible';

    console.log(`%c${document.visibilityState}`, `color: ${isActive ? 'green' : 'red' };`); //DEBUG

    if (isActive && context.state === 'paused' && !context.pending) {
      sched.start();
    } else if (isActive && context.state === 'paused') {
      sched.unpause();
    } else if (!isActive && context.state === 'active') {
      sched.cancel();
      sched.pause();
      if (closefn && typeof closefn === 'function')
        closefn();
    }
  };

  /**
   * Activates inactive poll handler
   */
  const sleep = () => {
    document.addEventListener('visibilitychange', inactiveHandler);
    return api;
  };

  /**
   * Deactivates inactive poll handler
   */
  const awake = () => {
    document.removeEventListener('visibilitychange', inactiveHandler);
    return api;
  };

  /**
   * Execs polling based on polling state
   */
  const poll = async () => {
    if (logging)
      console.log('poll()', context);

    if (context.state === 'active') {
      try {
        context.pending = true;
        const response = await pollfn(context.lastPoll);
        context.pending = false;
        context.errorcount = 0;
        //Recheck for state after async call
        if (context.state === 'active')
          sched.start();

        return response;
      } catch (err) {
        context.errorcount++;
        if (context.errorcount < MAX_ERRORS_BEFORE_QUIT) {
          sched.start();
        } else {
          context.errorcount = 0;
          sched.cancel();
          console.warn(`Scheduled polling failed ${MAX_ERRORS_BEFORE_QUIT} time(s) and was cancelled. Call the start() method to restart polling.`);
        }

        throw err;
      }

    }

  };

  /**
   * Handles scheduled polling states/actions
   */
  const scheduler = () => {
    let id;

    /**
     * Starts the polling schedule
     * @param {Object} options 
     * @param {Object} [options.immediate] - flag for sending the poll request immediately 
     */
    const start = ({ immediate = false } = {}) => {
      context.state = 'active';

      if (id)
        clearTimeout(id);

      id = setTimeout(api.poll, immediate ? 0 : interval);
      messageEvent();

      if (logging)
        console.log('scheduler.start()');

      return id;
    };

    /**
     * Pauses the schedule
     */
    const pause = () => {
      context.state = 'paused';
      messageEvent();

      if (logging)
        console.log('scheduler.pause()');
    };

    /**
     * Unpauses the schedule
     */
    const unpause = () => {
      context.state = 'active';
      messageEvent();

      if (logging)
        console.log('scheduler.unpause()');
    };

    /**
     * Cancels the schedule
     */
    const cancel = () => {
      if (id)
        clearTimeout(id);
      context.state = 'cancelled';
      messageEvent();

      if (logging)
        console.log('scheduler.cancel()');
    };

    return {
      start,
      pause,
      unpause,
      cancel,
      status: () => context.state
    };
  };

  const sched = scheduler();

  let closefn;
  /**
   * Sets a handler callback for when the poller disconnects (cancels)
   * @param {Function} fn - callback function to for on disconnect
   */
  const onDisconnect = (fn) => {
    closefn = fn;
    return api;
  };

  let messageHandler;
  /**
   * Sets handler callback for polling messages (recieving responses)
   * @param {Function} fn - callback function for on message
   */
  const onMessage = (fn) => {
    messageHandler = fn;
    return api;
  };

  /**
   * Helper to exec message handler function if it exists
   */
  const messageEvent = () => {
    if (messageHandler && typeof messageHandler === 'function')
      messageHandler({ ...context });
  };

  const api = {
    poll,
    sleep,
    awake,
    scheduler: sched,
    onDisconnect,
    onMessage
  };

  return api;

};
const AppsWorker = (id) => {
  // https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers
  const script = document.querySelector(`#${id}`);
  if (!script)
    throw new Error(`<script> with id ${id} not found!`);

  if (script.getAttribute('type') !== 'text/js-worker')
    throw new Error(`<script> with id ${id} has the incorrect 'type' should be 'text/js-worker'!`);

  const blob = new Blob([script.textContent]);
  const worker = new Worker(window.URL.createObjectURL(blob));

  const exec = async (action, ...args) => {
    return new Promise((resolve, reject) => {
      const id = crypto.randomUUID();
      const handler = (e) => {
        if (e.data.id === id) {
          worker.removeEventListener('message', handler);
          resolve(e.data.result);
        }
      };

      const err = (error) => {
        worker.removeEventListener('error', err);
        reject(error);
      };

      worker.addEventListener('error', err);
      worker.addEventListener('message', handler);

      worker.postMessage({
        id,
        action,
        args
      });
    });
  };

  return {
    exec,
    worker
  };
};
// https://www.freecodecamp.org/news/javascript-debounce-example/
const debounce = (fn, wait) => {
  let timeout = null;
  return (...args) => {
    clearTimeout(timeout);
    timeout = setTimeout(() => fn(...args), wait);
  };
};
/**
 * Initializer for app keyboard shortcuts
 * @param {Vue} vueApp - vue root app model
 */
const IspKeyboardShortcuts = (vueApp) => {

  const actions = {
    // GOTO navbar search
    'ctrl+alt+/': (event) => {
      event.preventDefault();

      const searchContainer = document.querySelector('#nav-full-text-search');
      if (!searchContainer)
        return;

      const search = searchContainer.querySelector('input');
      if (search) {
        search.focus();
        search.select();
      }
    },

    // GOTO dashboard
    'ctrl+alt+h': (event) => {
      event.preventDefault();

      vueApp.$router.push('/');
    },

    // GOTO my projects
    'ctrl+alt+p': (event) => {
      event.preventDefault();

      vueApp.$router.push({
        path: '/projects',
        query: { tab: 'mine' },
      });
    },

    // GOTO queue
    'ctrl+alt+q': (event) => {
      event.preventDefault();

      vueApp.$router.push('/queue');
    },

    // GOTO my items
    'ctrl+alt+i': (event) => {
      event.preventDefault();

      vueApp.$router.push({
        path: '/items',
        query: { tab: 'mine' },
      });
    },

    // GOTO timelines
    'ctrl+alt+c': (event) => {
      event.preventDefault();

      vueApp.$router.push('/timelines-chart');
    },

    // GOTO settings
    'ctrl+alt+s': (event) => {
      event.preventDefault();

      vueApp.$router.push('/settings');
    },

  };

  const handler = (event) => {
    let key = '';

    if (event.ctrlKey)
      key += 'ctrl+';
    if (event.altKey)
      key += 'alt+';
    if (event.shiftKey)
      key += 'shift+';

    key += event.key.toLowerCase();

    const action = actions[key];
    if (action)
      action.call(null, event);
  };

  const connect = () => document.addEventListener('keydown', handler);
  const disconnect = () => document.removeEventListener('keydown', handler);

  return {
    connect,
    disconnect
  };

};

/**
 * App client to server api handler
 * @param {Object} [options] - optional options
 * @param {Function} [options.errorHandler] - optional error handler function for all requests
 * @param {string} [options.env] - optional environment
 */
const MockAppsClient = (options = {}) => {
  
  const errorHandler = options.errorHandler && typeof options.errorHandler === 'function'
    ? options.errorHandler
    : () => { };

  const env = options.env || 'development'

  const STATUS_CODE = {
    SUCCESS: 200,
    CREATED: 201,
    BAD_REQUEST: 400,
    FORBIDDEN: 403,
    NOT_FOUND: 404,
    SERVER_ERROR: 500
  };

  const MIME_TYPES = {
    JSON: 'application/json',
    HTML: 'text/html'
  };

  const request = (route) => {
    const req = {
      route,
      method: '',
      headers: {},
      body: null
    };

    /**
     * Sends request to server api
     * @param {any} body 
     * @returns {Promise<AppsResponse>}
     */
    const send = (body) => new Promise((resolve, reject) => {
      req.body = body || null;

      if (env !== 'production')
        console.log('AppsClient.send', req);

      const server = MockServer.server();

      const res = server.request(req);

      if (env !== 'production')
        console.log('AppsClient response', res);

      if ([
        STATUS_CODE.BAD_REQUEST,
        STATUS_CODE.FORBIDDEN,
        STATUS_CODE.NOT_FOUND,
        STATUS_CODE.SERVER_ERROR
      ].includes(res.status)) {
        const err = new Error(res.body.message);
        err.name = res.body.name || 'Error';
        err.stack = res.body.stack;

        errorHandler(err);
        reject(err);
      }
      else
        resolve(res);
    });

    const headers = (hdrs) => {
      req.headers = {
        ...req.headers,
        ...hdrs
      };

      return api;
    };

    const method = (mthd) => {
      req.method = mthd;
      return api;
    };

    const api = {
      method,
      headers,
      send
    };

    return api;
  };

  const get = (route) => {
    const req = request(route);
    req.method('get');

    return req;
  };

  const post = (route) => {
    const req = request(route);
    req.method('post');

    return req;
  };

  const del = (route) => {
    const req = request(route);
    req.method('delete');

    return req;
  };

  return {
    get,
    post,
    delete: del
  };
};
class MockApiError extends Error {
  constructor(message, { code = 400 } = {}) {
    super(message);
    this.code = code;
  }
}

class MockAppsServer {

  /**
   * @param {*} options 
   */
  static create(options = {}) {
    //TODO: default options
    const debug = options.debug || false;

    const STATUS_CODE = {
      SUCCESS: 200,
      CREATED: 201,
      BAD_REQUEST: 400,
      UNAUTHORIZED: 401,
      FORBIDDEN: 403,
      NOT_FOUND: 404,
      SERVER_ERROR: 500
    };

    const MIME_TYPES = {
      JSON: 'application/json',
      HTML: 'text/html',
      CSV: 'text/csv',
      JS: 'js/object',
      RAW: 'data/raw'
    };

    const parseRouteWithParams = (route) => {
      const params = {};
      const [routestr, paramstr] = route.split('?');

      if (!paramstr)
        return {
          route: routestr,
          params
        };

      const elements = paramstr.split('&');
      elements.forEach(el => {
        const [prop, val] = el.split('=');
        params[decodeURIComponent(prop)] = decodeURIComponent(val);
      });

      return {
        route: routestr,
        params
      };
    };

    /**
     * Attempts to find and tokenize a matching route with named parames (ie. /home/user/:id)
     * @param {AppsRequest} req - request obj
     * @param {Object} method - route methods
     */
    const findTokenRoute = (req, method) => {
      const tokenRoutes = Object.keys(method).filter(key => key.includes(':'));

      for (const route of tokenRoutes) {
        const tk = tokenizeRoute(route);
        if (tk.isMatch(req.route)) {
          req.params = {
            ...req.params,
            ...tk.paramsFromTokens(req.route)
          };
          return method[route];
        }
      }
    };

    /**
     * Tokenizes a registered route so that it can be used to match a requested route
     * @param {string} route - registered route to tokenize for matching
     */
    const tokenizeRoute = (route) => {
      const parts = route.split('/');
      // if theres a part that starts with ':' it means its a route param,
      // so that means we have to pick that part out of the actual route and get that as a param somehow...
      // So the regex could become => :param replace with [^/]* then matching...
      // and the param could remember where it came from (before and after uri, then match within...)

      const tokens = [];
      parts.forEach((p, i) => {
        if (p.startsWith(':')) {
          tokens.push([parts[i - 1] || '', p, [parts[i + 1] || '']]);
        }
      });

      // now we can match the route still...
      const matcher = route.replace(/:[^/]*/g, '[^/]*');
      const isMatch = (sent) => new RegExp(matcher).test(sent);

      // and when we get a route, we can match the values
      const paramsFromTokens = (sent) => {
        const params = {};
        tokens.forEach(t => {
          const key = t[1].replace(':', '');
          const before = t[0];
          const after = t[2];

          const [match] = (sent.match(`(?<=.*/${before !== undefined ? before : ''}/)([^/]*)(?=/?${after !== undefined ? after : ''}.*)`) || []);
          params[key] = decodeURIComponent(match);
        });

        return params;
      };

      return { isMatch, paramsFromTokens };

    };

    const matchRoute = (pattern, route) => new RegExp(pattern).test(route);

    const middleware = [];
    const use = (route, fn) => {
      const mw = (req, res, next) => {
        if (!matchRoute(route, req.route))
          return next();

        return fn(req, res, next);
      }
      middleware.push(mw);
    };

    const errors = [];
    const error = (fn) => errors.push(fn);

    const gets = {};
    const get = (route, ...fns) => {
      gets[route] = fns;
    };

    const posts = {};
    const post = (route, ...fns) => {
      posts[route] = fns;
    };

    const deletes = {};
    const del = (route, ...fns) => {
      deletes[route] = fns;
    };

    const methods = {
      get: gets,
      post: posts,
      delete: deletes
    };

    /**
     * Print routes
     */
    const inspect = () => {
      let details = 'AppsServer inspect:\n\n';

      details += 'GET ROUTES\n';
      details += '---------------------\n';
      details += Object.keys(gets).join('\n');
      details += '\n---------------------\n\n';

      details += 'POST ROUTES\n';
      details += '---------------------\n';
      details += Object.keys(posts).join('\n');
      details += '\n---------------------\n\n';

      details += 'DELETE ROUTES\n';
      details += '---------------------\n';
      details += Object.keys(deletes).join('\n');
      details += '\n---------------------\n\n';

      console.log(details);
      return details;
    };

    /**
     * Create new response obj
     */
    const response = () => {
      const res = {
        status: 999,
        headers: {},
        type: MIME_TYPES.JSON,
        body: null,
      };

      /**
       * Handler of response typing
       */
      res.toType = () => {
        if (res.type === MIME_TYPES.JSON)
          return JSON.stringify(res);

        if (res.type === MIME_TYPES.RAW)
          return res.body;

        return res;
      };

      const isSuccess = () => res.status >= 200 && res.status < 300;

      const send = (body) => {
        res.body = body;
        return res;
      };

      const render = ({ html, file }, props) => {

        res.status = STATUS_CODE.SUCCESS;
        res.type = MIME_TYPES.HTML;
        res.body = html || file;

        return res;
      };

      const type = (ty) => {
        res.type = ty;
        return api;
      };

      const status = (code) => {
        res.status = code;
        return api;
      };

      const headers = (hdrs) => {
        res.headers = {
          ...res.headers,
          ...hdrs
        };
        return api;
      };

      const api = {
        locals: {},
        isSuccess,
        send,
        render,
        status,
        headers,
        type,
        res
      };

      return api;
    };

    /**
     * Middleware stack composer
     * @param {AppsRequest} req - request
     * @param {AppsResponse} res - response
     * @param {Function[]} handlers - route handlers
     */
    const mwstack = (req, res, handlers) => {
      let index = 0;
      const all = [
        ...middleware,
        ...handlers
      ];

      const nxt = (i) => {
        index = i;

        let mw = all[index];
        if (!mw) {
          // If we have made it to the last element of the stack (which will be the route handler, it is undefined, return NOT_FOUND_RESPONSE)
          if (index === all.length)
            return res.status(STATUS_CODE.NOT_FOUND).send({ message: `${req.route} not a valid route!` })
          else
            throw new Error(`Something went wrong in the mw stack for index ${index}`);
        }

        return mw(req, res, nxt.bind(null, index + 1));
      };

      return nxt(0);
    }

    /**
     * Handles a request from the client
     * @param {AppsRequest} req - request options
     * @returns {AppsResponse} response 
     */
    const request = (req) => {

      try {
        req.by = 'Me';
        req.auth = {};

        req.params = req.params || {};
        req.rawRoute = req.route;

        const parsed = parseRouteWithParams(req.route);
        req.route = parsed.route;
        req.params = {
          ...req.params,
          ...parsed.params
        };

        const res = response();
        const method = methods[String(req.method).toLowerCase()] || {};

        let handler = method[req.route];
        if (!handler)
          handler = findTokenRoute(req, method) || [];

        debug && console.time('mwstack');
        mwstack(req, res, handler);
        debug && console.timeEnd('mwstack');

        return res.res;
      } catch (error) {
        const res = response();
        console.error(error);
        console.error(error.stack);

        res.status(error.code || STATUS_CODE.SERVER_ERROR)
          .send({
            name: error.name,
            message: error.code ? error.message : 'Something went wrong!',
            stack: debug ? error.stack : undefined
          });

        errors.forEach(handler => {
          try {
            handler(error, req);
          } catch (handlerError) {
            console.error(handlerError);
            console.error(handlerError.stack);
          }
        });

        if (debug) {
          console.log('error-request', req);
          console.log('error-response', res);
        }

        return res.res;
      }

    };

    /**
     * Helper to handle client requests, call this from the top level "api" function in your app
     * @param {AppsRequest} req - request
     */
    const handleClientRequest = (req = {}) => {
      if (typeof req === 'string')
        req = JSON.parse(req);
      //ignore any additional props of the request so we know the request is clean when it comes in
      const {
        method,
        headers,
        route,
        params,
        body
      } = req;

      return request({
        method,
        headers,
        route,
        params,
        body
      }).toType();
    };

    return {
      STATUS_CODE,
      MIME_TYPES,
      inspect,
      use,
      error,
      get,
      post,
      delete: del,
      request,
      handleClientRequest
    };
  }

}
const MockDatabase = {

  nextKey: 1,

  db: {
    Projects: [{
      _key: '1',
      id: 'project-0',
      name: 'Portfolio',
      description: 'Developer portfolio project',
      version: '1.0',
      status: 'Development',
      categories: ['Website'],
      platforms: ['HTML', 'CSS', 'JavaScript'],
      dependsOnProjects: [],
      priority: 'High',
      accessibilityStatus: 'Open',
      iteration: '',
      planningNotes: 'Outline projects to include...',
      program: 'All',
      hasPII: false,
      links: [],
      owner: 'Me',
      backup: 'Me',
      isPublic: false,
      createdBy: 'Me',
      createdDate: '2024-11-03T13:50:58.758Z',
      modifiedBy: 'Me',
      modifiedDate: '2024-11-03T13:50:58.758Z'
    },
    {
      _key: '2',
      id: 'project-1',
      name: 'Project tracking app',
      description: 'This app!',
      version: '1.0',
      status: 'Development',
      categories: ['App'],
      platforms: ['HTML', 'CSS', 'JavaScript', 'Vue.js', 'Bulma.css'],
      dependsOnProjects: [],
      priority: 'High',
      accessibilityStatus: 'Open',
      iteration: '',
      planningNotes: '',
      program: 'All',
      hasPII: false,
      links: [],
      owner: 'Me',
      backup: 'Me',
      isPublic: false,
      createdBy: 'Me',
      createdDate: '2024-11-03T13:50:58.758Z',
      modifiedBy: 'Me',
      modifiedDate: '2024-11-03T13:50:58.758Z'
    }],
  
    Timelines: [{
      _key: '1',
      id: 'timeline-0',
      projects: ['project-0'],
      name: 'First iteration of portfolio',
      description: 'Complete the first iteration of the portfolio',
      status: 'Open',
      effort: 7,
      priority: 2,
      magnitude: 1,
      impacts: [],
      notes: '',
      startDate: '2024-10-01',
      endDate: '2025-01-01',
      createdBy: 'Me',
      createdDate: '2024-11-03T13:50:58.758Z',
      modifiedBy: 'Me',
      modifiedDate: '2024-11-03T13:50:58.758Z'
    }],
  
    Items: [{
      _key: '1',
      id: 'item-0',
      itemNumber: 100,
      project: 'project-0',
      deployment: '',
      parent: '',
      name: 'Add projects',
      description: 'Add the projects page to the portfolio',
      tags: [],
      files: [],
      version: '1.0',
      type: 'Task',
      priority: 'Medium',
      status: 'Open',
      scheduledDate: null,
      hours: null,
      resolvedDate: '',
      closedDate: '',
      assignee: 'Me',
      createdBy: 'Me',
      createdDate: '2024-11-03T13:50:58.758Z',
      modifiedBy: 'Me',
      modifiedDate: '2024-11-03T13:50:58.758Z'
    },
    {
      _key: '2',
      id: 'item-1',
      itemNumber: 101,
      project: 'project-0',
      deployment: '',
      parent: '',
      name: 'Add contact page',
      description: 'Include links for contacting!',
      tags: [],
      files: [],
      version: '1.0',
      type: 'Task',
      priority: 'Medium',
      status: 'Testing',
      scheduledDate: null,
      hours: null,
      resolvedDate: '',
      closedDate: '',
      assignee: 'Me',
      createdBy: 'Me',
      createdDate: '2024-11-03T13:50:58.758Z',
      modifiedBy: 'Me',
      modifiedDate: '2024-11-03T13:50:58.758Z'
    },
    {
      _key: '3',
      id: 'item-2',
      itemNumber: 102,
      project: 'project-1',
      deployment: '',
      parent: '',
      name: 'Create client mocking files',
      description: 'These will allow the app to run as a sample in the browser without making any actuall server calls',
      tags: ['Sample'],
      files: [],
      version: '1.0',
      type: 'Task',
      priority: 'Crtical',
      status: 'Closed',
      scheduledDate: null,
      hours: null,
      resolvedDate: '',
      closedDate: '',
      assignee: 'Me',
      createdBy: 'Me',
      createdDate: '2024-11-03T13:50:58.758Z',
      modifiedBy: 'Me',
      modifiedDate: '2024-11-03T13:50:58.758Z'
    }],
  
    Comments: [{
      _key: '1',
      id: 'comment-0',
      item: 'item-0',
      comment: 'Added the ASV project',
      createdBy: 'Me',
      createdDate: '2024-11-03T13:50:58.758Z',
      modifiedBy: 'Me',
      modifiedDate: '2024-11-03T13:50:58.758Z'
    }],
  
    Users: [{
      _key: '1',
      id: 'user-0',
      email: 'Me',
      settings: { theme: 'Dark', queue: [], favoriteProjects: [] },
      role: 'dev',
      createdDate: '2024-11-03T13:50:58.758Z',
    }],
  },

  schema: DataModel.schema(),

  Projects: {
    save(project) { 
      return MockDatabase.saveRecordInPlace(
        MockDatabase.db.Projects,
        MockDatabase.schema.Project,
        project
      );
    },
    delete(project) {
      return MockDatabase.deleteRecordInPlace(
        MockDatabase.db.Projects,
        project
      );
    },
  },

  Timelines: {
    save(timeline) { 
      return MockDatabase.saveRecordInPlace(
        MockDatabase.db.Timelines,
        MockDatabase.schema.Timeline,
        timeline
      );
    },
    delete(timeline) {
      return MockDatabase.deleteRecordInPlace(
        MockDatabase.db.Timelines,
        timeline
      );
    },
  },

  Items: {
    save(item) { 
      return MockDatabase.saveRecordInPlace(
        MockDatabase.db.Items,
        MockDatabase.schema.Item,
        item
      );
    },
    delete(item) {
      return MockDatabase.deleteRecordInPlace(
        MockDatabase.db.Items,
        item
      );
    },
  },
  
  Comments: {
    save(comment) { 
      return MockDatabase.saveRecordInPlace(
        MockDatabase.db.Comments,
        MockDatabase.schema.Comment,
        comment
      );
    },
    delete(comment) {
      return MockDatabase.deleteRecordInPlace(
        MockDatabase.db.Comments,
        comment
      );
    },
  },
  
  Users: {
    save(user) { 
      return MockDatabase.saveRecordInPlace(
        MockDatabase.db.Users,
        MockDatabase.schema.User,
        user
      );
    },
    delete(user) {
      return MockDatabase.deleteRecordInPlace(
        MockDatabase.db.Users,
        user
      );
    },
  },

  /**
   * @param {{ id: string }[]} set 
   * @param {{ id: string, [key: string]: any }} updated 
   */
  deleteRecordInPlace(set, deleted) {
    const index = set.findIndex(rec => rec.id === deleted.id);
    if (index !== -1) {
      set.splice(index, 1);
    }
  },

  /**
   * @param {{ id: string }[]} set 
   * @param {{ exec: () => object, parse: () => object }} schema
   * @param {{ id: string, [key: string]: any }} updated 
   */
  saveRecordInPlace(set, schema, updated) {
    const isNew = !updated._key;
    const value = schema.exec(updated, { isNew });
    if (isNew) {
      return MockDatabase.addRecordInPlace(set, schema, value);
    } else {
      return MockDatabase.updateRecordInPlace(set, schema, value);
    }
  },

  /**
   * @param {{ id: string }[]} set 
   * @param {{ exec: () => object, parse: () => object }} schema
   * @param {{ id: string, [key: string]: any }} updated 
   */
  addRecordInPlace(set, schema, updated) {
    set.push(updated);

    updated._key = String(MockDatabase.nextKey++);
    const saved = schema.parse(updated);
    return saved;
  },

  /**
   * @param {{ id: string }[]} set 
   * @param {{ exec: () => object, parse: () => object }} schema
   * @param {{ id: string, [key: string]: any }} updated 
   */
  updateRecordInPlace(set, schema, updated) {
    const index = set.findIndex(rec => rec.id === updated.id);
    if (index === -1) throw new Error('Not found!');

    set[index] = updated;

    const saved = schema.parse(updated);
    return saved;
  }
}
class MockServer {

  static server() {
    const server = MockAppsServer.create({
      debug: true
    });

    // -------------------------------------------------------
    // |                     APP DATA                        |
    // -------------------------------------------------------

    server.get('/auth/app-init', (req, res) => {
      const data = {
        user: MockDatabase.Users[0],
        environment: 'development'
      }
      res.status(server.STATUS_CODE.SUCCESS).send(data);
    });

    server.get('/auth/ds/app-data', (req, res) => {
      const models = {
        users: [...MockDatabase.db.Users],
        projects: [...MockDatabase.db.Projects],
        items: [...MockDatabase.db.Items],
        comments: [...MockDatabase.db.Comments],
        timelines: [...MockDatabase.db.Timelines],
      };

      const data = {
        DataModel,
        config: {
          datasourceUrl: `#`
        },
        lists: MockServer.getAppLists(),
        models
      };
      res.status(server.STATUS_CODE.SUCCESS).send(data);
    });

    server.get('/auth/ds/app-data/latest', (req, res) => {
      const data = {
        users: [],
        projects: [],
        items: [],
        comments: [],
        timelines: [],
      };

      res.status(server.STATUS_CODE.SUCCESS).send(data);
    });

    server.get('/auth/ds/app-lists', (req, res) => {
      const data = MockServer.getAppLists();
      res.status(server.STATUS_CODE.SUCCESS).send(data);
    });

    // -------------------------------------------------------
    // |                      PROJECT                        |
    // -------------------------------------------------------

    server.post('/auth/ds/project/save', (req, res) => {
      /** @type {IProject} */
      const proj = req.body;
      const saved = MockDatabase.Projects.save(proj);

      res.status(server.STATUS_CODE.SUCCESS).send(saved);
    });

    server.post('/auth/ds/project/update-items-version', (req, res) => {
      /** @type {IProject} */
      const project = req.body;
      const items = MockDatabase.db.Items.filter(item => item.project === project.id && item.status !== 'Closed')
        .map(item => MockDatabase.Items.save({
          ...item,
          version: project.version,
        }));

      res.status(server.STATUS_CODE.SUCCESS).send(items);
    });

    server.delete('/auth/ds/project/delete', (req, res) => {
      const project = req.body;
      MockDatabase.Projects.delete(project);

      res.status(server.STATUS_CODE.SUCCESS).send(null);
    });

    // -------------------------------------------------------
    // |                       ITEM                          |
    // -------------------------------------------------------

    server.post('/auth/ds/item/save', (req, res) => {
      const item = req.body;
      const saved = MockDatabase.Items.save(item);

      res.status(server.STATUS_CODE.SUCCESS).send(saved);
    });

    server.delete('/auth/ds/item/delete', (req, res) => {
      const item = req.body;
      MockDatabase.Items.save(item);

      res.status(server.STATUS_CODE.SUCCESS).send(null);
    });

    server.post('/auth/ds/item/email', (req, res) => {
      //NOOP
      res.status(server.STATUS_CODE.SUCCESS).send(null);
    });

    server.post('/auth/ds/item/calendar-event', (req, res) => {
      //NOOP
      res.status(server.STATUS_CODE.SUCCESS).send(null);
    });

    server.post('/auth/file/create', (req, res) => {
      //Hmm
      const blob = req.body;

      const info = {
        resource: 'file',
        id: '1234567890',
        url: null,
        download: null,
        name: blob.name,
        size: blob.size,
        type: blob.type,
        owner: 'Me',
        created: new Date().toJSON(),
        updated: new Date().toJSON(),
        viewers: ['Me'],
        editors: ['Me'],
        trashed: false,
        target: '',
        targetType: ''
      };

      // const info = ItemServices.createItemFile(req.body);
      res.status(server.STATUS_CODE.SUCCESS).send(info);
    });

    // -------------------------------------------------------
    // |                     TIMELINE                        |
    // -------------------------------------------------------

    server.post('/auth/ds/timeline/save', (req, res) => {
      const tl = req.body;
      const saved = MockDatabase.Timelines.save(tl);

      res.status(server.STATUS_CODE.SUCCESS).send(saved);
    });

    server.delete('/auth/ds/timeline/delete', (req, res) => {
      const timeline = req.body;
      MockDatabase.Timelines.delete(timeline);

      res.status(server.STATUS_CODE.SUCCESS).send(null);
    });

    // -------------------------------------------------------
    // |                     COMMENT                         |
    // -------------------------------------------------------

    server.post('/auth/ds/comment/save', (req, res) => {
      const cmt = req.body;
      const saved = MockDatabase.Comments.save(cmt);

      res.status(server.STATUS_CODE.SUCCESS).send(saved);
    });

    server.delete('/auth/ds/comment/delete', (req, res) => {
      const comment = req.body;
      MockDatabase.Comments.delete(comment);

      res.status(server.STATUS_CODE.SUCCESS).send(null);
    });

    // -------------------------------------------------------
    // |                        UTIL                         |
    // -------------------------------------------------------

    server.post('/auth/ds/files/create-prd', (req, res) => {
      //NOOP
      res.status(server.STATUS_CODE.SUCCESS).send(null);
    });

    server.post('/auth/ds/user/save', (req, res) => {
      const user = req.body;

      res.status(server.STATUS_CODE.SUCCESS).send(user);
    });

    // -------------------------------------------------------
    // |                      ERROR                          |
    // -------------------------------------------------------

    server.error((err, req) => {
      console.error({
        message: err.message,
        route: req.rawRoute,
        stack: err.stack
      });
    });

    return server;
  }

  /**
   * Gets app lists
   */
  static getAppLists() {
    const lists = {
      types: [
        'Feature',
        'Epic',
        'Story',
        'Bug',
        'Issue',
        'Enhancement',
        'Task',
        'Accessibility',
        'Planning',
        'Support'
      ],
      priorities: [
        'Low',
        'Medium',
        'High',
        'Critical'
      ],
      statuses: [
        'New',
        'Open',
        'Hold',
        'Testing',
        'Closed'
      ],
      themes: [
        'Dark',
        'Light',
        'Red',
        'Blue'
      ],
      projectStatuses: [
        'Backlog',
        'Planning',
        'Development',
        'System testing',
        'UAT',
        'Stable',
        'Inactive'
      ],
      projectPrograms: [
        'All',
      ],
      accessibilityStatuses: [
        'N/A',
        'Planning',
        'Remediation',
        'Maintenance',
        'Resolved'
      ],
      timelineStatuses: [
        'Open',
        'Closed'
      ],
      timelineEfforts: [
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10
      ],
      timelinePriorities: [
        1,
        2,
        3,
        4,
        5,
        6,
        7,
        8,
        9,
        10
      ],
      timelineMagnitudes: [
        1,
        2,
        3,
        4,
        5
      ],
      users: ['Me']
    };

    return lists;
  }

}
/**
 * Global store to hold app level reactive state
 */
const store = (() => {
  /** @type {VueOverrides} */
  const {
    ref,
    computed,
    reactive,
  } = Vue;

  const state = reactive({
    app: {
      environment: 'development',
      refresh: {
        initialLoadComplete: false,
        lastDataFetch: new Date().toJSON(),
      },
      /** @type {IUser} */
      user: { role: 'dev', email: 'Me', settings: { theme: 'Dark', queue: [], favoriteProjects: ['project-1'] } },
      session: 'session-id-123',
      workingQueue: [],
      errorMessage: '',
      appMessage: '',
      showLoadingOverlay: false,
      currentRoute: '',
      currentQueryParams: {},
      currentNavSection: null,
      currentPageName: null,
      polling: {
        status: '',
        sessionPolls: 0,
        lastUpdate: ''
      },
      confirm: {
        show: false,
        title: '',
        description: '',
        caption: '',
        confirmClasses: '',
        action: null,
        cancel: null,
      },
      config: {
        datasourceUrl: ''
      },
      logs: [],
      title: ''
    },
    data: {
      /** @type {IProject[]} */
      projects: [],
      /** @type {IItem[]} */
      items: [],
      /** @type {IComment[]} */
      comments: [],
      /** @type {ITimeline[]} */
      timelines: [],
      /** @type {IDeployment[]} */
      deployments: [],
    },
    dataModel: {
      model: {}
    },
    project: {
      newProject: null,
    },
    item: {
      newItem: null,
    },
    timeline: {
      newTimeline: null,
    },
    list: {
      /** @type {string[]} */
      types: [],
      /** @type {string[]} */
      priorities: [],
      /** @type {string[]} */
      statuses: [],
      /** @type {string[]} */
      themes: [],
      /** @type {string[]} */
      projectStatuses: [],
      /** @type {string[]} */
      projectPrograms: [],
      /** @type {string[]} */
      accessibilityStatuses: [],
      /** @type {string[]} */
      timelineStatuses: [],
      /** @type {number[]} */
      timelineEfforts: [],
      /** @type {number[]} */
      timelinePriorities: [],
      /** @type {number[]} */
      timelineMagnitudes: [],
      /** @type {string[]} */
      users: []
    }
  });

  const helpers = {
    history: window.history,
    url: {},
    /** 
     * @template T
     * @param {T[]} arr
     * @param {keyof T} keyName
     * @returns {{ [key: string]: T }}
     */
    createKeyMap(arr, keyName = '_key') {
      return arr.reduce((map, el) => {
        map[el[keyName]] = el;
        return map;
      }, {});
    },
    /** 
     * @template T
     * @param {T[]} arr
     * @param {keyof T} keyName
     * @returns {{ [key: string]: T[] }}
     */
    createForeignKeyMap(arr, keyName) {
      return arr.reduce((map, el) => {
        if (!map[el[keyName]])
          map[el[keyName]] = [];

        map[el[keyName]].push(el);
        return map;
      }, {});
    }
  };

  const projectById = computed(() =>
    helpers.createKeyMap(state.data.projects, 'id')
  );

  /**
   * computed state base on global store
   */
  const calculated = {

    /**
     * Experimental flags for in progress dev that may be tested out some in prod for certain cases
     */
    experimental: {
      polling: computed(() => state.app.user)
    },

    activeProjects: computed(() =>
      state.data.projects.filter(proj => proj.status !== 'Inactive')
    ),
    inactiveProjects: computed(() =>
      state.data.projects.filter(proj => proj.status === 'Inactive')
    ),
    activeProjectItems: computed(() =>
      state.data.items.filter(item => {
        const project = projectById.value[item.project];
        return project && project.status !== 'Inactive';
      })
    ),
    projectById,
    deploymentById: computed(() =>
      helpers.createKeyMap(state.data.deployments, 'id')
    ),
    deploymentsByProject: computed(() =>
      helpers.createForeignKeyMap(state.data.deployments, 'project')
    ),
    itemById: computed(() =>
      helpers.createKeyMap(state.data.items, 'id')
    ),
    itemsByProject: computed(() =>
      helpers.createForeignKeyMap(state.data.items, 'project')
    ),
    itemsByItem: computed(() =>
      helpers.createForeignKeyMap(state.data.items, 'parent')
    ),
    commentById: computed(() =>
      helpers.createKeyMap(state.data.comments, 'id')
    ),
    commentsByItem: computed(() =>
      helpers.createForeignKeyMap(state.data.comments, 'item')
    ),
    timelineById: computed(() =>
      helpers.createKeyMap(state.data.timelines, 'id')
    ),
    timelinesByProject: computed(() => {
      const map = {};

      state.data.timelines.forEach(ms => {
        ms.projects.forEach(id => {
          const timelines = map[id] || [];
          timelines.push(ms);
          map[id] = timelines;
        });
      });

      return map;
    }),
    dependentForByProjects: computed(() => {
      const projects = state.data.projects;
      const map = {};

      projects.forEach(child =>
        child.dependsOnProjects.forEach(parent => {
          if (!map[parent])
            map[parent] = [];

          map[parent].push(child);
        })
      );

      return map;
    })
  };

  /**
   * Client API to handle client requests to the server
   */
  const api = MockAppsClient({
    errorHandler: (err) => console.error(err),
    environment: state.app.environment
  });

  /**
   * Global dispatchers to handle app level state change requests
   * public vars from /app/dispatch dir
   */
  const dispatch = {
    app: appDispatch(),
    user: userDispatch(),
    project: projectDispatch(),
    item: itemDispatch(),
    comment: commentDispatch(),
    timeline: timelineDispatch(),
    deployment: deploymentDispatch(),
    util: utilDispatch()
  };

  const schema = DataModel.schema();

  return {
    state,
    helpers,
    calculated,
    api,
    dispatch,
    schema,
  };
})();

</script>

<script>
/**
 * setup vue app
 */
//TODO: handle this more gracefully within VueRouter
//I think this is technically a race condition with the vm.mounted() function, but im pretty confident this will win every time haha
// let initLocation = window.location;
// google.script.url.getLocation(location => {
//   console.log('location', location);
//   initLocation = location;
// });

const app = Vue.createApp({
  // data() {},

  async mounted() {
    // //init dispatch with root vue ref;

    const {
      state,
      dispatch,
    } = store;

    state.app.showLoadingOverlay = true;

    // DEPRECATED AS NOT NEEDED WITH REFACTOR TO LOADING USER DIRECTLY TO STORE VIA SERVER TEMPLATE RENDERING
    // dispatch.app.loadAppInit({ bypassWorkingQueue: true });
    await dispatch.app.loadAppData({ bypassWorkingQueue: true });

    // const {
    //   parameter,
    //   hash
    // } = initLocation;

    // initLocation.

    //navigate based on provided route and params
    // if (hash) {
    //   this.$router.push({ path: hash, query: parameter });
    // } else {
    //   this.$router.push('/');
    // }

    state.app.showLoadingOverlay = false;

    IspKeyboardShortcuts(this).connect();
  },

  // computed: {},

  // methods: {}

  // watch: {},

});
</script>

<template id="pipeline-board-template">
  <div class="columns is-multiline">
    <section class="column is-4 p-1">
      <div class="p-3 height-full has-background-light border-radius">
        <component
          :is="heading"
          class="
            title
            is-5
            mb-1
            pb-2
            pt-1
            sticky-header
            has-small-tabs has-background-light
          "
        >
          Backlog ({{ vm.backlogProjects.length }})
        </component>

        <project-card
          v-for="project in vm.sortProjectByPriority(vm.backlogProjects)"
          :key="project.id"
          ref="projectRefs"
          :project="project"
          :show-owner="showOwner"
          class="mb-2 light-border"
          @project-click="handleGoToProject"
          @prop-update="handleFocusUpdate"
        ></project-card>
      </div>
    </section>
    <section class="column is-4 p-1">
      <div class="p-3 height-full has-background-light border-radius">
        <component
          :is="heading"
          class="
            title
            is-5
            mb-1
            pb-2
            pt-1
            sticky-header
            has-small-tabs has-background-light
          "
        >
          Planning ({{ vm.planningProjects.length }})
        </component>

        <project-card
          v-for="project in vm.sortProjectByPriority(vm.planningProjects)"
          :key="project.id"
          ref="projectRefs"
          :project="project"
          :show-owner="showOwner"
          class="mb-2 light-border"
          @project-click="handleGoToProject"
          @prop-update="handleFocusUpdate"
        ></project-card>
      </div>
    </section>
    <section class="column is-4 p-1">
      <div class="p-3 height-full has-background-light border-radius">
        <component
          :is="heading"
          class="
            title
            is-5
            mb-1
            pb-2
            pt-1
            sticky-header
            has-small-tabs has-background-light
          "
        >
          Development ({{ vm.developmentProjects.length }})
        </component>

        <project-card
          v-for="project in vm.sortProjectByPriority(vm.developmentProjects)"
          :key="project.id"
          ref="projectRefs"
          :project="project"
          :show-owner="showOwner"
          class="mb-2 light-border"
          @project-click="handleGoToProject"
          @prop-update="handleFocusUpdate"
        ></project-card>
      </div>
    </section>
    <section class="column is-4 p-1">
      <div class="p-3 height-full has-background-light border-radius">
        <component
          :is="heading"
          class="
            title
            is-5
            mb-1
            pb-2
            pt-1
            sticky-header
            has-small-tabs has-background-light
          "
        >
          Testing ({{ vm.testingProjects.length }})
        </component>

        <project-card
          v-for="project in vm.sortProjectByPriority(vm.testingProjects)"
          :key="project.id"
          ref="projectRefs"
          :project="project"
          :show-owner="showOwner"
          class="mb-2 light-border"
          @project-click="handleGoToProject"
          @prop-update="handleFocusUpdate"
        ></project-card>
      </div>
    </section>
    <section class="column p-1">
      <div class="p-3 height-full has-background-light border-radius">
        <component
          :is="heading"
          class="
            title
            is-5
            mb-1
            pb-2
            pt-1
            sticky-header
            has-small-tabs has-background-light
          "
        >
          Stable ({{ vm.stableProjects.length }})
        </component>

        <project-card
          v-for="project in vm.sortProjectByPriority(vm.stableProjects)"
          :key="project.id"
          ref="projectRefs"
          :project="project"
          :show-owner="showOwner"
          class="mb-2 light-border"
          @project-click="handleGoToProject"
          @prop-update="handleFocusUpdate"
        ></project-card>
      </div>
    </section>
  </div>
</template>

<script>
const PipelineBoard = {
  props: {
    vm: Object,
    showOwner: {
      type: Boolean,
      default: true,
    },
    heading: {
      type: String,
      default: 'h1'
    },
  },

  methods: {
    handleGoToProject(project) {
      this.$router.push(`/project/${project.id}`);
    },
    handleFocusUpdate({ prop, project }) {
      this.$nextTick().then(() => {
        const card = this.$refs.projectRefs.find(
          (projectRef) => projectRef.project.id === project.id
        );
        if (card) {
          const tag = card.$refs[`${prop}-tag`];
          if (tag && typeof tag.publicFocusTag === "function")
            tag.publicFocusTag();
        }
      });
    },
  },

  template: document.querySelector("#pipeline-board-template").innerHTML,
};

app.component("pipeline-board", PipelineBoard);
</script>
<template id="app-logo-template">
  <figure class="image">
    <span class="icon ml-0">
      <span aria-hidden="true" class="material-symbols-outlined">
        stacks
      </span>
    </span>
  </figure>
</template>

<script>
const AppLogo = {
  template: document.querySelector("#app-logo-template").innerHTML,
};

app.component("app-logo", AppLogo);
</script>
<template id="apps-checkbox-template">
  <div class="field">
    <div class="control">
      <label
        class="checkbox label has-text-weight-normal"
        :class="sizeClass"
      >
        <input
          class="checkbox mr-1"
          type="checkbox"
          :style="{ height: checkboxSize, width: checkboxSize }"
          :aria-label="ariaLabel"
          :value="modelValue"
          :checked="modelValue"
          :disabled="disabled"
          :required="required"
          v-bind="client"
          @change="handleChange"
          @blur="handleBlur"
        />
        <slot name="label">{{ label }}</slot>
        <span
          class="has-text-danger"
          v-show="required"
        >*</span>
      </label>
    </div>
    <p
      class="help has-text-danger"
      role="alert"
      v-show="showError"
    >
      {{ message }}
    </p>
  </div>
</template>

<script>
const AppsCheckbox = {
  props: {
    label: String,
    ariaLabel: String,
    size: String,
    modelValue: Boolean,
    required: Boolean,
    disabled: Boolean,
    errors: {
      type: Array,
      default: () => []
    },
    immediateValidation: Boolean,
    /** @type {import('vue').PropType<AsvAny>} */
    schema: Object,
  },

  emits: ["input", "change", "blur", "update:modelValue"],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      ref,
      computed
    } = Vue;

    const hasSchema = computed(() => !!props.schema);

    //if a schema is provided, do internal validation with it....
    const internal = {
      validation: computed(() =>
        hasSchema.value ? props.schema.evaluate(props.modelValue) : null
      ),
      client: computed(() =>
        hasSchema.value ? { ...props.schema.client.get, type: 'checkbox' } : {}
      )
    };

    const errors = computed(() => 
      hasSchema.value ? internal.validation.value.errors : props.errors
    );

    const required = computed(() => 
      hasSchema.value ? internal.client.value.required : props.required
    );

    const visited = ref(false);
    const message = computed(() => errors.value.join(', '));
    const showError = computed(() =>
      (props.immediateValidation || visited.value)
      && errors.value.length > 0
    );

    const sizeClass = computed(() => {
      const sizes = {
        'is-small': 'is-size-7',
        'is-medium': 'is-size-5',
        'is-large': 'is-size-4'
      };

      return sizes[props.size] || '';
    });

    const checkboxSize = computed(() => {
      const sizes = {
        'is-small': '.75rem',
        'is-medium': '1.25rem',
        'is-large': '1.5rem'
      };

      return sizes[props.size] || '';
    });

    const handleChange = (e) => {
      ctx.emit("update:modelValue", e.target.checked);
      ctx.emit("input", e.target.checked);
      ctx.emit("change", e.target.checked);

      visited.value = true;
    };

    const handleBlur = () => {
      ctx.emit("blur");
      visited.value = true;
    };

    return {
      message,
      showError,
      sizeClass,
      checkboxSize,
      client: internal.client,
      errors,
      required,
      handleChange,
      handleBlur
    };
  },

  template: document.querySelector("#apps-checkbox-template").innerHTML,
};

app.component("apps-checkbox", AppsCheckbox);
</script>
<template id="apps-drive-picker-template">
  <aside class="modal" :class="{ 'is-active': show }">
    <div class="modal-background"></div>

    <div class="modal-content">
      <div class="box">
        <div class="columns">
          <div class="column is-narrow">
            <span class="icon">
              <span class="material-symbols-outlined">add_to_drive</span>
            </span>
          </div>

          <div class="column pl-2">
            <p class="subtitle">Pick a File</p>
          </div>

          <div class="column is-pulled-right">
            <progress
              class="progress is-small is-info"
              max="100"
              :class="{ 'is-hidden': !isLoading }"
            >
              100%
            </progress>
          </div>
        </div>

        <div class="breadcrumb" aria-label="breadcrumbs">
          <ul>
            <li v-for="(crumb, index) in breadcrumbs" :key="crumb.folder.id">
              <a @click="goToCrumb(index)">{{ crumb.folder.name }}</a>
            </li>
          </ul>
        </div>

        <div class="control" :class="{ 'is-loading': isLoading }">
          <input
            class="input"
            type="search"
            placeholder="Search files..."
            :disabled="isLoading"
            :value="search"
            @change="onSearchChange"
          />
        </div>

        <div class="container drive-content-list">
          <div
            class="columns pb-2 pt-2 drive-content-border"
            tabindex="0"
            v-for="content in contentList"
            :key="content.id"
            :class="{
              'has-background-info-light': highlightedContent.id === content.id,
              'drive-content-selected': highlightedContent.id === content.id,
            }"
            @click="highlightContent(content)"
            @dblclick="selectContent(content)"
            @keydown="keyboardSelectContent($event, content)"
          >
            <div class="column is-narrow ml-1">
              <span class="icon">
                <span class="material-symbols-outlined">{{ getIconByType(content) }}</span>
              </span>
            </div>

            <div class="column is-one-third">
              {{ shortenMimeType(content.type || "folder") }}
            </div>

            <div class="column">
              {{ content.name }}
            </div>
          </div>
        </div>

        <div class="buttons has-addons mt-4">
          <div class="button is-dark" @click="cancel">Cancel</div>
          <div
            class="button is-warning"
            :disabled="
              !highlightedContent.id || highlightedContent.type === 'Folder'
            "
            @click="selectFile"
          >
            Select file
          </div>
        </div>
      </div>
    </div>

    <button
      class="modal-close is-large"
      aria-label="Close"
      @click="cancel"
    ></button>
  </aside>
</template>

  <style>
.drive-content-list {
  max-height: 50vh;
  overflow-y: auto;
}

.drive-content-border {
  border-bottom: 1px solid gray;
}

.drive-content-selected {
  outline: none;
}
</style>
  
<script>
const AppsDrivePicker = {
  props: {
    show: Boolean,
  },

  emits: ["file-selected", "update:show"],

  setup() {
    return {
      api: store.api,
    };
  },

  data() {
    return {
      search: "",
      isLoading: false,
      highlightedContent: {},
      breadcrumbs: [
        {
          folder: {},
          content: [],
        },
      ],
      cache: {},
      icons: {
        mine: {
          folder: "folder",
          file: "insert_drive_file",
        },
        shared: {
          folder: "folder_shared",
          file: "contact_page",
        },
      },
    };
  },

  methods: {
    selectFile() {
      this.$emit("file-selected", this.highlightedContent);
      this.$emit("update:show", false);
    },
    cancel() {
      this.$emit("update:show", false);
    },
    async onSearchChange(e) {
      //send search request to server
      this.search = e.target.value || "";
      if (this.search.length === 0) return;

      //caching for search results
      if (this.cache[this.search]) {
        this.breadcrumbs = [this.breadcrumbs[0], this.cache[this.search]];
      } else {
        this.isLoading = true;

        const response = await this.api
          .post("/apps-drive-picker/search")
          .promise({ term: this.search });

        const searchResults = {
          folder: {
            id: this.search,
            name: "Search results",
          },
          content: response.body,
        };

        this.cache[this.search] = searchResults;
        this.breadcrumbs = [this.breadcrumbs[0], searchResults];
        this.isLoading = false;
      }
    },
    highlightContent(content) {
      this.highlightedContent = content;
    },
    async selectContent(content) {
      if (
        content.resource === "folder" ||
        content.type === "application/vnd.google-apps.shortcut"
      ) {
        //caching folders
        if (this.cache[content.id]) {
          this.breadcrumbs.push(this.cache[content.id]);
        } else {
          this.isLoading = true;

          const response = await this.api
            .post("/apps-drive-picker/dir")
            .send({ id: content.id });

          const folder = {
            folder: content,
            content: response.body,
          };

          this.cache[content.id] = folder;
          this.breadcrumbs.push(folder);
          this.isLoading = false;
        }
      } else {
        this.selectFile(content);
      }
    },
    keyboardSelectContent(e, content) {
      if (e.key === "Enter") this.selectContent(content);
    },
    goToCrumb(index) {
      this.breadcrumbs = this.breadcrumbs.slice(0, index + 1);
    },
    shortenMimeType(mime) {
      const tokens = mime.split(".");
      const doc = tokens[tokens.length - 1];
      const docTokens = doc.split("/");

      return docTokens[docTokens.length - 1];
    },
    getIconByType(content) {
      const shared = content.viewers.length > 1 || content.editors.length > 1;
      const icons = shared ? this.icons.shared : this.icons.mine;

      return icons[content.resource] || "question_mark";
    },
  },

  computed: {
    contentList() {
      if (this.isLoading) return [];

      const lastIndex = this.breadcrumbs.length - 1;
      return this.breadcrumbs[lastIndex].content;
    },
  },

  watch: {
    async show(val) {
      //load root on first show
      if (val && !this.cache.root) {
        this.isLoading = true;
        const response = await this.api.post("/apps-drive-picker/dir").send();

        const folder = {
          folder: {
            id: "root",
            name: "My Drive",
          },
          content: response.body,
        };

        this.breadcrumbs = [folder];
        this.cache["root"] = folder;

        this.isLoading = false;
      }
    },
  },

  template: document.querySelector("#apps-drive-picker-template").innerHTML,
};

app.component("apps-drive-picker", AppsDrivePicker);
</script>
<template id="apps-file-input-template">
  <div
    class="field p-2 border-radius"
    :class="borderClass"
  >
    <div class="control">
      <div
        class="file"
        :class="[size]"
      >
        <label
          class="file-label"
          style="display: block; font-weight: 700"
        >
          <span
            v-if="label !== undefined || $slots.label"
            style="display: block"
          >
            <slot name="label">{{ label }}</slot>
            <span
              class="has-text-danger"
              v-show="required"
            >*</span>
          </span>
          <input
            class="file-input"
            type="file"
            :aria-label="ariaLabel"
            :accept="acceptString"
            :disabled="disabled || filesList.length >= maxlength"
            :value="value"
            v-bind="client"
            :required="requiredFlag"
            @change="handleFileSelect"
            @focus="handleFocus"
            @blur="handleBlur"
          />
          <span
            v-show="!disabled"
            class="file-cta"
            :class="{ 'is-hovered': isFocused }"
          >
            <span class="file-icon">
              <span
                class="material-symbols-outlined"
                aria-hidden="true"
              >file_upload</span>
            </span>
            <span class="file-label">
              {{ caption }}
            </span>
          </span>
        </label>
      </div>
      <p
        class="help has-text-danger"
        role="alert"
        v-show="showError"
      >
        {{ message }}
      </p>
      <p
        class="help has-text-danger"
        role="alert"
        v-show="internalMessage"
      >
        {{ internalMessage }}
      </p>
      <div class="pt-2 pb-2">
        <div
          v-for="(f, index) in filesList"
          :key="f.id"
          class="is-flex"
        >
          <span
            v-if="!f.url"
            :class="fontSize"
          >{{ f.name }} - {{ getFileSize(f.size) }}</span>
          <a
            v-if="!!f.url"
            :href="f.url"
            :class="fontSize"
            target="_blank"
            rel="noopener noreferrer"
          >{{ f.name }} - {{ getFileSize(f.size) }}</a>
          <div class="ml-1">
            <button
              v-show="!disabled && asyncLoadingQueue.length === 0"
              title="Remove file"
              type="button"
              class="delete"
              :class="size"
              @click="handleRemoveFile($event, index)"
            ></button>
          </div>
        </div>
      </div>
      <div
        v-show="showLoading"
        class="p-2 is-flex-polite is-justify-content-center"
      >
        <bulma-spinner></bulma-spinner>
      </div>
    </div>
    <p
      class="help is-flex-polite is-justify-content-end"
      v-show="fileCountHelp"
    >
      <span>{{ fileCountHelp }}</span>
    </p>
  </div>
</template>

<script>
const AppsFileInput = {
  //TODO: individual client validation for Array<File> schemas...

  //TODO: Show button as disabled when disabled
  props: {
    modelValue: [Array, Object],
    label: String,
    ariaLabel: String,
    size: String,
    loading: Boolean,
    maxlength: {
      type: Number,
      default: 1
    },
    minlength: Number,
    caption: {
      type: String,
      default: "Select a file",
    },
    accept: {
      type: [Array, String],
      default: () => [],
    },
    maxsize: Number,
    disabled: {
      type: Boolean,
      default: false,
    },
    required: Boolean,
    errors: {
      type: Array,
      default: () => []
    },
    immediateValidation: Boolean,
    asyncselect: Function,
    asyncremove: Function,
    /** @type {import('vue').PropType<AsvAny>} */
    schema: Object
  },

  emits: [
    "change",
    "file-select",
    "file-remove",
    "update:modelValue",
  ],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      ref,
      computed
    } = Vue;

    const hasSchema = computed(() => !!props.schema);

    //if a schema is provided, do internal validation with it....
    const internal = {
      validation: computed(() =>
        hasSchema.value ? props.schema.evaluate(props.modelValue) : null
      ),
      client: computed(() =>
        hasSchema.value ? props.schema.client.get : {}
      )
    };

    const errors = computed(() => 
      hasSchema.value ? internal.validation.value.errors : props.errors
    );

    const required = computed(() => 
      hasSchema.value ? internal.client.value.required : props.required
    );

    const minlength = computed(() => 
      hasSchema.value ? internal.client.value.minlength : props.minlength
    );
    const maxlength = computed(() => 
      hasSchema.value ? internal.client.value.maxlength : props.maxlength
    );
    const maxsize = computed(() => 
      hasSchema.value ? internal.client.value.maxsize : props.maxsize
    );

    const visited = ref(false);

    const value = ref('');
    const isFocused = ref(false);
    const asyncLoadingQueue = ref([]);

    const internalMessage = ref('');

    const isMultiple = computed(() => Array.isArray(props.modelValue));
    const filesList = computed(() =>
      !props.modelValue ? []
        : isMultiple.value ? props.modelValue
          : [props.modelValue]
    );

    const message = computed(() => errors.value.join(', '));
    const showError = computed(() =>
      (props.immediateValidation || visited.value)
      && errors.value.length > 0
    );
    const fileCountHelp = computed(() => {
      if (!maxlength.value && !minlength.value)
        return '';

      // Very wierd, was getting a 'SYNTAX Error Unexpected token..' when usin Template literal for the final return...
      // no idea why, it was a copy past from the <apps-input> component that does the same thing and doesnt cause the same error....
        // really no clue what was going on, so just switch to string concat
      const len = filesList.value.length;
      const min = minlength.value || 0;
      const max = maxlength.value || 'any';
      const minPart = len < min ? ` [${min}]` : '';
      return String(len) + minPart + '/' + max;
    });

    const acceptString = computed(() => Array.isArray(props.accept) ? props.accept.join(',') : props.accept);

    const borderClass = computed(() =>
      isFocused.value ? 'focus-border'
        : showError.value ? 'error-border'
          : 'light-border'
    );

    const fontSize = computed(() => {
      const sizes = {
        'is-small': 'is-size-7',
        'is-medium': 'is-size-5',
        'is-large': 'is-size-4'
      };

      return sizes[props.size] || '';
    });

    const showLoading = computed(() => props.loading || asyncLoadingQueue.value.length > 0);

    const requiredFlag = computed(() =>
      //This is a hack to bypass the HTML5 form validation if there are values, but nothing in the actual input
      //in that case the input reads as invalid to HTML5 validation, but we technically have values within the model, so we can just switch off the required attribute to get it past validation there
      (filesList.value.length > 0)
        ? false
        : required.value
    );

    const getNewValue = (val) => isMultiple.value ? [...props.modelValue, val] : val;

    /* https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file */
    const getFileSize = (number) => {
      if (number < 1024) {
        return number + "bytes";
      } else if (number >= 1024 && number < 1048576) {
        return (number / 1024).toFixed(1) + "KB";
      } else if (number >= 1048576) {
        return (number / 1048576).toFixed(1) + "MB";
      }
    };

    const handleFocus = () => isFocused.value = true;
    const handleBlur = () => {
      isFocused.value = false;
      visited.value = true;
    };

    const validSize = (sz) => !maxsize.value || sz <= maxsize.value;
    const validCount = (ct) => !maxlength.value || ct <= maxlength.value;

    const handleFileSelect = (event) => {
      internalMessage.value = '';
      const files = event.target.files;

      if (files.length === 0) return;

      const [file] = files;

      const reader = new FileReader();

      reader.onload = async (e) => {
        const dataUrl = e.target.result;
        const base64 = dataUrl.replace(/data:(.*);base64,/, "");

        const blob = {
          data: base64,
          type: file.type,
          name: file.name,
          size: file.size,
        };

        if (!validSize(blob.size)) {
          internalMessage.value = `File must be less than ${getFileSize(maxsize.value)}`;
          value.value = "";
          return;
        }

        const newValue = getNewValue(blob);

        if (isMultiple.value && !validCount(newValue.length)) {
          internalMessage.value = `Only ${maxlength.value} files allowed`;
          value.value = "";
          return;
        }

        if (props.asyncselect && typeof props.asyncselect === "function") {
          asyncLoadingQueue.value.push(true);
          try {
            await props.asyncselect(blob);
            asyncLoadingQueue.value.pop();
          } catch (error) {
            asyncLoadingQueue.value.pop();
            throw error;
          }
        }

        ctx.emit("update:modelValue", newValue);
        ctx.emit("change", event);
        ctx.emit("file-select", blob);

        value.value = "";
      };

      reader.readAsDataURL(file);
    };

    const handleRemoveFile = async (event, index) => {
      const removed = filesList.value[index];

      const newValue = isMultiple.value
        ? [...props.modelValue].filter((b, i) => i !== index)
        : null;

      if (props.asyncremove && typeof props.asyncremove === "function") {
        asyncLoadingQueue.value.push(true);
        try {
          await props.asyncremove(removed);
          asyncLoadingQueue.value.pop();
        } catch (error) {
          asyncLoadingQueue.value.pop();
          throw error;
        }
      }

      ctx.emit("update:modelValue", newValue);
      ctx.emit("change", event);
      ctx.emit("file-remove", { blob: removed, index });
    };

    return {
      value,
      isFocused,
      asyncLoadingQueue,
      internalMessage,
      filesList,
      message,
      showError,
      fileCountHelp,
      borderClass,
      fontSize,
      showLoading,
      requiredFlag,
      acceptString,
      client: internal.client,
      errors,
      required,
      maxlength,
      getFileSize,
      handleFocus,
      handleBlur,
      handleFileSelect,
      handleRemoveFile
    };
  },

  template: document.querySelector("#apps-file-input-template").innerHTML,
};

app.component("apps-file-input", AppsFileInput);
</script>
<template id="apps-input-template">
  <div>
    <label
      v-if="label !== undefined || $slots.label"
      class="label mb-1"
      :for="id"
      :class="size"
    >
      <slot name="label">{{ label }}</slot>
      <span
        class="has-text-danger"
        v-show="required || showAsRequired"
      >*</span>
    </label>
    <div
      class="field"
      :class="{ 'has-addons': $slots.addon, 'mb-0': showError || maxlength || minlength }"
    >
      <div
        class="control is-expanded"
        :class="{ 'mr-0': showError, 'has-icons-left': iconLeft, 'has-icons-right': iconRight }"
      >
        <slot name="desc"></slot>
        <input
          v-if="type !== 'textarea'"
          :id="id"
          class="input"
          :class="{
            'is-danger': showError,
            [size]: size,
          }"
          :aria-label="ariaLabel"
          :placeholder="placeholder"
          :type="type"
          :value="showValue"
          :pattern="pattern"
          :max="max"
          :min="min"
          :maxlength="maxlength"
          :minlength="minlength"
          :readonly="readonly"
          :disabled="disabled"
          :step="step"
          :required="required"
          v-bind="client"
          @input="handleInput"
          @change="handleChange"
          @blur="handleBlur"
          @keydown="$emit('keydown', $event)"
          @keypress="$emit('keypress', $event)"
          @keyup="$emit('keyup', $event)"
        />
        <textarea
          v-if="type === 'textarea'"
          class="textarea"
          :id="id"
          :class="{
            'is-danger': showError,
            [size]: size,
          }"
          :aria-label="ariaLabel"
          :placeholder="placeholder"
          :value="modelValue"
          :maxlength="maxlength"
          :minlength="minlength"
          :readonly="readonly"
          :disabled="disabled"
          :required="required"
          v-bind="client"
          @input="handleInput"
          @change="handleChange"
          @blur="handleBlur"
          @keydown="$emit('keydown', $event)"
          @keypress="$emit('keypress', $event)"
          @keyup="$emit('keyup', $event)"
        ></textarea>
        <span
          v-if="iconLeft"
          class="icon is-left"
          :class="size"
          style="top: auto; bottom: 0;"
        >
          <span
            aria-hidden="true"
            class="material-symbols-outlined"
          >{{ iconLeft }}</span>
        </span>
        <span
          v-if="iconRight"
          class="icon is-right"
          :class="size"
          style="top: auto; bottom: 0;"
        >
          <span
            aria-hidden="true"
            class="material-symbols-outlined"
          >{{ iconRight }}</span>
        </span>
      </div>
      <div
        v-if="$slots.addon"
        class="control is-flex"
      >
        <slot name="addon"></slot>
      </div>
    </div>
    <div class="help is-flex-polite is-justify-content-end">
      <p
        class="has-text-danger"
        role="alert"
        style="flex: 1;"
        v-show="showError"
      >
        {{ message }}
      </p>
      <p
        v-show="lengthHelp"
        role="alert"
      >
        {{ lengthHelp }}
      </p>
    </div>
  </div>
</template>

<script>
const AppsInput = {
  props: {
    label: String,
    ariaLabel: String,
    placeholder: String,
    size: String,
    modelValue: [String, Number],
    modelModifiers: {
      type: Object,
      default: () => ({}),
    },
    type: {
      type: String,
      default: "text",
    },
    required: Boolean,
    max: Number,
    min: Number,
    minlength: Number,
    maxlength: Number,
    pattern: String,
    patternmessage: String,
    readonly: Boolean,
    disabled: Boolean,
    step: {
      type: [String, Number],
      default: "any",
    },
    errors: {
      type: Array,
      default: () => []
    },
    iconLeft: String,
    iconRight: String,
    showAsRequired: Boolean,
    immediateValidation: Boolean,
    /** @type {import('vue').PropType<AsvAny>} */
    schema: Object
  },

  emits: [
    "input",
    "change",
    "blur",
    "keyup",
    "keydown",
    "keypress",
    "update:modelValue",
  ],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      ref,
      computed,
      watch
    } = Vue;

    const hasSchema = computed(() => !!props.schema);

    //if a schema is provided, do internal validation with it....
    const internal = {
      validation: computed(() =>
        hasSchema.value ? props.schema.evaluate(getModifiedValue(props.modelValue)) : null
      ),
      client: computed(() =>
        hasSchema.value ? props.schema.client.get : {}
      )
    };

    const errors = computed(() => 
      hasSchema.value ? internal.validation.value.errors : props.errors
    );

    const required = computed(() => 
      hasSchema.value ? internal.client.value.required : props.required
    );

    const minlength = computed(() => 
      hasSchema.value ? internal.client.value.minlength : props.minlength
    );
    const maxlength = computed(() => 
      hasSchema.value ? internal.client.value.maxlength : props.maxlength
    );

    const type = computed(() => 
      hasSchema.value ? internal.client.value.type : props.type
    );

    const id = ref(crypto.randomUUID());
    const visited = ref(false);

    const getModifiedValue = (val) => {
      if (props.modelModifiers.number || type.value === "number") {
        const parsed = parseFloat(val);
        return !Number.isNaN(parsed) ? parsed : val;
      }

      return val;
    };

    const message = computed(() => errors.value.join(', '));
    const showValue = ref(getModifiedValue(props.modelValue));

    const showError = computed(() =>
      (props.immediateValidation || visited.value)
      && errors.value.length > 0
    );

    const lengthHelp = computed(() => {
      if (!maxlength.value && !minlength.value)
        return null;

      const len = (props.modelValue || '').length;
      const min = minlength.value || 0;
      const max = maxlength.value || 'any';

      return `${len}${len < min ? ` [${min}]` : ''}/${max}`;
    });

    const handleInput = (e) => {
      const newValue = getModifiedValue(e.target.value);
      showValue.value = newValue;

      if (!props.modelModifiers.lazy) ctx.emit("update:modelValue", newValue);

      ctx.emit("input", newValue);
    };

    const handleChange = (e) => {
      const newValue = getModifiedValue(e.target.value);

      if (props.modelModifiers.lazy) ctx.emit("update:modelValue", newValue);
      ctx.emit("change", newValue);

      visited.value = true;
    };

    const handleBlur = () => {
      ctx.emit("blur");
      visited.value = true;
    };

    watch(
      () => props.modelValue,
      () => showValue.value = props.modelValue
    );

    return {
      id,
      showError,
      message,
      showValue,
      lengthHelp,
      client: internal.client,
      errors,
      required,
      type,
      handleInput,
      handleChange,
      handleBlur
    };
  },

  template: document.querySelector("#apps-input-template").innerHTML,
};

app.component("apps-input", AppsInput);
</script>
<template id="apps-lookup-template">
  <div
    ref="dropdown"
    class="dropdown"
    style="width: 100%"
    :class="{ 'is-active': dropdownActive }"
    @focusout="handleFocusOut"
  >
    <div
      ref="searchContainer"
      class="dropdown-trigger"
      style="width: 100%"
    >
      <apps-input
        :label="label"
        :aria-label="ariaLabel"
        :size="size"
        :placeholder="placeholder"
        :type="type"
        :model-value="text"
        :pattern="pattern"
        :patternmessage="patternmessage"
        :max="max"
        :min="min"
        :maxlength="maxlength"
        :minlength="minlength"
        :readonly="readonly"
        :disabled="disabled"
        :required="required"
        :show-as-required="showAsRequired"
        :immediate-validation="immediateValidation"
        :errors="errors"
        :icon-left="iconLeft"
        :icon-right="iconRight"
        :schema="schema"
        @input="handleInput"
        @keydown="handleKeydown"
      >
        <template
          v-if="$slots.desc"
          #desc
        >
          <slot name="desc"></slot>
        </template>
        <template #addon>
          <slot></slot>
          <button
            class="button"
            type="button"
            :class="size"
            style="min-height: 100%;"
            :aria-label="searchForMatches ? 'Collapse dropdown menu' : 'Expand dropdown menu'"
            aria-haspopup="true"
            :disabled="disabled"
            @click="handleExpandClick"
          >
            <span
              class="icon"
              :class="size"
            >
              <span
                class="material-symbols-outlined"
                aria-hidden="true"
              >{{ searchForMatches ? 'expand_less' : 'expand_more' }}</span>
            </span>
          </button>
        </template>
      </apps-input>
    </div>
    <div
      class="dropdown-menu"
      role="menu"
      style="width: 100%; top: calc(100% - 16px);"
    >
      <div
        ref="menu"
        class="dropdown-content pt-0 pb-0"
        style="max-height: 50vh; overflow-y: auto;"
      >
        <span
          v-if="matches.length === 0"
          class="dropdown-item"
          :class="matchFontSize"
          style="white-space: pre-line;"
          role="row"
        >(No matches found)</span>
        <a
          href="#"
          class="dropdown-item"
          style="white-space: pre-line;"
          role="row"
          v-for="(match, index) in matches"
          :key="`${index}-${match.value}`"
          :class="{ 'has-background-light': currentItem === index, [matchFontSize]: true }"
          :aria-selected="currentItem === index"
          @click.prevent="handleSelect(match)"
        >
          <span
            v-for="(el, i) in splitMatchOnSearch(match.value)"
            :key="i"
            :class="{ 'theme-independent-white-font has-background-link': el.match }"
          >
            {{ el.val }}
          </span>
        </a>
      </div>
    </div>
  </div>
</template>

<script>
const AppsLookup = {
  props: {
    label: String,
    ariaLabel: String,
    placeholder: String,
    size: String,
    modelValue: [String, Number, Object],
    display: [String, Function],
    debounce: {
      type: Number,
      default: 500
    },
    type: {
      type: String,
      default: "text",
    },
    required: Boolean,
    max: Number,
    min: Number,
    minlength: Number,
    maxlength: Number,
    pattern: String,
    patternmessage: String,
    readonly: Boolean,
    disabled: Boolean,
    lookups: Array,
    limit: Number,
    externalSearch: String,
    errors: {
      type: Array,
      default: () => []
    },
    iconLeft: String,
    iconRight: String,
    showAsRequired: Boolean,
    immediateValidation: Boolean,
    /** @type {import('vue').PropType<AsvAny>} */
    schema: Object,
  },

  emits: ['input', 'change', 'keypress', 'update:modelValue'],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const { ref, computed, watch } = Vue;

    const valueGetter = () => {
      const firstEl = props.lookups[0];
      if (typeof firstEl === 'string')
        return (el) => el;

      return typeof props.display === 'function'
        ? (el) => props.display(el)
        : (el) => el[props.display];
    };

    const reset = () => {
      const getValue = valueGetter();
      const val = props.modelValue;
      text.value = (val === undefined || val === null) ? val : getValue(val);
    };

    const dropdown = ref(null);
    const searchContainer = ref(null);

    const focusSearch = () => {
      if (!searchContainer.value)
        return;

      const input = searchContainer.value.querySelector('input');
      if (input) {
        input.focus();
        input.select();
      }
    };

    const search = ref('');
    const text = ref('');

    const currentItem = ref(0);
    const menu = ref(null);

    const scrollToItem = () => {
      const menuEl = menu.value;
      if (!menuEl)
        return;

      const itm = menuEl.children[currentItem.value];
      if (itm && itm.scrollIntoView)
        itm.scrollIntoView({ behavior: "smooth", block: "nearest", inline: "nearest" });
    };

    const splitMatchOnSearch = (match) => {
      // Find the matching term in the match string
      if (search.value === '')
        return [{ val: match }];

      const lowerSearch = search.value.toLowerCase();
      const lowerMatch = match.toLowerCase();

      const parts = lowerMatch.split(lowerSearch);

      const returnValue = [];
      let cursor = 0;
      parts.forEach((part, i) => {
        returnValue.push({ val: match.slice(cursor, cursor + part.length) });
        cursor += part.length;
        if (i < parts.length - 1) {
          returnValue.push({ val: match.slice(cursor, cursor + lowerSearch.length), match: true });
          cursor += lowerSearch.length;
        }
      });

      return returnValue;
    };

    const searchForMatches = ref(false);
    const matchFontSize = computed(() => {
      const sizes = {
        'is-small': 'is-size-7',
      };
      return sizes[props.size] || '';
    });

    const displaylookups = computed(() => {
      const getVal = valueGetter();
      return props.lookups.map((lu, index) => ({ value: getVal(lu), pos: index }));
    });

    const matches = computed(() => {
      if (!searchForMatches.value) return [];
      const lower = String(search.value).toLowerCase();

      const matched = displaylookups.value
        .filter((op) => String(op.value).toLowerCase().includes(lower))
        .sort((a, b) => (a.value < b.value ? -1 : 1));

      if (props.limit)
        return matched.slice(0, props.limit);

      return matched;
    });

    const dropdownActive = computed(() => searchForMatches.value);

    const debouncedSearch = debounce(() => {
      searchForMatches.value = true;
      search.value = text.value.toLowerCase()
    }, props.debounce);

    const handleInput = (val) => {
      text.value = val;
      currentItem.value = 0;
      ctx.emit('input', val);
      debouncedSearch();
    };

    const handleKeydown = (e) => {
      switch (e.key) {
        case 'Down':
        case 'ArrowDown':
          e.preventDefault();
          if (currentItem.value + 1 >= matches.value.length) {
            currentItem.value = 0;
          } else {
            currentItem.value++;
          }
          scrollToItem();
          break;

        case 'Up':
        case 'ArrowUp':
          e.preventDefault();
          if (currentItem.value <= 0) {
            currentItem.value = matches.value.length - 1;
          } else {
            currentItem.value--;
          }
          scrollToItem();
          break;

        case 'Tab':
          if (text.value === '') {
            handleSelect(null);
          }
          searchForMatches.value = false;
          break;
        case 'Enter':
          if (text.value === '' && !searchForMatches.value) {
            handleSelect(null);
          } else if (searchForMatches.value && matches.value[currentItem.value]) {
            e.preventDefault();
            handleSelect(matches.value[currentItem.value]);
          }
          searchForMatches.value = false;
          currentItem.value = 0;
          break;

        case 'Escape':
          if (searchForMatches.value) {
            searchForMatches.value = false;
          } else {
            text.value = '';
          }
          break;

        case 'z':
          if (e.ctrlKey) {
            e.preventDefault();
            searchForMatches.value = false;
            reset();
          }
      }
    };

    const handleFocusOut = (e) => {
      const container = dropdown.value;
      if (!!container && !container.contains(e.relatedTarget))
        searchForMatches.value = false;
    };

    const handleSelect = (match) => {
      const matched = (match === null || match === undefined) ? match : props.lookups[match.pos];
      const getVal = valueGetter();
      text.value = (matched === null || matched === undefined) ? matched : getVal(matched);

      ctx.emit('update:modelValue', matched);
      ctx.emit('change', matched);

      searchForMatches.value = false;
    };

    const handleExpandClick = () => {
      search.value = text.value || '';
      searchForMatches.value = !searchForMatches.value;
      focusSearch();
    };

    watch(
      () => props.modelValue,
      (val) =>
        text.value = (val === null || val === undefined) ? '' : (valueGetter())(val),
      { immediate: true }
    );

    watch(
      () => props.externalSearch,
      (val) => {
        searchForMatches.value = true;
        search.value = val;
        text.value = val;
      }
    );

    return {
      dropdown,
      searchContainer,
      search,
      text,
      currentItem,
      menu,
      splitMatchOnSearch,
      searchForMatches,
      matchFontSize,
      displaylookups,
      matches,
      dropdownActive,
      debouncedSearch,
      handleInput,
      handleKeydown,
      handleFocusOut,
      handleSelect,
      handleExpandClick
    };
  },

  template: document.querySelector("#apps-lookup-template").innerHTML,
};

app.component("apps-lookup", AppsLookup);
</script>
<template id="apps-radio-template">
  <div class="field">
    <div class="control">
      <fieldset :disabled="disabled" :aria-label="ariaLabel">
        <legend
          class="label"
          :class="sizeClass"
        >
          <slot>{{ label }}</slot>
          <span
            class="has-text-danger"
            v-show="required"
          >*</span>
        </legend>
        <label
          class="radio"
          :class="sizeClass"
          :style="optionStyle"
          v-for="option in computedOptions"
          :key="option.value"
        >
          <input
            class="radio"
            type="radio"
            :name="id"
            :style="{ height: radioSize, width: radioSize }"
            :value="option.value"
            :checked="option.value === modelValue"
            :required="required"
            v-bind="client"
            @change="handleChange"
            @blur="handleBlur"
          />
          {{ option.text }}
        </label>
      </fieldset>
    </div>
    <p
      class="help has-text-danger"
      role="alert"
      v-show="showError"
    >
      {{ message }}
    </p>
  </div>
</template>
  
<script>
const AppsRadio = {
  //TODO: file size
  props: {
    label: String,
    ariaLabel: String,
    size: String,
    modelValue: [String, Number],
    options: Array,
    required: Boolean,
    disabled: Boolean,
    vertical: Boolean,
    errors: {
      type: Array,
      default: () => []
    },
    immediateValidation: Boolean,
    /** @type {import('vue').PropType<AsvAny>} */
    schema: Object,
  },

  emits: ["input", "change", "blur", "update:modelValue"],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      ref,
      computed,
    } = Vue;

    const hasSchema = computed(() => !!props.schema);

    //if a schema is provided, do internal validation with it....
    const internal = {
      validation: computed(() =>
        hasSchema.value ? props.schema.evaluate(props.modelValue) : null
      ),
      client: computed(() =>
        hasSchema.value ? { ...props.schema.client.get, type: 'radio' } : {}
      )
    };

    const errors = computed(() => 
      hasSchema.value ? internal.validation.value.errors : props.errors
    );

    const required = computed(() => 
      hasSchema.value ? internal.client.value.required : props.required
    );

    const id = ref(crypto.randomUUID());
    const visited = ref(false);

    const message = computed(() => errors.value.join(', '));

    const showError = computed(() =>
      (props.immediateValidation || visited.value)
      && errors.value.length > 0
    );

    const computedOptions = computed(() => {
      const opts = props.options || [];
      if (opts.length === 0) return opts;

      const isObject = typeof opts[0] === "object";

      return opts.map((opt) => ({
        value: isObject ? opt.value : opt,
        text: isObject ? opt.text : opt,
      }));
    });

    const optionStyle = computed(() =>
      props.vertical
        ? { display: "block", "margin-left": "0" }
        : ""
    );

    const sizeClass = computed(() => {
      const sizes = {
        'is-small': 'is-size-7',
        'is-medium': 'is-size-5',
        'is-large': 'is-size-4'
      };

      return sizes[props.size] || '';
    });

    const radioSize = computed(() => {
      const sizes = {
        'is-small': '.75rem',
        'is-medium': '1.25rem',
        'is-large': '1.5rem'
      };

      return sizes[props.size] || '';
    });

    const handleChange = (e) => {
      const newValue = e.target.value;

      ctx.emit("update:modelValue", newValue);
      ctx.emit("input", newValue);
      ctx.emit("change", newValue);

      visited.value = true;
    };

    const handleBlur = () => {
      ctx.emit("blur");
      visited.value = true;
    };

    return {
      id,
      message,
      showError,
      computedOptions,
      optionStyle,
      sizeClass,
      radioSize,
      client: internal.client,
      errors,
      required,
      handleChange,
      handleBlur
    };
  },

  template: document.querySelector("#apps-radio-template").innerHTML,
};

app.component("apps-radio", AppsRadio);
</script>
<template id="apps-select-template">
  <div class="field">
    <label
      v-if="label !== undefined || $slots.label"
      class="label mb-1"
      :for="id"
      :class="size"
    >
      <slot name="label">{{ label }}</slot>
      <span
        class="has-text-danger"
        v-show="required"
      >*</span>
    </label>
    <div
      class="control"
      :class="{ 'has-icons-left': iconLeft }"
    >
      <slot name="desc"></slot>
      <div
        class="select"
        :class="size"
        :style="selectStyle"
      >
        <select
          :id="id"
          class="input"
          :class="{
            'is-danger': showError,
            [size]: size,
          }"
          :aria-label="ariaLabel"
          :value="modelValue"
          :disabled="disabled"
          :required="required"
          @change="handleChange"
          @blur="handleBlur"
        >
          <option
            v-if="placeholder"
            value=""
          >{{ placeholder }}</option>
          <option
            v-for="option in computedOptions"
            :key="option.value"
            :value="option.value"
          >
            {{ option.text }}
          </option>
        </select>
        <span
          v-if="iconLeft"
          class="icon is-left"
          :class="size"
        >
          <span
            aria-hidden="true"
            class="material-symbols-outlined"
          >{{ iconLeft }}</span>
        </span>
      </div>
    </div>
    <p
      class="help has-text-danger"
      role="alert"
      v-show="showError"
    >
      {{ message }}
    </p>
  </div>
</template>

<script>
const AppsSelect = {
  props: {
    label: String,
    ariaLabel: String,
    placeholder: String,
    size: String,
    modelValue: [String, Number],
    modelModifiers: {
      type: Object,
      default: () => ({}),
    },
    validation: String,
    required: Boolean,
    options: Array,
    disabled: Boolean,
    fullwidth: Boolean,
    errors: {
      type: Array,
      default: () => []
    },
    iconLeft: String,
    immediateValidation: Boolean,
    /** @type {import('vue').PropType<AsvAny>} */
    schema: Object,
  },

  emits: ["input", "change", "blur", "update:modelValue"],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      ref,
      computed
    } = Vue;

    const hasSchema = computed(() => !!props.schema);

    //if a schema is provided, do internal validation with it....
    const internal = {
      validation: computed(() =>
        hasSchema.value ? props.schema.evaluate(getModifiedValue(props.modelValue)) : null
      ),
      client: computed(() =>
        hasSchema.value ? props.schema.client.get : {}
      )
    };

    const errors = computed(() => 
      hasSchema.value ? internal.validation.value.errors : props.errors
    );

    const required = computed(() => 
      hasSchema.value ? internal.client.value.required : props.required
    );

    const id = ref(crypto.randomUUID());
    const visited = ref(false);

    const getModifiedValue = (val) => {
      if (props.modelModifiers.number) {
        const parsed = parseFloat(val);
        return !Number.isNaN(parsed) ? parsed : val;
      }

      return val;
    };

    const message = computed(() => errors.value.join(', '));

    const showError = computed(() =>
      (props.immediateValidation || visited.value)
      && errors.value.length > 0
    );

    const computedOptions = computed(() => {
      const opts = props.options || [];
      if (opts.length === 0) return opts;

      const isObject = typeof opts[0] === "object";

      return opts.map((opt) => ({
        value: isObject ? opt.value : opt,
        text: isObject ? opt.text : opt,
      }));
    });

    const selectStyle = computed(() => props.fullwidth ? 'width: 100%' : '');

    const handleChange = (e) => {
      const newValue = getModifiedValue(e.target.value);
      ctx.emit("update:modelValue", newValue);
      ctx.emit("input", newValue);
      ctx.emit("change", newValue);

      visited.value = true;
    };

    const handleBlur = () => {
      ctx.emit("blur");
      visited.value = true;
    };

    return {
      id,
      visited,
      message,
      showError,
      computedOptions,
      selectStyle,
      client: internal.client,
      errors,
      required,
      handleChange,
      handleBlur
    };
  },

  template: document.querySelector("#apps-select-template").innerHTML,
};

app.component("apps-select", AppsSelect);
</script>
<template id="apps-suggest-template">
  <div
    ref="dropdown"
    class="dropdown"
    style="width: 100%"
    :class="{ 'is-active': dropdownActive }"
    @focusout="handleFocusOut"
  >
    <div
      ref="searchContainer"
      class="dropdown-trigger"
      style="width: 100%"
    >
      <apps-input
        :label="label"
        :aria-label="ariaLabel"
        :size="size"
        :placeholder="placeholder"
        :type="type"
        :model-value="modelValue"
        :pattern="pattern"
        :patternmessage="patternmessage"
        :max="max"
        :min="min"
        :maxlength="maxlength"
        :minlength="minlength"
        :readonly="readonly"
        :disabled="disabled"
        :required="required"
        :show-as-required="showAsRequired"
        :immediate-validation="immediateValidation"
        :errors="errors"
        :icon-left="iconLeft"
        :icon-right="iconRight"
        :schema="schema"
        @input="handleInput"
        @change="handleChange"
        @keydown="handleKeydown"
      >
        <template
          v-if="$slots.desc"
          #desc
        >
          <slot name="desc"></slot>
        </template>
        <template
          v-if="dropdownButton"
          #addon
        >
          <slot></slot>
          <button
            class="button"
            type="button"
            :class="size"
            :aria-label="searchForMatches ? 'Collapse dropdown menu' : 'Expand dropdown menu'"
            aria-haspopup="true"
            :disabled="disabled"
            @click="handleExpandClick"
          >
            <span
              class="icon"
              :class="size"
            >
              <span
                class="material-symbols-outlined"
                aria-hidden="true"
              >{{ searchForMatches ? 'expand_less' : 'expand_more' }}</span>
            </span>
          </button>
        </template>
      </apps-input>
    </div>
    <div
      class="dropdown-menu"
      role="menu"
      style="width: 100%; top: calc(100% - 16px);"
    >
      <div
        ref="menu"
        class="dropdown-content pt-0 pb-0"
        style="max-height: 50vh; overflow-y: auto;"
      >
        <span
          v-if="matches.length === 0"
          class="dropdown-item"
          :class="matchFontSize"
          style="white-space: pre-line; font-size: inherit;"
          role="row"
        >(No matches found)</span>
        <a
          v-for="(match, index) in matches"
          :key="`${index}-${match}`"
          href="#"
          class="dropdown-item"
          style="white-space: pre-line;"
          role="row"
          :class="{ 'has-background-light': currentItem === index, [matchFontSize]: true }"
          :aria-selected="currentItem === index"
          @click.prevent="handleSelect(match)"
        >
          <span
            v-for="(el, i) in splitMatchOnSearch(match)"
            :key="i"
            :class="{ 'theme-independent-white-font has-background-link': el.match }"
          >
            {{ el.val }}
          </span>
        </a>
      </div>
    </div>
  </div>
</template>

<script>
const AppsSuggest = {
  props: {
    label: String,
    ariaLabel: String,
    placeholder: String,
    size: String,
    dropdownButton: Boolean,
    modelValue: [String, Number],
    debounce: {
      type: Number,
      default: 500
    },
    type: {
      type: String,
      default: "text",
    },
    required: Boolean,
    max: Number,
    min: Number,
    minlength: Number,
    maxlength: Number,
    pattern: String,
    patternmessage: String,
    readonly: Boolean,
    disabled: Boolean,
    suggestions: Array,
    limit: Number,
    errors: {
      type: Array,
      default: () => []
    },
    iconLeft: String,
    iconRight: String,
    showAsRequired: Boolean,
    immediateValidation: Boolean,
    /** @type {import('vue').PropType<AsvAny>} */
    schema: Object,
  },

  emits: ['input', 'change', 'keypress', 'update:modelValue'],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const { ref, computed } = Vue;

    const update = (val) => ctx.emit('update:modelValue', val);

    const dropdown = ref(null);
    const searchContainer = ref(null);

    const focusSearch = () => {
      if (!searchContainer.value)
        return;

      const input = searchContainer.value.querySelector('input');
      if (input) {
        input.focus();
        input.select();
      }
    };

    const search = ref('');

    const currentItem = ref(0);
    const menu = ref(null);

    const scrollToItem = () => {
      const menuEl = menu.value;
      if (!menuEl)
        return;

      const itm = menuEl.children[currentItem.value];
      if (itm && itm.scrollIntoView)
        itm.scrollIntoView({ behavior: "smooth", block: "nearest", inline: "nearest" });
    };

    const splitMatchOnSearch = (match) => {
      // Find the matching term in the match string
      if (search.value === '')
        return [{ val: match }];

      const lowerSearch = search.value.toLowerCase();
      const lowerMatch = match.toLowerCase();

      const parts = lowerMatch.split(lowerSearch);

      const returnValue = [];
      let cursor = 0;
      parts.forEach((part, i) => {
        returnValue.push({ val: match.slice(cursor, cursor + part.length) });
        cursor += part.length;
        if (i < parts.length - 1) {
          returnValue.push({ val: match.slice(cursor, cursor + lowerSearch.length), match: true });
          cursor += lowerSearch.length;
        }
      });

      return returnValue;
    };

    const searchForMatches = ref(false);
    const matchFontSize = computed(() => {
      const sizes = {
        'is-small': 'is-size-7',
      };
      return sizes[props.size] || '';
    });

    const matches = computed(() => {
      if (!searchForMatches.value) return [];
      const lower = search.value.toLowerCase();

      const matched = props.suggestions
        .filter((sugg) => String(sugg).toLowerCase().includes(lower))
        .sort((a, b) => (a < b ? -1 : 1));

      if (props.limit)
        return matched.slice(0, props.limit);

      return matched;
    });

    const dropdownActive = computed(() => searchForMatches.value);

    const debouncedSearch = debounce(() => {
      searchForMatches.value = true;
      search.value = props.modelValue || '';
    }, props.debounce);

    const handleInput = (val) => {
      currentItem.value = 0;
      ctx.emit('input', val);
      update(val);
      debouncedSearch();
    };

    const handleKeydown = (e) => {
      switch (e.key) {
        case 'Down':
        case 'ArrowDown':
          e.preventDefault();
          if (currentItem.value + 1 >= matches.value.length) {
            currentItem.value = 0;
          } else {
            currentItem.value++;
          }
          scrollToItem();
          break;

        case 'Up':
        case 'ArrowUp':
          e.preventDefault();
          if (currentItem.value <= 0) {
            currentItem.value = matches.value.length - 1;
          } else {
            currentItem.value--;
          }
          scrollToItem();
          break;

        case 'Enter':
        case 'Tab':
          if (searchForMatches.value && matches.value[currentItem.value]) {
            e.preventDefault();
            handleSelect(matches.value[currentItem.value]);
          }
          searchForMatches.value = false;
          currentItem.value = 0;
          break;

        case 'Escape':
          if (searchForMatches.value) {
            searchForMatches.value = false;
          } else {
            update('');
          }
          break;
      }
    };

    const handleChange = (val) => {
      update(val);
      ctx.emit('change', val);
    };

    const handleFocusOut = (e) => {
      const container = dropdown.value;
      if (!!container && !container.contains(e.relatedTarget))
        searchForMatches.value = false;
    };

    const handleSelect = (match) => {
      update(match);
      ctx.emit('change', match);

      searchForMatches.value = false;
    };

    const handleExpandClick = () => {
      search.value = props.modelValue || '';
      searchForMatches.value = !searchForMatches.value;
      focusSearch();
    };

    return {
      dropdown,
      searchContainer,
      search,
      currentItem,
      menu,
      splitMatchOnSearch,
      searchForMatches,
      matchFontSize,
      matches,
      dropdownActive,
      debouncedSearch,
      handleInput,
      handleKeydown,
      handleFocusOut,
      handleChange,
      handleSelect,
      handleExpandClick
    };
  },

  template: document.querySelector("#apps-suggest-template").innerHTML,
};

app.component("apps-suggest", AppsSuggest);
</script>
<template id="apps-tags-template">
  <component
    :is="component"
    :label="label"
    :aria-label="ariaLabel"
    :size="size"
    :fullwidth="fullwidth"
    :model-modifiers="modelModifiers"
    :placeholder="placeholder"
    :type="type"
    :pattern="pattern"
    :patternmessage="patternmessage"
    :max="max"
    :min="min"
    :maxlength="maxlength"
    :minlength="minlength"
    :readonly="readonly"
    :disabled="disabled"
    :immediate-validation="immediateValidation"
    :lookups="lookups"
    :suggestions="suggestions"
    :limit="limit"
    :options="options"
    :errors="errors"
    :icon-left="iconLeft"
    :icon-right="iconRight"
    :show-as-required="required"
    :required="requiredFlag"
    v-model="newTag"
    @input="handleInput"
    @change="handleChange"
    @blur="handleBlur"
    @keydown="handleNewItemKeydown"
  >
    <template #desc>
      <article
        v-show="modelValue.length > 0"
        aria-live="polite"
        class="tags mb-0"
        :style="tagListStyle"
      >
        <span
          v-for="(val, i) in modelValue"
          :key="val"
          class="tag m-1"
          :class="[size, tagColor]"
        >
          {{ display(val) }}
          <button
            v-show="!disabled"
            type="button"
            class="delete"
            :class="size"
            title="Remove tag"
            :disabled="disabled"
            @click="handleRemoveTag(i)"
          ></button>
        </span>
      </article>
    </template>
  </component>
</template>

<script>
const AppsTags = {
  props: {
    label: String,
    ariaLabel: String,
    placeholder: String,
    size: String,
    fullwidth: Boolean,
    tagColor: String,
    modelValue: Array,
    modelModifiers: {
      type: Object,
      default: () => ({}),
    },
    type: {
      type: String,
      default: "text",
    },
    options: Array,
    suggestions: Array,
    lookups: Array,
    limit: Number,
    required: Boolean,
    max: Number,
    min: Number,
    minlength: Number,
    maxlength: Number,
    pattern: String,
    patternmessage: String,
    readonly: Boolean,
    disabled: Boolean,
    step: {
      type: [String, Number],
      default: "any",
    },
    errors: {
      type: Array,
      default: () => []
    },
    iconLeft: String,
    iconRight: String,
    immediateValidation: Boolean,
    displayFn: Function,
    /** @type {import('vue').PropType<AsvArray>} */
    schema: Object,
  },

  emits: [
    "input",
    "change",
    "blur",
    "keyup",
    "keydown",
    "keypress",
    "update:modelValue",
  ],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      ref,
      computed
    } = Vue;

    const hasSchema = computed(() => !!props.schema);

    //if a schema is provided, do internal validation with it....
    const internal = {
      validation: computed(() =>
        hasSchema.value ? props.schema.evaluate(props.modelValue) : null
      ),
      client: computed(() =>
        hasSchema.value ? props.schema.client.get : {}
      )
    };

    const errors = computed(() => {
      if (!hasSchema.value)
        return props.errors;

      const primary = internal.validation.value.errors;
      const suberrors = internal.validation.value.items || [];

      return [...primary, ...suberrors.map((vl) => vl.errors).flat()];
    });

    const required = computed(() =>
      hasSchema.value ? internal.client.value.required : props.required
    );

    const type = computed(() =>
      hasSchema.value ? internal.client.value.type : props.type
    );

    const visited = ref(false);

    const newTag = ref('');

    const showError = computed(() =>
      (props.immediateValidation || visited.value)
      && errors.value.length > 0
    );

    const inputStyle = computed(() => {
      const hasTags = props.modelValue && props.modelValue.length > 0;
      if (!hasTags)
        return "";

      const style = {
        "border-top": "none",
        "border-top-left-radius": 0,
        "border-top-right-radius": 0
      };

      return style;
    });

    const component = computed(() =>
      props.lookups ? 'apps-lookup'
        : props.suggestions ? 'apps-suggest'
          : props.options ? 'apps-select'
            : 'apps-input'
    );

    const tagListStyle = computed(() => {
      const borderRadius =
        props.size && props.size.includes("is-small") ? "2px" : "4px";

      const color = showError.value ? 'var(--danger-color)' : 'var(--highlight-color)';
      return {
        border: `1px solid ${color}`,
        "border-bottom": "none",
        "border-top-left-radius": borderRadius,
        "border-top-right-radius": borderRadius,
        "border-bottom-left-radius": 0,
        "border-bottom-right-radius": 0,
      };
    });
    const requiredFlag = computed(() =>
      //This is a hack to bypass the HTML5 form validation if there are values, but nothing in the actual input
      //in that case the input reads as invalid to HTML5 validation, but we technically have values within the model, so we can just switch off the required attribute to get it past validation there
      (errors.value.length === 0)
        ? false
        : required.value
    );

    const handleInput = (e) => {
      ctx.emit("input", e);
    };

    const handleNewItemKeydown = (e) => {
      ctx.emit("keydown", e);
      if (e.key === "Enter") {
        e.preventDefault();
        handleNewItem(e.target.value);
      }
    };

    let toggle = newTag.value; //Hack to force watchers to see new val
    const handleNewItem = (tagValue) => {
      //TODO: validate item... then add if valid??

      if (!!tagValue || tagValue === 0) {
        const newValue = getModifiedValue(tagValue);
        ctx.emit("update:modelValue", newValue);
        ctx.emit("change", newValue);
      }

      toggle = toggle === null ? '' : null;

      newTag.value = toggle;
      visited.value = true;
    };

    const handleChange = (e) => {
      const val = e && e.target ? e.target.value : e;
      handleNewItem(val);
    };

    const handleBlur = () => {
      ctx.emit("blur");
      visited.value = true;
    };

    const handleRemoveTag = (index) => {
      const newValue = props.modelValue.filter((itm, i) => i !== index);
      ctx.emit("change", newValue);
      ctx.emit("update:modelValue", newValue);
      visited.value = true;
    };

    const getModifiedValue = (val) => {
      let newTag = val;
      if (props.modelModifiers.number || type.value === "number") {
        const parsed = parseFloat(val);
        newTag = !Number.isNaN(parsed) ? parsed : val;
      }

      const set = new Set([...props.modelValue, newTag]);
      const newValue = [...set];

      return newValue;
    };

    const display = (val) => {
      if (typeof props.displayFn === 'function') {
        return props.displayFn(val);
      } else {
        return val;
      }
    }

    return {
      visited,
      newTag,
      inputStyle,
      component,
      tagListStyle,
      requiredFlag,
      client: internal.client,
      errors,
      required,
      type,
      handleInput,
      handleNewItemKeydown,
      handleNewItem,
      handleChange,
      handleBlur,
      handleRemoveTag,
      display,
    };
  },

  template: document.querySelector("#apps-tags-template").innerHTML,
};

app.component("apps-tags", AppsTags);
</script>
<template id="bulma-spinner-template">
  <div role="figure" class="bulma-spinner" :style="style"></div>
</template>

<script>
const BulmaSpinner = {
  props: {
    color: String,
  },

  computed: {
    style() {
      if (!this.color) return {};

      return {
        "border-left-color": this.color,
        "border-bottom-color": this.color,
      };
    },
  },

  template: document.querySelector("#bulma-spinner-template").innerHTML,
};

app.component("bulma-spinner", BulmaSpinner);
</script>
<template id="confirm-button-template">
  <div class="field" :class="{ 'has-addons': showConfirm }">
    <div class="control" v-if="!showConfirm">
      <button
        class="button"
        ref="show"
        :class="[
          classes || '',
          size || '',
          { 'is-fullwidth': fullwidth, 'is-radiusless': radiusless },
        ]"
        :title="hoverTitle"
        :disabled="disabled"
        @click="handleShowConfirm"
      >
        <slot></slot>
      </button>
    </div>
    <div
      class="control"
      :class="{ 'is-expanded': fullwidth }"
      v-if="showConfirm"
    >
      <button
        class="button"
        ref="confirm"
        :class="[
          size || '',
          confirmcolor,
          { 'is-fullwidth': fullwidth, 'is-radiusless': radiusless },
        ]"
        @click="handleConfirm"
      >
        {{ confirm }}
      </button>
    </div>
    <div class="control" v-if="showConfirm">
      <button
        class="button"
        ref="cancel"
        :class="[size || '', , { 'is-radiusless': radiusless }]"
        @click="handleCancel"
      >
        Cancel
      </button>
    </div>
  </div>
</template>

<script>
const ConfirmButton = {
  props: {
    classes: String,
    size: String,
    confirm: {
      type: String,
      default: "Confirm",
    },
    hoverTitle: String,
    confirmcolor: {
      type: String,
      default: "is-info",
    },
    disabled: Boolean,
    fullwidth: Boolean,
    radiusless: Boolean,
  },

  emits: ["confirm"],

  data() {
    return {
      showConfirm: false,
    };
  },

  methods: {
    handleShowConfirm() {
      this.showConfirm = true;
      this.$nextTick(() => this.$refs.confirm && this.$refs.confirm.focus());
    },
    handleCancel() {
      this.showConfirm = false;
      this.$nextTick(() => this.$refs.show && this.$refs.show.focus());
    },
    handleConfirm() {
      this.handleCancel();
      this.$emit("confirm");
    },
  },

  template: document.querySelector("#confirm-button-template").innerHTML,
};

app.component("confirm-button", ConfirmButton);
</script>
<template id="confirm-modal-template">
  <aside class="modal" :class="{ 'is-active': show }">
    <div class="modal-background"></div>

    <div class="modal-content">
      <div class="box">
        <p class="subtitle">{{ title || "Action warning" }}</p>
        <p class="content">{{ description || "Are you sure?" }}</p>

        <div class="buttons has-addons is-right">
          <button
            class="button"
            :class="confirmClasses"
            ref="confirm"
            @click="doConfirmAction"
            @keydown="handleKeydown($event, 'cancel')"
          >
            {{ confirmCaption || "Confirm" }}
          </button>
          <button
            class="button is-dark is-outlined"
            ref="cancel"
            @click="doCancelAction"
            @keydown="handleKeydown($event, 'confirm')"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>
  </aside>
</template>

<script>
const ConfirmModal = {
  props: {
    show: Boolean,
    confirmAction: Function,
    cancelAction: Function,
    confirmClasses: [Object, Array, String],
    title: String,
    description: String,
    confirmCaption: String,
  },

  emits: ["close", "update:show"],

  mounted() {
    const confirm = this.$refs.confirm;

    this.$nextTick(() => confirm.focus());
  },

  methods: {
    handleKeydown(e, tabTo) {
      if (e.key === "Tab") {
        e.preventDefault();
        this.$refs[tabTo].focus();
      }
    },
    doConfirmAction() {
      if (typeof this.confirmAction === "function") this.confirmAction();

      this.close();
    },
    doCancelAction() {
      if (typeof this.cancelAction === "function") this.cancelAction();

      this.close();
    },
    close() {
      this.$emit("update:show", false);
      this.$emit("close");
    },
  },

  template: document.querySelector("#confirm-modal-template").innerHTML,
};

app.component("confirm-modal", ConfirmModal);
</script>
<template id="draggable-item-template">

  <div
    class="is-flex-polite"
    @dragstart="handleDragstart"
    @dragend="handleDragend"
    @drag="handleDrag"
    draggable="true"
  >
    <div class="is-flex is-flex-direction-column">
      <button
        class="button is-small is-radiusless"
        :title="arrowUpTitle || 'Change order up'"
        @click="$emit('arrow-up')"
      >
        <span class="icon">
          <span
            aria-hidden="true"
            class="material-symbols-outlined"
          >
            arrow_upward
          </span>
        </span>
      </button>
      <button
        data-target="drag-handle"
        class="button is-small is-radiusless is-flex-grow-1"
        :style="{ cursor: dragging ? 'grabbing' : 'grab', height: '100%' }"
        :title="`${handleTitle || 'Re-order item'} (drag or use arrow keys)`"
        @keydown="handleKeydown"
      >
        <span class="icon">
          <span
            aria-hidden="true"
            class="material-symbols-outlined"
          >
            drag_handle
          </span>
        </span>
      </button>
      <button
        class="button is-small is-radiusless"
        :title="arrowDownTitle || 'Change order down'"
        @click="$emit('arrow-down')"
      >
        <span class="icon">
          <span
            aria-hidden="true"
            class="material-symbols-outlined"
          >
            arrow_downward
          </span>
        </span>
      </button>
    </div>
    <div class="is-flex-grow-1">
      <slot></slot>
    </div>
  </div>

</template>

<script>
const DraggableItem = {
  props: {
    dragdata: String,
    handleTitle: String,
    arrowUpTitle: String,
    arrowDownTitle: String,
  },

  emits: ['dragstart', 'dragend', 'drag', 'arrow-up', 'arrow-down', 'arrow-left', 'arrow-right'],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      ref,
    } = Vue;

    const dragging = ref(false);

    const handleKeydown = (/** @type {KeyboardEvent} */ e) => {
      if (e.key === 'ArrowUp') {
        ctx.emit('arrow-up', props.dragdata);
      } else if (e.key === 'ArrowDown') {
        ctx.emit('arrow-down', props.dragdata);
      } else if (e.key === 'ArrowLeft') {
        ctx.emit('arrow-left', props.dragdata);
      } else if (e.key === 'ArrowRight') {
        ctx.emit('arrow-right', props.dragdata);
      }
    };

    const handleDrag = (/** @type {InputEvent} */ e) => {
      e.dataTransfer.setData('text/plain', props.dragdata);
      ctx.emit('drag', e);
    };
    const handleDragstart = (/** @type {DragEvent} */ e) => {
      dragging.value = true;
      e.dataTransfer.setData('text/plain', props.dragdata);
      ctx.emit('dragstart', e);
    };
    const handleDragend = (/** @type {DragEvent} */ e) => {
      dragging.value = false;
      ctx.emit('dragend', e);
    };

    return {
      dragging,
      handleKeydown,
      handleDrag,
      handleDragstart,
      handleDragend,
    };
  },

  data() {
    return {}
  },

  template: document.querySelector('#draggable-item-template').innerHTML
};

app.component('draggable-item', DraggableItem);
</script>
<template id="loading-inset-template">
  <div
    class="is-flex-polite is-align-items-center is-flex-direction-column is-justify-content-center"
    style="position: fixed; bottom: 0; top: 0; left: 0; right: 0; z-index: -1;"
  >
    <div
      class="p-1 modal-content"
      style="width: 100%; overflow: hidden"
    >
      <div
        class="bulma-spinner m-auto"
        :class="color"
        :style="{ height: height, width: width }"
      ></div>
    </div>
  </div>
</template>

<script>
const LoadingInset = {
  props: {
    width: {
      type: String,
      default: '64px'
    },
    height: {
      type: String,
      default: '64px'
    },
    color: {
      type: String,
      default: 'has-text-link'
    }
  },

  template: document.querySelector('#loading-inset-template').innerHTML
};

app.component('loading-inset', LoadingInset);
</script>
<template id="loading-overlay-template">
  <aside
    class="modal"
    role="dialog"
    aria-live="polite"
    :class="{ 'is-active': show }"
  >
    <div class="modal-background"></div>
    <div class="modal-content" style="width: 100%; overflow: hidden">
      <h1
        class="title theme-independent-white-font is-family-code is-size-1 has-text-centered"
      >
        Loading...
      </h1>
      <div class="loading-overlay-indicator"></div>
    </div>
  </aside>
</template>

<style>
.loading-overlay-indicator {
  background-color: cornflowerblue;
  width: 100px;
  height: 10px;

  -webkit-animation: 3s ease-in-out 0s infinite loading;
  animation: 3s ease-in-out 0s infinite loading;
}

@-webkit-keyframes loading {
  0% {
    transform: translateX(-100%);
  }
  50% {
    transform: translateX(45vw);
  }
  100% {
    transform: translateX(100vw);
  }
}

@keyframes loading {
  0% {
    transform: translateX(-100%);
  }
  50% {
    transform: translateX(45vw);
  }
  100% {
    transform: translateX(100vw);
  }
}
</style>

<script>
const LoadingOverlay = {
  props: {
    show: Boolean,
  },

  template: document.querySelector("#loading-overlay-template").innerHTML,
};

app.component("loading-overlay", LoadingOverlay);
</script>
<template id="notification-toast-template">
  <aside
    class="notification-toast"
    role="status"
    aria-live="polite"
    :style="`bottom: ${bottom};`"
    :class="{ 'is-hidden': !show }"
  >
    <div class="container">
      <div class="notification pt-2 pr-2" :class="color">
        <div class="columns is-vcentered is-1 p-1">
          <div class="column">
            <slot>{{ message }}</slot>
          </div>

          <div class="column is-narrow">
            <button class="button ml-2" :class="color" @click="handleClose">
              {{ caption }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </aside>
</template>

<style>
.notification-toast {
  position: fixed;
  width: 100%;
  padding: 1rem;
  left: 0;
  z-index: 1000;
}
</style>

<script>
const NotificationToast = {
  props: {
    message: String,
    show: Boolean,
    bottom: {
      type: String,
      default: "0",
    },
    caption: {
      type: String,
      default: "Dismiss",
    },
    color: {
      type: String,
      default: "is-info",
    },
  },

  setup(props, context) {
    const {
      watch,
      onUnmounted
    } = Vue;

    const handleClose = () => {
      context.emit("update:show", false);
      context.emit("close-notification");
    };
    
    const handler = (e) => {
      console.log('This was the notification toast event handler!');
      if (e.key === 'Escape')
        handleClose();
    };

    watch(() => props.show, (newVal) => {
      if (newVal) {
        document.removeEventListener('keydown', handler);
        document.addEventListener('keydown', handler);
      } else {
        document.removeEventListener('keydown', handler);
      }
    });
    onUnmounted(() => document.removeEventListener('keydown', handler));

    return {
      handleClose
    };
  },

  emits: ["update:show", "close-notification"],

  template: document.querySelector("#notification-toast-template").innerHTML,
};

app.component("notification-toast", NotificationToast);
</script>
<template id="panel-input-list-template">
  <article class="panel is-shadowless light-border" :class="color">
    <p class="panel-heading">{{ heading }}</p>
    <div v-for="(item, i) in modelValue" :key="item" class="panel-block">
      <div class="field has-addons" style="width: 100%">
        <div class="control is-expanded">
          <input
            class="input"
            type="text"
            :value="item"
            :disabled="!editable"
            @keydown="handleUpdateKeyDown(i, $event)"
            @change="handleItemUpdate(i, $event)"
          />
        </div>
        <div v-show="confirmIndex !== i" class="control">
          <button
            ref="delete"
            class="button is-danger"
            title="Delete"
            :disabled="!editable"
            @click="showConfirm(i)"
          >
            <span class="icon">
              <span class="material-symbols-outlined">delete</span>
            </span>
          </button>
        </div>
        <div v-show="confirmIndex === i" class="control">
          <button
            ref="cancel"
            class="button"
            title="Cancel delete"
            @click="cancelConfirm(i)"
          >
            <span class="icon">
              <span class="material-symbols-outlined">close</span>
            </span>
          </button>
        </div>
        <div v-show="confirmIndex === i" class="control">
          <button
            class="button is-danger"
            title="Confirm delete"
            @click="handleItemDelete(i)"
          >
            <span class="icon">
              <span class="material-symbols-outlined">done</span>
            </span>
          </button>
        </div>
      </div>
    </div>
    <div class="panel-block">
      <p class="control has-icons-left">
        <input
          class="input"
          type="text"
          :placeholder="newPlaceholder"
          :disabled="!editable"
          v-model="newItemText"
          @keydown="handleNewItemKeydown"
          @change="handleNewItem"
        />
        <span class="icon is-left">
          <span class="material-symbols-outlined">add</span>
        </span>
      </p>
    </div>
  </article>
</template>

<script>
const PanelInputList = {
  props: {
    heading: String,
    modelValue: Array,
    color: String,
    newPlaceholder: String,
    editable: {
      type: Boolean,
      default: true
    }
  },

  emits: ["input", "change", "update:modelValue"],

  data() {
    return {
      newItemText: "",
      confirmIndex: null
    };
  },

  methods: {
    handleUpdateKeyDown(index, e) {
      if (e.key === "Enter") {
        e.preventDefault();
        this.handleItemUpdate(index, e);
      }
    },
    handleItemUpdate(index, e) {
      this.modelValue.splice(index, 1, e.target.value);
      this.$emit("update:modelValue", this.modelValue);
      this.$emit("change", this.modelValue);
    },
    handleItemDelete(index) {
      this.modelValue.splice(index, 1);
      this.confirmIndex = null;
      this.$emit("update:modelValue", this.modelValue);
      this.$emit("change", this.modelValue);
    },
    handleNewItemKeydown(e) {
      if (e.key === "Enter") {
        e.preventDefault();
        this.handleNewItem();
      }
    },
    handleNewItem() {
      this.modelValue.push(this.newItemText);
      this.newItemText = "";
      this.$emit("update:modelValue", this.modelValue);
      this.$emit("change", this.modelValue);
    },
    showConfirm(i) {
      this.confirmIndex = i;
      const cancel = this.$refs.cancel[i];
      this.$nextTick(() => cancel.focus());
    },
    cancelConfirm(i) {
      this.confirmIndex = null;
      const del = this.$refs.delete[i];
      this.$nextTick(() => del.focus());
    }
  },

  template: document.querySelector("#panel-input-list-template").innerHTML,
};

app.component("panel-input-list", PanelInputList);
</script>
<template id="skip-to-main-content-template">

  <article class="skip-to-main-content-container">
    <div class="is-flex is-justify-content-center">
      <a
        :href="hash"
        class="button p-5 skip-to-main-content-link"
        :class="linkClass"
        @click="handleSkipClick"
      >Skip to main content</a>
    </div>
  </article>

</template>

<style>

.skip-to-main-content-container {
  position: absolute;
  pointer-events: none;
  width: 100%;
}

.skip-to-main-content-link {
  opacity: 0;
}

.skip-to-main-content-link:focus {
  opacity: 1;
  pointer-events: all;
  z-index: 1000;
}
</style>

<script>
const SkipToMainContent = {
  props: {
    to: String,
    linkClass: String
  },

  emits: ['skip-to-main'],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      computed,
    } = Vue;

    const hash = computed(() =>
      props.to ? `#${String(props.to)}` : '#'
    );

    const handleSkipClick = (e) => {
      e.preventDefault();

      if (hash.value !== '#') {
        const toFocus = document.querySelector(hash.value);
        if (toFocus) {
          const focusable = toFocus.querySelector('a,input,textarea,button,select,radio');
          if (focusable) focusable.focus();
        }
      }

      ctx.emit('skip-to-main');
    };

    return {
      hash,
      handleSkipClick
    };
  },

  data() {
    return {}
  },

  template: document.querySelector('#skip-to-main-content-template').innerHTML
};

app.component('skip-to-main-content', SkipToMainContent);
</script>
<template id="split-pane-template">
  <section
    class="height-full"
    ref="container"
  >
    <div
      class="split-pane-columns columns p-0"
      :class="columnsDirection"
    >
      <transition :name="transition">
        <div
          v-show="collapsed !== 'first'"
          class="split-pane-element column is-narrow p-0"
          :class="firstclass"
          :style="firststyle"
        >
          <slot name="first"></slot>
        </div>
      </transition>

      <div
        draggable="true"
        tabindex="0"
        title="Pane separator (Shift + Arrow Keys to resize)"
        aria-label="Pane separator (Shift + Arrow Keys to resize)"
        class="split-pane-separator column is-narrow p-0"
        :style="separatorStyle"
        @click="handleSeparatorClick"
        @keydown="handleSeparatorKeydown"
        @dragstart="handleDragStart"
        @drag="handleSeparatorDrag"
      ></div>

      <transition :name="transition">
        <div
          v-show="collapsed !== 'second'"
          class="split-pane-element column is-narrow p-0"
          :class="secondclass"
          :style="secondstyle"
        >
          <slot name="second"></slot>
        </div>
      </transition>
    </div>
  </section>
</template>

<style>
.hcollapse-enter-active,
.hcollapse-leave-active {
  transition: width 0.5s ease;
}

.hcollapse-enter-from,
.hcollapse-leave-to {
  width: 0;
}

.vcollapse-enter-active,
.vcollapse-leave-active {
  transition: height 0.5s ease;
}

.vcollapse-enter-from,
.vcollapse-leave-to {
  height: 0;
}

@media screen and (min-width: 769px) {
  .split-pane-columns {
    flex-wrap: nowrap;
    height: 100%;
  }
}

@media screen and (max-width: 768px) {
  .split-pane-separator {
    display: none;
  }

  .split-pane-element {
    width: 100% !important;
    display: block !important;
  }
}
</style>

<script>
const SplitPane = {
  props: {
    horizontal: Boolean,
    firstclass: String,
    secondclass: String,
    collapsed: String,
    initialOffset: {
      type: Number,
      default: 0.5
    },
    cache: String,
    fixed: Boolean
  },

  emits: ['update:collapsed'],

  setup(props, context) {
    const {
      ref,
      computed,
      onMounted,
      onUnmounted,
    } = Vue;

    const container = ref(null);
    const width = ref(0);
    const height = ref(0);
    const separatorWidth = ref(6 + 6 + 4);

    const collapse = (target) => {
      context.emit('update:collapsed', target);
      cacheState(target);
    };

    const cacheState = (collapsed) => {
      if (!props.cache)
        return;

      localStorage.setItem(`_split-pane_${props.cache}`, collapsed || offsetfirst.value);
    };

    const loadCachedState = () => {
      if (!props.cache)
        return null;

      const cached = localStorage.getItem(`_split-pane_${props.cache}`);
      if (cached === null)
        return;

      if (cached === 'first') {
        collapse('first');
      } else if (cached === 'second') {
        collapse('second');
      } else {
        const parsed = parseFloat(cached);
        if (!Number.isNaN(parsed))
          offsetfirst.value = parsed;
      }
    };

    const handleContainerResize = () => {
      width.value = container.value.clientWidth;
      height.value = container.value.clientHeight;
    };

    const boundaryDistance = computed(() => props.horizontal ? height.value : width.value);

    const offsetfirst = ref(props.initialOffset);
    loadCachedState();

    const firstwidth = computed(() => Math.floor((boundaryDistance.value * offsetfirst.value) - separatorWidth.value / 2));
    const secondwidth = computed(() => Math.ceil((boundaryDistance.value * (1 - offsetfirst.value)) - separatorWidth.value / 2));

    const firststyle = computed(() => {
      const dir = props.horizontal ? 'height' : 'width';

      const style = {
        'max-height': '100%',
        'max-width': '100%',
        'overflow': 'auto',
        [dir]: `${firstwidth.value}px`
      };
      if (props.collapsed === 'first')
        style[dir] = 0;
      if (props.collapsed === 'second')
        style[dir] = `${firstwidth.value + secondwidth.value}px`;
      return style;
    });
    const secondstyle = computed(() => {
      const dir = props.horizontal ? 'height' : 'width';

      const style = {
        'max-height': '100%',
        'max-width': '100%',
        'overflow': 'auto',
        [dir]: `${secondwidth.value}px`
      };
      if (props.collapsed === 'second')
        style[dir] = 0;
      if (props.collapsed === 'first')
        style[dir] = `${firstwidth.value + secondwidth.value}px`;

      return style;
    });

    const separatorStyle = computed(() => {
      const h = props.horizontal;

      const style = {
        [`border-${h ? 'bottom' : 'right'}`]: '4px solid var(--light-color)',
        [`margin-${h ? 'top' : 'left'}`]: '6px',
        [`margin-${h ? 'bottom' : 'right'}`]: '6px',
        'cursor': `${h ? 'row' : 'col'}-resize`
      };

      return style;
    });

    const columnsDirection = computed(() => props.horizontal ? 'is-flex-direction-column' : 'is-flex-direction-row');

    const transition = computed(() => props.horizontal ? 'vcollapse' : 'hcollapse');

    const handleCollapseToggle = (target) => {
      const current = props.collapsed === target;
      const toCollapse = current ? '' : target;
      collapse(toCollapse);
    };

    const resizeOffset = (diff) => {
      offsetfirst.value = offsetfirst.value - diff;

      if (offsetfirst.value > 0.9) {
        offsetfirst.value = 0.9;
        collapse('second');
      }

      if (offsetfirst.value < 0.1) {
        offsetfirst.value = 0.1;
        collapse('first');
      }

      cacheState();
    };

    const handleSeparatorClick = () => handleCollapseToggle(offsetfirst.value < 0.5 ? 'first' : 'second');
    const handleSeparatorKeydown = (e) => {
      const { key, shiftKey } = e;

      switch (key) {
        case 'Enter':
          handleCollapseToggle(offsetfirst.value < 0.5 ? 'first' : 'second');
          break;

        case 'ArrowLeft':
        case 'ArrowUp':
          if (props.fixed) break;
          if (shiftKey)
            resizeOffset(0.01);
          break;

        case 'ArrowRight':
        case 'ArrowDown':
          if (props.fixed) break;
          if (shiftKey)
            resizeOffset(-0.01);
          break;
      };
    };

    const dragStart = ref(0);
    const handleDragStart = (e) => {
      if (props.fixed) return;

      handleCollapseToggle('');
      const { x, y } = e;
      dragStart.value = props.horizontal ? y : x;
    };

    const handleSeparatorDrag = (e) => {
      if (props.fixed) return;

      const { x, y } = e;
      const measure = props.horizontal ? y : x;

      if (measure === 0)
        return;

      const diff = dragStart.value - measure;
      dragStart.value = measure;
      const ratio = diff / boundaryDistance.value;

      resizeOffset(ratio);
    };

    const handleKeyboardShortcut = (event) => {
      const actions = {
        'ctrl+shift+h': (event) => {
          event.preventDefault();
          handleCollapseToggle(props.collapsed);
        },
      };

      let key = '';

      if (event.ctrlKey)
        key += 'ctrl+';
      if (event.altKey)
        key += 'alt+';
      if (event.shiftKey)
        key += 'shift+';

      key += event.key.toLowerCase();

      const action = actions[key];
      if (action)
        action.call(null, event);
    };

    onMounted(() => {
      document.addEventListener('keydown', handleKeyboardShortcut);
      window.addEventListener('resize', handleContainerResize);
      window.dispatchEvent(new Event('resize'));
    });

    onUnmounted(() => {
      document.removeEventListener('keydown', handleKeyboardShortcut);
      window.removeEventListener('resize', handleContainerResize);
    });

    return {
      container,
      handleContainerResize,
      firstwidth,
      secondwidth,
      firststyle,
      secondstyle,
      separatorStyle,
      columnsDirection,
      transition,
      handleCollapseToggle,
      handleSeparatorClick,
      handleSeparatorKeydown,
      handleDragStart,
      handleSeparatorDrag
    };
  },

  template: document.querySelector('#split-pane-template').innerHTML
};

app.component('split-pane', SplitPane);
</script>
<template id="tag-edit-dropdown-template">
  <div class="dropdown" :class="{ 'is-active': isActive }">
    <div class="dropdown-trigger">
      <span
        ref="tag"
        :role="enabled ? 'button' : 'generic'"
        :aria-haspopup="enabled ? true : ''"
        :tabindex="enabled ? 0 : ''"
        class="tag"
        :class="[tagClass, { 'is-clickable highlight-link-outline': enabled }]"
        @click="handleIsActive"
        @keydown="handleKeydown"
        >{{ value }}</span
      >
    </div>
    <div class="dropdown-menu">
      <div class="dropdown-content">
        <a
          v-for="option in options"
          :key="option"
          href="#"
          class="dropdown-item is-size-7"
          :class="{ 'is-active': option === value }"
          @click.prevent="handleOptionClick(option)"
        >
          {{ option }}
        </a>
      </div>
    </div>
  </div>
</template>

<script>
const TagEditDropdown = {
  props: {
    value: String,
    options: Array,
    tagClass: [String, Object],
    enabled: {
      type: Boolean,
      default: true,
    },
  },

  emits: ["option-select"],

  data() {
    return {
      isActive: false,
    };
  },

  methods: {
    handleIsActive() {
      if (!this.enabled) this.isActive = false;
      this.isActive = !this.isActive;
    },
    handleKeydown(e) {
      if (e.key === "Enter") this.handleIsActive();
    },
    handleOptionClick(selectedOption) {
      this.$emit("option-select", selectedOption);
      this.isActive = false;
    },
    /**
     * Designed to be used by public ref to this component
     */
    publicFocusTag() {
      if (!this.enabled)
        return;

      this.$refs.tag.scrollIntoView({ behavior: 'smooth' });
      this.$refs.tag.focus();
    }
  },

  template: document.querySelector("#tag-edit-dropdown-template")
    .innerHTML,
};

app.component("tag-edit-dropdown", TagEditDropdown);
</script>
<template id="accessibility-dashboard-view-template">
  <main class="p-2">
    <h1 class="title is-6 mb-2 icon-text is-align-items-center">
      <span class="icon is-large">
        <span aria-hidden="true" class="material-symbols-outlined">accessibility</span>
      </span>
      <span> Accessibility dashboard </span>
    </h1>

    <section>
      <!-- <items-pie-chart
        :items="vm.items.map(({ item }) => item)"
      ></items-pie-chart> -->

      <article class="columns p-1">
        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Total projects</p>
          {{ vm.stats.totalProjects }}
        </div>
        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Total items</p>
          {{ vm.stats.totalItems }}
        </div>

        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Pending items</p>
          {{ vm.stats.pendingItems }}
        </div>

        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Closed items</p>
          {{ vm.stats.closedItems }}
        </div>

        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Complete percent</p>
          {{ vm.stats.completePercent }}
        </div>
      </article>
      <hr />

      <article class="columns mb-0">
        <section v-if="vm.pendingPastDueItems.length > 0" class="column p-1">
          <h2 class="subtitle mb-1">Past due scheduled items</h2>
          <item-card
            v-for="{ item } in vm.pendingPastDueItems"
            :item="item"
            :key="item.id"
            class="mb-2 danger-border"
            @item-click="handleGoToItem"
            @project-click="handleGoToProjectAndItem"
          ></item-card>
        </section>

        <section class="column p-1">
          <h2 class="subtitle mb-1">
            Upcoming scheduled items ({{ vm.pendingScheduledItems.length }})
          </h2>
          <item-card
            v-for="{ item } in vm.pendingScheduledItems"
            :key="item.id"
            :item="item"
            class="mb-2"
            @item-click="handleGoToItem"
            @project-click="handleGoToProjectAndItem"
          ></item-card>
        </section>
      </article>

      <pipeline-board :vm="vm" heading="h3"></pipeline-board>
    </section>
  </main>
</template>

<script>
const AccessibilityDashboardView = {
  setup() {
    const vm = useAccessibilityDashboardViewModel();
    return {
      vm,
    };
  },

  methods: {
    handleGoToProjectAndItem({ project, item }) {
      this.$router.push({
        path: `/project/${project.id}`,
        query: {
          tab: item.id
        }
      });
    },
    handleGoToItem(item) {
      this.$router.push(`/item/${item.id}`);
    },
    formatScheduledDate(scheduled) {
      const d = new Date(scheduled);
      return d.toLocaleDateString();
    },
  },

  template: document.querySelector("#accessibility-dashboard-view-template")
    .innerHTML,
};

app.component("accessibility-dashboard-view", AccessibilityDashboardView);
</script>
<template id="dashboardTabsView-template">
  <section>
    <div class="sticky-header has-background-white">
      <nav class="tabs is-small is-fullwidth force-32-height">
        <ul>
          <li v-focus :class="{ 'is-active': selectedTab === 'my' }">
            <a href="#" @click.prevent="selectTab('my')">My dashboard</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'team' }">
            <a href="#" @click.prevent="selectTab('team')">Team dashboard</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'pipeline' }">
            <a href="#" @click.prevent="selectTab('pipeline')"
              >Pipeline dashboard</a
            >
          </li>
          <!-- <li :class="{ 'is-active': selectedTab === 'accessibility' }">
            <a href="#" @click.prevent="selectTab('accessibility')"
              >Accessibility dashboard</a
            >
          </li> -->
        </ul>
      </nav>
    </div>

    <keep-alive>
      <my-dashboard-view v-if="selectedTab === 'my'"></my-dashboard-view>
    </keep-alive>

    <keep-alive>
      <team-dashboard-view
        v-if="selectedTab === 'team'"
      ></team-dashboard-view>
    </keep-alive>

    <keep-alive>
      <pipeline-dashboard-view
        v-if="selectedTab === 'pipeline'"
      ></pipeline-dashboard-view>
    </keep-alive>

    <!-- <keep-alive>
      <accessibility-dashboard-view
        v-if="selectedTab === 'accessibility'"
      ></accessibility-dashboard-view>
    </keep-alive> -->
  </section>
</template>

<script>
const DashboardTabsView = {
  props: {},

  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  data() {
    return {};
  },

  computed: {
    selectedTab() {
      return this.state.app.currentQueryParams.tab || "my";
    },
  },

  methods: {
    selectTab(tabName) {
      this.$router.replace({
        path: this.state.app.currentRoute,
        query: { tab: String(tabName) },
      });
    },
  },

  template: document.querySelector("#dashboardTabsView-template").innerHTML,
};

app.component("dashboardTabsView", DashboardTabsView);
</script>
<template id="my-dashboard-view-template">
  <main class="p-2">
    <h1 class="title is-6 mb-2 icon-text is-align-items-center">
      <span class="icon is-large">
        <span aria-hidden="true" class="material-symbols-outlined">list_alt</span>
      </span>
      <span> My projects dashboard </span>
    </h1>

    <section>
      <!-- <items-pie-chart
        :items="vm.items.map(({ item }) => item)"
      ></items-pie-chart> -->

      <article class="columns p-1">
        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Total projects</p>
          {{ vm.stats.totalProjects }}
        </div>
        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Total items</p>
          {{ vm.stats.totalItems }}
        </div>

        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Pending items</p>
          {{ vm.stats.pendingItems }}
        </div>

        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Closed items</p>
          {{ vm.stats.closedItems }}
        </div>

        <div class="column p-1 has-text-centered light-border">
          <p class="subtitle">Complete percent</p>
          {{ vm.stats.completePercent }}
        </div>
      </article>

      <h2 class="subtitle mb-1">
        Favorite projects ({{ vm.favoriteProjects.length }})
      </h2>

      <project-card
        v-for="project in vm.favoriteProjects"
        :key="project.id"
        :project="project"
        class="link-border mb-2"
        :show-owner="false"
        @project-click="handleGoToProject"
      ></project-card>

      <article class="columns p-1 mb-0">
        <section v-if="vm.pendingPastDueItems.length > 0" class="column p-1">
          <h2 class="subtitle mb-1">
            Past due scheduled items ({{ vm.pendingPastDueItems.length }})
          </h2>
          <item-card
            v-for="{ item } in vm.pendingPastDueItems"
            :item="item"
            :key="item.id"
            class="mb-2 danger-border"
            :show-assignee="false"
            @item-click="handleGoToItem"
            @project-click="handleGoToProjectAndItem"
          ></item-card>
        </section>

        <section class="column p-1">
          <h2 class="subtitle mb-1">
            Upcoming scheduled items ({{ vm.pendingScheduledItems.length }})
          </h2>
          <item-card
            v-for="{ item } in vm.pendingScheduledItems"
            :key="item.id"
            :item="item"
            class="mb-2"
            :show-assignee="false"
            @item-click="handleGoToItem"
            @project-click="handleGoToProjectAndItem"
          ></item-card>
        </section>
      </article>

      <article class="columns p-1 mb-0">
        <section class="column p-1">
          <h2 class="subtitle mb-1">
            Testing items ({{ vm.testingItems.length }})
          </h2>
          <item-card
            v-for="{ item } in vm.testingItems"
            :key="item.id"
            :item="item"
            class="mb-2 success-border"
            :show-assignee="false"
            @item-click="handleGoToItem"
            @project-click="handleGoToProjectAndItem"
          ></item-card>
        </section>

        <section class="column p-1">
          <h2 class="subtitle mb-1">Open items ({{ vm.openItems.length }})</h2>
          <item-card
            v-for="{ item } in vm.openItems"
            :key="item.id"
            :item="item"
            class="mb-2 warning-border"
            :show-assignee="false"
            @item-click="handleGoToItem"
            @project-click="handleGoToProjectAndItem"
          ></item-card>
        </section>
      </article>

      <h2 class="subtitle mb-1 mt-3">
        Active projects ({{ vm.activeProjects.length }})
      </h2>

      <pipeline-board :vm="vm" heading="h3" :show-owner="false"></pipeline-board>
    </section>
  </main>
</template>

<script>
const MyDashboardView = {
  setup() {
    const vm = useDashboardViewModel({ my: true });

    return {
      vm,
    };
  },

  methods: {
    handleGoToProjectAndItem({ project, item }) {
      this.$router.push({
        path: `/project/${project.id}`,
        query: {
          tab: item.id
        }
      });
    },
    handleGoToProject(project) {
      this.$router.push(`/project/${project.id}`);
    },
    handleGoToItem(item) {
      this.$router.push(`/item/${item.id}`);
    },
  },

  template: document.querySelector("#my-dashboard-view-template").innerHTML,
};

app.component("my-dashboard-view", MyDashboardView);
</script>
<template id="pipeline-dashboard-view-template">
  <main class="p-2">
    <h1 class="title is-6 mb-2 icon-text is-align-items-center">
      <span class="icon is-large">
        <span aria-hidden="true" class="material-symbols-outlined">timeline</span>
      </span>
      <span> Pipeline dashboard </span>
    </h1>

    <section class="pb-5">
      <fieldset>
        <legend class="subtitle is-6 mb-1">Filter by project owners</legend>
        <label class="checkbox">
          <input
            type="checkbox"
            v-model="selectAllOwners"
            @change="handleSelectAllChange"
          />
          All owners
        </label>
        <div class="columns is-multiline">
          <div
            v-for="user in state.list.users"
            :key="user"
            class="column p-0 is-3"
          >
            <label class="checkbox">
              <input
                type="checkbox"
                :value="user"
                v-model="vm.selectedUsers"
                @change="handleSelectedUsersChange"
              />
              {{ user }}
            </label>
          </div>
        </div>
      </fieldset>
    </section>

    <article class="columns p-1">
      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Total projects</p>
        {{ vm.stats.totalProjects }}
      </div>
      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Total items</p>
        {{ vm.stats.totalItems }}
      </div>

      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Pending items</p>
        {{ vm.stats.pendingItems }}
      </div>

      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Closed items</p>
        {{ vm.stats.closedItems }}
      </div>

      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Complete percent</p>
        {{ vm.stats.completePercent }}
      </div>
    </article>

    <pipeline-board :vm="vm"></pipeline-board>
  </main>
</template>

<script>
const PipelineDashboardView = {
  setup() {
    const vm = useDashboardViewModel({ team: true });

    return {
      state: {
        list: store.state.list,
      },
      vm,
    };
  },

  data() {
    return {
      selectAllOwners: true,
    };
  },

  methods: {
    handleSelectAllChange() {
      if (this.selectAllOwners) this.vm.selectedUsers = [];
    },
    handleSelectedUsersChange() {
      if (this.vm.selectedUsers.length > 0) this.selectAllOwners = false;
    },
  },

  template: document.querySelector("#pipeline-dashboard-view-template")
    .innerHTML,
};

app.component("pipeline-dashboard-view", PipelineDashboardView);
</script>
<template id="team-dashboard-view-template">
  <main class="p-2">
    <h1 class="title is-6 mb-2 icon-text is-align-items-center">
      <span class="icon is-large">
        <span aria-hidden="true" class="material-symbols-outlined">dashboard</span>
      </span>
      <span> Team dashboard </span>
    </h1>

    <!-- <items-pie-chart
      :items="vm.items.map(({ item }) => item)"
    ></items-pie-chart> -->

    <article class="columns p-1">
      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Total projects</p>
        {{ vm.stats.totalProjects }}
      </div>
      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Total items</p>
        {{ vm.stats.totalItems }}
      </div>

      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Pending items</p>
        {{ vm.stats.pendingItems }}
      </div>

      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Closed items</p>
        {{ vm.stats.closedItems }}
      </div>

      <div class="column p-1 has-text-centered light-border">
        <p class="subtitle">Complete percent</p>
        {{ vm.stats.completePercent }}
      </div>
    </article>

    <article class="columns is-multiline is-vcentered pt-5">
      <div v-for="wvm in vm.workloadVms" :key="wvm.email" class="column is-3">
        <workload-card class="light-border" :vm="wvm"></workload-card>
      </div>
    </article>

    <article class="columns mb-0">
      <section v-if="vm.pendingPastDueItems.length > 0" class="column p-1">
        <h2 class="subtitle mb-1">Past due scheduled items</h2>
        <item-card
          v-for="{ item } in vm.pendingPastDueItems"
          :item="item"
          :key="item.id"
          class="mb-2 danger-border"
          @item-click="handleGoToItem"
          @project-click="handleGoToProject"
        ></item-card>
      </section>

      <section class="column p-1">
        <h2 class="subtitle mb-1">
          Upcoming scheduled items ({{ vm.pendingScheduledItems.length }})
        </h2>
        <item-card
          v-for="{ item } in vm.pendingScheduledItems"
          :key="item.id"
          :item="item"
          class="mb-2"
          @item-click="handleGoToItem"
          @project-click="handleGoToProject"
        ></item-card>
      </section>
    </article>
  </main>
</template>

<script>
const TeamDashboardView = {
  setup() {
    const vm = useDashboardViewModel({ team: true });

    return {
      vm,
    };
  },

  methods: {
    handleGoToProject({ project }) {
      this.$router.push(`/project/${project.id}`);
    },
    handleGoToItem(item) {
      this.$router.push(`/item/${item.id}`);
    },
    formatScheduledDate(scheduled) {
      const d = new Date(scheduled);
      return d.toLocaleDateString();
    },
  },

  template: document.querySelector("#team-dashboard-view-template").innerHTML,
};

app.component("team-dashboard-view", TeamDashboardView);
</script>
<template id="project-dependency-layers-template">
  <article class="columns is-multiline is-vcentered">
    <div
      v-for="(layer, layerIndex, index) in vm.dependencyLayerMap"
      :key="layerIndex"
      class="column is-narrow"
    >
      <div class="is-flex is-align-items-center">
        <div class="light-border">
          <h3 class="title is-6 mb-1 p-2 light-border-bottom has-background-grey-lighter">Dependency layer #{{ layerIndex }}</h3>
          <ul class="pb-3 pr-3 pl-3 pt-1">
            <li v-for="project in layer" :key="project.id">
              <a
                href="#"
                class="is-size-7 has-text-dark"
                @click.prevent="handleGoToProject(project)"
              >
                {{ project.name }}
              </a>
            </li>
          </ul>
        </div>
        <span v-show="index < lastLayerArrayIndex" class="icon pl-5">
          <span aria-hidden="true" class="material-symbols-outlined">arrow_forward_ios</span>
        </span>
      </div>
    </div>
  </article>
</template>

<script>
const ProjectDependencyLayers = {
  props: {
    vm: Object,
  },

  computed: {
    lastLayerArrayIndex() {
      return Object.keys(this.vm.dependencyLayerMap).length - 1;
    }
  },

  methods: {
    handleGoToProject(project) {
      this.$router.push(`/project/${project.id}`);
    },
  },

  template: document.querySelector("#project-dependency-layers-template")
    .innerHTML,
};

app.component("project-dependency-layers", ProjectDependencyLayers);
</script>
<template id="full-text-search-template">
  <section class="dropdown" :class="{ 'is-active': showResults, 'is-right': !isTouchWidth, 'is-up': isTouchWidth }">
    <div class="dropdown-trigger">
      <div class="control has-icons-left" :class="{ 'is-loading': searching }">
        <input
          ref="searchInput"
          aria-label="App search"
          type="search"
          class="input is-small is-rounded"
          :style="inputStyle"
          :placeholder="searchPlaceholder || 'Search...'"
          v-model="search"
          @keydown="handleKeyDown"
        />
        <span class="icon is-left is-small" style="padding-bottom: 4px;">
          <span aria-hidden="true" class="material-symbols-outlined">search</span>
        </span>
      </div>
    </div>
    <div
      class="dropdown-menu link-border"
      style="max-height: 30vh; overflow-y: auto; min-width: 50vw"
      aria-live="polite"
    >
      <div class="dropdown-content">
        <div
          v-for="result in results"
          :key="result.model.id"
          class="dropdown-item highlight-border-bottom"
        >
          <search-result-row
            :result="result"
            @keydown="handleKeyDown"
            @result-select="handleResultSelect"
          ></search-result-row>
        </div>
        <div v-show="searching" class="dropdown-item">
          <div class="is-flex is-justify-content-center">
            <bulma-spinner color="var(--link-color)"></bulma-spinner>
          </div>
        </div>
        <div v-show="!searching && results.length === 0" class="dropdown-item">
          No results found...
        </div>
      </div>
    </div>
  </section>
</template>

<script>
const FullTextSearch = {
  props: {
    searchPlaceholder: String,
    inputStyle: {
      type: Object,
      default: () => ({})
    }
  },

  setup() {
    const { onUnmounted } = Vue;

    const work = AppsWorker("worker-fts");

    onUnmounted(() => work.worker.terminate());

    return {
      state: {
        app: store.state.app,
        data: store.state.data,
      },
      work,
    };
  },

  data() {
    return {
      searching: false,
      showResults: false,
      isTouchWidth: false,
      search: "",
      results: [],
    };
  },

  methods: {
    async handleSearch() {
      this.results = [];
      
      if (!this.search) {
        this.showResults = false;
        return;
      }

      this.searching = true;
      this.isTouchWidth = this.getIsTouchScreenWidth();
      this.showResults = true;
      const search = String(this.search).toLowerCase();

      const models = JSON.stringify({
        projects: this.state.data.projects,
        items: this.state.data.items,
        comments: this.state.data.comments,
      });

      try {
        this.results = await this.work.exec("fts", search, models);
      } catch (err) {
        console.error(err);
        this.state.app.errorMessage = err.message;
      }

      this.searching = false;
    },
    handleResultSelect(res) {
      this.results = [];
      this.showResults = false;
      this.$router.push(`/${res.type.toLowerCase()}/${res.model.id}`);
    },
    handleKeyDown(e) {
      if (e.key === "Escape") {
        this.showResults = false;
        this.$refs.searchInput.focus();
        return;
      }

      if (e.key === "Enter") this.handleSearch();
    },
    getIsTouchScreenWidth() {
      const BULMA_TABLET_SCREEN_WIDTH = 1023;
      return window.innerWidth <= BULMA_TABLET_SCREEN_WIDTH;
    }
  },

  template: document.querySelector("#full-text-search-template").innerHTML,
};

app.component("full-text-search", FullTextSearch);
</script>
<template id="search-result-row-template">
  <a
    href="#"
    class="is-size-7 has-text-dark"
    @click.prevent="handleClick"
    @keydown="handleKeydown"
  >
    <item-type-icon
      v-if="result.type === 'Item'"
      class="is-small mr-2"
      icon-class="is-size-6"
      :type="result.model.type"
    ></item-type-icon>
    <span v-else class="icon is-small mr-2">
      <span aria-hidden="true" class="material-symbols-outlined is-size-6 is-dark"
        >source</span
      >
    </span>
    <span>
      {{ display }}
    </span>
  </a>
</template>

<script>
const SearchResultRow = {
  props: {
    result: Object,
  },

  emits: ["keydown", "result-select"],

  computed: {
    display() {
      switch (this.result.type) {
        case "Project":
          const project = this.result.model;
          return `[Project] - ${project.name}`;

        case "Item":
          const item = this.result.model;
          return `[${item.itemNumber}] - ${item.name}`;
      }
    },
  },

  methods: {
    handleClick() {
      this.$emit("result-select", this.result);
    },
    handleKeydown(e) {
      if (e.key === "Enter")
        return;
      
      this.$emit("keydown", e);
    }
  },

  template: document.querySelector("#search-result-row-template").innerHTML,
};

app.component("search-result-row", SearchResultRow);
</script>
<template id="home-view-template">
  <main class="section">
    <div class="container">
      <h1 class="title">
        <span class="icon is-large"
          ><span aria-hidden="true" class="material-symbols-outlined">list_alt</span></span
        >
        Information Services projects and work item tracking
      </h1>

      <div class="message is-warning">
        <div class="message-body">
          This system is under development!
        </div>
      </div>

      <div class="content">
        Keeping track of your projects and whatnot...
      </div>
    </div>
  </main>
</template>

<script>
const HomeView = {
  template: document.querySelector("#home-view-template").innerHTML,
};

app.component("home-view", HomeView);
</script>
<template id="admin-system-log-template">
  <article>
    <ul>
      <li v-for="(log, index) in state.app.logs" :key="index">
        {{ log.at }}
        <span :class="TYPE[log.type] || ''">[{{ log.type }}]</span> &gt;
        {{ log.message }}
      </li>
    </ul>
  </article>
</template>

<script>
const AdminSystemLog = {
  props: {},

  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  data() {
    return {
      TYPE: {
        INFO: "has-text-info",
        WARN: "has-text-warning",
        ERROR: "has-text-danger",
      },
    };
  },

  template: document.querySelector("#admin-system-log-template").innerHTML,
};

app.component("admin-system-log", AdminSystemLog);
</script>
<template id="main-view-template">
  <div class="is-size-7-polite is-flex is-flex-direction-column" style="height: 100%">
    <header>
      <skip-to-main-content
        style="top: 0;"
        to="main-content"
        link-class="is-dark"
      ></skip-to-main-content>
      <nav-bar></nav-bar>
    </header>

    <div id="main-content" class="main-content">
      <router-view :key="$route.path"></router-view>
    </div>

    <notification-toast
      :show="state.app.errorMessage ? true : false"
      :message="state.app.errorMessage"
      @close-notification="state.app.errorMessage = ''"
      :color="'is-danger'"
    ></notification-toast>

    <notification-toast
      :show="state.app.appMessage ? true : false"
      :message="state.app.appMessage"
      @close-notification="state.app.appMessage = ''"
      :color="'is-dark'"
    ></notification-toast>

    <confirm-modal
      v-if="state.app.confirm.show"
      v-focus
      v-model:show="state.app.confirm.show"
      :title="state.app.confirm.title"
      :description="state.app.confirm.description"
      :confirm-caption="state.app.confirm.caption"
      :confirm-classes="state.app.confirm.confirmClasses"
      :confirm-action="state.app.confirm.action"
      :cancel-action="state.app.confirm.cancel"
      @close="handleConfirmClose"
    >
    </confirm-modal>

    <loading-overlay
      v-model:show="state.app.showLoadingOverlay"
    ></loading-overlay>

    <footer class="main-footer border-top is-size-7 is-justify-content-end">
      <a
        href="https://github.com/nick-luedde"
        class="mx-2"
        style="display: block;"
        target="_blank"
        rel="noopener noreferrer"
      >
        Check out more from me
      </a>
    </footer>
  </div>
</template>

<script>
const MainView = {
  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  methods: {
    handleConfirmClose() {
      const confirm = this.state.app.confirm;

      confirm.show = false;
      confirm.title = "";
      confirm.description = "";
      confirm.caption = "";
      confirm.confirmClasses = "";
      confirm.action = null;
      confirm.cancel = null;
    },
  },

  template: document.querySelector("#main-view-template").innerHTML,
};

app.component("main-view", MainView);
</script>
<template id="nav-bar-template">
  <nav
    ref="nav"
    style="min-height: auto; height: 32px"
    class="navbar is-fixed-top is-size-7 nav-border-ef002"
    role="navigation"
    aria-label="main navigation"
    @focusout="handleNavFocusOut"
  >
    <div class="navbar-brand" style="min-height: auto; height: 32px">
      <div class="navbar-item p-1">
        <app-logo class="is-24x24"></app-logo>
      </div>

      <div class="navbar-item p-1">
        <button
          class="button is-small is-white p-1"
          @click="handleBackClick"
          title="Back"
        >
          <span aria-hidden="true" class="material-symbols-outlined is-size-6"
            >arrow_back</span
          >
        </button>
      </div>

      <div class="navbar-item pl-0 pr-3">
        <bulma-spinner
          class="ml-1 mr-2"
          :style="{
            visibility:
              state.app.workingQueue.length > 0 ? 'visible' : 'hidden',
          }"
          color="var(--font-color)"
        ></bulma-spinner>

        <h1>
          <a
            href="#"
            title="Home"
            class="has-text-dark has-text-weight-bold"
            @click.prevent="navigate('/')"
          >
            <span>AP</span>
          </a>
        </h1>
      </div>

      <div class="navbar-item is-expanded is-hidden-desktop">
        <nav-bar-title :title="state.app.title"></nav-bar-title>
      </div>

      <a
        role="button"
        href="#"
        class="navbar-burger"
        style="height: 32px"
        :class="{ 'is-active': showMenu }"
        aria-label="Menu"
        @click.prevent="toggleMenu"
      >
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div class="navbar-menu" :class="{ 'is-active': showMenu }">
      <div class="navbar-start" style="flex: 1">
        <div
          class="navbar-item has-dropdown"
          :class="{ 'is-hoverable': navBarActive }"
        >
          <a
            href="#"
            class="navbar-link pl-1"
            @mouseenter="navBarActive && $event.target.focus()"
            @click.prevent="handleNavMenuClick"
          >
            Projects
          </a>

          <div class="navbar-dropdown is-size-7">
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="navigate('/projects')"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >list</span
                >
              </span>
              <span class="ml-1"> All projects </span>
            </a>
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="
                navigate({
                  path: '/projects',
                  query: { tab: 'mine' },
                })
              "
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >assignment_ind</span
                >
              </span>
              <span class="ml-1"> My projects </span>
            </a>
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="
                navigate({
                  path: '/projects',
                  query: { tab: 'planning' },
                })
              "
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >edit_note</span
                >
              </span>
              <span class="ml-1"> Planning projects </span>
            </a>
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="
                navigate({
                  path: '/projects',
                  query: { tab: 'development' },
                })
              "
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >code</span
                >
              </span>
              <span class="ml-1"> Development projects </span>
            </a>
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="
                navigate({
                  path: '/projects',
                  query: { tab: 'testing' },
                })
              "
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >quiz</span
                >
              </span>
              <span class="ml-1"> Testing projects </span>
            </a>

            <hr class="navbar-divider soft-background" />
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="handleNewProject"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >add</span
                >
              </span>
              <span class="ml-1"> New project </span>
            </a>
          </div>
        </div>

        <div
          class="navbar-item has-dropdown"
          :class="{ 'is-hoverable': navBarActive }"
        >
          <a
            href="#"
            class="navbar-link pl-1"
            @mouseenter="navBarActive && $event.target.focus()"
            @click.prevent="handleNavMenuClick"
          >
            Items
          </a>

          <div class="navbar-dropdown is-size-7">
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="navigate('/items')"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6">
                  checklist
                </span>
              </span>
              <span class="ml-1"> All items </span>
            </a>

            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="
                navigate({
                  path: '/items',
                  query: { tab: 'mine' },
                })
              "
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6">
                  assignment
                </span>
              </span>
              <span class="ml-1"> My items </span>
            </a>
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="
                navigate({
                  path: '/items',
                  query: { tab: 'priority' },
                })
              "
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >priority_high</span
                >
              </span>
              <span class="ml-1"> High priority items </span>
            </a>
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="
                navigate({
                  path: '/items',
                  query: { tab: 'pending' },
                })
              "
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >task_alt</span
                >
              </span>
              <span class="ml-1"> Pending items </span>
            </a>
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="
                navigate({
                  path: '/items',
                  query: { tab: 'testing' },
                })
              "
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >fact_check</span
                >
              </span>
              <span class="ml-1"> Testing items </span>
            </a>
            <hr class="navbar-divider soft-background" />
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="navigate('/queue')"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >format_list_numbered</span
                >
              </span>
              <span class="ml-1"> Queue </span>
            </a>
          </div>
        </div>

        <div
          class="navbar-item has-dropdown"
          :class="{ 'is-hoverable': navBarActive }"
        >
          <a
            href="#"
            class="navbar-link pl-1"
            @mouseenter="navBarActive && $event.target.focus()"
            @click.prevent="handleNavMenuClick"
          >
            Timelines
          </a>

          <div class="navbar-dropdown is-size-7">
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="navigate('/timelines-chart')"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >view_timeline</span
                >
              </span>
              <span class="ml-1"> Timelines chart </span>
            </a>

            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="navigate('/timelines')"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >view_list</span
                >
              </span>
              <span class="ml-1"> Timelines list </span>
            </a>

            <hr class="navbar-divider soft-background" />
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="handleNewTimeline"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >add</span
                >
              </span>
              <span class="ml-1"> New timeline </span>
            </a>
          </div>
        </div>

        <div
          class="navbar-item has-dropdown"
          :class="{ 'is-hoverable': navBarActive }"
        >
          <a
            href="#"
            class="navbar-link pl-1"
            @mouseenter="navBarActive && $event.target.focus()"
            @click.prevent="handleNavMenuClick"
          >
            More
          </a>

          <div class="navbar-dropdown is-size-7">
            <a
              href="#"
              class="navbar-item pt-1 pb-1"
              @click.prevent="navigate('/inactive-projects')"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                  >block</span
                >
              </span>
              <span class="ml-1"> Inactive projects </span>
            </a>
            <!-- <hr class="navbar-divider soft-background" />

            <a
              href=""
              target="_blank"
              rel="noopener noreferrer"
              class="navbar-item pt-1 pb-1"
              @click="navBarActive = false"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6">
                  analytics
                </span>
              </span>
              <span class="ml-1"> Reporting </span>
            </a>

            <hr class="navbar-divider soft-background" />

            <a
              href=""
              target="_blank"
              rel="noopener noreferrer"
              class="navbar-item pt-1 pb-1"
              @click="navBarActive = false"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6">
                  menu_book
                </span>
              </span>
              <span class="ml-1"> Documentation </span>
            </a>

            <a
              :href="state.app.config.datasourceUrl"
              target="_blank"
              rel="noopener noreferrer"
              class="navbar-item pt-1 pb-1"
              @click="navBarActive = false"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined is-size-6">
                  storage
                </span>
              </span>
              <span class="ml-1"> Datasource </span>
            </a> -->
          </div>
        </div>

        <div class="navbar-item is-expanded is-hidden-touch">
          <nav-bar-title :title="state.app.title"></nav-bar-title>
        </div>
      </div>

      <div class="navbar-end">
        <div class="navbar-item pr-0">
          <full-text-search
            id="nav-full-text-search"
            search-placeholder="Search (ctrl + alt + /)"
            :input-style="{ height: '24px' }"
          ></full-text-search>
        </div>
        <div class="navbar-item">
          <div class="buttons p-0">
            <button
              class="button is-white is-small p-1"
              title="Refresh data"
              v-show="showRefreshAction"
              :class="{ 'is-loading': isLoading }"
              :disabled="isLoading"
              @click="refreshData"
            >
              <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                >refresh</span
              >
            </button>
            <button
              class="button is-white is-small p-1"
              title="Settings (ctrl + alt + s)"
              :class="{ 'is-loading': isLoading }"
              @click="navigate('/settings')"
            >
              <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                >settings</span
              >
            </button>
          </div>
        </div>
      </div>
    </div>
  </nav>
</template>

<style>
.nav-border-ef002 {
  border-bottom: 1px solid gray;
}
</style>

<script>
const NavBar = {
  setup() {
    return {
      state: {
        app: store.state.app,
        data: store.state.data,
      },
      calculated: store.calculated,
      dispatch: {
        timeline: store.dispatch.timeline,
        project: store.dispatch.project,
        app: store.dispatch.app,
      },
    };
  },

  data() {
    return {
      showMenu: false,
      isLoading: false,
      navBarActive: false,
    };
  },

  computed: {
    showRefreshAction() {
      const currentRoute = this.state.app.currentRoute;

      return [
        "/",
        "/projects",
        "/inactive-projects",
        "/items",
        "/settings",
      ].includes(currentRoute);
    },
  },

  methods: {
    handleNavFocusOut(e) {
      if (!this.$refs.nav.contains(e.relatedTarget)) this.navBarActive = false;
    },
    handleNavMenuClick() {
      this.navBarActive = !this.navBarActive;
    },
    navigate(path) {
      this.navBarActive = false;
      this.$router.push(path);
    },
    toggleMenu() {
      this.showMenu = !this.showMenu;
    },
    async refreshData() {
      //prevent additional requests while one is in progess
      if (this.isLoading) return;

      this.isLoading = true;
      await this.dispatch.app.loadAppData();
      this.isLoading = false;
    },
    handleNewTimeline() {
      // const route = { path: "/timelines", query: { type: "new-timeline" } };
      const route = this.dispatch.timeline.getNewTimelineRoute();
      this.navigate(route);
    },
    handleNewProject() {
      const route = this.dispatch.project.getNewProjectRoute();
      this.navigate(route);
    },
    handleBackClick() {
      window.history.back();
    },
    handleFlashingAnimationEnd(e) {
      e.target.classList.remove("flashing");
    },
  },

  watch: {
    "state.app.polling.sessionPolls": {
      handler() {
        this.$refs.pollingIndicator.classList.add("flashing");
      },
    },
  },

  template: document.querySelector("#nav-bar-template").innerHTML,
};

app.component("nav-bar", NavBar);
</script>
<template id="nav-bar-title-template">
  <article class="has-text-centered" style="overflow-x: clip; width: 100%">
    {{ title }}
  </article>
</template>

<script>
const NavBarTitle = {
  props: {
    title: String,
  },

  template: document.querySelector("#nav-bar-title-template").innerHTML,
};

app.component("nav-bar-title", NavBarTitle);
</script>
<template id="data-poll-details-template">
  <article>
    <p><strong>Status: </strong>{{ state.app.polling.status }}</p>
    <p>
      <strong>Session polls: </strong>{{ state.app.polling.sessionPolls }}
    </p>
    <p><strong>Last poll: </strong>{{ state.app.polling.lastUpdate }}</p>
  </article>
</template>

<script>
const DataPollDetails = {
  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  template: document.querySelector("#data-poll-details-template").innerHTML,
};

app.component("data-poll-details", DataPollDetails);
</script>
<template id="queue-view-template">

  <main class="queue-view-height">
    <split-pane
      v-model:collapsed="collapsed"
      :initial-offset="0.35"
      cache="queue-view"
    >
      <template #first>
        <!-- list of items in the queue -->
        <section
          v-if="vm.items.length === 0"
          class="p-3"
        >
          <p class="subtitle">Nothing in your queue!</p>
        </section>
        <section
          v-if="vm.items.length > 0"
          class="p-3"
          ref="list"
        >
          <div
            style="height: 16px"
            @dragover.prevent="handleDragover"
            @dragleave="handleDragleave"
            @drop.prevent="(e) => handleDrop(e, 0)"
          ></div>
          <div
            v-for="(item, index) in vm.items"
            :key="item.id"
          >
            <draggable-item
              :dragdata="item.id"
              class="mb-2"
              :data-id="item.id"
              :arrow-up-title="`Move to position ${Math.max(index, 1)} of ${vm.items.length}`"
              :arrow-down-title="`Move to position ${index + 2} of ${vm.items.length}`"
              :handle-title="`Re-order from position ${index + 1} of ${vm.items.length}`"
              @arrow-up="handleArrow(item.id, index - 1)"
              @arrow-down="handleArrow(item.id, index + 2)"
            >
              <item-card
                :class="{ 'has-background-light': vm.selectedItem === item }"
                :item="item"
                @item-click="vm.selectedItem = item"
                @project-click="vm.selectedItem = item"
              ></item-card>
            </draggable-item>
            <div
              style="height: 16px"
              @dragover.prevent="handleDragover"
              @dragleave="handleDragleave"
              @drop.prevent="(e) => handleDrop(e, index + 1)"
            ></div>
          </div>
        </section>
      </template>

      <template
        #second
        v-if="vm.selectedItem"
      >
        <item-edit-details
          :key="vm.selectedItem.id"
          class="p-5"
          :item="vm.selectedItem"
          @new-item="vm.handleNewItem"
        ></item-edit-details>
      </template>
    </split-pane>
  </main>

</template>

<style>

.queue-view-height {
  height: 100%;
}

@media screen and (min-width: 769px) {
  .queue-view-height {
    height: calc(100vh - 56px);
  }
}

</style>

<script>
const QueueView = {
  props: {},

  setup() {
    /** @type {VueOverrides} */
    const {
      ref,
      nextTick,
    } = Vue;

    const { useRoute, useRouter } = VueRouter;

    const route = useRoute();
    const router = useRouter();
    const { id } = route.query;

    const vm = useQueueViewModel({ initialId: id });

    /** @type {ValueType<Element>} */
    const list = ref(null);

    const handleGoToProject = ({ project }) => {
      router.push(`/project/${project.id}`);
    };

    const collapsed = ref(vm.items.length === 0 ? 'first' : '');

    const displayAsDropZone = (/** @type {HTMLElement} */ el) => {
      el.style.height = '32px';
      el.classList.add('has-background-primary', 'my-2');
    };

    const resetDropZone = (/** @type {HTMLElement} */ el) => {
      el.style.height = '16px';
      el.classList.remove('has-background-primary', 'my-2');
    };

    const handleDrop = (/** @type {DragEvent} */ e, index) => {
      const id = e.dataTransfer.getData('text/plain');
      if (!id) return;

      resetDropZone(e.target);
      vm.reorder(id, index);
      vm.autosave();
    };

    const handleDragover = (/** @type {DragEvent} */ e) => {
      e.dataTransfer.dropEffect = 'move';
      displayAsDropZone(e.target);
    };

    const handleDragleave = (/** @type {DragEvent} */ e) => {
      resetDropZone(e.target)
    };

    const handleArrow = (id, index) => {
      vm.reorder(id, index);
      vm.autosave();
      focusById(id);
    };

    const focusById = (id) => {
      nextTick().then(() => {
        if (list.value === null) return;
  
        const element = list.value.querySelector(`[data-id="${id}"]`);
        if (!element) return;
  
        const btn = element.querySelector('[data-target="drag-handle"]');
        if (!btn) return;
  
        btn.focus();
      });
    };

    return {
      vm,
      list,
      handleGoToProject,
      collapsed,
      handleDrop,
      handleDragover,
      handleDragleave,
      handleArrow,
      focusById
    };
  },

  data() {
    return {}
  },

  template: document.querySelector('#queue-view-template').innerHTML
};

app.component('queue-view', QueueView);
</script>
<template id="settings-view-template">
  <main v-if="!!vm" class="container">
    <div class="columns">
      <section class="column">
        <h2 class="title is-6 mb-1">App settings</h2>
        <hr />
        <!-- <apps-select
          label="Theme (reload app to update theme after changing it)"
          size="is-small"
          v-model="vm.user.settings.theme"
          :options="['Light', 'Dark']"
          @change="vm.saveUser"
        ></apps-select> -->

        <!-- <apps-checkbox
          label="Subscribe to item assignment email notifications"
          size="is-small"
          v-model="vm.user.settings.getItemEmailNotifications"
          @change="vm.saveUser"
        ></apps-checkbox> -->
      </section>

      <section class="column">
        <p class="title is-6 mb-1">Other settings...</p>
        <hr />
        <h2 class="subtitle is-7 highlight-border-bottom mb-2">
          Keyboard shortcuts
        </h2>
        <article class="content is-size-7">
          <ul>
            <li><strong>(ctrl + alt + /)</strong> - Go to search</li>
            <li><strong>(ctrl + alt + p)</strong> - Go to my projects</li>
            <li><strong>(ctrl + alt + q)</strong> - Go to queue</li>
            <li><strong>(ctrl + alt + i)</strong> - Go to my items</li>
            <li><strong>(ctrl + alt + c)</strong> - Go to timelines chart</li>
            <li><strong>(ctrl + alt + h)</strong> - Go to home dashboard</li>
            <li><strong>(ctrl + alt + s)</strong> - Go to settings</li>
          </ul>
        </article>
      </section>
    </div>
    <!-- <section class="is-flex is-flex-direction-column" style="max-height: 40vh">
      <admin-system-log
        class="m-2 p-2 light-border"
        style="
          font-family: 'Courier New', Courier, monospace;
          flex-grow: 1;
          flex-shrink: 1;
          overflow-y: auto;
        "
      ></admin-system-log>
    </section> -->
  </main>
</template>

<script>
const SettingsView = {
  setup() {
    const vm = store.state.app.user
      ? useUserViewModel(store.state.app.user)
      : null;

    return {
      vm,
    };
  },

  template: document.querySelector("#settings-view-template").innerHTML,
};

app.component("settings-view", SettingsView);
</script>
<template id="last-saved-on-template">
  <span>Last saved: {{ lastSavedOn }}</span>
</template>

<script>
const lastSavedOn = {
  props: {
    rec: Object,
    live: {
      type: Boolean,
      default: true
    }
  },

  setup(props) {
    const { lastSavedOn } = useLastSavedOn(props.rec || {}, { live: props.live });
    
    return {
      lastSavedOn
    };
  },

  template: document.querySelector('#last-saved-on-template').innerHTML
};

app.component('last-saved-on', lastSavedOn);
</script>
<template id="side-menu-container-template">
  <div>
    <div
      class="modal-background side-menu-expand-bg"
      style="position: fixed; z-index: 20"
      v-show="expand"
      @click="expand = false"
    ></div>

    <div class="side-menu-expander">
      <button
        class="button is-small is-dark is-radiusless"
        style="width: 100%; height: 64px;"
        :title="expandTitle"
        @click="handleExpand"
      >
        <span class="material-symbols-outlined">{{ icon }}</span>
      </button>
    </div>

    <aside
      class="side-menu-container has-background-white"
      :class="{ 'side-menu-hide': !expand }"
    >
      <slot></slot>
    </aside>
  </div>
</template>

<style>
.side-menu-container {
  position: fixed;
  overflow-y: auto;
  left: 0;
  top: 32px;
  bottom: 0;
  width: 260px;
  border-top: 1px solid gray;
  border-right: 1px solid gray;
  z-index: 20;
}

.side-menu-expander {
  display: none;
  position: fixed;
  opacity: 90%;
  left: 0;
  bottom: 16px; 
  z-index: 21;
}

.side-menu-expand-bg {
  display: none;
}

.side-menu-hide {
  display: inherit;
}

/* @media (max-width: 768px) { */
@media (max-width: 1024px) {
  .side-menu-expander {
    display: inherit;
  }

  .side-menu-hide {
    display: none;
  }

  .side-menu-container {
    width: 60%;
  }

  .side-menu-expand-bg {
    display: inherit;
  }
}
</style>

<script>
const SideMenuContainer = {
  data() {
    return {
      expand: false,
    };
  },

  computed: {
    icon() {
      return this.expand ? "arrow_back_ios" : "arrow_forward_ios";
    },
    expandTitle() {
      return this.expand ? "Hide left menu" : "Expand left menu";
    },
  },

  methods: {
    handleExpand() {
      this.expand = !this.expand;
    },
  },

  template: document.querySelector("#side-menu-container-template").innerHTML,
};

app.component("side-menu-container", SideMenuContainer);
</script>
<template id="side-menu-content-template">
  <section class="side-menu-content">
    <slot></slot>
  </section>
</template>

<style>
.side-menu-content {
  margin-left: 260px;
}

/* @media (max-width: 768px) { */
@media (max-width: 1024px) {
  .side-menu-content {
    margin-left: 0px;
  }
}
</style>

<script>
const SideMenuContent = {
  template: document.querySelector("#side-menu-content-template").innerHTML,
};

app.component("side-menu-content", SideMenuContent);
</script>
<template id="status-bar-template">
  <article class="level" :style="style">
    <div class="level-left">
      <slot name="left"></slot>
    </div>
    <div class="level-right">
      <slot name="right"></slot>
    </div>
  </article>
</template>

<script>
const StatusBar = {
  props: {
    pos: String,
  },

  computed: {
    style() {
      const st = {
        position: "fixed",
        "z-idex": 20,
        width: "100%",
        left: "0px",
        "border-top": "1px solid var(--soft-color)",
      };

      if (this.pos === "bottom") st.bottom = "0px";
      else st.top = "0px";

      return st;
    },
  },

  template: document.querySelector("#status-bar-template").innerHTML,
};

app.component("status-bar", StatusBar);
</script>
<template id="workload-card-template">
  <article>
    <h2
      class="
        title
        is-6
        mb-1
        p-2
        highlight-border-bottom
      "
    >
      {{ vm.username }}
    </h2>

    <div class="pb-3 pr-3 pl-3 pt-1">
      <p>Active projects: {{ vm.workload.activeProjects }}</p>
      <p>Active project items: {{ vm.workload.activeProjectItems }}</p>
    </div>
  </article>
</template>

<script>
const WorkloadCard = {
  props: {
    vm: Object,
  },

  setup() {
    return {};
  },

  template: document.querySelector("#workload-card-template").innerHTML,
};

app.component("workload-card", WorkloadCard);
</script>
<template id="hero-slot-table-template">
  <div>
    <div
      ref="hero"
      class="hero is-small"
      style="border-bottom: 1px solid gray"
      :class="headerClass"
    >
      <div class="hero-body p-2">
        <section class="container">
          <h1
            class="title is-4 mb-1"
            v-if="!!title"
          >{{ title }}</h1>

          <table-search
            :criteria="criteria"
            :count="filteredRows.length"
            :more-options="searchMoreOptions"
            :displayed-rows="filteredRows"
            :all-rows="rows"
            @more-options-action="$emit('more-options-action', $event)"
          ></table-search>

          <table-filter
            :fields="filterFields"
            :dates="filterDates"
            :criteria="criteria"
          ></table-filter>
        </section>
      </div>
      <section
        class="container pb-2"
        style="width: 100%"
      >
        <table-sort-header
          :sizes="sizes"
          :headers="headers"
          :criteria="criteria"
        ></table-sort-header>
      </section>
    </div>
    <div
      v-show="working"
      class="mt-2"
      style="position: relative;"
    >
      <loading-inset></loading-inset>
    </div>
    <div
      v-show="!working"
      class="mt-2"
    >
      <slot
        v-for="row in displayRows"
        :key="row._rowKey"
        v-bind="row"
      ></slot>
    </div>
  </div>
</template>

<script>
const HeroSlotTable = {
  props: {
    title: String,
    // bulma column size classes
    sizes: Array,
    // { prop: <property name>, caption: <header caption to display> }
    headers: Array,
    // { Object containing all of the rows, MUST contain unique id prop }
    rows: Array,
    // { prop: <property name> , options: <array of options> { value, text } }
    filterFields: {
      type: Array,
      default: () => [],
    },
    // { prop: <property name> , label: <string> }
    filterDates: {
      type: Array,
      default: () => [],
    },
    //{ filter: { prop: value, ... }, sort: { header: prop, ascending: boolean }, search: value }
    criteria: Object,
    // options for the header columns class
    //helpfull if you want to make it sticky or something i think
    headerClass: {
      type: [String, Object],
      default: "is-white sticky-header",
    },
    searchMoreOptions: {
      type: Array,
      default: () => [],
    },
    useWorker: Boolean
  },

  emits: ["more-options-action", "update:count", "update:displayed-rows", "update:hero"],

  setup(props, context) {
    const { watch, ref, onMounted } = Vue;

    const defaultFilter = props.filterFields.reduce((obj, fld) => {
      obj[fld.prop] = props.criteria.filter[fld.prop] || "";
      return obj;
    }, {});

    const hero = ref(null);

    props.criteria.filter = defaultFilter;

    const {
      rows,
      criteria,
      headers,
      filterFields,
      filterDates,
      working,
      filteredRows,
      displayRows,
      rowsToDisplay,
    } = useTableSortFilterScroll(context, {
      rows: props.rows,
      headers: props.headers,
      criteria: props.criteria,
      filterFields: props.filterFields,
      filterDates: props.filterDates,
      useWorker: props.useWorker
    });

    watch(
      () => props.criteria,
      (newVal) => (criteria.value = newVal)
    );
    watch(
      () => props.rows,
      (newVal) => (rows.value = newVal)
    );
    watch(
      () => props.headers,
      (newVal) => (headers.value = newVal)
    );
    watch(
      () => props.filterFields,
      (newVal) => (filterFields.value = newVal)
    );
    watch(
      () => props.filterDates,
      (newVal) => (filterDates.value = newVal)
    );

    onMounted(() => context.emit('update:hero', hero.value));

    return {
      hero,
      rows,
      criteria,
      headers,
      filteredRows,
      displayRows,
      rowsToDisplay,
      working
    };
  },

  template: document.querySelector("#hero-slot-table-template").innerHTML,
};

app.component("hero-slot-table", HeroSlotTable);
</script>
<template id="scrollable-filter-table-template">
  <div
    class="table-container"
    ref="scrollElement"
    style="overflow-y: scroll; position: relative"
  >
    <table class="table scrollable-table-aac092">
      <thead>
        <tr>
          <th
            class="sticky-table-header-aac092"
            v-for="(header, index) in displayHeaders"
            :style="header.style"
            :class="[headerBackgroundClass, { 'sticky-table-row-aac092 z-3-aac092': index === internalFreezeColumn }, header.class || '']"
            :key="header.prop"
            scope="col"
          >
            <span
              tabindex="0"
              class="subtitle is-6 is-clickable"
              :class="{ [sortClass]: criteria.sort.header === header.prop }"
              @click="sortByHeader(header.prop)"
              @keydown="sortByHeader(header.prop, $event)"
            >{{ header.caption }}
            </span>
            <a
              href="#"
              aria-label="Pin column"
              title="Pin column"
              style="height: 1.5rem;"
              class="ml-2 button is-small is-ghost p-0 pin-hover-aac092"
              :class="{ 'has-text-primary': index === internalFreezeColumn }"
              @click.prevent="handleFreezeColumn(index)"
            >
              <span
                class="material-symbols-outlined is-size-6"
                :class="{ 'pin-aac092': index !== internalFreezeColumn }"
              >push_pin</span>
            </a>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr
          style="position: relative;"
          v-if="working"
        >
          <td><loading-inset></loading-inset></td>
        </tr>
        <tr
          v-else
          tabindex="0"
          class="is-clickable highlight-hover"
          v-for="(row, index) in displayRows"
          :class="headerBackgroundClass"
          :key="row._rowKey"
          @click="handleRowSelect(row, index)"
          @keydown="handleRowSelect(row, index, $event)"
        >
          <td
            v-for="(header, hindex) in displayHeaders"
            :key="header.prop"
            :class="{ 'sticky-table-row-aac092 z-2-aac092': hindex === internalFreezeColumn }"
          >
            <slot
              :name="header.prop"
              v-bind="row"
            >{{ row[header.prop] }}</slot>
          </td>
        </tr>
      </tbody>
    </table>

    <div
      v-show="!working"
      class="p-5"
    >
      <button
        aria-label="Loading"
        v-show="filteredRows.length > rowsToDisplay"
        class="button is-fullwidth static is-white is-loading"
      ></button>
    </div>
  </div>
</template>

<style>
/* added '-aac092' just to scope the classname */
.sticky-table-header-aac092 {
  position: sticky;
  top: 0;
  /* border: 1px solid var(--soft-color) !important; */
  z-index: 1;
  background-color: inherit;
  white-space: nowrap;
  font-weight: bold;
}

.sticky-table-row-aac092 {
  position: sticky;
  left: 0;
  border-right: 1px solid lightslategray !important;
  background-color: inherit;
}

.z-2-aac092 {
  z-index: 2;
}

.z-3-aac092 {
  z-index: 3;
}

.scrollable-table-aac092 {
  table-layout: fixed;
  /* width: max-content; */
  min-width: 100%;
  /* quick fix for dissapearing borders on scroll... */
  border-collapse: separate;
}

.pin-aac092 {
  visibility: hidden;
}

.pin-hover-aac092:hover>span.pin-aac092,
.pin-hover-aac092:focus>span.pin-aac092 {
  visibility: visible;
}

.sort-asc-aac092::after {
  content: "";
  margin-left: 6px;
}

.sort-desc-aac092::after {
  content: "";
  margin-left: 6px;
}
</style>

<script>
const ScrollableFilterTable = {
  props: {
    criteria: Object,
    headers: Array,
    filterFields: Array,
    filterDates: Array,
    count: Number,
    rows: Array,
    windowXY: Object,
    offset: Number,
    headerBackgroundClass: {
      type: String,
      default: "has-background-white",
    },
    freezeColumn: {
      type: Number
    },
    useWorker: Boolean
  },

  emits: ["update:count", "update:displayed-rows", "update:freeze-column", "row-select"],

  setup(props, context) {
    const { watch } = Vue;

    const {
      rows,
      criteria,
      headers,
      filterFields,
      filterDates,
      working,
      rowsToDisplay,
      scrollElement,
      filteredRows,
      displayRows,
    } = useTableSortFilterScroll(context, {
      rows: props.rows,
      headers: props.headers,
      criteria: props.criteria,
      filterFields: props.filterFields,
      filterDates: props.filterDates,
      useWorker: props.useWorker
    });

    watch(
      () => props.criteria,
      (newVal) => (criteria.value = newVal)
    );
    watch(
      () => props.rows,
      (newVal) => (rows.value = newVal)
    );
    watch(
      () => props.headers,
      (newVal) => (headers.value = newVal)
    );
    watch(
      () => props.filterFields,
      (newVal) => (filterFields.value = newVal)
    );
    watch(
      () => props.filterDates,
      (newVal) => (filterDates.value = newVal)
    );

    return {
      rows,
      criteria,
      headers,
      rowsToDisplay,
      scrollElement,
      filteredRows,
      displayRows,
      working
    };
  },

  data() {
    return {
      internalFreezeColumn: null
    }
  },

  computed: {
    sortClass() {
      return this.criteria.sort.ascending
        ? "sort-asc-aac092"
        : "sort-desc-aac092";
    },
    displayHeaders() {
      return this.headers.filter((h) => !h.searchOnly);
    },
  },

  methods: {
    sortByHeader(header, e) {
      //Enter keypress activates the sort
      if (e && e.key !== "Enter") return;

      const ascending =
        this.criteria.sort.header === header
          ? !this.criteria.sort.ascending
          : false;

      const newSort = {
        header,
        ascending,
      };

      this.criteria.sort = newSort;
    },
    handleRowSelect(row, index, e) {
      if (!e || e.key === "Enter") this.$emit("row-select", { row, index });
    },
    handleFreezeColumn(index) {
      const isCurrent = this.internalFreezeColumn === index;
      const newI = isCurrent ? null : index;
      this.internalFreezeColumn = newI;
      this.$emit('update:freeze-column', newI);
    }
  },

  watch: {
    windowXY: {
      handler(newXY) {
        const self = this;

        // needed to postpone till next tick as it would throw an error on init
        this.$nextTick().then(() => {
          const container = self.$refs.scrollElement;

          let offset = container.getBoundingClientRect().top;
          if (this.offset)
            offset += this.offset;

          container.style.height = `${newXY.y - offset}px`;
        });
      },
      immediate: true,
    },
    criteria: {
      handler() {
        const container = this.$refs.scrollElement;

        container.scroll({
          top: 0,
          left: container.scrollX,
          behavior: "smooth",
        });
      },
      deep: true,
    },
    freezeColumn(val) {
      this.internalFreezeColumn = val;
    }
  },

  template: document.querySelector("#scrollable-filter-table-template")
    .innerHTML,
};

app.component("scrollable-filter-table", ScrollableFilterTable);
</script>
<template id="scrollable-hero-table-template">
  <div>
    <div
      ref="hero"
      class="hero is-small"
      style="border-bottom: 1px solid gray"
      :class="headerClass"
    >
      <div class="hero-body p-2">
        <section class="container">
          <h1
            class="title is-4 mb-1"
            v-if="!!title"
          >{{ title }}</h1>

          <table-search
            :criteria="criteria"
            :count="count"
            :more-options="searchMoreOptions"
            :displayed-rows="displayedRows"
            :all-rows="rows"
            @more-options-action="$emit('more-options-action', $event)"
          ></table-search>

          <table-filter
            :fields="filterFields"
            :dates="filterDates"
            :criteria="criteria"
          ></table-filter>
        </section>
      </div>
    </div>

    <scrollable-filter-table
      :headers="headers"
      :filter-fields="filterFields"
      :filter-dates="filterDates"
      :criteria="criteria"
      :rows="rows"
      v-model:count="count"
      :window-x-y="windowXY"
      :offset="offset"
      :use-worker="useWorker"
      @row-select="handleRowSelect"
      @update:displayed-rows="handleUpdateDisplayedRows"
    >
      <template
        v-for="(_, name) in $slots"
        v-slot:[name]="slotData"
      >
        <slot
          :name="name"
          v-bind="slotData"
        ></slot>
      </template>
    </scrollable-filter-table>
  </div>
</template>

<script>
const ScrollableHeroTable = {
  props: {
    title: String,
    // { prop: <property name>, caption: <header caption to display> }
    headers: Array,
    // { Object containing all of the header prop names, MUST contain unique id prop }
    rows: Array,
    // { prop: <property name> , options: <array of options> { value, text } }
    filterFields: {
      type: Array,
      default: () => [],
    },
    // { prop: <property name> , label: <string> }
    filterDates: {
      type: Array,
      default: () => [],
    },
    //{ filter: { prop: value, ... }, sort: { header: prop, ascending: boolean }, search: value }
    criteria: Object,
    // options for the header columns class
    //helpfull if you want to make it sticky or something i think
    headerClass: {
      type: [String, Object],
      default: "is-white sticky-header",
    },
    searchMoreOptions: {
      type: Array,
      default: () => [],
    },
    freezeColumn: Number,
    useWorker: Boolean,
    offset: Number,
  },

  emits: ["row-select", "update:displayed-rows", "update:freeze-column", "more-options-action", "update:hero"],

  created() {
    const defaultFilter = this.filterFields.reduce((obj, fld) => {
      obj[fld.prop] = this.criteria.filter[fld.prop] || "";
      return obj;
    }, {});

    this.criteria.filter = defaultFilter;
  },

  mounted() {
    window.addEventListener("resize", this.updateWindowXY);
    this.updateWindowXY();
    this.$emit('update:hero', this.$refs.hero);
  },

  destroyed() {
    window.removeEventListener("resize", this.updateWindowXY);
  },

  data() {
    return {
      count: 0,
      windowXY: {
        x: window.innerWidth,
        y: window.innerHeight,
      },
      displayedRows: [],
    };
  },

  methods: {
    handleRowSelect(row) {
      this.$emit("row-select", row);
    },
    updateWindowXY() {
      this.windowXY = {
        x: window.innerWidth,
        y: window.innerHeight,
      };
    },
    handleUpdateDisplayedRows(rows) {
      this.displayedRows = rows;
      this.$emit("update:displayed-rows", rows);
    },
    handleUpdateFreezeColumn(index) {
      this.$emit("update:freeze-column", index);
    }
  },

  template: document.querySelector("#scrollable-hero-table-template").innerHTML,
};

app.component("scrollable-hero-table", ScrollableHeroTable);
</script>
<template id="table-filter-template">
  <section class="mb-2">
    <div v-show="showFilter && (fields.length > 0 || dates.length > 0)" class="columns is-mobile p-0 mb-1">
      <div class="column p-0 is-flex is-flex-wrap-wrap">
        <div
          class="mr-2"
          style="max-width: 25%"
          v-for="field in fields"
          :key="field.prop"
        >
          <div
            class="select is-small"
            :class="{ 'is-info': !!criteria.filter[field.prop] }"
          >
            <select
              @change="handleFilterAdd(field.prop, $event)"
              aria-label="Filter"
            >
              <option
                v-for="option in field.options"
                :key="option.value"
                :value="option.value"
                :title="option.text"
              >
                {{ truncate(option.text, 50) }}
              </option>
            </select>
          </div>
        </div>
        <div class="mr-2" v-for="date in dates" :key="date.prop">
          <div class="field has-addons">
            <div class="control">
              <a
                role="none"
                aria-hidden="true"
                class="button is-small"
                :class="{
                  'is-static': !criteria.dates[date.prop],
                  'is-info no-events': !!criteria.dates[date.prop],
                }"
                >{{ date.caption }}</a
              >
            </div>
            <div class="control">
              <input
                :aria-label="`${date.caption} start`"
                class="input is-small"
                :class="{ 'is-info': !!criteria.dates[date.prop] }"
                type="date"
                :value="
                  criteria.dates[date.prop]
                    ? criteria.dates[date.prop].start
                    : ''
                "
                @change="handleFilterDateChange('start', date.prop, $event)"
              />
            </div>
            <div class="control">
              <input
                :aria-label="`${date.caption} end`"
                class="input is-small"
                :class="{ 'is-info': !!criteria.dates[date.prop] }"
                type="date"
                :value="
                  criteria.dates[date.prop] ? criteria.dates[date.prop].end : ''
                "
                @change="handleFilterDateChange('end', date.prop, $event)"
              />
            </div>
            <div class="control">
              <button
                :disabled="
                  !(
                    criteria.dates[date.prop] &&
                    (criteria.dates[date.prop].start ||
                      criteria.dates[date.prop].end)
                  )
                "
                class="button is-small info-border"
                :title="`Clear ${date.caption.toLowerCase()} dates`"
                @click="handleClearDates(date.prop)"
              >
                <span class="icon">
                  <span aria-hidden="true" class="material-symbols-outlined">clear</span>
                </span>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="column is-narrow p-0">
        <button
          ref="less"
          class="button is-small is-white"
          title="Hide filter options"
          @click="handleToggleShowFilter"
        >
          <span class="icon">
            <span aria-hidden="true" class="material-symbols-outlined">expand_less</span>
          </span>
        </button>
      </div>
    </div>

    <aside class="columns p-0 pb-1 is-mobile">
      <div class="column p-0">
        <section class="tags are-small">
          <span
            v-for="({ prop, val }, index) in allFilters"
            :key="index"
            :title="getFilterDisplay(prop, val)"
            class="tag is-info m-1"
          >
            <span
              style="
                max-width: 112px;
                overflow-x: hidden;
                text-overflow: ellipsis;
              "
            >
              {{ getFilterDisplay(prop, val) }}
            </span>
            <button
              class="delete is-small"
              title="Remove filter"
              @click="handleFilterRemove(prop, val)"
            ></button>
          </span>
          <span
            v-for="prop in dateFiltersToShow"
            v-show="!showFilter"
            :key="prop"
            :title="getFilterDateDisplay(prop)"
            class="tag is-info m-1"
          >
            <span
              style="
                max-width: 112px;
                overflow-x: hidden;
                text-overflow: ellipsis;
              "
            >
              {{ getFilterDateDisplay(prop) }}
            </span>
            <button
              class="delete is-small"
              title="Remove date filter"
              @click="criteria.dates[prop] = undefined"
            ></button>
          </span>
          <a
            v-show="allFilters.length >= 3"
            href="#"
            role="button"
            class="tag is-warning m-1"
            title="Clear all filters"
            @click.prevent="handleClearAllFilters"
          >
            Clear all filters
          </a>
        </section>
      </div>
      <div v-show="!showFilter" class="column is-narrow p-0">
        <button
          ref="more"
          class="button is-small is-white"
          title="Show filter options"
        >
          <span class="icon">
            <span
              aria-hidden="true"
              class="material-symbols-outlined"
              @click="handleToggleShowFilter"
              >expand_more</span
            >
          </span>
        </button>
      </div>
    </aside>
  </section>
</template>

<script>
const TableFilter = {
  props: {
    // { prop: <property name> , options: <array of options> }
    fields: Array,
    dates: Array,
    criteria: Object,
  },

  data() {
    return {
      showFilter: true,
    };
  },

  computed: {
    allFilters() {
      console.time("All_Filters"); //DEBUG
      const all = Object.keys(this.criteria.filter)
        .filter((prop) => Array.isArray(this.criteria.filter[prop]))
        .map((prop) => this.criteria.filter[prop].map((val) => ({ prop, val })))
        .flat();
      console.timeEnd("All_Filters"); //DEBUG
      return all;
    },
    dateFiltersToShow() {
      return Object.keys(this.criteria.dates).filter(
        (prop) =>
          !!this.criteria.dates[prop] && (!!this.criteria.dates[prop].start || !!this.criteria.dates[prop].end)
      );
    },
  },

  methods: {
    handleFilterAdd(prop, e) {
      console.time("Add_Filter"); //DEBUG
      const val = e.target.value;
      const filter = this.criteria.filter[prop];
      if (Array.isArray(filter)) {
        if (!filter.includes(val)) filter.push(val);
      } else this.criteria.filter[prop] = [val];

      this.dispatchResize();
      e.target.value = "";
      console.timeEnd("Add_Filter"); //DEBUG
    },
    handleFilterRemove(prop, val) {
      console.time("Remove_Filter"); //DEBUG
      const filtered = this.criteria.filter[prop];
      if (!Array.isArray(filtered)) return;

      const index = filtered.findIndex((v) => String(v) === String(val));
      if (index !== -1) filtered.splice(index, 1);

      if (filtered.length === 0) this.criteria.filter[prop] = undefined;
      this.dispatchResize();
      console.timeEnd("Remove_Filter"); //DEBUG
    },
    getFilterDisplay(prop, val) {
      const field = this.fields.find((f) => f.prop === prop) || {};
      const selection = (field.options || []).find(
        (o) => String(o.value) === String(val)
      );
      return selection ? selection.text : "(Unknown)";
    },
    handleToggleShowFilter() {
      this.showFilter = !this.showFilter;
      const refs = this.$refs;
      const toggleButton = this.showFilter ? refs.less : refs.more;
      this.$nextTick().then(() => {
        toggleButton.focus();
      });
      this.dispatchResize();
    },
    handleClearAllFilters() {
      this.criteria.filter = {};
      this.criteria.dates = {};
      this.dispatchResize();
    },
    getFilterDateDisplay(prop) {
      const filtered = this.criteria.dates[prop];
      const dateField = this.dates.find((d) => d.prop === prop);

      const caption = dateField ? dateField.caption : "";
      const hasStart = !!filtered.start;
      const hasEnd = !!filtered.end;
      const hasStartAndEnd = hasStart && hasEnd;

      const expression = hasStartAndEnd
        ? `${filtered.start} to ${filtered.start}`
        : hasStart
        ? `On or after ${filtered.start}`
        : `On or before ${filtered.end}`;

      return `${caption}: ${expression}`;
    },
    handleFilterDateChange(type, prop, e) {
      this.criteria.dates[prop] = {
        ...this.criteria.dates[prop],
        [type]: e.target.value,
      };

      const d = this.criteria.dates[prop];
      if (!d.start && !d.end) this.criteria.dates[prop] = undefined;
    },
    handleClearDates(prop) {
      this.criteria.dates[prop] = undefined;
    },
    dispatchResize() {
      this.$nextTick().then(() =>
        requestAnimationFrame(() => window.dispatchEvent(new Event("resize")))
      );
    },
    truncate(str, len) {
      let val = String(str);
      if (val.length >= len)
        val = `${val.slice(0, len)}...`;

      return val;
    }
  },

  watch: {
    criteria: {
      handler() {
        window.scroll({ top: 0, left: window.scrollX, behavior: "smooth" });
      },
      deep: true,
    },
  },

  template: document.querySelector("#table-filter-template").innerHTML,
};

app.component("table-filter", TableFilter);
</script>
<template id="table-row-slots-template">
  <div>
    <div
      v-show="working"
      style="position: relative;"
    >
      <loading-inset></loading-inset>
    </div>
    <div v-show="!working">
      <div
        class="columns is-mobile is-clickable"
        style="border-bottom: 1px solid gray"
        tabindex="0"
        v-for="(row, index) in displayRows"
        :key="row._rowKey"
        @click="handleRowSelect(row, index)"
        @keydown="handleRowSelect(row, index, $event)"
      >
        <div
          class="column"
          v-for="(header, index) in displayHeaders"
          :key="header.prop"
          :class="{
            [sizes[index]]: !!sizes[index],
            [header.visibility]: !!header.visibility,
          }"
          :aria-label="`${header.caption} ${row[header.prop]}`"
        >
          <slot
            v-bind="row"
            :name="header.prop"
          >{{
            row[header.prop]
          }}</slot>
        </div>
      </div>

      <div class="p-5">
        <button
          aria-label="Loading"
          v-show="filteredRows.length > rowsToDisplay"
          class="button is-fullwidth static is-white is-loading"
        ></button>
      </div>
    </div>
  </div>
</template>

<script>
const TableRowSlots = {
  props: {
    sizes: Array,
    headers: Array,
    filterFields: Array,
    filterDates: Array,
    criteria: Object,
    count: Number,
    rows: Array,
    useWorker: Boolean
  },

  emits: ["update:count", "update:displayed-rows", "row-select"],

  setup(props, context) {
    const { watch } = Vue;

    const {
      rows,
      criteria,
      headers,
      filterFields,
      filterDates,
      working,
      filteredRows,
      displayRows,
      rowsToDisplay,
    } = useTableSortFilterScroll(context, {
      rows: props.rows,
      headers: props.headers,
      criteria: props.criteria,
      filterFields: props.filterFields,
      filterDates: props.filterDates,
      useWorker: props.useWorker
    });

    watch(
      () => props.criteria,
      (newVal) => (criteria.value = newVal)
    );
    watch(
      () => props.rows,
      (newVal) => (rows.value = newVal)
    );
    watch(
      () => props.headers,
      (newVal) => (headers.value = newVal)
    );
    watch(
      () => props.filterFields,
      (newVal) => (filterFields.value = newVal)
    );
    watch(
      () => props.filterDates,
      (newVal) => (filterDates.value = newVal)
    );

    return {
      rows,
      criteria,
      headers,
      filteredRows,
      displayRows,
      rowsToDisplay,
      working
    };
  },

  computed: {
    displayHeaders() {
      return this.headers.filter((h) => !h.searchOnly);
    },
    displayHeaderAriaCaptions() {
      return this.displayHeaders.map((h) => h.caption).join(", ");
    },
  },

  methods: {
    handleRowSelect(row, index, e) {
      if (!e || e.key === "Enter") this.$emit("row-select", { row, index });
    },
  },

  template: document.querySelector("#table-row-slots-template").innerHTML,
};

app.component("table-row-slots", TableRowSlots);
</script>
<template id="table-search-template">
  <div class="field mb-2" :class="{ 'has-addons': count !== undefined }">
    <div class="control is-expanded">
      <input
        aria-label="Search"
        type="search"
        class="input is-small"
        placeholder="Search..."
        :class="{ 'is-info': !!criteria.search }"
        :value="criteria.search"
        @change="syncSearch"
        @keydown="handleSearchKeydown"
      />
    </div>
    <div class="control" v-if="count !== undefined">
      <button
        role="generic"
        class="button is-small is-static has-background-white"
        disabled
        style="opacity: 1"
      >
        {{ count }} record(s)
      </button>
    </div>
    <div v-if="moreOptions && moreOptions.length > 0" class="control">
      <div class="dropdown is-right" :class="{ 'is-active': showMoreDropdown }" style="height: 100%;">
        <div class="dropdown-trigger">
          <button
            class="button is-small"
            title="More"
            aria-haspopup="true"
            @click="handleShowMoreDropdown"
          >
            <span class="icon">
              <span class="material-symbols-outlined" aria-hidden="true">more_vert</span>
            </span>
          </button>
        </div>
        <div class="dropdown-menu">
          <div class="dropdown-content light-border">
            <a
              v-for="option in moreOptions"
              :key="option.caption"
              href="#"
              aria-label="Search"
              class="dropdown-item"
              @click.prevent="handleMoreOptionsAction(option.action)"
            >
              {{ option.caption }}
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
const TableSearch = {
  props: {
    criteria: Object,
    count: Number,
    // { caption: String, action: String (action identifier) }
    moreOptions: Array,
    allRows: Array,
    displayedRows: Array,
  },

  emits: ["more-options-action"],

  data() {
    return {
      showMoreDropdown: false,
    };
  },

  methods: {
    syncSearch(e) {
      this.criteria.search = e.target.value;
    },
    handleSearchKeydown(e) {
      if (e.key === "Enter" || e.key === "Escape") this.syncSearch(e);
    },
    handleMoreOptionsAction(action) {
      this.$emit("more-options-action", {
        action,
        allRows: this.allRows,
        displayedRows: this.displayedRows,
      });
      this.showMoreDropdown = false;
    },
    handleShowMoreDropdown() {
      this.showMoreDropdown = !this.showMoreDropdown;
    },
  },

  template: document.querySelector("#table-search-template").innerHTML,
};

app.component("table-search", TableSearch);
</script>
<template id="table-sort-header-template">
  <div class="columns is-mobile" style="width: 100%">
    <div
      class="column"
      v-for="(header, index) in displayHeaders"
      :key="header.prop"
      :class="{
        [sizes[index]]: !!sizes[index],
        [header.visibility]: !!header.visibility,
      }"
    >
      <a
        href="#"
        role="button"
        class="subtitle is-6 is-clickable"
        title="Sort"
        :class="{ [sortClass]: criteria.sort.header === header.prop }"
        @click.prevent="sortByHeader(header.prop)"
        >{{ header.caption }}</a
      >
    </div>
  </div>
</template>

<style>
/* Sort indicators added '-0acfde' just to scope the classname */
.sort-asc-0acfde::after {
  content: "";
  margin-left: 6px;
}

.sort-desc-0acfde::after {
  content: "";
  margin-left: 6px;
}
</style>

<script>
const TableSortHeader = {
  props: {
    sizes: Array,
    headers: Array,
    criteria: Object,
  },

  computed: {
    sortClass() {
      return this.criteria.sort.ascending
        ? "sort-asc-0acfde"
        : "sort-desc-0acfde";
    },
    displayHeaders() {
      return this.headers.filter((h) => !h.searchOnly);
    },
  },

  methods: {
    sortByHeader(header, e) {
      //Enter keypress activates the sort
      if (e && e.key !== "Enter") return;

      const ascending =
        this.criteria.sort.header === header
          ? !this.criteria.sort.ascending
          : false;

      const newSort = {
        header,
        ascending,
      };

      this.criteria.sort = newSort;
    },
  },

  template: document.querySelector("#table-sort-header-template").innerHTML,
};

app.component("table-sort-header", TableSortHeader);
</script>
<template id="item-action-bar-template">
  <article class="columns is-mobile mb-0">
    <div class="column p-0">
      <span class="icon-text">
        <item-type-icon :type="vm.item.type"></item-type-icon>
        <span v-show="!vm.isNew" class="is-size-7">
          <span
            class="tag is-small has-text-weight-bold"
            :class="vm.itemStatusBulmaTag"
          >
            [{{ vm.item.itemNumber }}]
          </span>
          Created: {{ createdDisplay }} | <last-saved-on :rec="vm.item"></last-saved-on>
        </span>
      </span>
    </div>

    <div class="column is-narrow p-0">
      <div v-show="!vm.isNew" class="buttons">
        <button
          v-show="vm.higherOrderType"
          class="button is-white is-small"
          title="Open related items"
          @click="handledRelatedItemListClick"
        >
          <span class="icon">
            <span aria-hidden="true" class="material-symbols-outlined">
              format_list_bulleted
            </span>
          </span>
        </button>
        <!-- TODO: hook up emailing maybe? -->
        <!-- <button class="button is-white is-small" title="Email item">
          <span class="icon is-small">
            <span class="material-symbols-outlined" aria-hidden="true">email</span>
          </span>
        </button> -->
        <button
          class="button is-white is-small"
          title="Delete item"
          ref="deleteButton"
          @click="handleDelete"
        >
          <span class="icon is-small">
            <span class="material-symbols-outlined" aria-hidden="true">delete</span>
          </span>
        </button>

        <!-- QUEUE -->
        <queue-button
          :queued="vm.isQueued"
          @push="vm.pushToQueue"
          @pop="vm.popFromQueue"
        ></queue-button>

        <div
          class="dropdown is-right"
          :class="{ 'is-active': showMoreOptions }"
        >
          <div class="dropdown-trigger">
            <button
              class="button is-white is-small"
              aria-haspopup="true"
              title="More options"
              @click="showMoreOptions = !showMoreOptions"
            >
              <span class="icon">
                <span aria-hidden="true" class="material-symbols-outlined">
                  more_horiz
                </span>
              </span>
            </button>
          </div>
          <div class="dropdown-menu">
            <div class="dropdown-content">
              <div v-if="showMoreOptions" class="dropdown-item">
                <apps-select
                  size="is-small"
                  label="Assigned project"
                  :options="projectOptions"
                  @change="vm.autosave"
                  v-model="vm.item.project"
                ></apps-select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </article>
</template>

<script>
const ItemActionBar = {
  props: {
    vm: Object,
  },

  emits: ["item-delete", "related-items-select"],

  setup() {
    return {
      state: {
        app: store.state.app,
        data: store.state.data,
      },
      calculated: store.calculated
    };
  },

  data() {
    return {
      showMoreOptions: false,
    };
  },

  computed: {
    projectOptions() {
      return this.state.data.projects
        .sort((a, b) => (a.name.toLowerCase() < b.name.toLowerCase() ? -1 : 1))
        .map((proj) => ({ value: proj.id, text: proj.name }));
    },
    createdDisplay() {
      const date = this.vm.item.createdDate;
      if (!date) return "unknown";

      return new Date(date).toLocaleDateString();
    },
  },

  methods: {
    handleDelete() {
      const confirm = this.state.app.confirm;
      const context = this;

      confirm.title = "Delete item";
      confirm.description = "Are you sure you want to delete this item?";
      confirm.caption = "Delete";
      confirm.confirmClasses = "is-danger";

      confirm.action = async () => {
        await context.vm.deleteItem();
        context.$emit("item-delete");
      };
      confirm.cancel = () => context.$refs.deleteButton.focus();

      confirm.show = true;
    },
    handledRelatedItemListClick() {
      this.$emit("related-items-select", this.vm.item);
    },
    handleReassignItemClick() {},
  },

  template: document.querySelector("#item-action-bar-template").innerHTML,
};

app.component("item-action-bar", ItemActionBar);
</script>
<template id="item-comment-edit-template">
  <section>
    <apps-input
      label="Comments"
      size="is-small"
      type="textarea"
      :disabled="isSaving"
      v-model="newComment"
    ></apps-input>
    <div class="buttons is-right">
      <button
        class="button is-small is-link mr-0"
        :class="{ 'is-loading': isSaving }"
        :disabled="!canComment"
        @click="handleSaveComment"
      >
        Post comment
      </button>
    </div>

    <article>
      <div
        v-for="comment in vm.comments"
        :key="comment.id"
        class="p-2 mb-2 light-border is-size-7"
        :class="{ 'has-background-light': deletingComments.includes(comment) }"
      >
        <div class="columns">
          <p class="column p-0">
            {{ comment.createdBy }} -
            {{ new Date(comment.createdDate).toLocaleDateString() }}
          </p>
          <p class="column is-narrow p-0">
            <button
              class="delete is-small"
              title="Remove comment"
              @click="handleDeleteComment(comment)"
            ></button>
          </p>
        </div>
        <p class="content" style="white-space: pre-wrap">
          {{ comment.comment }}
        </p>
      </div>
    </article>
  </section>
</template>

<script>
const ItemCommentEdit = {
  props: {
    vm: Object,
  },

  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  data() {
    return {
      newComment: "",
      isSaving: false,
      deletingComments: [],
    };
  },

  computed: {
    canComment() {
      return !this.isSaving && !!this.newComment;
    },
  },

  methods: {
    async handleSaveComment() {
      if (!this.newComment) return;

      this.isSaving = true;

      await this.vm.postComment(this.newComment);

      this.isSaving = false;
      this.newComment = "";
    },
    handleDeleteComment(comment) {
      const confirm = this.state.app.confirm;
      const context = this;

      confirm.title = "Delete item";
      confirm.description = "Are you sure you want to delete this comment?";
      confirm.caption = "Delete";
      confirm.confirmClasses = "is-danger";

      confirm.action = async () => context.handleRemoveComment(comment);

      confirm.show = true;
    },
    async handleRemoveComment(comment) {
      const isDeleting = this.deletingComments.includes(comment);
      if (isDeleting) return;

      this.deletingComments.push(comment);

      await this.vm.deleteComment(comment);

      this.deletingComments = this.deletingComments.filter(
        (com) => com.id !== comment.id
      );
    },
  },

  template: document.querySelector("#item-comment-edit-template").innerHTML,
};

app.component("item-comment-edit", ItemCommentEdit);
</script>
<template id="drive-file-url-input-template">
  <div class="field has-addons">
    <div class="control">
      <button
        class="button"
        :class="[size, { 'is-primary': expanded, 'is-loading': loading }]"
        title="Add drive file by url"
        :disabled="loading"
        @click="handleDriveFileClick"
      >
        <span class="icon">
          <span class="material-symbols-outlined">add_to_drive</span>
        </span>
      </button>
    </div>
    <div v-show="expanded" class="control is-expanded">
      <input
        ref="urlinput"
        class="input"
        aria-label="Drive file url"
        placeholder="https://docs.google.com..."
        :class="size"
        :disabled="loading"
        v-model="url"
        @keydown="handleUrlKeydown"
      />
    </div>
    <div v-show="expanded" class="control">
      <button
        class="button"
        title="Attach file"
        :class="size"
        :disabled="loading"
        @click="handleAddClick"
      >
        <span class="icon">
          <span class="material-symbols-outlined">attachment</span>
        </span>
      </button>
    </div>
  </div>
</template>

<script>
const DriveFileUrlInput = {
  props: {
    size: {
      type: String,
      default: "is-small",
    },
    loading: false,
  },

  emits: ["url-select"],

  setup() {
    return {};
  },

  data() {
    return {
      url: "",
      expanded: false,
    };
  },

  methods: {
    handleDriveFileClick() {
      this.expanded = !this.expanded;
      this.$nextTick().then(() => this.$refs.urlinput.focus());
    },
    handleUrlKeydown(e) {
      if (e.key === "Enter") this.handleAddClick();
    },
    handleAddClick() {
      if (!this.url) return;
      this.$emit("url-select", this.url);
      this.url = "";
      this.expanded = false;
    },
  },

  template: document.querySelector("#drive-file-url-input-template").innerHTML,
};

app.component("drive-file-url-input", DriveFileUrlInput);
</script>
<template id="item-card-template">
  <article class="card p-0 is-shadowless light-border">
    <div class="card-content p-3">
      <div class="media mb-2">
        <div class="media-left">
          <div class="display-block mb-2">
            <item-type-icon :type="vm.item.type"></item-type-icon>
            <queue-button
              :queued="vm.isQueued"
              @push="vm.pushToQueue"
              @pop="vm.popFromQueue"
            ></queue-button>
          </div>
          <tag-edit-dropdown
            ref="status-tag"
            :value="vm.item.status"
            :options="state.list.statuses"
            :tag-class="vm.itemStatusBulmaTag"
            @option-select="handleStatusSelect"
          ></tag-edit-dropdown>
        </div>
        <div class="media-content overflow-x-inherit">
          <p>
            <a
              class="title is-6 mb-1"
              href="#"
              @click.prevent="handleProjectClick"
            >
              {{ vm.project.name }}
            </a>
          </p>
          <p>
            <a
              class="subtitle is-7"
              href="#"
              @click.prevent="handleItemClick"
            >
              [{{ vm.item.itemNumber }}] - {{ vm.item.name }}
            </a>
          </p>
        </div>
      </div>

      <article>
        <ul>
          <li v-show="showAssignee">
            Assigned: {{ vm.item.assignee }}
          </li>
          <li v-show="!!vm.item.scheduledDate">
            Scheduled: {{ formatScheduledDate(vm.item.scheduledDate) }}
          </li>
        </ul>
      </article>
    </div>
  </article>
</template>

<script>
const ItemCard = {
  props: {
    item: Object,
    showAssignee: {
      type: Boolean,
      default: true
    }
  },

  emits: ["item-click", "project-click"],

  setup(props) {
    const vm = useItemViewModel(props.item);

    return {
      state: {
        list: store.state.list,
      },
      calculated: store.calculated,
      vm,
    };
  },

  methods: {
    handleItemClick() {
      this.$emit("item-click", this.vm.item);
    },
    handleProjectClick() {
      this.$emit("project-click", { project: this.vm.project, item: this.vm.item });
    },
    formatScheduledDate(scheduled) {
      const d = new Date(scheduled);
      return d.toLocaleDateString();
    },
    handleStatusSelect(status) {
      this.vm.autoResolveItemByStatus(status);
    }
  },

  template: document.querySelector("#item-card-template").innerHTML,
};

app.component("item-card", ItemCard);
</script>
<template id="items-pie-chart-template">
  <article>
    <div class="is-flex is-justify-content-center">
      <div class="select is-small">
        <select
          aria-label="Chart breakdown"
          v-model="breakdown"
          @change="renderChart"
        >
          <option value="status">Status</option>
          <option value="priority">Priority</option>
          <option value="type">Type</option>
        </select>
      </div>
    </div>
    <figure ref="chart"></figure>
  </article>
</template>

<script>
const ItemsPieChart = {
  props: {
    items: Array,
  },

  setup() {
    const { list } = store.state;

    const breakdowns = {
      type: {
        title: "Items by type",
        column: "Type",
        prop: "type",
        options: () => list.types,
      },
      priority: {
        title: "Items by priority",
        column: "Priority",
        prop: "priority",
        options: () => list.priorities,
      },
      status: {
        title: "Items by status",
        column: "Status",
        prop: "status",
        options: () => list.statuses,
      },
    };

    return {
      breakdowns,
      state: {
        app: store.state.app,
        list: store.state.list,
      },
    };
  },

  mounted() {
    // Load the Visualization API and the corechart package.
    google.charts.load("current", { packages: ["corechart"] });
    // Set a callback to run when the Google Visualization API is loaded.
    google.charts.setOnLoadCallback(this.renderChart);

    window.addEventListener("resize", this.redrawChart);
  },

  unmounted() {
    window.removeEventListener("resize", this.redrawChart);
  },

  data() {
    return {
      breakdown: "status",
      drawChart: null,
    };
  },

  methods: {
    renderChart() {
      const table = new google.visualization.DataTable();
      const bd = this.breakdowns[this.breakdown] || this.breakdowns.type;

      table.addColumn("string", bd.column);
      table.addColumn("number", "Total");

      const rows = bd
        .options()
        .map((opt) => [
          opt,
          this.items.filter((item) => item[bd.prop] === opt).length,
        ]);

      table.addRows(rows);

      const user = this.state.app.user;
      const fontColor = (user && user.settings.theme === "Dark") ? "#ffffff" : "#333333";

      const options = {
        title: bd.title,
        backgroundColor: "transparent",
        animation: {
          startup: true,
          duration: 1000,
          easing: 'out'
        },
        titleTextStyle: {
          color: fontColor,
        },
        hAxis: {
          textStyle: {
            color: fontColor,
          },
          titleTextStyle: {
            color: fontColor,
          },
        },
        vAxis: {
          textStyle: {
            color: fontColor,
          },
          titleTextStyle: {
            color: fontColor,
          },
        },
        legend: {
          textStyle: {
            color: fontColor,
          },
        },
      };

      const chartContainer = this.$refs.chart;
      chartContainer.innerHTML = "";

      const chart = new google.visualization.PieChart(chartContainer);
      chart.draw(table, options);
      this.drawChart = () => chart.draw(table, options);
    },
    redrawChart() {
      if (this.drawChart) this.drawChart();
    },
  },

  watch: {
    items() {
      this.renderChart();
    },
  },

  template: document.querySelector("#items-pie-chart-template").innerHTML,
};

app.component("items-pie-chart", ItemsPieChart);
</script>
<template id="item-type-icon-template">
  <span class="icon">
    <span aria-hidden="true" class="material-symbols-outlined" :class="[icon.color, iconClass]">{{
      icon.name
    }}</span>
  </span>
</template>

<script>
const ItemTypeIcon = {
  props: {
    type: String,
    iconClass: String
  },

  computed: {
    icon() {
      switch (this.type) {
        case "Bug":
          return { name: "bug_report", color: "has-text-danger" };
        case "Issue":
          return { name: "warning", color: "has-text-warning" };
        case "Enhancement":
          return { name: "code", color: "has-text-link" };
        case "Feature":
          return { name: "account_tree", color: "has-text-primary" };
        case "Epic":
          return { name: "deployed_code", color: "purple-text" };
        case "Story":
          return { name: "history_edu", color: "has-text-info" };
        case "Task":
          return { name: "build_circle", color: "has-text-dark" };
        case "Accessibility":
          return { name: "accessibility", color: "has-text-link" };
        case "Planning":
          return { name: "edit_note", color: "has-text-info" };
        case "Support":
          return { name: "help_center", color: "has-text-success" };
        default:
          return { name: "eco", color: "has-text-light" };
      }
    },
  },

  template: document.querySelector("#item-type-icon-template").innerHTML,
};

app.component("item-type-icon", ItemTypeIcon);
</script>
<template id="parent-higher-breadcrumbs-template">
  <nav class="breadcrumb" aria-label="breadcrumbs">
    <ul>
      <li v-for="higher in reversedParentHigherItems" :key="higher.id">
        <a href="#" @click.prevent="handleHigherClick(higher)"> [{{ higher.itemNumber }}] - {{ higher.name }} </a>
      </li>
    </ul>
  </nav>
</template>

<script>
const ParentHigherBreadcrumbs = {
  props: {
    vm: Object,
  },

  emits: ["higher-click"],

  computed: {
    reversedParentHigherItems() {
      return this.vm.parentHighers.reverse();
    }
  },

  methods: {
    handleHigherClick(higher) {
      this.$emit('higher-click', higher);
    }
  },

  template: document.querySelector("#parent-higher-breadcrumbs-template")
    .innerHTML,
};

app.component("parent-higher-breadcrumbs", ParentHigherBreadcrumbs);
</script>
<template id="queue-button-template">
  <button
    :style="style"
    class="button is-small p-0"
    :class="classes"
    :title="title"
    @click="handleClick"
  >
    <span class="icon">
      <span
        aria-hidden="true"
        class="material-symbols-outlined"
      >{{ icon }}</span>
    </span>
  </button>
</template>

<script>
const QueueButton = {
  props: {
    show: Boolean,
    queued: Boolean,
    size: {
      type: String,
      default: '24px'
    },

  },

  emits: ['push', 'pop'],

  setup(props, ctx) {
    /** @type {VueOverrides} */
    const {
      computed,
    } = Vue;

    const icon = computed(() => props.queued ? 'remove_circle' : 'queue');
    const title = computed(() => props.queued ? 'Remove from item queue' : 'Add to item queue');
    const style = computed(() => ({ height: props.size, width: props.size }));
    const classes = computed(() => ({ 'is-info': props.queued, 'is-white': !props.queued }));

    const handleClick = () => ctx.emit(props.queued ? 'pop' : 'push');

    return {
      icon,
      title,
      style,
      classes,
      handleClick
    };
  },

  data() {
    return {}
  },

  template: document.querySelector('#queue-button-template').innerHTML
};

app.component('queue-button', QueueButton);
</script>
<template id="item-edit-details-template">
  <div>
    <item-action-bar
      :vm="vm"
      @related-items-select="$emit('related-items-select', $event)"
    ></item-action-bar>

    <parent-higher-breadcrumbs
      class="is-small mb-0"
      :vm="vm"
      @higher-click="handleParentHigherClick"
    ></parent-higher-breadcrumbs>

    <div class="p-3">
      <apps-input
        v-focus
        label="Name"
        size="is-small"
        :schema="vm.validation.schema.name"
        v-model="vm.item.name"
        @input="vm.autosave"
      ></apps-input>

      <apps-input
        label="Description"
        size="is-small"
        :schema="vm.validation.schema.description"
        v-model="vm.item.description"
        @input="vm.autosave"
      ></apps-input>
    </div>

    <div class="columns mb-0">
      <apps-select
        class="column pt-0 pb-0"
        label="Assigned to"
        size="is-small"
        icon-left="person"
        fullwidth
        :options="users"
        :schema="vm.validation.schema.assignee"
        v-model="vm.item.assignee"
        @change="vm.autosave"
      ></apps-select>

      <apps-select
        class="column pt-0 pb-0"
        label="Type"
        size="is-small"
        fullwidth
        :options="state.list.types"
        :schema="vm.validation.schema.type"
        v-model="vm.item.type"
        @change="vm.autosave"
      ></apps-select>

      <apps-select
        class="column pt-0 pb-0"
        label="Priority"
        size="is-small"
        fullwidth
        :options="state.list.priorities"
        :schema="vm.validation.schema.priority"
        v-model="vm.item.priority"
        @change="vm.autosave"
      ></apps-select>

      <apps-select
        class="column pt-0 pb-0"
        label="Status"
        size="is-small"
        fullwidth
        :options="state.list.statuses"
        :schema="vm.validation.schema.status"
        v-model="vm.item.status"
        @change="vm.autosave"
      ></apps-select>
    </div>

    <div class="columns mb-0">
      <div
        v-show="!!vm.item.scheduledDate"
        class="column is-narrow pt-0 pr-0 pb-0"
        style="align-self: center"
      >
        <button
          class="button is-small is-white"
          :class="{ 'is-loading': calendarEvent.loading }"
          :disabled="calendarEvent.loading"
          title="Add to calendar"
          @click="handleAddCalendarEvent"
        >
          <span class="icon">
            <span aria-hidden="true" class="material-symbols-outlined">event</span>
          </span>
        </button>
      </div>

      <apps-input
        label="Scheduled"
        size="is-small"
        class="column pt-0 pb-0"
        :schema="vm.validation.schema.scheduledDate"
        v-model="vm.item.scheduledDate"
        @input="vm.autosave"
      ></apps-input>

      <apps-input
        label="Resolved"
        size="is-small"
        class="column pt-0 pb-0"
        :schema="vm.validation.schema.resolvedDate"
        v-model="vm.item.resolvedDate"
        @input="vm.autosave"
      ></apps-input>

      <apps-input
        label="Closed"
        size="is-small"
        class="column pt-0 pb-0"
        :schema="vm.validation.schema.closedDate"
        v-model="vm.item.closedDate"
        @input="vm.autosave"
      ></apps-input>

      <apps-input
        label="Integration version"
        size="is-small"
        class="column is-narrow pt-0 pb-0"
        :schema="vm.validation.schema.version"
        v-model="vm.item.version"
        @input="vm.autosave"
      ></apps-input>
    </div>

    <div v-show="!vm.isNew" class="columns">
      <div class="column is-7 pt-0 pb-0">
        <div class="columns p-0">
          <apps-input
            label="Hours"
            size="is-small"
            class="column is-narrow pt-0 pb-0 pl-0"
            step="0.05"
            :schema="vm.validation.schema.hours"
            v-model="vm.item.hours"
            @input="vm.autosave"
          ></apps-input>

          <apps-tags
            label="Tags"
            size="is-small"
            class="column pt-0 pb-0 pr-0"
            placeholder="New item tag..."
            icon-left="add"
            :debounce="75"
            :suggestions="tagSuggestions"
            :schema="vm.validation.schema.tags"
            v-model="vm.item.tags"
            @change="vm.autosave"
          ></apps-tags>
        </div>

        <item-comment-edit :vm="vm"></item-comment-edit>
      </div>

      <div class="column">
        <apps-file-input
          label="Files"
          size="is-small"
          :maxsize="1024 * 1024 * 100"
          :schema="vm.validation.schema.files"
          v-model="vm.item.files"
          :asyncselect="vm.uploadFile"
          @change="vm.autosave"
        ></apps-file-input>

        <drive-file-url-input
          size="is-small"
          :loading="drivelUrlLoading"
          @url-select="handleDriveUrlSelect"
        ></drive-file-url-input>

        <item-related-edit
          :vm="vm"
          @open-item="$emit('open-item', $event)"
          @new-item="$emit('new-item', $event)"
        ></item-related-edit>
      </div>
    </div>

    <notification-toast
      v-model:show="calendarEvent.show"
      :color="calendarEvent.color"
    >
      <span>
        {{ calendarEvent.message }}
        <a
          v-if="calendarEvent.url"
          :href="calendarEvent.url"
          target="_blank"
          rel="noopener noreferrer"
          >Open event</a
        >
      </span>
    </notification-toast>
  </div>
</template>

<script>
const ItemEditDetails = {
  props: {
    item: Object,
  },

  emits: ["open-item", "new-item", "related-items-select"],

  setup(props) {
    const { computed } = Vue;
    const vm = useItemViewModel(props.item);

    const { itemTags } = useListFilters();
    const tagSuggestions = computed(() => itemTags.value.map(t => t.value));

    return {
      vm,
      tagSuggestions,
      state: {
        data: store.state.data,
        list: store.state.list,
      },
    };
  },

  data() {
    return {
      drivelUrlLoading: false,
      calendarEvent: {
        show: false,
        url: "",
        color: "is-info",
        message: "",
      },
    };
  },

  computed: {
    users() {
      return this.state.list.users;
    },
  },

  methods: {
    async handleAddCalendarEvent() {
      this.calendarEvent.loading = true;
      const response = await this.vm.addToCalendar();

      if (response) {
        const { htmlLink } = response.body;
        this.calendarEvent.url = htmlLink;
        this.calendarEvent.message = "New calendar event created!";
        this.calendarEvent.color = "is-success";
      } else {
        this.calendarEvent.url = "";
        this.calendarEvent.message = "Failed to create calendar event!";
        this.calendarEvent.color = "is-danger";
      }

      this.calendarEvent.loading = false;
      this.calendarEvent.show = true;
    },
    handleParentHigherClick(higher) {
      this.$emit("open-item", higher.id);
    },
    async handleDriveUrlSelect(url) {
      if (url) {
        this.drivelUrlLoading = true;
        await this.vm.attachDriveFileDetails(url);
        this.drivelUrlLoading = false;
      }
    },
  },

  template: document.querySelector("#item-edit-details-template").innerHTML,
};

app.component("item-edit-details", ItemEditDetails);
</script>
<template id="item-edit-view-template">
  <main v-if="!!vm">
    <side-menu-container>
      <section class="p-2">
        <h1 class="title is-6">Work item</h1>
        <h2 class="subtitle is-6 mb-2">
          Project: {{ vm.project.name }} - (v{{ vm.project.version }})
        </h2>
        <hr />
      </section>
      <button
        class="button is-small is-fullwidth is-radiusless"
        @click="handleOpenProject"
      >
        <span class="icon">
          <span class="material-symbols-outlined" aria-hidden="true">folder_open</span>
        </span>
        <span> Open project </span>
      </button>
    </side-menu-container>

    <side-menu-content>
      <item-edit-details
        class="p-2"
        :item="vm.item"
        @new-item="handleNewItem"
      ></item-edit-details>
    </side-menu-content>
  </main>
</template>

<script>
const ItemEditView = {
  props: {
    id: String,
  },

  setup(props) {
    const { state } = store;

    const { itemById } = store.calculated;

    const item = !state.app.currentQueryParams.isNew
      ? itemById.value[props.id]
      : state.item.newItem;

    // clear new item once referenced
    state.item.newItem = null;

    //create the viewmodel with a copy of the item object to keep it separate from other interactions with the main item data 
    const vm = item ? useItemViewModel(JSON.parse(JSON.stringify(item))) : null;

    return {
      vm,
      state: {
        app: store.state.app,
        item: store.state.item,
      },
    };
  },

  created() {
    if (!this.vm) this.$router.replace("/not-found");
  },

  data() {
    return {};
  },

  methods: {
    handleOpenProject() {
      this.$router.push({
        path: `/project/${this.vm.project.id}`,
        query: { tab: this.vm.item.id },
      });
    },
    handleNewItem(newItem) {
      this.state.item.newItem = newItem;
      this.$router.push({
        path: `/item/${newItem.id}`,
        query: { isNew: true },
      });
    },
  },

  template: document.querySelector("#item-edit-view-template").innerHTML,
};

app.component("item-edit-view", ItemEditView);
</script>
<template id="items-list-view-template">
  <main>
    <div class="sticky-header has-background-white">
      <nav class="tabs is-small is-fullwidth force-32-height">
        <ul>
          <li
            v-focus
            :class="{ 'is-active': selectedTab === 'all' }"
          >
            <a
              href="#"
              @click.prevent="selectTab('all')"
            >All</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'mine' }">
            <a
              href="#"
              @click.prevent="selectTab('mine')"
            >Mine</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'priority' }">
            <a
              href="#"
              @click.prevent="selectTab('priority')"
            >High priority</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'pending' }">
            <a
              href="#"
              @click.prevent="selectTab('pending')"
            >Pending</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'testing' }">
            <a
              href="#"
              @click.prevent="selectTab('testing')"
            >Testing</a>
          </li>
        </ul>
      </nav>
    </div>
    <scrollable-hero-table
      v-focus
      header-class="is-white sticky-header has-small-tabs"
      :offset="24"
      :headers="headers"
      :rows="rows"
      :filter-fields="filterFields"
      :filter-dates="filterDates"
      :criteria="criteria"
      :use-worker="true"
      :search-more-options="searchMoreOptions"
      @more-options-action="handleMoreOptionsAction"
      @row-select="handleRowSelect"
    >
      <template #type="row">
        <span class="icon-text is-flex-wrap-nowrap">
          <item-type-icon
            class="is-small"
            icon-class="is-size-6"
            :type="row.item.type"
          ></item-type-icon>
          <span>
            {{ row.item.type }}
          </span>
        </span>
      </template>
      <template #status="row">
        <span
          class="tag"
          :class="row.itemStatusBulmaTag"
        >
          {{ row.item.status }}
        </span>
      </template>
    </scrollable-hero-table>
  </main>
</template>

<script>
const ItemsListView = {
  props: {},

  setup() {
    const { users, itemTypes, itemStatuses, itemTags, priorities } =
      useListFilters();

    return {
      users,
      itemTypes,
      itemStatuses,
      itemTags,
      priorities,
      state: {
        app: store.state.app,
        data: store.state.data,
      },
      calculated: {
        activeProjectItems: store.calculated.activeProjectItems,
      },
      dispatch: {
        util: store.dispatch.util,
      },
    };
  },

  mounted() {
    this.updateTabFilteredRows(this.selectedTab);
  },

  data() {
    return {
      tabRows: [],
      headers: [
        {
          prop: "itemNumber",
          caption: "#",
        },
        {
          prop: "_projectName",
          caption: "Project",
          style: { 'min-width': '14vw' },
        },
        {
          prop: "_assignee",
          caption: "Assigned to",
        },
        {
          prop: "name",
          caption: "Name",
          style: { 'min-width': '20vw' },
        },
        {
          prop: "description",
          searchOnly: true,
        },
        {
          prop: "type",
          caption: "Type",
        },
        {
          prop: "priority",
          caption: "Priority",
        },
        {
          prop: "status",
          caption: "Status",
        },
        {
          prop: "version",
          caption: "Version",
        },
        {
          prop: "_tagsDisplay",
          caption: "Tags",
        },
        {
          prop: "hours",
          caption: "Hours",
        },
        {
          prop: "resolvedDate",
          caption: "Resolved",
        },
        {
          prop: "closedDate",
          caption: "Closed",
        },
        {
          prop: "_modifiedDate",
          caption: "Modified",
        },
        {
          prop: "_modifiedBy",
          caption: "Modified by",
        },
        {
          prop: "_createdDate",
          caption: "Created",
        },
        {
          prop: "_createdBy",
          caption: "Created by",
        },
        {
          prop: "_search",
          searchOnly: true,
        },
      ],
      filterDates: [
        {
          prop: "_createdDate",
          caption: "Created",
        },
      ],
      criteria: {
        search: "",
        filter: {},
        dates: {},
        sort: {
          header: "itemNumber",
          ascending: false,
        },
      },
      searchMoreOptions: [
        {
          caption: "Export to csv",
          action: "EXPORT_TO_CSV",
        },
      ],
    };
  },

  computed: {
    selectedTab() {
      return this.state.app.currentQueryParams.tab || "all";
    },
    rows() {
      console.time("items list");
      const removeEmailAt = (email) => String(email).split("@")[0];
      const formatJsonDate = (dt) => String(dt).split("T")[0];

      const items = this.tabRows.map((item) => {
        const vm = useItemViewModel(item);

        return {
          item,
          ...item,
          _rowKey: item.id,
          _tagsDisplay: item.tags.join(" | "),
          _assignee: removeEmailAt(item.assignee),
          _projectName: vm.project ? vm.project.name : "(No project)",
          _createdDate: formatJsonDate(item.createdDate),
          _createdBy: removeEmailAt(item.createdBy),
          _modifiedDate: formatJsonDate(item.modifiedDate),
          _modifiedBy: removeEmailAt(item.modifiedBy),
          _search: vm.comments.map((c) => c.comment).join(" "),
          itemStatusBulmaTag: vm.itemStatusBulmaTag,
          _tags: item.tags,
          item__tags: true
        };
      });

      console.timeEnd("items list");
      return items;
    },
    filterFields() {
      const projectNames = new Set(
        this.state.data.projects.map((project) => project.name)
      );
      const projectOptions = [...projectNames]
        .sort((a, b) => (a.toLowerCase() < b.toLowerCase() ? -1 : 1))
        .map((n) => ({ value: n, text: n }));

      const tab = this.selectedTab;

      let fields = [
        {
          prop: "_projectName",
          options: [
            {
              value: "",
              text: "- Projects -",
            },
            ...projectOptions,
          ],
        },
      ];

      if (tab !== "mine")
        fields.push({
          prop: "assignee",
          options: [
            {
              value: "",
              text: "- Assignees -",
            },
            ...this.users,
          ],
        });

      fields.push({
        prop: "type",
        options: [
          {
            value: "",
            text: "- Types -",
          },
          ...this.itemTypes,
        ],
      });

      if (tab !== "riority")
        fields.push({
          prop: "priority",
          options: [
            {
              value: "",
              text: "- Priorities -",
            },
            ...this.priorities,
          ],
        });

      return [
        ...fields,
        {
          prop: "status",
          options: [
            {
              value: "",
              text: "- Statuses -",
            },
            ...this.itemStatuses,
          ],
        },
        {
          prop: "item__tags",
          options: [
            {
              value: "",
              text: "- Tags -",
            },
            ...this.itemTags,
          ],
        },
      ];
    },
  },

  methods: {
    selectTab(tabName) {
      this.$router.replace({
        path: this.state.app.currentRoute,
        query: { tab: String(tabName) },
      });
    },
    updateTabFilteredRows(tab) {
      const userEmail = this.state.app.user && this.state.app.user.email;
      const tabFilter = (item) => {
        if (tab === "all") return true;

        if (tab === "mine") return item.assignee === userEmail;

        if (tab === "priority")
          return item.priority === "High" || item.priority === "Critical";

        if (tab === "pending")
          return item.status === "New" || item.status === "Open";

        if (tab === "testing") return item.status === "Testing";

        return true;
      };

      const activeProjectItems =
        this.calculated.activeProjectItems.value.filter(tabFilter);

      this.tabRows = activeProjectItems;
    },
    handleRowSelect({ row }) {
      this.$router.push(`/item/${row.item.id}`);
    },
    handleMoreOptionsAction({ action, displayedRows, allRows }) {
      switch (action) {
        case "EXPORT_TO_CSV":
          this.handleExportToCsv(displayedRows);
          break;
      }
    },
    handleExportToCsv(displayedRows) {
      const dataToDownload = displayedRows.map((row) => {
        const obj = {};
        this.headers
          .filter((header) => !header.searchOnly)
          .forEach((header) => (obj[header.caption] = row[header.prop]));
        return obj;
      });

      this.dispatch.util.downloadDataAsCsv(
        `IS-Projects-download_project_data_${new Date().toJSON()}.csv`,
        dataToDownload
      );
    },
  },

  watch: {
    selectedTab(newTab) {
      console.log('SELECTED_TAB.watch'); //DEBUG
      if (!this.state.app.currentRoute.startsWith('/items'))
        return;

      this.updateTabFilteredRows(newTab);

      const criteria = this.criteria;
      const filterFields = this.filterFields;
      requestAnimationFrame(() => {
        criteria.search = "";
        criteria.sort = {
          header: "itemNumber",
          ascending: false,
        };
        filterFields.forEach(({ prop }) => (criteria.filter[prop] = ""));
      });
    },
  },

  template: document.querySelector("#items-list-view-template").innerHTML,
};

app.component("items-list-view", ItemsListView);
</script>
<template id="item-related-edit-template">
  <section>
    <h2 class="title is-6 mb-1">Related items</h2>
    <button
      class="button is-link is-small is-fullwidth mb-1"
      @click="handleLinkItemClick"
    >
      <span class="icon is-small">
        <span aria-hidden="true" class="material-symbols-outlined">link</span>
      </span>
      <span> Link existing item </span>
    </button>

    <article v-if="!!vm.parentItem" class="mb-1">
      <p class="subtitle is-6 mb-1">Parent</p>
      <div class="is-flex is-align-items-center">
        <a href="#" class="is-size-7" @click.prevent="handleParentClick"
          >[{{ vm.parentItem.itemNumber }}] {{ vm.parentItem.name }}</a
        >
        <button
          class="button is-small is-white"
          title="Remove parent item"
          @click="handleClearParent"
        >
          <span class="icon is-small">
            <span aria-hidden="true" class="material-symbols-outlined">close</span>
          </span>
        </button>
      </div>
    </article>

    <div class="columns is-vcentered p-0 mb-0">
      <div class="column p-0">
        <p class="subtitle is-6 mb-1">Child items</p>
      </div>
      <div class="column p-0 is-narrow">
        <button
          class="button is-white is-small"
          title="Create new child item"
          @click="handleNewChildItem"
        >
          <span class="icon is-small">
            <span aria-hidden="true" class="material-symbols-outlined">add</span>
          </span>
        </button>
      </div>
    </div>
    <div
      v-for="item in vm.relatedItems"
      :key="item.id"
      class="is-flex is-size-7 pb-1"
    >
      <a href="#" @click.prevent="handleGoToRelatedItem(item)"
        >[{{ item.itemNumber }}] {{ item.name }}</a
      >
      -
      <item-type-icon icon-class="is-size-6" :type="item.type"></item-type-icon
      >{{ item.type }} - {{ item.status }} - ({{ item.version }})
    </div>

    <linked-item-picker
      v-if="showItemPicker"
      v-focus
      height="90%"
      v-model:show="showItemPicker"
      :items="linkedItemOptions"
      @item-select="handleLinkItemSelect"
    ></linked-item-picker>
  </section>
</template>

<script>
const ItemRelatedEdit = {
  props: {
    vm: Object,
  },

  emits: ["open-item", "new-item"],

  setup() {
    return {
      state: {
        app: store.state.app,
      },
      dispatch: {
        item: store.dispatch.item,
      },
    };
  },

  data() {
    return {
      showItemPicker: false,
    };
  },

  computed: {
    linkedItemOptions() {
      return this.vm.projectItems.filter((itm) => itm.id !== this.vm.item.id);
    },
  },

  methods: {
    handleNewChildItem() {
      const newChildItem = this.dispatch.item.createNewItem({
        project: this.vm.item.project,
        parent: this.vm.item.id,
        version: this.vm.project.version,
      });
      this.$emit("new-item", newChildItem);
    },
    handleLinkItemSelect({ type, item }) {
      if (type === "parent") {
        this.vm.item.parent = item.id;
        this.vm.autosave();
        return;
      }

      if (type === "child") {
        this.vm.linkChildItem(item);
        return;
      }
    },
    handleParentClick() {
      this.goToItemBasedOnViewContext(this.vm.parentItem.id);
    },
    handleClearParent() {
      this.vm.item.parent = null;
      this.vm.autosave();
    },
    handleGoToRelatedItem(item) {
      this.goToItemBasedOnViewContext(item.id);
    },
    handleLinkItemClick() {
      this.showItemPicker = true;
    },
    goToItemBasedOnViewContext(id) {
      const { currentRoute } = this.state.app;

      if (String(currentRoute).startsWith("/project/"))
        this.$emit("open-item", id);
      else this.$router.push(`/item/${id}`);
    },
  },

  template: document.querySelector("#item-related-edit-template").innerHTML,
};

app.component("item-related-edit", ItemRelatedEdit);
</script>
<template id="linked-item-picker-template">
  <aside class="modal" role="dialog" :class="{ 'is-active': show }">
    <div class="modal-background" @click="handleClose"></div>
    <div class="modal-card" :style="sizeStyle">
      <header class="modal-card-head">
        <label class="label is-small">
          Link type
          <div class="select is-small">
            <select v-model="linkType" @change="handleFilterChange">
              <option value="parent">Parent</option>
              <option value="child">Child</option>
            </select>
          </div>
        </label>
        <input
          aria-label="Search items"
          type="search"
          class="input is-small ml-1 mr-3"
          placeholder="Search items..."
          v-model="search"
          @input="handleFilterChange"
        />
        <button class="delete" aria-label="close" @click="handleClose"></button>
      </header>
      <section class="modal-card-body">
        <div class="panel-is-shadowless is-radiusless">
          <a
            v-for="item in filteredItems"
            :key="item.id"
            href="#"
            class="panel-block is-size-7"
            :class="{
              'has-background-link theme-independent-white-font is-radiusless': item === selectedItem,
            }"
            @click.prevent="handleSelectItem(item)"
          >
            <span style="width: 65%">
              [{{ item.itemNumber }}] {{ item.name }} -
            </span>
            <item-type-icon
              icon-class="is-size-6"
              :type="item.type"
            ></item-type-icon>
            {{ item.type }} - ({{ item.version }}) -
            {{ formatJsonDate(item.createdDate) }}</a
          >
        </div>
      </section>
      <footer class="modal-card-foot is-justify-content-end">
        <button
          class="button is-dark is-small"
          :disabled="!linkType || !selectedItem"
          @click="handlCreateLink"
        >
          Create link
        </button>
        <button class="button is-small" @click="handleClose">Cancel</button>
      </footer>
    </div>
  </aside>
</template>

<script>
const LinkedItemPicker = {
  props: {
    items: Array,
    show: Boolean,
    minwidth: {
      type: String,
      default: "auto",
    },
    height: {
      type: String,
      default: "auto",
    },
  },

  emits: ["update:show", "close", "item-select"],

  data() {
    return {
      search: "",
      linkType: "",
      selectedItem: null,
    };
  },

  computed: {
    filteredItems() {
      const lowerSearch = this.search.toLowerCase();
      const type = this.linkType;
      if (!type) return [];

      return this.items
        .filter((item) => (type === "child" ? !item.parent : true))
        .filter(
          (item) =>
            `[${String(item.itemNumber)}] ${String(
              item.name
            ).toLowerCase()}`.includes(lowerSearch) ||
            String(item.description).toLowerCase().includes(lowerSearch) ||
            String(item.type).toLowerCase().includes(lowerSearch) ||
            String(item.createdDate).toLowerCase().includes(lowerSearch)
        );
    },
    sizeStyle() {
      return {
        "min-width": this.minwidth,
        height: this.height,
      };
    },
  },

  methods: {
    handlCreateLink() {
      if (!this.linkType || !this.linkType) return;
      this.$emit("item-select", {
        type: this.linkType,
        item: this.selectedItem,
      });
      this.handleClose();
    },
    handleFilterChange() {
      this.selectedItem = null;
    },
    handleSelectItem(item) {
      this.selectedItem = item;
      this.search = `[${this.selectedItem.itemNumber}] ${this.selectedItem.name}`;
    },
    handleClose() {
      this.$emit("update:show", false);
      this.$emit("close");
    },
    formatJsonDate(dt) {
      const [dateString] = String(dt).split("T");
      return dateString;
    },
  },

  template: document.querySelector("#linked-item-picker-template").innerHTML,
};

app.component("linked-item-picker", LinkedItemPicker);
</script>
<template id="project-action-bar-template">
  <section class="mb-3">
    <article class="p-0">
      <span class="icon-text">
        <span v-show="!vm.isNew" class="is-size-7">
          Created: {{ createdDisplay }} | <last-saved-on :rec="vm.project"></last-saved-on>
        </span>
      </span>
    </article>

    <article class="is-pulled-right">
      <div v-show="!vm.isNew" class="buttons">
        <toggle-project-favorite
          size="is-small"
          :vm="vm"
        ></toggle-project-favorite>
        <!-- <button
          class="button is-outlined is-small"
          title="Create PRD"
          ref="prdButton"
          @click="handlePrd"
        >
          <span class="icon is-small">
            <span class="material-symbols-outlined" aria-hidden="true">description</span>
          </span>
        </button> -->
        <button
          class="button is-outlined is-small"
          title="Duplicate project"
          ref="duplicateButton"
          @click="handleDuplicate"
        >
          <span class="icon is-small">
            <span class="material-symbols-outlined" aria-hidden="true">content_copy</span>
          </span>
        </button>
        <button
          class="button is-danger is-outlined is-small"
          title="Delete project"
          ref="deleteButton"
          @click="handleDelete"
        >
          <span class="icon is-small">
            <span class="material-symbols-outlined" aria-hidden="true">delete</span>
          </span>
        </button>
      </div>
    </article>
  </section>
</template>

<script>
const ProjectActionBar = {
  props: {
    vm: Object,
  },

  emits: ["project-delete", "project-duplicate", "project-prd-file"],

  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  computed: {
    createdDisplay() {
      const date = this.vm.project.createdDate;
      if (!date) return "unknown";

      return new Date(date).toLocaleDateString();
    }
  },

  methods: {
    handleDelete() {
      const confirm = this.state.app.confirm;
      const context = this;

      confirm.title = "Delete project";
      confirm.description = "Are you sure you want to delete this project?";
      confirm.caption = "Delete";
      confirm.confirmClasses = "is-danger";

      confirm.action = () => {
        // await context.vm.deleteProject();
        context.$emit("project-delete");
      };
      confirm.cancel = () => context.$refs.deleteButton.focus();

      confirm.show = true;
    },
    handleDuplicate() {
      const confirm = this.state.app.confirm;
      const context = this;

      confirm.title = "Duplicate project";
      confirm.description = "Are you sure you want to create a duplicate of this project?";
      confirm.caption = "Duplicate";
      confirm.confirmClasses = "is-primary";

      confirm.action = () => {
        // await context.vm.deleteProject();
        context.$emit("project-duplicate");
      };
      confirm.cancel = () => context.$refs.duplicateButton.focus();

      confirm.show = true;
    },
    handlePrd() {
      const confirm = this.state.app.confirm;
      const context = this;

      confirm.title = "Create PRD";
      confirm.description = "Are you sure you want to create a project requirements document (PRD) for this project?";
      confirm.caption = "Create";
      confirm.confirmClasses = "is-primary";

      confirm.action = () => {
        // await context.vm.createProjectPrdLink();
        context.$emit("project-prd-file");
      };
      confirm.cancel = () => context.$refs.prdButton.focus();

      confirm.show = true;
    }
  },

  template: document.querySelector("#project-action-bar-template").innerHTML,
};

app.component("project-action-bar", ProjectActionBar);
</script>
<template id="project-card-template">
  <article class="card p-0 is-shadowless">
    <div class="card-content p-3">
      <div class="media mb-2">
        <div class="media-left">
          <p>
            <tag-edit-dropdown
              ref="priority-tag"
              :value="vm.project.priority"
              :options="state.list.priorities"
              :tag-class="vm.priorityTag"
              @option-select="
                handlePropSelect({ prop: 'priority', val: $event })
              "
            ></tag-edit-dropdown>
          </p>
          <p>
            <tag-edit-dropdown
              ref="status-tag"
              :value="vm.project.status"
              :options="projectStatusOptions"
              tag-class="is-light"
              @option-select="handlePropSelect({ prop: 'status', val: $event })"
            ></tag-edit-dropdown>
          </p>
          <p>
            <span class="tag">{{ vm.project.program }}</span>
          </p>
        </div>
        <div class="media-content overflow-x-inherit">
          <div class="columns p-0">
            <div class="column p-0">
              <p>
                <a
                  class="title is-6 mb-1"
                  href="#"
                  @click.prevent="handleProjectClick"
                >
                  <span class="icon is-small mr-1">
                    <span aria-hidden="true" class="material-symbols-outlined is-size-6"
                      >edit</span
                    >
                  </span>
                  <span>
                    {{ vm.project.name }}
                  </span>
                </a>
              </p>
              <p class="subtitle is-7 mb-1">
                {{ vm.project.platforms.join(", ") }}
              </p>
              <p class="subtitle is-7 mb-1">
                {{ vm.project.categories.join(", ") }}
              </p>
            </div>

            <div v-show="showDescription" class="column p-0 pl-2">
              {{ vm.project.description }}
            </div>
          </div>
        </div>
        <div class="media-right">
          <toggle-project-favorite
            v-if="showFavorite"
            class="is-pulled-right"
            size="is-small"
            :vm="vm"
          ></toggle-project-favorite>
          <p class="has-text-right is-size-7">v{{ vm.project.version }}</p>
        </div>
      </div>

      <section>
        <ul>
          <li v-show="showOwner">Owner: {{ vm.project.owner }}</li>
          <li v-show="!!vm.project.iteration">
            Iteration date: {{ formatDate(vm.project.iteration) }}
          </li>
          <li v-show="showItemStats">
            Total items: {{ vm.stats.totalItems }} | Pending items:
            {{ vm.stats.pendingItems }}
          </li>
        </ul>
      </section>
      <section class="is-flex is-justify-content-end is-size-7">
        Created: {{ formatDate(vm.project.createdDate) }}
      </section>
    </div>
  </article>
</template>

<script>
const ProjectCard = {
  props: {
    vm: Object,
    project: Object,
    // optional row prop if used as a component table row
    row: Object,
    showOwner: {
      type: Boolean,
      default: true,
    },
    showFavorite: {
      type: Boolean,
      default: true,
    },
    showDescription: {
      type: Boolean,
      default: false,
    },
    showItemStats: {
      type: Boolean,
      default: true,
    },
  },

  emits: ["project-click", "prop-update"],

  setup(props) {
    const proj = props.row ? props.row.project : props.project;
    const existingVm = props.vm || (props.row ? props.row.vm : null);
    const vm = existingVm || useProjectViewModel(proj);

    return {
      state: {
        list: store.state.list,
      },
      vm,
    };
  },

  computed: {
    projectStatusOptions() {
      return this.state.list.projectStatuses.filter(
        (status) => status !== "Inactive"
      );
    },
  },

  methods: {
    handleProjectClick() {
      this.$emit("project-click", this.vm.project);
    },
    formatDate(dt) {
      const d = new Date(dt);
      return d.toLocaleDateString();
    },
    async handlePropSelect({ prop, val }) {
      if (this.vm.project[prop] === val) return;

      const rollbackVal = this.vm.project[prop];
      this.vm.project[prop] = val;

      this.$emit("prop-update", { prop, project: this.vm.project });
      const response = await this.vm.quicksave();
      if (!response) {
        this.vm.project[prop] = rollbackVal;
        this.$emit("prop-update", { prop, project: this.vm.project });
      }
    },
  },

  template: document.querySelector("#project-card-template").innerHTML,
};

app.component("project-card", ProjectCard);
</script>
<template id="toggle-project-favorite-template">
  <button
    class="button is-white"
    :class="size"
    :title="vm.isFavorite ? 'Unfavorite project' : 'Favorite project'"
    @click="vm.toggleProjectFavorite"
  >
    <span class="icon" :class="size">
      <span
        v-if="vm.isFavorite"
        class="material-symbols-outlined has-text-link"
        aria-hidden="true"
        >star</span
      >
      <span v-if="!vm.isFavorite" class="material-symbols-outlined" aria-hidden="true"
        >star_border</span
      >
    </span>
  </button>
</template>

<script>
const ToggleProjectFavorite = {
  props: {
    vm: Object,
    size: String,
  },

  template: document.querySelector("#toggle-project-favorite-template").innerHTML,
};

app.component("toggle-project-favorite", ToggleProjectFavorite);
</script>
<template id="dependent-for-projects-template">
  <section class="p-1 light-border">
    <h2 class="subtitle is-6 mb-1">Dependent for</h2>
    <span v-show="vm.dependentForProjects.length === 0" class="is-size-7">(No projects)</span>
    <div class="tags mb-0 are-small">
      <span
        v-for="project in vm.dependentForProjects"
        :key="project.id"
        class="tag"
      >
        <a
          href="#"
          class="has-text-weight-semibold"
          @click.prevent="handleGoToProject(project.id)"
        >
          {{ project.name }}
        </a>
      </span>
    </div>
  </section>
</template>

<script>
const DependentForProjects = {
  props: {
    vm: Object,
  },

  methods: {
    handleGoToProject(id) {
      this.$router.push(`/project/${id}`);
    },
  },

  template: document.querySelector("#dependent-for-projects-template")
    .innerHTML,
};

app.component("dependent-for-projects", DependentForProjects);
</script>
<template id="depends-on-projects-template">
  <section class="p-1 light-border">
    <h2 class="subtitle is-6 mb-1">Depends on</h2>
    <div class="tags are-small mb-0">
      <span
        v-for="project in vm.dependsOnProjects"
        :key="project.id"
        class="tag m-1"
      >
        <a
          href="#"
          class="has-text-weight-semibold"
          @click.prevent="handleGoToProject(project.id)"
        >
          {{ project.name }}
        </a>
        <button
          class="delete is-small"
          title="Delete dependency"
          @click="handleRemoveDependsOn(project.id)"
        ></button>
      </span>
    </div>

    <apps-select
      label="Depends on project"
      size="is-small"
      fullwidth
      :options="projectOptions"
      v-model="newDependsOn"
      @change="handleNewDependsOnProject"
    ></apps-select>
  </section>
</template>

<script>
const DependsOnProjects = {
  props: {
    vm: Object,
  },

  setup() {
    return {
      state: {
        data: store.state.data,
      },
    };
  },

  data() {
    return {
      newDependsOn: "",
    };
  },

  computed: {
    projectOptions() {
      return this.state.data.projects
        .filter(proj => !this.vm.project.dependsOnProjects.includes(proj.id))
        .sort((a, b) => (a.name.toLowerCase() > b.name.toLowerCase() ? 1 : -1))
        .map((proj) => ({ value: proj.id, text: proj.name }));
    },
  },

  methods: {
    handleNewDependsOnProject(id) {
      this.vm.project.dependsOnProjects.push(id);
      this.vm.autosave();
      this.newDependsOn = "";
    },
    handleRemoveDependsOn(id) {
      this.vm.project.dependsOnProjects =
        this.vm.project.dependsOnProjects.filter((dependId) => dependId !== id);
      this.vm.autosave();
    },
    handleGoToProject(id) {
      this.$router.push(`/project/${id}`);
    },
  },

  template: document.querySelector("#depends-on-projects-template").innerHTML,
};

app.component("depends-on-projects", DependsOnProjects);
</script>
<template id="project-edit-details-template">
  <section>
    <project-stats :vm="vm"></project-stats>
    <hr />

    <apps-input
      label="Name"
      size="is-small"
      :schema="vm.validation.schema.name"
      v-model="vm.project.name"
      @input="vm.autosave"
    ></apps-input>

    <apps-input
      label="Description"
      size="is-small"
      :schema="vm.validation.schema.description"
      v-model="vm.project.description"
      @input="vm.autosave"
    ></apps-input>

    <div class="columns">
      <div class="column p-1">
        <apps-tags
          label="Platform"
          size="is-small"
          placeholder="New platform..."
          icon-left="add"
          :suggestions="platformSuggestions"
          :schema="vm.validation.schema.platforms"
          v-model="vm.project.platforms"
          @change="vm.autosave"
        ></apps-tags>

        <apps-tags
          label="Category"
          size="is-small"
          placeholder="New category..."
          icon-left="add"
          :suggestions="categorySuggestions"
          :schema="vm.validation.schema.categories"
          v-model="vm.project.categories"
          @change="vm.autosave"
        ></apps-tags>

        <apps-select
          label="Priority"
          size="is-small"
          fullwidth
          :options="state.list.priorities"
          :schema="vm.validation.schema.priority"
          v-model="vm.project.priority"
          @input="vm.autosave"
        ></apps-select>

        <apps-select
          label="Program"
          size="is-small"
          fullwidth
          :options="state.list.projectPrograms"
          :schema="vm.validation.schema.program"
          v-model="vm.project.program"
          @change="vm.autosave"
        ></apps-select>

        <apps-checkbox
          label="Contains PII"
          size="is-small"
          :schema="vm.validation.schema.hasPII"
          v-model="vm.project.hasPII"
          @change="vm.autosave"
        ></apps-checkbox>

        <apps-checkbox
          label="Is public for support requests"
          size="is-small"
          :schema="vm.validation.schema.isPublic"
          v-model="vm.project.isPublic"
          @change="vm.autosave"
        ></apps-checkbox>

        <p class="subtitle is-6 mb-1">Project links</p>
        <project-links-edit
          class="mb-2 mt-2"
          :vm="vm"
        ></project-links-edit>
      </div>

      <div class="column p-1">
        <apps-input
          label="Version"
          size="is-small"
          :schema="vm.validation.schema.version"
          :model-value="vm.project.version"
          @change="handleUpdateVersion"
        ></apps-input>

        <apps-select
          label="Accessibility status"
          size="is-small"
          fullwidth
          :options="state.list.accessibilityStatuses"
          :schema="vm.validation.schema.accessibilityStatus"
          v-model="vm.project.accessibilityStatus"
          @change="vm.autosave"
        ></apps-select>

        <apps-select
          label="Status"
          size="is-small"
          fullwidth
          :options="state.list.projectStatuses"
          :schema="vm.validation.schema.status"
          v-model="vm.project.status"
          @change="vm.autosave"
        ></apps-select>

        <apps-select
          label="Owner"
          size="is-small"
          icon-left="person"
          fullwidth
          :options="users"
          :schema="vm.validation.schema.owner"
          v-model="vm.project.owner"
          @change="vm.autosave"
        ></apps-select>

        <apps-select
          label="Backup"
          size="is-small"
          icon-left="people"
          fullwidth
          :options="users"
          :schema="vm.validation.schema.backup"
          v-model="vm.project.backup"
          @change="vm.autosave"
        ></apps-select>

        <apps-input
          label="Project iteration target"
          size="is-small"
          :schema="vm.validation.schema.iteration"
          v-model="vm.project.iteration"
          @input="vm.autosave"
        ></apps-input>

        <apps-input
          label="Planning notes"
          size="is-small"
          :schema="vm.validation.schema.planningNotes"
          v-model="vm.project.planningNotes"
          @input="vm.autosave"
        ></apps-input>
      </div>
    </div>

    <h2 class="title is-6 mb-1">Dependencies</h2>
    <hr class="mb-4" />

    <div class="columns">
      <div class="column p-1">
        <depends-on-projects :vm="vm"></depends-on-projects>
      </div>

      <div class="column p-1">
        <dependent-for-projects :vm="vm"></dependent-for-projects>
      </div>
    </div>

    <project-dependency-layers :vm="dependencyVm"></project-dependency-layers>
  </section>
</template>

<script>
const ProjectEditDetails = {
  props: {
    vm: Object,
  },

  setup(props) {
    const { computed } = Vue;
    const dependencyVm = useProjectDependencyViewModel(props.vm.project);

    const { projectPlatforms, projectCategories } = useListFilters();
    const platformSuggestions = computed(() => projectPlatforms.value.map(t => t.value));
    const categorySuggestions = computed(() => projectCategories.value.map(t => t.value));

    return {
      dependencyVm,
      platformSuggestions,
      categorySuggestions,
      state: {
        app: store.state.app,
        data: store.state.data,
        list: store.state.list,
      },
    };
  },

  data() {
    return {};
  },

  computed: {
    users() {
      return this.state.list.users;
    },
  },

  methods: {
    handleUpdateVersion(newVersion) {
      const confirm = this.state.app.confirm;
      const context = this;
      if (!newVersion || newVersion === this.vm.project.version) return;

      if (!this.vm.isValid) {
        this.state.app.errorMessage =
          "Cannot update version until all required fields are provided! Set all required project fields and then try again.";

        const current = this.vm.project.version;
        this.vm.project.version = "";
        this.$nextTick().then(() => (this.vm.project.version = current));

        return;
      }

      confirm.title = "Update project version";
      confirm.description = `Are you sure you want to update the project version to ${newVersion}?
This will also update all outstanding project items to version ${newVersion}`;
      confirm.caption = "Update";
      confirm.confirmClasses = "is-success";

      confirm.action = async () => {
        await context.vm.updateProjectVersion(newVersion);
      };

      confirm.cancel = () =>
        (context.vm.project.version = context.vm.project.version);

      confirm.show = true;
    },
  },

  template: document.querySelector("#project-edit-details-template").innerHTML,
};

app.component("project-edit-details", ProjectEditDetails);
</script>
<template id="project-edit-tabs-template">
  <section>
    <div class="sticky-header has-background-white">
      <nav class="tabs is-small force-32-height">
        <ul>
          <li v-focus :class="{ 'is-active': selectedTab === 'details' }">
            <a href="#" @click.prevent="selectTab('details')">Details</a>
          </li>
          <li
            v-show="!vm.isNew"
            :class="{ 'is-active': selectedTab === 'items' }"
          >
            <a
              href="#"
              @click.prevent="selectTab('items', { forceResize: true })"
              >Items</a
            >
          </li>
          <li
            v-for="higher in selectedHighers"
            :key="higher.id"
            :class="{ 'is-active': `f-${higher.id}` === String(selectedTab) }"
          >
            <span class="is-flex is-align-items-bottom">
              <a href="#" @click.prevent="selectTab(`f-${higher.id}`)">
                <item-type-icon
                  class="is-small"
                  icon-class="is-size-6"
                  :type="higher.type"
                ></item-type-icon>
                <span>
                  [{{ higher.itemNumber }}] - {{ truncate(higher.name) }}
                </span>
              </a>
              <a
                href="#"
                class="pl-0 pr-0"
                title="Close higher"
                @click.prevent="handleCloseHigherTab(higher.id)"
              >
                <span class="delete is-small"></span>
              </a>
            </span>
          </li>
          <li
            v-for="item in selectedItems"
            :key="item.id"
            :class="{ 'is-active': String(item.id) === String(selectedTab) }"
          >
            <span class="is-flex is-align-items-bottom">
              <a href="#" @click.prevent="selectTab(item.id)">
                [{{ item.itemNumber }}] - {{ truncate(item.name) }}
              </a>
              <a
                href="#"
                class="pl-0 pr-0"
                title="Close item"
                @click.prevent="handleCloseItemTab(item.id)"
              >
                <span class="delete is-small"></span>
              </a>
            </span>
          </li>
        </ul>
      </nav>
    </div>

    <section v-show="selectedTab === 'details'" class="p-2 container mb-4">
      <!-- <section class="p-2" v-show="vm.currentTimelines.length > 0">
        <h2 class="subtitle mb-3">Current active timelines</h2>
        <timelines-chart :rows="vm.currentTimelineChartRows"></timelines-chart>
      </section> -->

      <project-edit-details v-focus :vm="vm"></project-edit-details>
    </section>

    <items-list
      v-show="selectedTab === 'items'"
      :items="vm.items"
      :versions="vm.versions"
      :default-version-filter="vm.project.version"
      @item-select="handleItemSelect"
    ></items-list>

    <items-list
      v-for="higher in selectedHighers"
      v-show="`f-${higher.id}` === String(selectedTab)"
      :key="higher.id"
      :items="higherRelatedItemsIndex[higher.id]"
      :versions="vm.versions"
      :default-version-filter="vm.project.version"
      @item-select="handleItemSelect"
    ></items-list>

    <item-edit-details
      v-for="item in selectedItems"
      v-show="String(item.id) === String(selectedTab)"
      class="p-2 container mb-4"
      :key="item.id"
      :item="item"
      @open-item="handleOpenRelatedItem"
      @new-item="handleItemSelect"
      @related-items-select="handleRelatedItemsSelect"
    ></item-edit-details>
  </section>
</template>

<script>
const ProjectEditTabs = {
  props: {
    vm: Object,
    selectItem: Object,
    selectHigher: Object,
  },

  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  mounted() {
    const { currentQueryParams } = this.state.app;

    const tab = currentQueryParams.tab;
    if (!tab) return;

    if (["details", "items"].includes(tab)) {
      this.selectTab(tab, { forceResize: true });
    } else {
      const item = this.vm.items.find((itm) => String(itm.id) === String(tab));
      if (item) {
        this.handleItemSelect(item);
        return;
      } else {
        const higher = this.vm.items.find(
          (itm) => `f-${itm.id}` === String(tab)
        );
        if (higher) {
          this.handleHigherSelect(higher);
          return;
        }
      }

      this.selectTab("details");
    }
  },

  data() {
    return {
      selectedItems: [],
      selectedHighers: [],
    };
  },

  computed: {
    selectedTab() {
      return this.state.app.currentQueryParams.tab || "details";
    },
    higherRelatedItemsIndex() {
      const index = {};
      console.time("higherRelatedItemsIndex");
      this.selectedHighers.forEach(
        (higher) =>
          (index[higher.id] = this.vm.getDeepItemRelatedList(higher))
      );
      console.timeEnd("higherRelatedItemsIndex");
      return index;
    },
  },

  methods: {
    selectTab(tabName, { forceResize = false } = {}) {
      this.$router.replace({
        path: this.state.app.currentRoute,
        query: { tab: String(tabName) },
      });

      if (forceResize)
        requestAnimationFrame(() => window.dispatchEvent(new Event("resize")));
    },
    handleHigherSelect(higher) {
      const selected = this.selectedHighers.find((ft) => ft.id === higher.id);
      if (!selected) this.selectedHighers.push(higher);

      this.$nextTick().then(() =>
        this.selectTab(`f-${higher.id}`, { forceResize: true })
      );
    },
    handleItemSelect(item) {
      const selected = this.selectedItems.find((it) => it.id === item.id);
      // Add a copy of the item to the selectedItems list, avoids re-rendering ItemLists when the item is edited
      if (!selected) this.selectedItems.push(JSON.parse(JSON.stringify(item)));

      this.selectTab(item.id);
    },
    handleCloseItemTab(id) {
      const isSelected = String(id) === String(this.selectedTab);
      this.selectedItems = this.selectedItems.filter((item) => item.id !== id);

      if (!isSelected) return;

      if (this.selectedItems.length > 0)
        this.selectTab(this.selectedItems[this.selectedItems.length - 1].id);
      else this.selectTab("items", { forceResize: true });
    },
    handleCloseHigherTab(id) {
      const isSelected = `f-${id}` === String(this.selectedTab);
      this.selectedHighers = this.selectedHighers.filter(
        (higher) => higher.id !== id
      );

      if (!isSelected) return;

      if (this.selectedHighers.length > 0)
        this.selectTab(
          `f-${this.selectedHighers[this.selectedHighers.length - 1].id}`
        );
      else this.selectTab("items", { forceResize: true });
    },
    handleOpenRelatedItem(id) {
      const item = this.vm.items.find((itm) => itm.id === id);
      if (item) this.handleItemSelect(item);
    },
    handleRelatedItemsSelect(higher) {
      this.handleHigherSelect(higher);
    },
    truncate(str, len = 10) {
      if (!str) return "New item...";
      if (str.length <= len + 3) return str;

      return `${str.slice(0, len)}...`;
    },
  },

  watch: {
    selectItem: {
      handler(newVal, oldVal) {
        if (!newVal || newVal === oldVal) return;

        this.handleItemSelect(newVal);
        this.$emit("update:selectItem", null);
      },
      immediate: true,
    },
    selectHigher: {
      handler(newVal, oldVal) {
        if (!newVal || newVal === oldVal) return;

        this.handleHigherSelect(newVal);
        this.$emit("update:selectHigher", null);
      },
      immediate: true,
    },
  },

  template: document.querySelector("#project-edit-tabs-template").innerHTML,
};

app.component("project-edit-tabs", ProjectEditTabs);
</script>
<template id="project-edit-view-template">
  <main v-if="!!vm">
    <side-menu-container>
      <article class="mb-3 p-2">
        <h1 class="title is-6 mb-2">
          {{ vm.project.name }} - (v{{ vm.project.version }})
        </h1>
        <div
          v-show="vm.project.status === 'Inactive'"
          class="notification has-text-centered is-warning p-2 mb-1"
        >
          Project is inactive!
        </div>
        <project-action-bar
          class="p-2"
          :vm="vm"
          @project-delete="handleProjectDelete"
          @project-duplicate="handleProjectDuplicate"
          @project-prd-file="handleProjectPrd"
        ></project-action-bar>
        <hr />
      </article>

      <new-item-dropdown
        v-show="!vm.isNew"
        fullwidth
        @type-select="handleNewItem"
      ></new-item-dropdown>

    </side-menu-container>

    <side-menu-content>
      <project-edit-tabs
        :vm="vm"
        v-model:select-item="selectItem"
        v-model:select-higher="selectHigher"
      ></project-edit-tabs>
    </side-menu-content>
  </main>
</template>

<script>
const ProjectEditView = {
  props: {
    id: String,
  },

  setup(props) {
    const { app } = store.state;

    const { projectById } = store.calculated;

    const project = !app.currentQueryParams.isNew
      ? projectById.value[props.id]
      : store.dispatch.project.createNewProject({ id: props.id });

    const vm = project ? useProjectViewModel(project) : null;

    return {
      vm,
      state: {
        app: store.state.app,
        project: store.state.project,
      },
      dispatch: {
        project: store.dispatch.project,
        item: store.dispatch.item,
      },
    };
  },

  created() {
    if (!this.vm) this.$router.replace("/not-found");
  },

  data() {
    return {
      selectItem: null,
      selectHigher: null,
    };
  },

  methods: {
    handleNewItem(type) {
      this.selectItem = this.dispatch.item.createNewItem({
        type,
        project: this.vm.project.id,
        version: this.vm.project.version,
      });
    },
    handleProjectDelete() {
      this.vm.deleteProject();
      this.$router.push("/");
    },
    async handleProjectDuplicate() {
      const copy = this.vm.duplicate();
      const copyVm = useProjectViewModel(copy);

      this.state.app.showLoadingOverlay = true;
      const response = await copyVm.quicksave();
      this.state.app.showLoadingOverlay = false;

      this.$router.push(`/project/${copy.id}`);
    },
    handleProjectPrd() {
      this.vm.createProjectPrdLink();
    },
  },

  template: document.querySelector("#project-edit-view-template").innerHTML,
};

app.component("project-edit-view", ProjectEditView);
</script>
<template id="project-links-edit-template">
  <section>
    <div
      v-for="(link, index) in vm.project.links"
      :key="link.url"
      class="field has-addons mb-1"
    >
      <p class="control is-flex">
        <button
          class="button is-small"
          :class="{
            'is-dark is-outlined': !editIndex[index],
            'is-primary': editIndex[index],
          }"
          style="border: none"
          :title="!editIndex[index] ? 'Edit entry' : 'Cancel edit'"
          @click="handleEdit(index)"
        >
          <span class="icon">
            <span class="material-symbols-outlined has-text-white">edit</span>
          </span>
        </button>
      </p>
      <p
        v-show="!editIndex[index]"
        class="control is-expanded is-size-7 is-flex-polite is-align-items-center ml-2"
      >
        <a
          v-if="link.url.match(/https?:\/\//)"
          :href="link.url"
          target="_blank"
          rel="noopener noreferrer"
          >{{ link.name || link.url }}</a
        >
        <span v-else>{{ link.name }} - {{ link.url }}</span>
      </p>
      <p v-show="!!editIndex[index]" class="control" style="width: 4.5rem">
        <input
          class="input is-small"
          type="number"
          step="-1"
          aria-label="Sort order"
          placeholder="Sort order"
          :value="index + 1"
          @change="handleReorder(index + 1, $event.target.value)"
        />
      </p>
      <p v-show="!!editIndex[index]" class="control is-expanded">
        <input
          v-model="link.name"
          class="input is-small"
          type="text"
          aria-label="Name"
          placeholder="Name"
          @input="vm.autosave"
        />
      </p>
      <p v-show="!!editIndex[index]" class="control">
        <input
          v-model="link.url"
          class="input is-small"
          type="text"
          aria-label="Url"
          placeholder="Url"
          @input="vm.autosave"
        />
      </p>
      <p class="control">
        <button
          v-show="!!editIndex[index]"
          class="button is-small is-outlined"
          title="Delete entry"
          @click="handleRemove(index)"
        >
          <span class="icon">
            <span class="material-symbols-outlined">clear</span>
          </span>
        </button>
      </p>
    </div>

    <!-- ADD NEW SECTION -->
    <hr />

    <div class="field has-addons">
      <p class="control" style="width: 4.5rem">
        <input
          class="input is-small"
          type="number"
          aria-label="Sort order"
          placeholder="Sort order"
          disabled
          :value="vm.project.links.length + 1"
        />
      </p>
      <p class="control is-expanded">
        <input
          v-model="newElement.name"
          class="input is-small"
          type="text"
          aria-label="Name"
          placeholder="Name"
          :disabled="adding"
        />
      </p>
      <p class="control">
        <input
          v-model="newElement.url"
          class="input is-small"
          type="text"
          aria-label="Url"
          placeholder="Url"
          :disabled="adding"
        />
      </p>
      <p class="control">
        <button
          class="button is-small is-outlined"
          :class="{ 'is-loading': adding }"
          title="New entry"
          @click="handleAdd"
        >
          <span class="icon">
            <span class="material-symbols-outlined">add_link</span>
          </span>
        </button>
      </p>
    </div>
  </section>
</template>

<script>
const ProjectLinksEdit = {
  props: {
    vm: Object,
  },

  data() {
    return {
      adding: false,
      editIndex: {},
      newElement: {
        name: "",
        url: "",
      },
    };
  },

  methods: {
    handleReorder(curI, newI) {
      curI = parseInt(curI) - 1;
      newI = parseInt(newI) - 1;
      this.vm.reorderLink(curI, newI);
      this.vm.autosave();

      const i = Math.min(Math.max(newI, 0), this.vm.project.links.length - 1);
      this.editIndex[curI] = this.editIndex[i];
      this.editIndex[i] = true;
    },
    async handleAdd() {
      const el = this.newElement;
      if (el.name === "" || el.url === "") return;

      this.adding = true;

      const toSave = { ...el };
      this.vm.addLink(toSave);
      el.name = "";
      el.url = "";

      const res = await this.vm.autosave();

      this.adding = false;
    },
    handleEdit(index) {
      this.editIndex[index] = !this.editIndex[index];
    },
    handleRemove(index) {
      this.vm.removeLink(index);
      this.vm.autosave();
    },
  },

  template: document.querySelector("#project-links-edit-template").innerHTML,
};

app.component("project-links-edit", ProjectLinksEdit);
</script>
<template id="items-list-template">
  <scrollable-hero-table
    v-focus
    header-class="is-white sticky-header has-small-tabs"
    :offset="24"
    :headers="headers"
    :rows="rows"
    :filter-fields="filterFields"
    :criteria="criteria"
    :use-worker="true"
    :search-more-options="searchMoreOptions"
    @more-options-action="handleMoreOptionsAction"
    @row-select="handleRowSelect"
  >
    <template #type="row">
      <span class="icon-text is-flex-wrap-nowrap">
        <item-type-icon
          class="is-small"
          icon-class="is-size-6"
          :type="row.item.type"
        ></item-type-icon>
        <span>
          {{ row.item.type }}
        </span>
      </span>
    </template>
    <template #status="row">
      <span class="tag" :class="row.itemStatusBulmaTag">
        {{ row.item.status }}
      </span>
    </template>
  </scrollable-hero-table>
</template>

<script>
const ItemsList = {
  props: {
    items: Array,
    versions: Array,
    defaultVersionFilter: String,
  },

  emits: ["item-select"],

  setup() {
    const { users, itemTypes, itemStatuses, priorities } = useListFilters();

    return {
      users,
      itemTypes,
      itemStatuses,
      priorities,
      dispatch: {
        util: store.dispatch.util,
      },
    };
  },

  data() {
    return {
      headers: [
        {
          prop: "itemNumber",
          caption: "#",
        },
        {
          prop: "name",
          caption: "Name",
          style: { 'min-width': '20vw' },
        },
        {
          prop: "description",
          searchOnly: true,
        },
        {
          prop: "_assignee",
          caption: "Assigned to",
        },
        {
          prop: "type",
          caption: "Type",
        },
        {
          prop: "priority",
          caption: "Priority",
        },
        {
          prop: "status",
          caption: "Status",
        },
        {
          prop: "version",
          caption: "Version",
        },
        {
          prop: "_tagsDisplay",
          caption: "Tags",
        },
        {
          prop: "hours",
          caption: "Hours",
        },
        {
          prop: "closedDate",
          caption: "Closed",
        },
        {
          prop: "_modifiedDate",
          caption: "Last updated",
        },
        {
          prop: "_modifiedBy",
          caption: "Last updated by",
        },
        {
          prop: "_createdDate",
          caption: "Created",
        },
        {
          prop: "_createdBy",
          caption: "Created by",
        },
        {
          prop: "_search",
          searchOnly: true,
        },
      ],
      filterDates: [
        {
          prop: "_createdDate",
          caption: "Created",
        },
      ],
      criteria: {
        search: "",
        filter: {
          version: [this.defaultVersionFilter],
        },
        dates: {},
        sort: {
          header: "itemNumber",
          ascending: false,
        },
      },
      searchMoreOptions: [
        {
          caption: "Export to csv",
          action: "EXPORT_TO_CSV",
        },
      ],
    };
  },

  computed: {
    rows() {
      const removeEmailAt = (email) => String(email).split("@")[0];
      const formatJsonDate = (dt) => String(dt).split("T")[0];

      return this.items.map((item) => {
        const vm = useItemViewModel(item);

        return {
          item,
          ...item,
          itemStatusBulmaTag: vm.itemStatusBulmaTag,
          _rowKey: item.id,
          _tagsDisplay: item.tags.join(" | "),
          _assignee: removeEmailAt(item.assignee),
          _createdDate: formatJsonDate(item.createdDate),
          _createdBy: removeEmailAt(item.createdBy),
          _modifiedDate: formatJsonDate(item.modifiedDate),
          _modifiedBy: removeEmailAt(item.modifiedBy),
          _search: vm.comments.map((c) => c.comment).join(" "),
          item__tags: true,
        };
      });
    },
    itemTags() {
      const set = new Set(this.items.map((itm) => itm.tags).flat());
      return [...set]
        .filter((tag) => !!tag)
        .map((tag) => ({ value: tag, text: tag }));
    },
    filterFields() {
      return [
        {
          prop: "assignee",
          options: [
            {
              value: "",
              text: "- Assignees -",
            },
            ...this.users,
          ],
        },
        {
          prop: "type",
          options: [
            {
              value: "",
              text: "- Types -",
            },
            ...this.itemTypes,
          ],
        },
        {
          prop: "priority",
          options: [
            {
              value: "",
              text: "- Priorities -",
            },
            ...this.priorities,
          ],
        },
        {
          prop: "status",
          options: [
            {
              value: "",
              text: "- Statuses -",
            },
            ...this.itemStatuses,
          ],
        },
        {
          prop: "item__tags",
          options: [
            {
              value: "",
              text: "- Tags -",
            },
            ...this.itemTags,
          ],
        },
        {
          prop: "version",
          options: [
            {
              value: "",
              text: "- Versions -",
            },
            ...this.versions.map((v) => ({ value: v, text: v })),
          ],
        },
      ];
    },
  },

  methods: {
    handleRowSelect({ row, index }) {
      this.$emit("item-select", row.item);
    },
    handleMoreOptionsAction({ action, displayedRows, allRows }) {
      switch (action) {
        case "EXPORT_TO_CSV":
          this.handleExportToCsv(displayedRows);
          break;
      }
    },
    handleExportToCsv(displayedRows) {
      const dataToDownload = displayedRows.map((row) => {
        const obj = {};
        this.headers
          .filter((header) => !header.searchOnly)
          .forEach((header) => (obj[header.caption] = row[header.prop]));
        return obj;
      });

      this.dispatch.util.downloadDataAsCsv(
        `IS-Projects-download_items_data_${new Date().toJSON()}.csv`,
        dataToDownload
      );
    },
  },

  watch: {},

  template: document.querySelector("#items-list-template").innerHTML,
};

app.component("items-list", ItemsList);
</script>
<template id="new-item-dropdown-template">
  <div class="dropdown" :class="{ 'is-active': isActive }" :style="style">
    <div class="dropdown-trigger" :style="style">
      <button
        class="button is-small"
        :style="style"
        aria-haspopup="true"
        @click="isActive = !isActive"
      >
        <span>Add new item</span>
        <span class="icon is-small">
          <span class="material-symbols-outlined" aria-hidden="true">expand_more</span>
        </span>
      </button>
    </div>
    <div class="dropdown-menu">
      <div class="dropdown-content">
        <a
          v-for="type in state.list.types"
          :key="type"
          href="#"
          class="dropdown-item"
          @click.prevent="handleTypeClick(type)"
        >
          <span class="icon-text">
            <item-type-icon class="is-small" :type="type"></item-type-icon>
            <span class="ml-1 is-size-7">
              {{ type }}
            </span>
          </span>
        </a>
      </div>
    </div>
  </div>
</template>

<script>
const NewItemDropdown = {
  props: {
    fullwidth: Boolean,
  },

  emits: ["type-select"],

  setup() {
    return {
      state: {
        list: store.state.list,
      },
    };
  },

  data() {
    return {
      isActive: false,
    };
  },

  computed: {
    style() {
      const style = {};
      if (this.fullwidth) style.width = "100%";

      return style;
    },
  },

  methods: {
    handleTypeClick(type) {
      this.$emit("type-select", type);
      this.isActive = false;
    },
  },

  template: document.querySelector("#new-item-dropdown-template").innerHTML,
};

app.component("new-item-dropdown", NewItemDropdown);
</script>
<template id="inactive-projects-list-view-template">
  <hero-slot-table
    v-focus
    title="Inactive projects"
    header-class="is-white sticky-header"
    :sizes="sizes"
    :headers="headers"
    :rows="rows"
    :filter-fields="filterFields"
    :criteria="criteria"
    :use-worker="true"
    :search-more-options="searchMoreOptions"
    @more-options-action="handleMoreOptionsAction"
  >
    <template v-slot="row">
      <project-card 
        :project="row.project"
        class="mb-2 light-border"
        :show-description="true"
        @project-click="handleGoToProject"
      ></project-card>
    </template>
  </hero-slot-table>
</template>

<script>
const InactiveProjectsListView = {
  props: {},

  setup() {
    return {
      calculated: {
        inactiveProjects: store.calculated.inactiveProjects,
      },
      dispatch: {
        util: store.dispatch.util,
      },
    };
  },

  data() {
    return {
      sizes: ["", "", "", "", ""],
      headers: [
        {
          prop: "name",
          caption: "Name",
        },
        {
          prop: "owner",
          caption: "Project lead",
        },
        {
          prop: "_totalItems",
          caption: "Total items",
        },
        {
          prop: "_openItems",
          caption: "Pending items",
        },
        {
          prop: "status",
          caption: "Status",
        },
        {
          prop: "_textSearch",
          searchOnly: true,
        },
      ],
      filterFields: [
        {
          prop: "_hasPII",
          options: [
            {
              value: "",
              text: "- PII status -",
            },
            {
              value: "true",
              text: "Contains PII",
            },
            {
              value: "false",
              text: "Does not contain PII",
            },
          ],
        },
      ],
      criteria: {
        search: "",
        filter: {},
        dates: {},
        sort: {
          header: "name",
          ascending: true,
        },
      },
      searchMoreOptions: [
        {
          caption: "Export to csv",
          action: "EXPORT_TO_CSV",
        },
      ],
    };
  },

  computed: {
    rows() {
      const inactiveProjects = this.calculated.inactiveProjects.value.map(
        (project) => {
          const vm = useProjectViewModel(project);

          return {
            project,
            ...project,
            _rowKey: project.id,
            _totalItems: vm.stats.totalItems,
            _openItems: vm.stats.pendingItems,
            _hasPII: vm.project.hasPII ? "true" : "false",
          };
        }
      );
      return inactiveProjects;
    },
  },

  methods: {
    handleMoreOptionsAction({ action, displayedRows, allRows }) {
      switch (action) {
        case "EXPORT_TO_CSV":
          this.handleExportToCsv(displayedRows);
          break;
      }
    },
    handleExportToCsv(rows) {
      const dataToDownload = rows.map((row) => row.project);

      this.dispatch.util.downloadDataAsCsv(
        `IS-Projects-download_project_data_${new Date().toJSON()}.csv`,
        dataToDownload
      );
    },
    handleGoToProject(project) {
      this.$router.push(`/project/${project.id}`);
    },
  },

  template: document.querySelector("#inactive-projects-list-view-template")
    .innerHTML,
};

app.component("inactive-projects-list-view", InactiveProjectsListView);
</script>
<template id="projects-list-view-template">
  <main>
    <div class="sticky-header has-background-white">
      <nav class="tabs is-small is-fullwidth force-32-height">
        <ul>
          <li v-focus :class="{ 'is-active': selectedTab === 'all' }">
            <a href="#" @click.prevent="selectTab('all')">All</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'mine' }">
            <a href="#" @click.prevent="selectTab('mine')">Mine</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'planning' }">
            <a href="#" @click.prevent="selectTab('planning')">Planning</a>
          </li>
          <li :class="{ 'is-active': selectedTab === 'development' }">
            <a href="#" @click.prevent="selectTab('development')"
              >Development</a
            >
          </li>
          <li :class="{ 'is-active': selectedTab === 'testing' }">
            <a href="#" @click.prevent="selectTab('testing')">Testing</a>
          </li>
        </ul>
      </nav>
    </div>

    <hero-slot-table
      v-focus
      header-class="is-white sticky-header has-small-tabs"
      :sizes="sizes"
      :headers="headers"
      :rows="rows"
      :filter-fields="filterFields"
      :filter-dates="filterDates"
      :criteria="criteria"
      :use-worker="true"
      :search-more-options="searchMoreOptions"
      @more-options-action="handleMoreOptionsAction"
    >
      <template v-slot="row">
        <project-card
          :project="row.project"
          class="mb-2 light-border"
          :show-description="true"
          @project-click="handleGoToProject"
        ></project-card>
      </template>
    </hero-slot-table>
  </main>
</template>

<script>
const ProjectsListView = {
  props: {},

  setup() {
    const {
      users,
      projects,
      priorities,
      projectStatuses,
      projectPrograms,
      projectPlatforms,
      projectCategories,
      accessibilityStatuses,
    } = useListFilters();

    return {
      listFilters: {
        users,
        projects,
        priorities,
        projectStatuses,
        projectPrograms,
        projectPlatforms,
        projectCategories,
        accessibilityStatuses,
      },
      state: {
        app: store.state.app,
      },
      calculated: {
        activeProjects: store.calculated.activeProjects,
      },
      dispatch: {
        project: store.dispatch.project,
        util: store.dispatch.util,
      },
    };
  },

  mounted() {
    this.updateTabFilteredRows(this.selectedTab);
  },

  data() {
    return {
      tabRows: [],
      sizes: ["", "", "", "", ""],
      headers: [
        {
          prop: "name",
          caption: "Name",
        },
        {
          prop: "owner",
          caption: "Project lead",
        },
        {
          prop: "_totalItems",
          caption: "Total items",
          visibility: "is-hidden-touch",
        },
        {
          prop: "_openItems",
          caption: "Pending items",
          visibility: "is-hidden-touch",
        },
        {
          prop: "status",
          caption: "Status",
        },
        {
          prop: "createdDate",
          caption: "Created",
        },
        {
          prop: "_textSearch",
          searchOnly: true,
        },
      ],
      filterDates: [
        {
          prop: 'createdDate',
          caption: 'Created'
        }
      ],
      criteria: {
        search: "",
        filter: {},
        dates: {},
        sort: {
          header: "name",
          ascending: true,
        },
      },
      searchMoreOptions: [
        {
          caption: "Create new project",
          action: "CREATE_NEW_PROJECT",
        },
        {
          caption: "Export to csv",
          action: "EXPORT_TO_CSV",
        },
      ],
    };
  },

  computed: {
    selectedTab() {
      return this.state.app.currentQueryParams.tab || "all";
    },
    rows() {
      console.time("project rows");

      const projects = this.tabRows.map((project) => {
        const vm = useProjectViewModel(project);

        return {
          project,
          ...project,
          _rowKey: project.id,
          _totalItems: vm.stats.totalItems,
          _openItems: vm.stats.pendingItems,
          _hasPII: vm.project.hasPII ? "true" : "false",
          _isPublic: vm.project.isPublic ? "true" : "false",
          project__platforms: true,
          project__categories: true,
          project__dependsOn: true,
          project__dependentFor: true,
          _textSearch: `${project.description} ${project.platforms.join(
            " "
          )} ${project.categories.join(" ")} ${project.program}`,
        };
      });

      console.timeEnd("project rows");
      return projects;
    },
    filterFields() {
      let fields = [];
      const tab = this.selectedTab;

      if (tab !== "mine")
        fields.push({
          prop: "owner",
          options: [
            {
              value: "",
              text: "- Owners -",
            },
            ...this.listFilters.users.value,
          ],
        });

      if (!["planning", "development", "testing"].includes(tab))
        fields.push({
          prop: "status",
          options: [
            {
              value: "",
              text: "- Statuses -",
            },
            ...this.listFilters.projectStatuses.value,
          ],
        });

      return [
        ...fields,
        {
          prop: "priority",
          options: [
            {
              value: "",
              text: "- Priorities -",
            },
            ...this.listFilters.priorities.value,
          ],
        },
        {
          prop: "project__platforms",
          options: [
            {
              value: "",
              text: "- Platforms -",
            },
            ...this.listFilters.projectPlatforms.value,
          ],
        },
        {
          prop: "project__categories",
          options: [
            {
              value: "",
              text: "- Categories -",
            },
            ...this.listFilters.projectCategories.value,
          ],
        },
        {
          prop: "accessibilityStatus",
          options: [
            {
              value: "",
              text: "- Accessibility statuses -",
            },
            ...this.listFilters.accessibilityStatuses.value,
          ],
        },
        {
          prop: "program",
          options: [
            {
              value: "",
              text: "- Programs -",
            },
            ...this.listFilters.projectPrograms.value,
          ],
        },
        {
          prop: "project__dependsOn",
          options: [
            {
              value: "",
              text: "- Depends on projects -",
            },
            ...this.listFilters.projects.value,
          ],
        },
        {
          prop: "project__dependentFor",
          options: [
            {
              value: "",
              text: "- Dependent for projects -",
            },
            ...this.listFilters.projects.value,
          ],
        },
        {
          prop: "_hasPII",
          options: [
            {
              value: "",
              text: "- PII status -",
            },
            {
              value: "true",
              text: "Contains PII",
            },
            {
              value: "false",
              text: "Does not contain PII",
            },
          ],
        },
        {
          prop: "_isPublic",
          options: [
            {
              value: "",
              text: "- Public/support status -",
            },
            {
              value: "true",
              text: "Is public for support requests",
            },
            {
              value: "false",
              text: "Is not public for support",
            },
          ],
        },
      ];
    },
  },

  methods: {
    selectTab(tabName) {
      this.$router.replace({
        path: this.state.app.currentRoute,
        query: { tab: String(tabName) },
      });
    },
    updateTabFilteredRows(tab) {
      const userEmail = this.state.app.user && this.state.app.user.email;
      const tabFilter = (project) => {
        if (tab === "all") return true;

        if (tab === "mine") return project.owner === userEmail;

        if (tab === "planning") return project.status === "Planning";

        if (tab === "development") return project.status === "Development";

        if (tab === "testing")
          return (
            project.status === "System testing" || project.status === "UAT"
          );

        return true;
      };

      const projects = this.calculated.activeProjects.value.filter(tabFilter);

      this.tabRows = projects;
    },
    handleGoToProject(project) {
      this.$router.push(`/project/${project.id}`);
    },
    handleCreateNewProject() {
      const route = this.dispatch.project.getNewProjectRoute();
      this.$router.push(route);
    },
    handleMoreOptionsAction({ action, displayedRows, allRows }) {
      switch (action) {
        case "EXPORT_TO_CSV":
          this.handleExportToCsv(displayedRows);
          break;

        case "CREATE_NEW_PROJECT":
          this.handleCreateNewProject();
          break;
      }
    },
    handleExportToCsv(rows) {
      const dataToDownload = rows.map((row) => row.project);

      this.dispatch.util.downloadDataAsCsv(
        `IS-Projects-download_project_data_${new Date().toJSON()}.csv`,
        dataToDownload
      );
    },
  },

  watch: {
    selectedTab(newTab) {
      this.updateTabFilteredRows(newTab);

      const criteria = this.criteria;
      const filterFields = this.filterFields;
      requestAnimationFrame(() => {
        criteria.search = "";
        criteria.sort = {
          header: "name",
          ascending: true,
        };
        filterFields.forEach(({ prop }) => (criteria.filter[prop] = ""));
      });
    },
  },

  template: document.querySelector("#projects-list-view-template").innerHTML,
};

app.component("projects-list-view", ProjectsListView);
</script>
<template id="project-stats-template">
  <article class="columns mb-0 is-mobile">
    <div class="column p-1 has-text-centered">
      <p class="subtitle">Total items</p>
      {{ vm.stats.totalItems }}
    </div>

    <div class="column p-1 has-text-centered">
      <p class="subtitle">Pending items</p>
      {{ vm.stats.pendingItems }}
    </div>

    <div class="column p-1 has-text-centered">
      <p class="subtitle">Closed items</p>
      {{ vm.stats.closedItems }}
    </div>

    <div class="column p-1 has-text-centered">
      <p class="subtitle">Complete percent</p>
      {{ vm.stats.completePercent }}
    </div>
  </article>
</template>

<script>
const ProjectStats = {
  props: {
    vm: Object,
  },

  template: document.querySelector("#project-stats-template").innerHTML,
};

app.component("project-stats", ProjectStats);
</script>
<template id="timeline-action-bar-template">
  <section class="columns p-0">
    <article class="column p-1">
      <p>
        <span class="is-size-7">
          Created: {{ createdDisplay }} | <last-saved-on :rec="vm.timeline"></last-saved-on>
        </span>
      </p>
    </article>

    <div class="column is-narrow p-1">
      <button
        v-show="!vm.isNew"
        class="button is-danger is-outlined is-small"
        title="Delete project"
        ref="deleteButton"
        @click="handleDelete"
      >
        <span class="icon is-small">
          <span class="material-symbols-outlined" aria-hidden="true">delete</span>
        </span>
      </button>
    </div>
  </section>
</template>

<script>
const TimelineActionBar = {
  props: {
    vm: Object,
  },

  setup() {
    return {};
  },

  data() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  computed: {
    createdDisplay() {
      const date = this.vm.timeline.createdDate;
      if (!date) return "unknown";

      return new Date(date).toLocaleDateString();
    }
  },

  methods: {
    handleDelete() {
      const confirm = this.state.app.confirm;

      confirm.title = "Delete timeline";
      confirm.description = "Are you sure you want to delete this timeline?";
      confirm.caption = "Delete";
      confirm.confirmClasses = "is-danger";

      confirm.action = async () => await this.vm.deleteTimeline();
      confirm.cancel = () => this.$refs.deleteButton.focus();

      confirm.show = true;
    },
  },

  template: document.querySelector("#timeline-action-bar-template").innerHTML,
};

app.component("timeline-action-bar", TimelineActionBar);
</script>
<template id="timelines-chart-template">
  <section class="columns mb-2">
    <article class="column is-12 p-0">
      <figure v-show="rows.length > 0" ref="chart"></figure>
      <h1 v-show="rows.length === 0" class="title pt-5">No Timelines found!</h1>
    </article>
    <!-- hack to force dataTable reactivity -->
    <div aria-hidden="true" v-show="false">
      {{ dataTable.getNumberOfRows() }}
    </div>
  </section>
</template>

<script>
const TimelinesTimelineChart = {
  props: {
    rows: Array,
  },

  emits: ["timeline-index-select"],

  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  mounted() {
    // Load the Visualization API and the timeline package.
    google.charts.load("current", { packages: ["timeline"] });
    google.charts.setOnLoadCallback(this.renderChart);

    window.addEventListener("resize", this.redrawChart);
  },

  unmounted() {
    window.removeEventListener("resize", this.redrawChart);
  },

  data() {
    return {
      drawChart: null,
      chart: null,
    };
  },

  computed: {
    dataTable() {
      const dataTable = new google.visualization.DataTable();
      
      // see https://developers.google.com/chart/interactive/docs/gallery/timeline#data-format
      dataTable.addColumn({ type: "string", id: "Timeline" });
      // dataTable.addColumn({ type: "string", id: "no-use-bar-label" });
      // dataTable.addColumn({ type: "string", role: "tooltip" });
      dataTable.addColumn({ type: "date", id: "Start" });
      dataTable.addColumn({ type: "date", id: "End" });

      const rows = this.rows.map((ms) => [
        ms.timeline,
        // null,
        // ms.tooltip,
        ms.startDate,
        ms.endDate,
      ]);

      dataTable.addRows(rows);

      this.$nextTick().then(() => this.redrawChart());
      return dataTable;
    },
    chartOptions() {
      const ROW_HEIGHT_PX = 41;
      const height = ROW_HEIGHT_PX * this.rows.length + 65;

      const user = this.state.app.user;
      const fontColor =
        user && user.settings.theme === "Dark" ? "#ffffff" : "#171717";
      const backgroundColor =
        user && user.settings.theme === "Light" ? "#ffffff" : "#171717";

      return {
        alternatingRowStyle: false,
        backgroundColor: backgroundColor,
        height,
        animation: {
          startup: true,
          duration: 1000,
          easing: "out",
        },
        timeline: {
          // showRowLabels: false,
          rowLabelStyle: {
            color: fontColor,
          },
        },
        // currently not supported for Timeline charts, but left for future reference
        hAxis: {
          textStyle: {
            color: fontColor,
          },
        },
      };
    },
  },

  methods: {
    renderChart() {
      const container = this.$refs.chart;
      container.innerHTML = "";

      const chart = new google.visualization.Timeline(container);

      // https://stackoverflow.com/questions/52156120/google-charts-change-color-of-x-axis-font-for-timelines
      google.visualization.events.addListener(chart, "ready", () => {
        const axisLabels = container.getElementsByTagName("text");
        [...axisLabels].forEach(
          (label) =>
            label.setAttribute(
              "fill",
              this.chartOptions.timeline.rowLabelStyle.color
            )
        );
      });

      google.visualization.events.addListener(chart, "select", () => {
        const [selected] = chart.getSelection();
        this.$emit("timeline-index-select", selected.row);
      });

      this.chart = chart;
      this.drawChart = () => {
        if (this.rows.length === 0) chart.clearChart();
        else chart.draw(this.dataTable, this.chartOptions);
      };

      if (this.rows.length > 0) this.drawChart();
    },
    redrawChart() {
      if (this.drawChart) this.drawChart();
    },
  },

  template: document.querySelector("#timelines-chart-template")
    .innerHTML,
};

app.component("timelines-chart", TimelinesTimelineChart);
</script>
<template id="timelines-view-template">
  <main>
    <div class="container">
      <section class="columns is-vcentered mb-0 pb-0">
        <apps-select
          class="column is-narrow mb-3"
          label="Status"
          size="is-small"
          :options="['All', ...state.list.timelineStatuses]"
          v-model="filter.status"
          @change="updateRouteQuery({ status: filter.status })"
        ></apps-select>

        <apps-input
          class="column mb-0"
          label="Start date"
          type="date"
          size="is-small"
          v-model="filter.startDate"
          @change="updateRouteQuery({ start: filter.startDate })"
        ></apps-input>

        <apps-input
          class="column mb-0"
          label="End date"
          type="date"
          size="is-small"
          v-model="filter.endDate"
          @change="updateRouteQuery({ end: filter.endDate })"
        ></apps-input>
      </section>

      <section class="pb-3">
        <fieldset>
          <legend class="subtitle is-6 mb-1">Filter by project owners</legend>
          <label class="checkbox">
            <input
              type="checkbox"
              v-model="selectAllOwners"
              @change="handleSelectAllChange"
            />
            All owners
          </label>
          <div class="columns is-multiline">
            <div
              v-for="user in state.list.users"
              :key="user"
              class="column p-0 is-3"
            >
              <label class="checkbox">
                <input
                  type="checkbox"
                  :value="user"
                  v-model="filter.users"
                  @change="handleSelectedUsersChange"
                />
                {{ user }}
              </label>
            </div>
          </div>
        </fieldset>
      </section>
    </div>

    <section class="container p-5">
      <div class="columns is-mobile is-vcentered">
        <div class="column p-0">
          <div class="field">
            <div class="control">
              <div class="select is-small" style="width: 100%">
                <select
                  :value="selectedTimelineIndex"
                  @change="handleTimelineSelect($event.target.value)"
                  style="width: 100%"
                >
                  <option value="">-- Select a timeline --</option>
                  <option
                    v-for="(timeline, index) in filteredTimelines"
                    :key="timeline.id"
                    :value="index"
                  >
                    {{ timeline.name }} ({{ timeline.startDate }} -
                    {{ timeline.endDate }})
                  </option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <div class="column is-narrow is-size-7 p-1">
          {{ filteredTimelines.length }} Timelines
        </div>
      </div>

      <!-- <timelines-chart
        :rows="chartRows"
        @timeline-index-select="handleTimelineSelect"
      ></timelines-chart> -->

      <timeline-panel
        v-if="!!selectedTimeline"
        :timeline="selectedTimeline"
      ></timeline-panel>
    </section>
  </main>
</template>

<script>
const TimelinesView = {
  props: {},

  setup() {
    return {
      state: {
        app: store.state.app,
        data: store.state.data,
        list: store.state.list,
      },
      dispatch: {
        timeline: store.dispatch.timeline,
      },
    };
  },

  created() {
    const query = this.$router.currentRoute.value.query;

    const { id, start, end, type } = query;

    if (id)
      this.selectedTimelineIndex = this.filteredTimelines.findIndex(
        (ms) => ms.id === id
      );

    if (start) this.filter.startDate = start;

    if (end) this.filter.endDate = end;
  },

  data() {
    const today = new Date();
    const defaultStartDate = new Date(today);
    const defaultEndDate = new Date(today);

    defaultStartDate.setDate(today.getDate() - 180);
    defaultEndDate.setDate(today.getDate() + 180);

    const [startDate] = defaultStartDate.toJSON().split("T");
    const [endDate] = defaultEndDate.toJSON().split("T");

    return {
      selectedTimelineIndex: "",
      selectAllOwners: true,
      filter: {
        status: "Open",
        users: [],
        startDate,
        endDate,
      },
    };
  },

  computed: {
    selectedTimeline() {
      return this.filteredTimelines[this.selectedTimelineIndex];
    },
    filteredTimelines() {
      const { startDate, endDate, status, users } = this.filter;

      const filtered = this.state.data.timelines
        .filter((ms) => {
          const vm = useTimelineViewModel(ms);

          return (
            (this.selectAllOwners ||
              vm.projects.length === 0 ||
              vm.projects.some((proj) => users.includes(proj.owner))) &&
            (status === "All" || status === ms.status) &&
            (!startDate ||
              !endDate ||
              (startDate >= ms.startDate && startDate <= ms.endDate) ||
              (endDate >= ms.startDate && endDate <= ms.endDate) ||
              (ms.startDate >= startDate && ms.startDate <= endDate) ||
              (ms.endDate >= startDate && ms.endDate <= endDate))
          );
        })
        .sort((a, b) => (a.startDate < b.startDate ? -1 : 1));

      return filtered;
    },
    chartRows() {
      const { startDate, endDate } = this.filter;

      return this.filteredTimelines.map((ms) => {
        const rowStart = ms.startDate < startDate ? startDate : ms.startDate;
        const rowEnd = ms.endDate > endDate ? endDate : ms.endDate;

        return {
          timeline: ms.name,
          startDate: new Date(rowStart),
          endDate: new Date(rowEnd),
        };
      });
    },
  },

  methods: {
    handleSelectAllChange() {
      if (this.selectAllOwners) this.filter.users = [];
    },
    handleSelectedUsersChange() {
      this.selectAllOwners = this.filter.users.length === 0;
    },
    handleTimelineSelect(timelineIndex) {
      this.selectedTimelineIndex = null;

      const timeline = this.filteredTimelines[timelineIndex];

      // chart.setSelection does not currently work for timeline chart :(
      // see https://github.com/google/google-visualization-issues/issues/2357
      // this.chart.setSelection([{ row: selectionIndex, column: undefined }]);

      this.updateRouteQuery({ id: timeline ? timeline.id : "" });
      this.$nextTick().then(
        () => (this.selectedTimelineIndex = timelineIndex)
      );
    },
    updateRouteQuery(options) {
      const currentQuery = this.$router.currentRoute.value.query;

      this.$router.replace({
        path: this.state.app.currentRoute,
        query: {
          ...currentQuery,
          ...options,
        },
      });
    },
  },

  template: document.querySelector("#timelines-view-template")
    .innerHTML,
};

app.component("timelines-view", TimelinesView);
</script>
<template id="timeline-edit-details-template">
  <section>
    <div class="p-3">
      <apps-input
        label="Name"
        size="is-small"
        :schema="vm.validation.schema.name"
        v-model="vm.timeline.name"
        @input="vm.autosave"
      ></apps-input>

      <apps-input
        label="Description"
        size="is-small"
        :schema="vm.validation.schema.description"
        v-model="vm.timeline.description"
        @input="vm.autosave"
      ></apps-input>

      <timeline-project-select :vm="vm"></timeline-project-select>
    </div>

    <div class="columns mb-0">
      <apps-select
        label="Status"
        size="is-small"
        class="column is-narrow pt-0 pb-0"
        :options="state.list.timelineStatuses"
        :schema="vm.validation.schema.status"
        v-model="vm.timeline.status"
        @change="vm.autosave"
      ></apps-select>

      <apps-select
        label="Effort"
        size="is-small"
        class="column is-narrow pt-0 pb-0"
        :options="state.list.timelineEfforts"
        :schema="vm.validation.schema.effort"
        v-model.number="vm.timeline.effort"
        @change="vm.autosave"
      ></apps-select>

      <apps-select
        label="Priority"
        size="is-small"
        class="column is-narrow pt-0 pb-0"
        :options="state.list.timelinePriorities"
        :schema="vm.validation.schema.priority"
        v-model.number="vm.timeline.priority"
        @change="vm.autosave"
      ></apps-select>

      <apps-select
        label="Magnitude"
        size="is-small"
        class="column is-narrow pt-0 pb-0"
        :options="state.list.timelineMagnitudes"
        :schema="vm.validation.schema.magnitude"
        v-model.number="vm.timeline.magnitude"
        @change="vm.autosave"
      ></apps-select>

      <apps-tags
        label="Impacts"
        size="is-small"
        class="column pt-0 pb-0"
        placeholder="Add impact..."
        tag-color="is-light"
        icon-left="add"
        :suggestions="impactSuggestions"
        :schema="vm.validation.schema.impacts"
        v-model="vm.timeline.impacts"
        @change="vm.autosave"
      ></apps-tags>
    </div>

    <div class="p-3">
      <apps-input
        label="Notes"
        size="is-small"
        :schema="vm.validation.schema.notes"
        v-model="vm.timeline.notes"
        @input="vm.autosave"
      ></apps-input>
    </div>

    <div class="columns mb-0">
      <apps-input
        label="Start date"
        size="is-small"
        class="column pt-0 pb-0"
        :schema="vm.validation.schema.startDate"
        v-model="vm.timeline.startDate"
        @input="vm.autosave"
      ></apps-input>

      <apps-input
        label="End date"
        size="is-small"
        class="column pt-0 pb-0"
        :schema="vm.validation.schema.endDate"
        v-model="vm.timeline.endDate"
        @input="vm.autosave"
      ></apps-input>
    </div>

    <div class="field is-grouped is-grouped-right is-grouped-multiline">
      <div class="control">
        <span class="tags has-addons">
          <span class="tag is-primary">Complexity index</span>
          <span class="tag is-light">{{ vm.complexityIndex }}</span>
        </span>
      </div>
      <div class="control">
        <span class="tags has-addons">
          <span class="tag is-info">Duration</span>
          <span class="tag is-light">{{ vm.duration }}</span>
        </span>
      </div>
      <div class="control">
        <span class="tags has-addons">
          <span class="tag is-warning">Remaining</span>
          <span class="tag is-light">{{ vm.remaining }}</span>
        </span>
      </div>
    </div>
  </section>
</template>

<script>
const TimelineEditDetails = {
  props: {
    timeline: Object,
    vm: Object,
  },

  setup(props) {
    const { computed } = Vue;
    const vm = props.vm || useTimelineViewModel(props.timeline);

    const { timelineImpacts } = useListFilters();
    const impactSuggestions = computed(() => timelineImpacts.value.map(t => t.value));

    return {
      vm,
      state: {
        data: store.state.data,
        list: store.state.list,
      },
      impactSuggestions
    };
  },

  computed: {
    users() {
      return this.state.list.users;
    },
  },

  template: document.querySelector("#timeline-edit-details-template")
    .innerHTML,
};

app.component("timeline-edit-details", TimelineEditDetails);
</script>
<template id="timeline-edit-modal-template">
  <section class="modal" role="dialog" :class="{ 'is-active': show }">
    <div class="modal-background" @click="handleClose"></div>
    <div class="modal-content box">
      <div class="columns is-mobile is-vcentered">
        <div class="column p-0">
          <h2 class="title is-6 mb-0">Timeline details</h2>
        </div>
        <div
          v-show="!vm.isNew && !vm.isAutosaving"
          class="column pl-2 is-narrow"
        >
          <button class="button is-small is-white">
            <span class="icon">
              <span
                aria-hidden="true"
                class="material-symbols-outlined"
                @click="handleDelete"
                >delete</span
              >
            </span>
          </button>
        </div>
        <div v-show="vm.isAutosaving" class="column pl-2 is-narrow">
          <bulma-spinner></bulma-spinner>
        </div>
      </div>
      <timeline-edit-details :vm="vm"></timeline-edit-details>
    </div>
    <button
      class="modal-close is-large"
      aria-label="close"
      @click="handleClose"
    ></button>
  </section>
</template>

<script>
const TimelineEditModal = {
  props: {
    show: Boolean,
    timeline: Object,
  },

  emits: ["update:show"],

  setup(props) {
    const vm = useTimelineViewModel(props.timeline);

    return {
      vm,
    };
  },

  methods: {
    handleClose() {
      this.$emit("update:show", false);
    },
    async handleDelete() {
      this.vm.deleteTimeline();
    },
  },

  template: document.querySelector("#timeline-edit-modal-template").innerHTML,
};

app.component("timeline-edit-modal", TimelineEditModal);
</script>
<template id="timeline-edit-tabs-template">
  <section>
    <div class="sticky-header has-background-white">
      <nav class="tabs is-small force-32-height">
        <ul>
          <li v-focus :class="{ 'is-active': selectedTab === 'details' }">
            <a href="#" @click.prevent="selectTab('details')">Details</a>
          </li>
          <li
            v-show="!vm.isNew"
            :class="{ 'is-active': selectedTab === 'projects' }"
          >
            <a
              href="#"
              @click.prevent="selectTab('projects', { forceResize: true })"
              >Projects</a
            >
          </li>
        </ul>
      </nav>
    </div>

    <timeline-edit-details
      v-show="selectedTab === 'details'"
      class="container p-2 mb-4"
      :vm="vm"
    ></timeline-edit-details>

    <section v-show="selectedTab === 'projects'" class="container">
      <project-card
        v-for="project in vm.projects"
        :key="project.id"
        class="mb-2 is-radiusless highlight-border-bottom"
        :project="project"
        :show-favorite="false"
        :show-owner="true"
        :show-item-stats="true"
        @project-click="handleProjectClick"
      ></project-card>
    </section>
  </section>
</template>

<script>
const TimelineEditTabs = {
  props: {
    vm: Object,
  },

  setup() {
    return {
      state: {
        app: store.state.app,
      },
    };
  },

  mounted() {
    const { currentQueryParams } = this.state.app;

    const tab = currentQueryParams.tab;
    if (!tab) return;

    this.selectTab(tab, { forceResize: true });
  },

  data() {
    return {};
  },

  computed: {
    selectedTab() {
      return this.state.app.currentQueryParams.tab || "details";
    },
  },

  methods: {
    selectTab(tabName, { forceResize = false } = {}) {
      this.$router.replace({
        path: this.state.app.currentRoute,
        query: { tab: String(tabName) },
      });

      if (forceResize)
        requestAnimationFrame(() => window.dispatchEvent(new Event("resize")));
    },
    handleProjectClick(project) {
      this.$router.push(`/project/${project.id}`);
    },
  },

  template: document.querySelector("#timeline-edit-tabs-template").innerHTML,
};

app.component("timeline-edit-tabs", TimelineEditTabs);
</script>
<template id="timeline-edit-view-template">
  <main v-if="!!vm">
    <side-menu-container>
      <article class="p-2">
        <h1 class="title is-6">Timeline</h1>
        <hr />

        <timeline-action-bar :vm="vm"></timeline-action-bar>

        <p v-show="!vm.isNew">
          <a href="#" @click.prevent="handleGoToTimeline">Open in timelines chart</a>
        </p>
      </article>
    </side-menu-container>

    <side-menu-content>
      <timeline-edit-tabs :vm="vm"></timeline-edit-tabs>
    </side-menu-content>
  </main>
</template>

<script>
const TimelineEditView = {
  props: {
    id: String,
  },

  setup(props) {
    const { state } = store;

    const { timelineById } = store.calculated;

    const timeline = !state.app.currentQueryParams.isNew
      ? timelineById.value[props.id]
      : store.dispatch.timeline.createNewTimeline({ id: props.id });

    const vm = timeline ? useTimelineViewModel(timeline) : null;

    return {
      vm,
      state: {
        app: store.state.app,
        timeline: store.state.timeline,
      },
    };
  },

  created() {
    if (!this.vm) this.$router.replace("/not-found");
  },

  data() {
    return {};
  },

  methods: {
    handleGoToTimeline() {
      const timeline = this.vm.timeline;

      this.$router.push({
        path: "/timelines-chart",
        query: {
          id: timeline.id,
          start: timeline.startDate,
          end: timeline.endDate,
          status: timeline.status,
        },
      });
    },
  },

  template: document.querySelector("#timeline-edit-view-template").innerHTML,
};

app.component("timeline-edit-view", TimelineEditView);
</script>
<template id="timelines-list-view-template">
  <main>
    <scrollable-hero-table
      v-focus
      :offset="24"
      :headers="headers"
      :rows="rows"
      :filter-fields="filterFields"
      :criteria="criteria"
      :use-worker="true"
      :search-more-options="searchMoreOptions"
      @more-options-action="handleMoreOptionsAction"
      @row-select="handleRowSelect"
    >
      <template #status="row">
        <span class="tag" :class="row.statusBulmaTag">
          {{ row.timeline.status }}
        </span>
      </template>
    </scrollable-hero-table>
  </main>
</template>

<script>
const TimelinesListView = {
  props: {},

  setup() {
    const { timelineStatuses } = useListFilters();
    return {
      timelineStatuses,
      state: {
        data: store.state.data,
      },
      dispatch: {
        util: store.dispatch.util,
      },
    };
  },

  data() {
    return {
      headers: [
        {
          prop: "name",
          caption: "Name",
        },
        {
          prop: "startDate",
          caption: "Start date",
        },
        {
          prop: "endDate",
          caption: "End date",
        },
        {
          prop: "status",
          caption: "Status",
        },
        {
          prop: "description",
          caption: "Description",
        },
        {
          prop: "_complexity",
          caption: "Complexity index",
        },
        {
          prop: "effort",
          caption: "Effort",
        },
        {
          prop: "priority",
          caption: "Priority",
        },
        {
          prop: "magnitude",
          caption: "Magnitude",
        },
        {
          prop: "_impacts",
          caption: "Impacts",
        },
        {
          prop: "_search",
          searchOnly: true,
        },
      ],
      filterFields: [
        {
          prop: "status",
          options: [
            {
              value: "",
              text: "Statuses"
            },
            ...this.timelineStatuses
          ],
        },
      ],
      criteria: {
        search: "",
        filter: {},
        dates: {},
        sort: {
          header: "startDate",
          ascending: false,
        },
      },
      searchMoreOptions: [
        {
          caption: "Export to csv",
          action: "EXPORT_TO_CSV",
        },
      ],
    };
  },

  computed: {
    rows() {
      return this.state.data.timelines.map((timeline) => {
        const vm = useTimelineViewModel(timeline);

        return {
          timeline,
          statusBulmaTag: vm.statusBulmaTag,
          _complexity: vm.complexityIndex,
          _impacts: vm.timeline.impacts.join(", "),
          _search: `${vm.timeline.notes}`,
          ...timeline,
        };
      });
    },
  },

  methods: {
    handleRowSelect({ row }) {
      this.$router.push(`/timeline/${row.timeline.id}`);
    },
    handleMoreOptionsAction({ action, displayedRows, allRows }) {
      switch (action) {
        case "EXPORT_TO_CSV":
          this.handleExportToCsv(displayedRows);
          break;
      }
    },
    handleExportToCsv(displayedRows) {
      const dataToDownload = displayedRows.map((row) => {
        const obj = {};
        this.headers
          .filter((header) => !header.searchOnly)
          .forEach((header) => (obj[header.caption] = row[header.prop]));
        return obj;
      });

      this.dispatch.util.downloadDataAsCsv(
        `IS-Projects-download_project_data_${new Date().toJSON()}.csv`,
        dataToDownload
      );
    },
  },

  template: document.querySelector("#timelines-list-view-template").innerHTML,
};

app.component("timelines-list-view", TimelinesListView);
</script>
<template id="timeline-panel-template">
  <section>
    <div class="columns border-radius light-border p-5">
      <div class="column">
        <div class="columns p-0">
          <div class="column p-1">
            <h2 class="title is-6 mb-3">Timeline details</h2>
          </div>

          <div class="column p-1 is-narrow">
            <timeline-action-bar :vm="vm"></timeline-action-bar>
          </div>
        </div>

        <timeline-edit-details :vm="vm"></timeline-edit-details>
      </div>

      <div v-show="vm.projects.length > 0" class="column is-5">
        <project-card
          v-for="project in vm.projects"
          :key="project.id"
          class="mb-2 is-radiusless highlight-border-bottom"
          :project="project"
          :show-favorite="false"
          :show-owner="false"
          :show-item-stats="false"
          @project-click="handleProjectClick"
        ></project-card>
      </div>
    </div>
  </section>
</template>

<script>
const TimelinePanel = {
  props: {
    timeline: Object,
    vm: Object,
  },

  setup(props) {
    const vm = props.vm || useTimelineViewModel(props.timeline);

    return {
      vm,
    };
  },

  data() {
    return {};
  },

  methods: {
    handleProjectClick(project) {
      this.$router.push(`/project/${project.id}`);
    },
  },

  template: document.querySelector("#timeline-panel-template").innerHTML,
};

app.component("timeline-panel", TimelinePanel);
</script>
<template id="timeline-project-select-template">
  <section>
    <h2 v-show="vm.projects.length > 0" class="subtitle is-6 mb-1">
      Selected projects
    </h2>
    <div class="tags are-small mb-0">
      <span v-for="project in vm.projects" :key="project.id" class="tag m-1">
        <a
          href="#"
          class="has-text-weight-semibold"
          @click.prevent="handleGoToProject(project.id)"
        >
          {{ project.name }}
        </a>
        <button
          class="delete is-small"
          title="Remove project"
          @click="handleRemoveProject(project.id)"
        ></button>
      </span>
    </div>

    <apps-select
      label="Timeline projects"
      size="is-small"
      fullwidth
      :options="projectOptions"
      v-model="newTimelineProject"
      @change="handleNewProject"
    ></apps-select>
  </section>
</template>

<script>
const TimelineProjectSelect = {
  props: {
    vm: Object,
  },

  setup() {
    return {
      state: {
        data: store.state.data,
      },
    };
  },

  data() {
    return {
      newTimelineProject: "",
    };
  },

  computed: {
    projectOptions() {
      return [
        { value: "", text: "-- Select a project --" },
        ...this.state.data.projects
          .filter((proj) => !this.vm.timeline.projects.includes(proj.id))
          .sort((a, b) => (a.name.toLowerCase() > b.name.toLowerCase() ? 1 : -1))
          .map((proj) => ({ value: proj.id, text: proj.name })),
      ];
    },
  },

  methods: {
    handleNewProject(id) {
      this.vm.timeline.projects.push(id);
      this.vm.autosave();
      this.newTimelineProject = "";
    },
    handleRemoveProject(id) {
      this.vm.timeline.projects = this.vm.timeline.projects.filter(
        (projId) => projId !== id
      );
      this.vm.autosave();
    },
    handleGoToProject(id) {
      this.$router.push(`/project/${id}`);
    },
  },

  template: document.querySelector("#timeline-project-select-template")
    .innerHTML,
};

app.component("timeline-project-select", TimelineProjectSelect);
</script>


<script>
//setup for vue routing
const router = VueRouter.createRouter({
  history: VueRouter.createWebHashHistory(),
  routes: [
    { path: '/projects', component: ProjectsListView, meta: { title: 'Projects', refresh: true } },
    { path: '/project/:id', component: ProjectEditView, props: true, meta: { title: 'Project' } },
    { path: '/inactive-projects', component: InactiveProjectsListView, meta: { title: 'Inactive projects', refresh: true } },
    { path: '/items', component: ItemsListView, meta: { title: 'Items', refresh: true } },
    { path: '/item/:id', component: ItemEditView, props: true, meta: { title: 'Item' } },
    { path: '/queue', component: QueueView, meta: { title: 'Queue', refresh: true } },
    { path: '/timelines-chart', component: TimelinesView, meta: { title: 'Timelines chart', refresh: true } },
    { path: '/timelines', component: TimelinesListView, meta: { title: 'Timelines', refresh: true } },
    { path: '/timeline/:id', component: TimelineEditView, props: true, meta: { title: 'Timeline' } },
    { path: '/settings', component: SettingsView, meta: { title: 'Settings' } },
    { path: '/', component: DashboardTabsView, meta: { title: 'Dashboard', refresh: true } },
    { path: '/:catchAll(.*)', component: { template: '<div class="section"><p class="title">Resource not found!</p></div>' }, meta: { title: 'Not found' } },
  ],
  scrollBehavior(to, from, savedPosition) {
    if (savedPosition) {
      return savedPosition;
    } else {
      return { x: 0, y: 0 };
    }
  }
});

//middleware to update store and google history from vue route
router.beforeEach((to, from, next) => {

  const {
    state,
    dispatch
  } = store;

  state.app.currentRoute = to.path;
  state.app.currentQueryParams = to.query;

  if (to.path !== from.path && to.meta.refresh) {
    dispatch.app.loadLatestData();
  }

  state.app.title = to.meta.title;

  // google.script.history.replace({}, to.query, to.path);
  next();

});

/**
 * custom focus directive
 * use: v-focus
 */
app.directive('focus', {

  mounted(el) {

    const focusable = [
      'a',
      'input',
      'select',
      'textarea',
      'button'
    ];

    if (focusable.includes(el.tagName.toLowerCase())) {
      el.focus();
    } else {
      const nearest = el.querySelector(focusable.join(','))
      if (nearest)
        requestAnimationFrame(() => nearest.focus());
    }
  }

});

app.use(router);
const vm = app.mount('#app');
</script>

</html>